include "bt_format "
org 0x0000

p_start:
0000 20200040 branch p_patch_array 

p_zcode:

wake_from_power:
0001 20400093 call init_hp_queue 
0002 58000000 setarg 0 
0003 67e60b4d store 3 ,mem_flash_address 
0004 58004b13 setarg mem_flash_start_addr 
0005 67e40b50 store 2 ,mem_flash_data_address 
0006 58000003 setarg 3 
0007 67e40b52 store 2 ,mem_flash_trans_length 
0008 20405f01 call qspi_nmode 
0009 20405f26 call qspi_read + 1 
000a 68444b14 fetcht 2 ,mem_flash_start_addr + 1 
000b 1850fe00 byteswap temp ,pdata 
000c 68424b13 fetcht 1 ,mem_flash_start_addr 
000d 18500400 lshift16 temp ,temp 
000e 9840fe00 iadd temp ,pdata 
000f 1fe0fffd increase -3 ,pdata 
0010 67e64b13 store 3 ,mem_flash_start_addr 
0011 20001770 nop 6000 
0012 68448352 fetcht 2 ,core_sumdata 
0013 60444a23 storet 2 ,mem_adc_current_value 
0014 6fec4140 fetch 6 ,mem_lap 
0015 67ec49d8 store 6 ,mem_local_lap 
0016 704a2601 jam 1 ,mem_bat_read_timer 
0017 70470401 jam 1 ,mem_wake_flag 
0018 204000b3 call p_hfp_clear_parms 
0019 20405db8 call otp_enable_chgpump 
001a 58001fdc setarg otp_charge_con_addr 
001b da204a28 arg mem_dc_otp_data ,rega 
001c d8400004 arg 4 ,temp 
001d 20405e01 call otpd_read_data 
001e 58001fe2 setarg otp_adc_io_0_5v_addr 
001f da204a06 arg mem_0_5_adc_io_data ,rega 
0020 d840000e arg 14 ,temp 
0021 20405e01 call otpd_read_data 
0022 20405dbb call otp_disable_chgpump 
0023 7042ac80 jam 0x80 ,mem_audio_vol 
0024 6fe88336 fetch 4 ,core_lpm_ctrl 
0025 793ffe1a set0 26 ,pdata 
0026 67e8804c store 4 ,core_lpm_reg 
0027 20403c9b call lpm_write_ctrl 
0028 6fe24b3a fetch 1 ,mem_hibernate_flag 
0029 c281002c bbit1 2 ,p_evt_restart 
002a 700b0865 jam bt_evt_reset ,mem_fifo_temp 
002b 2020038c branch ipc_tx_m0 

p_evt_restart:
002c 700b086a jam bt_evt_restart ,mem_fifo_temp 
002d 2020038c branch ipc_tx_m0 

init_all_queue:
002e 58004b50 setarg mem_alloc_block 
002f 20400033 call queue_init 
0030 58004b69 setarg mem_media_block 
0031 20400033 call queue_init 
0032 58004b81 setarg mem_lcp_block 

queue_init:
0033 1fe20a00 copy pdata ,contw 
0034 1fe0fe09 add pdata ,block_data_offset ,pdata 
0035 e7e40005 istore 2 ,contw 
0036 e7e40005 istore 2 ,contw 
0037 e7e40005 istore 2 ,contw 
0038 1fe0fe0f add pdata ,block_max_len ,pdata 
0039 e7e40005 istore 2 ,contw 
003a df200010 arg block_max_len + 1 ,loopcnt 
003b 2020776c branch clear_mem 
003c 2000003c nop 0x3C 
003d 2000003d nop 0x3D 
003e 2000003e nop 0x3E 
003f 2000003f nop 0x3F 

p_patch_array:
0040 c284006b bbit1 8 ,p_start_ext 
0041 c01f8274 beq patch07_7 ,p_slave_loop 
0042 c020026d beq patch08_0 ,p_slave_notmatch 
0043 c04202ec beq patch10_4 ,p_shutdown_radio 
0044 c029039b beq patch0a_2 ,p_slave_conn_recv_packet 
0045 c02c03a9 beq patch0b_0 ,p_rx_type_dispatch 
0046 c02e02b8 beq patch0b_4 ,p_process_dmh_common_sub_2 
0047 c02e80d2 beq patch0b_5 ,p_process_dmh_data_l2cap_start_pkt 
0048 c02f00ed beq patch0b_6 ,p_process_dmh_data_l2cap_continue_pkt 
0049 c02f8124 beq patch0b_7 ,p_process_dmh_data_end 
004a c0300105 beq patch0c_0 ,p_process_dmh_l2cap_packet 
004b c0310142 beq patch0c_2 ,p_ack_payload 
004c c0348198 beq patch0d_1 ,p_clear_got_txlmp 
004d c03501d0 beq patch0d_2 ,p_start_encryption 
004e c03706da beq patch0d_6 ,p_check_attempt 
004f c0670155 beq patch19_6 ,p_push_cvsd_data_to_dec 
0050 c03600ae beq patch0d_4 ,p_sniff_init 
0051 c0380178 beq patch0e_0 ,p_parse_l2cap 
0052 c03900a0 beq patch0e_2 ,p_slave_conn_send_packet 
0053 c03b015e beq patch0e_6 ,p_transmit_fhs 
0054 c04405eb beq patch11_0 ,p_set_freq_tx 
0055 c0448615 beq patch11_1 ,p_initialize_radio_cont 
0056 c05282db beq patch14_5 ,p_lpm_dispatch 
0057 c0533c19 beq patch14_6 ,lpm_no_ssp + 11 
0058 c05700c6 beq patch15_6 ,p_lpm_check_wake_lock 
0059 c0760710 beq patch1d_4 ,p_hfp_voice_stop 
005a c05f81a1 beq patch17_7 ,p_l2cap_call_proc_avdtp 
005b c06083d7 beq patch18_1 ,p_avd_signal_parse_cmd 
005c c062036a beq patch18_4 ,p_hp_init 
005d c0638456 beq patch18_7 ,p_app_evt_100ms_loop 
005e c0690289 beq patch1a_2 ,p_hp_scb_init 
005f c06800a4 beq patch1a_0 ,p_pop_cvsd_data_send 
0060 c0688497 beq patch1a_1 ,p_a2dp_dac_init 
0061 c06c00b3 beq patch1b_0 ,p_hfp_clear_parms 
0062 c06f80b6 beq patch1b_7 ,p_hfp_process_rfcomm_packet 
0063 c06e82a5 beq patch1b_5 ,p_hfp_hsp_process 
0064 c07504c3 beq patch1d_2 ,p_hfp_dac_init 
0065 c07584ab beq patch1d_3 ,p_hfp_voice_start 
0066 c077071c beq patch1d_6 ,p_ipc_init 
0067 c079872f beq patch1e_3 ,p_ipc_rx_process 
0068 c07c03d1 beq patch1f_0 ,p_l2cap_init_wake 
0069 c07c8242 beq patch1f_1 ,p_process_normal_rx_l2cap_pkt 
006a c07d023e beq patch1f_2 ,p_process_normal_rx_l2cap_pkt_avdtp 

p_start_ext:
006b c0008172 beq patch20_1 ,p_l2cap_proc_signal_connect_req_allow_psm 
006c c003009c beq patch20_6 ,p_l2cap_proc_signal_connect_rsp 
006d c0060120 beq patch21_4 ,p_l2cap_load_channel_param 
006e c015019c beq patch25_2 ,p_l2cap_save_server_ptr 
006f c01f05e5 beq patch27_6 ,p_letx_setfreq 
0070 c02506e3 beq patch29_2 ,p_le_send_adv_ind 
0071 c02906e7 beq patch2a_2 ,p_le_scan 
0072 c02a0707 beq patch2a_4 ,p_le_connected 
0073 c03306f4 beq patch2c_6 ,p_le_adv 
0074 c04002a3 beq patch30_0 ,p_parse_lmp 
0075 c0410397 beq patch30_2 ,p_parse_lmp_accepted 
0076 c0418399 beq patch30_3 ,p_parse_lmp_not_accepted 
0077 c04201f9 beq patch30_4 ,p_send_lmp 
0078 c04301d5 beq patch30_6 ,p_process_conn_sm_continue 
0079 c14c8000 rtneq patch33_1 
007a c1498000 rtneq patch32_3 
007b c14a0000 rtneq patch32_4 
007c c14a8000 rtneq patch32_5 
007d c05003f5 beq patch34_0 ,p_rfc_parse_server_packet 
007e c068068e beq patch3a_0 ,p_tws_rcv_context_info_btclk 
007f c0710309 beq patch3c_2 ,p_check_51cmd_once 
0080 c0718661 beq patch3c_3 ,p_check_51cmd_once_continue 
0081 c0738286 beq patch3c_7 ,p_upper_clear_upper_sm 
0082 c07701cc beq patch3d_6 ,p_upper_major_connect_audio 
0083 c15f8000 rtneq patch37_7 
0084 c060035f beq patch38_0 ,p_tws_send_info_not_match 
0085 c0608353 beq patch38_1 ,p_tws_send_context_info_keymap 
0086 c061065d beq patch38_2 ,p_tws_send_context_info_phase_end 
0087 c0628340 beq patch38_5 ,p_tws_send_connecting_info 
0088 c0630500 beq patch38_6 ,p_tws_m_wait_ack_process 
0089 c066065f beq patch39_4 ,p_tws_send_context_info 
008a c06786ba beq patch39_7 ,p_tws_s_wait_connecting 
008b c0690655 beq patch3a_2 ,p_tws_rcv_context_info_phase_end 
008c c0698630 beq patch3a_3 ,p_tws_check_master_a2dp_start 
008d c06a809e beq patch3a_5 ,p_tws_slave_listen 
008e c06b0657 beq patch3a_6 ,p_tws_slave_scan_adv 
008f c06b8523 beq patch3a_7 ,p_tws_s_rcv_ack 
0090 c06d01ff beq patch3b_2 ,p_tws_rcv_context_info_memcontext 
0091 c06d833b beq patch3b_3 ,p_tws_wait_adv 
0092 70820301 jam 1 ,core_ice_ctrl 

init_hp_queue:
0093 2040002e call init_all_queue 
0094 18007205 force block_max_num ,loopcnt 
0095 dee04b99 arg mem_queue_ptr ,rege 

queue_loop:
0096 ea460037 ifetchr regb ,3 ,rege 
0097 da204b50 arg mem_alloc_block ,rega 
0098 2040075f call queue_insert 
0099 1ee0ee03 increase 3 ,rege 
009a c2000096 loop queue_loop 
009b 20600000 rtn 

p_l2cap_proc_signal_connect_rsp:
009c 700bc692 jam zcode_92 ,mem_zcode_temp_param0 
009d 202007a7 branch p_zcode_entrance 

p_tws_slave_listen:
009e 204007de call p_kick_watchdog 
009f 20207b47 branch tws_slave_listen + 1 

p_slave_conn_send_packet:
00a0 6fe246ea fetch 1 ,mem_tws_state 
00a1 c30037d5 bbit0 tws_state_enable ,slave_conn_send_packet_normal 
00a2 c30336f0 bbit0 tws_state_master ,clear_got_tx 
00a3 202037d1 branch slave_conn_send_packet + 4 

p_pop_cvsd_data_send:
00a4 6fe280f5 fetch 1 ,core_cvsd_ctrl 
00a5 c30000a7 bbit0 cvsd_enable ,p_set_esco_tx_0x55 
00a6 2040432f call pop_cvsd_data_send + 1 

p_set_esco_tx_0x55:
00a7 6fe2473b fetch 1 ,mem_vp_enable 
00a8 243a00ab nbranch tx_esco_0x55 ,blank 
00a9 6fe24a2e fetch 1 ,mem_mic_mute 
00aa 207a0000 rtn blank 

tx_esco_0x55:
00ab df20003c arg 60 ,loopcnt 
00ac d8a0029e arg mem_sco_outdata ,contw 
00ad 202042f2 branch cvsd_set_0x55 

p_sniff_init:
00ae c595b739 bmark0 mark_sco_flag ,sniff_init_acl 
00af 1c40a201 add clkn_bt ,1 ,rega 
00b0 2034b73c branch sniff_init_master ,master 
00b1 1d00a201 add clke_bt ,1 ,rega 
00b2 2020373c branch sniff_init_master 

p_hfp_clear_parms:
00b3 20404467 call hfp_clear_parms + 1 
00b4 7043250f jam hfp_speaker_max_vlm ,mem_hf_vlm_speaker 
00b5 20600000 rtn 

p_hfp_process_rfcomm_packet:
00b6 18e27e00 deposit queue 
00b7 20628000 rtn zero 
00b8 60e40b0d storer queue ,2 ,mem_temp 
00b9 204045a4 call hfp_send_credit_return 
00ba 68e40b0d fetchr queue ,2 ,mem_temp 
00bb 60e24bd0 storer queue ,1 ,mem_ipc_tx_buf + 1 
00bc 18e0f202 add queue ,2 ,loopcnt 

p_wait_rxbuffer:
00bd 20404815 call ipc_check_tx_buf_is_enough 
00be 243400bd nbranch p_wait_rxbuffer ,user 
00bf 704bcf07 jam ipc_type_mesh ,mem_ipc_tx_buf 
00c0 6f224bd0 fetchr loopcnt ,1 ,mem_ipc_tx_buf + 1 
00c1 6fe44328 fetch 2 ,mem_at_payload_ptr 
00c2 1fe20c00 copy pdata ,contr 
00c3 d8a04bd1 arg mem_ipc_tx_buf + 2 ,contw 
00c4 2040779f call memcpy 
00c5 2020072a branch ipc_tx_data 

p_lpm_check_wake_lock:
00c6 20403cb6 call lpm_check_wake_lock + 2 
00c7 243a7905 nbranch setarg1 ,blank 
00c8 6fe44b07 fetch 2 ,mem_m0_lpm_flag 
00c9 243a7905 nbranch setarg1 ,blank 
00ca 204047e7 call ipc_rx_items_inquire 
00cb 2422f905 nbranch setarg1 ,zero 
00cc 204047eb call ipc_tx_items_inquire 
00cd 2422f905 nbranch setarg1 ,zero 
00ce 70433402 jam mcu_state_lpm ,mem_ipc_mcu_state 
00cf 204002c7 call ipc_check_ack0 
00d0 243a7905 nbranch setarg1 ,blank 
00d1 20207907 branch setarg0 

p_process_dmh_data_l2cap_start_pkt:
00d2 c507b689 bmark1 mark_old_packet ,ack_payload 
00d3 6fe4012a fetch 2 ,mem_len 
00d4 d84002e0 arg max_l2cap_len ,temp 
00d5 98467c00 isub temp ,null 
00d6 202136a6 branch error_payload ,positive 
00d7 da204b50 arg mem_alloc_block ,rega 
00d8 20400780 call queue_is_empty 
00d9 203a36b6 branch end_of_packet ,blank 
00da 6fe40309 fetch 2 ,mem_l2cap_rxbuff1_len 
00db c08000e5 bne 0 ,p_l2cap_rxbuff_len_error 
00dc 6844012a fetcht 2 ,mem_len 
00dd 5800026c setarg 620 
00de 98467c00 isub temp ,null 
00df 202100e1 branch p_process_dmh_data_into_buff_normal ,positive 
00e0 7046ec00 jam 0 ,mem_tws_rcv_long_pck 

p_process_dmh_data_into_buff_normal:
00e1 da204b50 arg mem_alloc_block ,rega 
00e2 2040076b call queue_get_read_ptr 
00e3 18c20a00 copy contr ,contw 
00e4 20203649 branch process_dmh_data 

p_l2cap_rxbuff_len_error:
00e5 6fe24b12 fetch 1 ,mem_l2cap_rxbuff_len_error 
00e6 1fe0fe01 increase 1 ,pdata 
00e7 67e24b12 store 1 ,mem_l2cap_rxbuff_len_error 
00e8 c08a36b6 bne 20 ,end_of_packet 
00e9 704b1200 jam 0 ,mem_l2cap_rxbuff_len_error 
00ea 58000000 setarg 0 
00eb 67e40309 store 2 ,mem_l2cap_rxbuff1_len 
00ec 202000e1 branch p_process_dmh_data_into_buff_normal 

p_process_dmh_data_l2cap_continue_pkt:
00ed c507b689 bmark1 mark_old_packet ,ack_payload 
00ee 6fe4012a fetch 2 ,mem_len 
00ef d84002e0 arg max_l2cap_len ,temp 
00f0 98467c00 isub temp ,null 
00f1 202136a6 branch error_payload ,positive 
00f2 6fe40309 fetch 2 ,mem_l2cap_rxbuff1_len 
00f3 203a00fc branch tws_end_of_packet0 ,blank 
00f4 20400101 call p_process_l2cap_continue_check_len 
00f5 242136b6 nbranch end_of_packet ,positive 
00f6 da204b50 arg mem_alloc_block ,rega 
00f7 2040076b call queue_get_read_ptr 
00f8 18c20a00 copy contr ,contw 
00f9 6fe40309 fetch 2 ,mem_l2cap_rxbuff1_len 
00fa 98a08a00 iadd contw ,contw 
00fb 20203649 branch process_dmh_data 

tws_end_of_packet0:
00fc 6fe246ea fetch 1 ,mem_tws_state 
00fd c08cb6b6 bne 0x19 ,end_of_packet 
00fe 6fe24bc4 fetch 1 ,mem_slave_flag 
00ff 203a36b6 branch end_of_packet ,blank 
0100 20207ba3 branch tws_handle_old_packet 

p_process_l2cap_continue_check_len:
0101 6844012a fetcht 2 ,mem_len 
0102 98408400 iadd temp ,temp 
0103 dfe002e0 arg max_l2cap_len ,pdata 
0104 202047e9 branch isub_pdata_temp 

p_process_dmh_l2cap_packet:
0105 6fe40309 fetch 2 ,mem_l2cap_rxbuff1_len 
0106 6844012a fetcht 2 ,mem_len 
0107 9840fe00 iadd temp ,pdata 
0108 67e40309 store 2 ,mem_l2cap_rxbuff1_len 
0109 203a3b25 branch assert ,blank 
010a da204b50 arg mem_alloc_block ,rega 
010b 2040076b call queue_get_read_ptr 
010c 18c20a00 copy contr ,contw 
010d e8440005 ifetcht 2 ,contw 
010e 18408404 increase 4 ,temp 
010f 6fe40309 fetch 2 ,mem_l2cap_rxbuff1_len 
0110 98467c00 isub temp ,null 
0111 20428113 call push_l2cap_to_queue ,zero 
0112 20203676 branch process_dmh_cont 

push_l2cap_to_queue:
0113 18a08a02 increase 2 ,contw 
0114 efe40005 ifetch 2 ,contw 
0115 d8400001 arg l2cap_signal_channel ,temp 
0116 98467c00 isub temp ,null 
0117 20228783 branch push_l2cap_queue ,zero 
0118 1fe22200 copy pdata ,rega 
0119 20404b24 call l2cap_get_channel_info_by_local_cid 
011a efe20013 ifetch 1 ,regc 
011b c08c8783 bne psm_avdtp ,push_l2cap_queue 
011c 6fe44294 fetch 2 ,mem_avdtpmedia_l2capch_ptr 
011d 9a667c00 isub regc ,null 
011e 2022878d branch push_media_queue ,zero 
011f 20200783 branch push_l2cap_queue 

p_l2cap_load_channel_param:
0120 6fe2035f fetch 1 ,mem_l2cap_temp_ch_psm 
0121 dee00226 arg 550 ,rege 
0122 c10c8000 rtneq psm_avdtp 
0123 202049ec branch l2cap_load_channel_param + 2 

p_process_dmh_data_end:
0124 09800010 parse demod ,bucket ,16 
0125 704b2b00 jam 0 ,mem_tws_last_rcv_phone_packet_crc_fail 
0126 24230128 nbranch p_process_dmh_data_end_remind_crc_not_fail ,crc_failed 
0127 704b2b01 jam 1 ,mem_tws_last_rcv_phone_packet_crc_fail 

p_process_dmh_data_end_remind_crc_not_fail:

p_check_and_update_rcv_ack:
0128 c507812c bmark1 mark_old_packet ,p_check_and_update_rcv_ack_end 
0129 6fe24b2a fetch 1 ,mem_tws_rcv_ack_in_crc_fail 
012a 243a012c nbranch p_check_and_update_rcv_ack_end ,blank 
012b 704b1a00 jam 0 ,mem_tws_rcv_ack 

p_check_and_update_rcv_ack_end:
012c 20230136 branch p_error_payload_crc ,crc_failed 

p_process_dmh_data_end0:
012d 6fe246ea fetch 1 ,mem_tws_state 
012e c3003656 bbit0 tws_state_enable ,process_dmh_packet 
012f c301b656 bbit0 tws_state_connected ,process_dmh_packet 
0130 c3037b83 bbit0 tws_state_master ,tws_send_ack_process 
0131 6fe24b1a fetch 1 ,mem_tws_rcv_ack 
0132 c0018134 beq 3 ,p_process_dmh_data_end_without_check_slave_ack 
0133 20207a3b branch tws_wait_ack_process 

p_process_dmh_data_end_without_check_slave_ack:
0134 c507b689 bmark1 mark_old_packet ,ack_payload 
0135 20203656 branch process_dmh_packet 

p_error_payload_crc:
0136 6fe246ea fetch 1 ,mem_tws_state 
0137 c30036a0 bbit0 tws_state_enable ,error_payload_crc 
0138 c301b6a0 bbit0 tws_state_connected ,error_payload_crc 
0139 c3030140 bbit0 tws_state_master ,p_tws_s_send_ack_with_crc_fail_check 
013a 2020013b branch p_tws_m_wait_ack_with_crc_fail_check 

p_tws_m_wait_ack_with_crc_fail_check:
013b 6fe24b1a fetch 1 ,mem_tws_rcv_ack 
013c c001813e beq 3 ,p_tws_m_wait_ack_with_crc_fail_check_2 
013d 20207a3b branch tws_wait_ack_process 

p_tws_m_wait_ack_with_crc_fail_check_2:
013e c507b689 bmark1 mark_old_packet ,ack_payload 
013f 202036a0 branch error_payload_crc 

p_tws_s_send_ack_with_crc_fail_check:
0140 c507fb83 bmark1 mark_old_packet ,tws_send_ack_process 
0141 202036a0 branch error_payload_crc 

p_ack_payload:
0142 6fe20019 fetch 1 ,mem_rx_type 
0143 c000b68a beq type_poll ,ack_payload + 1 
0144 c000368a beq type_null ,ack_payload + 1 
0145 6fe246ea fetch 1 ,mem_tws_state 
0146 c300368a bbit0 tws_state_enable ,ack_payload + 1 
0147 c301b68a bbit0 tws_state_connected ,ack_payload + 1 
0148 c283014a bbit1 tws_state_master ,p_ack_payload_no_set_ack_check 
0149 2020368a branch ack_payload + 1 

p_ack_payload_no_set_ack_check:
014a c0b4814d bne 0x69 ,p_ack_payload_no_set_ack_check0 
014b 6fe24bc6 fetch 1 ,mem_tws_mater_listening 
014c 243a0153 nbranch p_ack_payload_tws_ack ,blank 

p_ack_payload_no_set_ack_check0:
014d 6fe24b1a fetch 1 ,mem_tws_rcv_ack 
014e c0018153 beq 3 ,p_ack_payload_tws_ack 
014f 68420121 fetcht 1 ,mem_temp_arq 
0150 6fe20047 fetch 1 ,mem_cur_arq 
0151 793ffe05 set0 arqnx ,pdata 
0152 2020368d branch ack_payload + 4 

p_ack_payload_tws_ack:
0153 704b2a00 jam 0 ,mem_tws_rcv_ack_in_crc_fail 
0154 2020368a branch ack_payload + 1 

p_push_cvsd_data_to_dec:
0155 6fe2473b fetch 1 ,mem_vp_enable 
0156 247a0000 nrtn blank 
0157 6fe24313 fetch 1 ,mem_hf_call_state 
0158 c1008000 rtneq hfp_incomming 
0159 6fe280f5 fetch 1 ,core_cvsd_ctrl 
015a c4000000 rtnbit0 cvsd_enable 
015b 2040478c call hfp_dac_updatewptr + 1 
015c 2040431f call push_cvsd_data_to_dec + 2 
015d 20200260 branch p_check_end_hfp_start_sync 

p_transmit_fhs:
015e 6fe2014c fetch 1 ,mem_fhs_am_addr 
015f 1fe20800 icopy am_addr 
0160 6fe20097 fetch 1 ,mem_fhs_misc 
0161 1fe23800 icopy fhs_misc 
0162 6fe6414a fetch 3 ,mem_class 
0163 1fe23a00 icopy fhs_class 
0164 6fe44144 fetch 2 ,mem_nap 
0165 1fe25c00 icopy nap 
0166 7824fc00 enable enable_crc 
0167 782e7c00 enable encode_fec2 
0168 1c022200 copy bt_adr ,rega 
0169 2040396d call fetch_self_bt_adr 
016a 782afc00 pulse recalc 
016b 20000020 nop 32 
016c 1c221600 copy bt_clk ,timeup 
016d 6fe8012c fetch 4 ,mem_clkn_bt 
016e 1fe24200 icopy bt_clk 
016f 53c07e00 preload fhs0 
0170 79207e3a set1 58 ,pdata 
0171 2020382f branch transmit_fhs0 

p_l2cap_proc_signal_connect_req_allow_psm:
0172 6a240363 fetchr rega ,2 ,mem_l2cap_temp_remote_cid 

p_l2cap_proc_signal_connect_req_allow_psm0:
0173 1a20a201 increase 1 ,rega 
0174 20404b24 call l2cap_get_channel_info_by_local_cid 
0175 20340173 branch p_l2cap_proc_signal_connect_req_allow_psm0 ,user 
0176 1a227e00 copy rega ,pdata 
0177 20204921 branch l2cap_proc_signal_connect_req_allow_psm + 2 

p_parse_l2cap:
0178 704b0601 jam 1 ,mem_enter_lpm_flag 
0179 793f8001 set0 mark_rxbuf_inuse ,mark 
017a 2040017b call p_parse_l2cap_buff_process 

p_parse_l2cap_buff_process:
017b 70031700 jam l2cap_rx_clear ,mem_l2cap_rx_done 
017c 20404a5f call l2cap_malloc_is_fifo_nearly_full 
017d 247a0000 nrtn blank 
017e da204b81 arg mem_lcp_block ,rega 
017f 20400780 call queue_is_empty 
0180 207a0000 rtn blank 

p_parse_l2cap_buff1_process:
0181 da204b81 arg mem_lcp_block ,rega 
0182 2040076b call queue_get_read_ptr 
0183 20400187 call p_process_rx_l2cap_pkt 
0184 6fe20317 fetch 1 ,mem_l2cap_rx_done 
0185 c0008789 beq l2cap_rx_done ,pop_l2cap_queue 
0186 20600000 rtn 

p_process_rx_l2cap_pkt:
0187 18c20400 copy contr ,temp 
0188 efe40006 ifetch 2 ,contr 
0189 67e40313 store 2 ,mem_l2cap_rx_pkt_length 
018a efe40006 ifetch 2 ,contr 
018b 67e40315 store 2 ,mem_l2cap_rx_cid 
018c 18c27e00 deposit contr 
018d 67e40311 store 2 ,mem_l2cap_payload_ptr 
018e 6fe40313 fetch 2 ,mem_l2cap_rx_pkt_length 
018f 203a48d4 branch l2cap_rx_reset_state ,blank 
0190 6fe20316 fetch 1 ,mem_l2cap_rx_cid + 1 
0191 c0808193 bne 1 ,p_process_rx_l2cap_pkt0 
0192 704b4001 jam 1 ,mem_special_cid 

p_process_rx_l2cap_pkt0:
0193 6fe40315 fetch 2 ,mem_l2cap_rx_cid 
0194 d8400001 arg l2cap_signal_channel ,temp 
0195 98467c00 isub temp ,null 
0196 2022c8c1 branch l2cap_call_proc_signal ,zero 
0197 202048a6 branch process_normal_rx_l2cap_pkt + 2 

p_clear_got_txlmp:
0198 6fe2051b fetch 1 ,mem_lmo_header_opcode 
0199 1fe37e00 rshift pdata ,pdata 
019a c10c0000 rtneq lmp_unsniff_req 
019b 2020370b branch clear_got_txlmp + 3 

p_l2cap_save_server_ptr:
019c 6fe2035f fetch 1 ,mem_l2cap_temp_ch_psm 
019d c00b819f beq psm_avctp ,p_l2cap_save_avr_ptr 
019e 20204b7c branch l2cap_save_server_ptr + 2 

p_l2cap_save_avr_ptr:
019f 704a2c00 jam 0 ,mem_hp_avctp_timer 
01a0 20204b82 branch l2cap_save_avr_ptr 

p_l2cap_call_proc_avdtp:
01a1 20404a5a call l2cap_malloc_is_fifo_full 
01a2 247a0000 nrtn blank 
01a3 6fe40311 fetch 2 ,mem_l2cap_payload_ptr 
01a4 1fe20c00 copy pdata ,contr 
01a5 efe20006 ifetch 1 ,contr 
01a6 1fe104f0 and pdata ,0xf0 ,temp 
01a7 18518400 rshift4 temp ,temp 
01a8 604201ea storet 1 ,mem_transaction_label 
01a9 1fe12203 and pdata ,0x3 ,rega 
01aa 1fe17e0c and pdata ,0xc ,pdata 
01ab c0804100 bne avdtp_packet_type_single ,avd_signal_prase_uncomplete 
01ac 1a227e00 copy rega ,pdata 
01ad c00101af beq avdtp_messgae_type_rsp_accept ,p_avd_signal_parse_rsp_accept 
01ae 2020402f branch l2cap_call_proc_avdtp + 13 

p_avd_signal_parse_rsp_accept:
01af efe20006 ifetch 1 ,contr 
01b0 1fe17e3f and pdata ,0x3f ,pdata 
01b1 67e201e9 store 1 ,mem_avdtp_signal_cmd 
01b2 c00101b4 beq avdtp_identifier_get_capabilities ,p_avd_signal_parse_rsp_accept_getcap 
01b3 202040e8 branch avd_signal_parse_rsp_accept + 3 

p_avd_signal_parse_rsp_accept_getcap:
01b4 18c27e00 copy contr ,pdata 
01b5 6a240313 fetchr rega ,2 ,mem_l2cap_rx_pkt_length 
01b6 9a20a200 iadd rega ,rega 
01b7 1a20a3fe increase -2 ,rega 
01b8 1fe20c00 copy pdata ,contr 

p_avd_signal_parse_rsp_accept_getcap_loop:
01b9 18c27e00 copy contr ,pdata 
01ba 9a267c00 isub rega ,null 
01bb 202140f4 branch avd_signal_parse_rsp_accept_getcap ,positive 
01bc efe20006 ifetch 1 ,contr 
01bd 60c40b25 storer contr ,2 ,mem_contr 
01be d8400007 arg avdtp_category_media_codec ,temp 
01bf 98467c00 isub temp ,null 
01c0 204281c6 call p_adv_analy_conf_codec_cap ,zero 
01c1 6fe40b25 fetch 2 ,mem_contr 
01c2 1fe20c00 copy pdata ,contr 
01c3 efe20006 ifetch 1 ,contr 
01c4 98c08c00 iadd contr ,contr 
01c5 202001b9 branch p_avd_signal_parse_rsp_accept_getcap_loop 

p_adv_analy_conf_codec_cap:
01c6 efe20006 ifetch 1 ,contr 
01c7 efec0006 ifetch 6 ,contr 
01c8 67ec0bbe store 6 ,mem_getcap_codec_type 
01c9 20600000 rtn 

p_upper_sub_avdtp_sig_setconf:
01ca 700bc6d0 jam zcode_d0 ,mem_zcode_temp_param0 
01cb 202007a7 branch p_zcode_entrance 

p_upper_major_connect_audio:
01cc 6fe246dd fetch 1 ,mem_sub_uppersm 
01cd 207a0000 rtn blank 
01ce 700bc6c0 jam zcode_c0 ,mem_zcode_temp_param0 
01cf 202007a7 branch p_zcode_entrance 

p_start_encryption:
01d0 20403726 call start_encryption + 1 
01d1 6fe20535 fetch 1 ,mem_lmp_conn_state 
01d2 c4008000 rtnbit0 sent_conn_req 
01d3 700b0803 jam bt_evt_reconn_started ,mem_fifo_temp 
01d4 202071ee branch ui_ipc_send_event 

p_process_conn_sm_continue:
01d5 6fe20055 fetch 1 ,mem_reconn_lmp_sm 
01d6 207a0000 rtn blank 
01d7 c00381de beq conn_sm_send_switch ,p_host_create_conn_switch 
01d8 c00401e5 beq conn_sm_wait_switch_after_host_connection ,p_host_creat_after_host_conn 
01d9 c00781e7 beq conn_sm_wait_switch ,p_host_create_conn_wait_switch 
01da c00801ec beq conn_sm_wait_send_auth ,p_host_create_conn_wait_send_auth 
01db c00481f2 beq conn_sm_send_aurand ,p_host_auth_remote_dev 
01dc c1088000 rtneq conn_sm_auth_wait 
01dd 20205b7c branch process_conn_sm_continue + 3 

p_host_create_conn_switch:
01de 6fe20535 fetch 1 ,mem_lmp_conn_state 
01df c4018000 rtnbit0 sent_setup_complete 
01e0 c4010000 rtnbit0 received_setup_complete 
01e1 243481e8 nbranch p_host_create_conn_wait_switch_end ,master 
01e2 6fe245a2 fetch 1 ,mem_switch_flag 
01e3 c1008000 rtneq switch_flag_accept 
01e4 20205baa branch host_create_conn_switch + 3 

p_host_creat_after_host_conn:
01e5 7000550f jam conn_sm_wait_switch ,mem_reconn_lmp_sm 
01e6 20600000 rtn 

p_host_create_conn_wait_switch:
01e7 20748000 rtn master 

p_host_create_conn_wait_switch_end:
01e8 1c427e00 copy clkn_bt ,pdata 
01e9 67e80bba store 4 ,mem_wait_auth_clk 
01ea 70005510 jam conn_sm_wait_send_auth ,mem_reconn_lmp_sm 
01eb 20600000 rtn 

p_host_create_conn_wait_send_auth:
01ec 1c427e00 copy clkn_bt ,pdata 
01ed 68480bba fetcht 4 ,mem_wait_auth_clk 
01ee 98467e00 isub temp ,pdata 
01ef 1fe67c64 sub pdata ,100 ,null 
01f0 20610000 rtn positive 
01f1 20205b93 branch host_creat_conn_wait_switch 

p_host_auth_remote_dev:
01f2 6fe20138 fetch 1 ,mem_connection_options 
01f3 c3005b98 bbit0 connection_auth ,host_sm_done 
01f4 70005511 jam conn_sm_auth_wait ,mem_reconn_lmp_sm 
01f5 6fe2004b fetch 1 ,mem_op 
01f6 c3808000 rtnbit1 op_auth_req 
01f7 70007c0b jam lmp_au_rand ,mem_lmo_opcode2 
01f8 20600000 rtn 

p_send_lmp:
01f9 78547c00 disable user 
01fa 20405b1e call lmo_fifo_process 
01fb 6fe20048 fetch 1 ,mem_lmp_to_send 
01fc 207a0000 rtn blank 
01fd 700bc661 jam zcode_61 ,mem_zcode_temp_param0 
01fe 202007a7 branch p_zcode_entrance 

p_tws_rcv_context_info_memcontext:
01ff 6fe20bb9 fetch 1 ,mem_tws_context_offset 
0200 c02d021a beq 90 ,p_tws_rcv_afh 
0201 c0348212 beq 105 ,p_tws_rcv_sco_info 
0202 c03c0227 beq 120 ,p_tws_rcv_a2dp_info 
0203 20400646 call p_tws_check_header 
0204 24740000 nrtn user 
0205 58004040 setarg mem_context 
0206 98408a00 iadd temp ,contw 
0207 1800721e force 30 ,loopcnt 

p_tws_rcv_context_info_memcontext1:
0208 2040779f call memcpy 

p_tws_rcv_context_info_memcontext2:
0209 6fe20bb9 fetch 1 ,mem_tws_context_offset 
020a 1fe0fe1e increase 30 ,pdata 

p_tws_rcv_context_info_memcontext3:
020b 67e20bb9 store 1 ,mem_tws_context_offset 
020c 6fe20bb8 fetch 1 ,mem_tws_connecting_phase 
020d 1fe0fe01 increase 1 ,pdata 
020e 67e20bb8 store 1 ,mem_tws_connecting_phase 

p_tws_rcv_context_info_memcontext4:
020f 20407b37 call tws_send_info_request 
0210 2436864f nbranch p_tws_reset_connecting ,match 
0211 20207ad8 branch tws_s_connecting_wait_match 

p_tws_rcv_sco_info:
0212 20400646 call p_tws_check_header 
0213 24740000 nrtn user 
0214 18007218 force 24 ,loopcnt 
0215 d8a042f9 arg mem_xmem_sco_start ,contw 
0216 2040779f call memcpy 
0217 6fe20bb9 fetch 1 ,mem_tws_context_offset 
0218 1fe0fe0f increase 15 ,pdata 
0219 2020020b branch p_tws_rcv_context_info_memcontext3 

p_tws_rcv_afh:
021a 20400646 call p_tws_check_header 
021b 24740000 nrtn user 
021c efe20006 ifetch 1 ,contr 
021d 67e242ac store 1 ,mem_audio_vol 
021e efe20006 ifetch 1 ,contr 
021f 67e249e6 store 1 ,mem_avctp_play_state 
0220 1800721c force 28 ,loopcnt 
0221 d8a04175 arg mem_afh_error_total ,contw 

p_tws_rcv_context_info_memcontext_user:
0222 2040779f call memcpy 
0223 6fe20bb9 fetch 1 ,mem_tws_context_offset 
0224 1fe0fe0f increase 15 ,pdata 
0225 67e20bb9 store 1 ,mem_tws_context_offset 
0226 2020020f branch p_tws_rcv_context_info_memcontext4 

p_tws_rcv_a2dp_info:
0227 20400646 call p_tws_check_header 
0228 24740000 nrtn user 
0229 18007215 force 21 ,loopcnt 
022a d8a045a6 arg mem_rfc_xmem_start ,contw 
022b 2040779f call memcpy 
022c efe80006 ifetch 4 ,contr 
022d 67e842e6 store 4 ,mem_avctp_xmem_start 
022e efea0006 ifetch 5 ,contr 
022f 67ea4296 store 5 ,mem_audio_allow 
0230 20200209 branch p_tws_rcv_context_info_memcontext2 

check_exit_sniff:
0231 6fe446c1 fetch 2 ,mem_ui_state_map 
0232 c282c24d bbit1 ui_state_bt_sniff ,app_bt_sniff_exit 
0233 20600000 rtn 

avrcp_cmd_play_press:
0234 dee00044 arg passthrough_id_play ,rege 
0235 204042ab call avrcp_press 

avrcp_cmd_play_release:
0236 dee00044 arg passthrough_id_play ,rege 
0237 2020023b branch avrcp_release 

avrcp_cmd_pause_press:
0238 dee00046 arg passthrough_id_pause ,rege 
0239 204042ab call avrcp_press 

avrcp_cmd_pause_release:
023a dee00046 arg passthrough_id_pause ,rege 

avrcp_release:
023b 704b3b01 jam 1 ,mem_avrcp_flag 
023c 79206e07 set1 7 ,rege 
023d 202042ab branch arc_send_ct 

p_process_normal_rx_l2cap_pkt_avdtp:
023e 6fe44292 fetch 2 ,mem_avdtpsignal_l2capch_ptr 
023f 9a667c00 isub regc ,null 
0240 2022c022 branch l2cap_call_proc_avdtp ,zero 
0241 202048d4 branch l2cap_rx_reset_state 

p_process_normal_rx_l2cap_pkt:
0242 efe20013 ifetch 1 ,regc 
0243 c00b8245 beq psm_avctp ,l2cap_process_avctp 
0244 202048ab branch process_normal_rx_l2cap_pkt + 7 

l2cap_process_avctp:
0245 700bc650 jam zcode_50 ,mem_zcode_temp_param0 
0246 202007a7 branch p_zcode_entrance 

proce_avctp_control:
0247 18c08c08 increase 8 ,contr 
0248 efe20006 ifetch 1 ,contr 
0249 67e24aef store 1 ,mem_set_abs_vlm_rsp + 11 
024a 67e24bd2 store 1 ,mem_ipc_tx_buf + 3 
024b 5880020a setarg 0x80020a 
024c 67e64bcf store 3 ,mem_ipc_tx_buf 
024d 2040072a call ipc_tx_data 
024e da604ae4 arg mem_set_abs_vlm_rsp ,regc 
024f 20200250 branch avc_malloc_rsp_buff 

avc_malloc_rsp_buff:
0250 6b0442e8 fetchr regd ,2 ,mem_avr_l2capch_ptr 
0251 ea220013 ifetchr rega ,1 ,regc 
0252 62640bc4 storer regc ,2 ,mem_tws_temp_val 
0253 20404aab call l2cap_malloc_server_channel 
0254 6fe20b0d fetch 1 ,mem_temp 
0255 1fe17e0f and pdata ,0xf ,pdata 
0256 1ff27e00 lshift4 pdata ,pdata 
0257 1fe0fe02 increase 2 ,pdata 
0258 e7e20005 istore 1 ,contw 
0259 58000e11 setarg actp_profile_identifier_avrcp 
025a e7e40005 istore 2 ,contw 
025b 6fe40bc4 fetch 2 ,mem_tws_temp_val 
025c 1fe20c00 icopy contr 
025d efe20006 ifetch 1 ,contr 
025e 1fe0f3fd add pdata ,-3 ,loopcnt 
025f 2020779f branch memcpy 

p_check_end_hfp_start_sync:
0260 6fe24bbc fetch 1 ,mem_enable_hfp_start_sync 
0261 207a0000 rtn blank 

p_check_end_hfp_start_sync_loop:
0262 6fe84bbd fetch 4 ,mem_hfp_start_sync_clk 
0263 9d067e00 isub clke_bt ,pdata 
0264 24210268 nbranch p_check_end_hfp_start_sync_loop_end ,positive 
0265 1fe67c1e sub pdata ,30 ,null 
0266 20210262 branch p_check_end_hfp_start_sync_loop ,positive 
0267 20600000 rtn 

p_check_end_hfp_start_sync_loop_end:
0268 704bbc00 jam 0 ,mem_enable_hfp_start_sync 
0269 6fe20308 fetch 1 ,mem_sco_flag 
026a 793ffe00 set0 sco_rcv_flag ,pdata 
026b 67e20308 store 1 ,mem_sco_flag 
026c 20200319 branch p_recover_audio 

p_slave_notmatch:
026d 20403c49 call lpm_set_mult 
026e 20403b18 call supervision_update 
026f 20210284 branch abnormal_disc_detected ,positive 
0270 204007de call p_kick_watchdog 
0271 20400433 call media_queue 
0272 2040028f call p_tws_media_sync 
0273 20203429 branch slave_notmatch + 4 

p_slave_loop:
0274 204061eb call scheduler_process 
0275 2040355c call slave_conn_recv_packet 
0276 2436b425 nbranch slave_notmatch ,match 
0277 20400279 call p_check_rssi 
0278 20203419 branch slave_loop + 4 

p_check_rssi:
0279 6a224b31 fetchr rega ,1 ,mem_rssi_data 
027a 6fee4b32 fetch 7 ,mem_rssi_data + 1 
027b 67ee4b31 store 7 ,mem_rssi_data 
027c 6fe20018 fetch 1 ,mem_rssi 
027d 67e24b38 store 1 ,mem_rssi_data + 7 
027e 68444b2d fetcht 2 ,mem_rssi_sum 
027f 9840fe00 iadd temp ,pdata 
0280 9a267e00 isub rega ,pdata 
0281 67e44b2d store 2 ,mem_rssi_sum 
0282 704b3e01 jam 1 ,mem_rssi_update 
0283 20600000 rtn 

abnormal_disc_detected:
0284 7920002d set1 mark_supervision_disconn ,mark 
0285 20203439 branch slave_disconnect 

p_upper_clear_upper_sm:
0286 58000000 setarg 0 
0287 67f046dc store 8 ,mem_uppersm_xmem_start 
0288 20600000 rtn 

p_hp_scb_init:
0289 20404415 call hp_scb_init + 1 
028a 58012800 setarg sbc_decode_buffer_start 
028b 67e4810c store 2 ,core_sbc_daddr 
028c 58001800 setarg sbc_decode_buffer_size 
028d 67e48110 store 2 ,core_sbc_dlen 
028e 20204420 branch hp_scb_init_end 

p_tws_media_sync:
028f 6fe24ba8 fetch 1 ,mem_enable_start_sync 
0290 203a029a branch p_tws_media_sync_0 ,blank 

p_tws_media_sync_check_end_start_sync_loop:
0291 6fe84bac fetch 4 ,mem_start_play_clk 
0292 9d067e00 isub clke_bt ,pdata 
0293 24210298 nbranch p_tws_media_sync_check_end_start_sync_loop_end ,positive 
0294 1fe67c28 sub pdata ,40 ,null 
0295 2041029b call p_set_media_wait_clk ,positive 
0296 20210291 branch p_tws_media_sync_check_end_start_sync_loop ,positive 
0297 2020029a branch p_tws_media_sync_0 

p_tws_media_sync_check_end_start_sync_loop_end:
0298 704ba800 jam 0 ,mem_enable_start_sync 
0299 704ba900 jam 0 ,mem_media_wait_clk 

p_tws_media_sync_0:
029a 20600000 rtn 

p_set_media_wait_clk:
029b 704ba901 jam 1 ,mem_media_wait_clk 
029c 20600000 rtn 

p_save_process_info:
029d 6fe44b4e fetch 2 ,mem_a2dp_seq_num 
029e 67e44bb0 store 2 ,mem_process_a2dp_seq_num 
029f 1d027e00 copy clke_bt ,pdata 
02a0 67e84bb2 store 4 ,mem_process_clk 
02a1 700b080c jam tws_sync_evt_update_audio_process_info ,mem_fifo_temp 
02a2 20200722 branch ipc_tx_tws_event 

p_parse_lmp:
02a3 700bc620 jam zcode_20 ,mem_zcode_temp_param0 
02a4 202007a7 branch p_zcode_entrance 

p_hfp_hsp_process:
02a5 20404a61 call l2cap_malloc_is_fifo_empty 
02a6 247a0000 nrtn blank 
02a7 6fe24312 fetch 1 ,mem_hf_state 
02a8 c084c517 bne hf_state_connected ,hfp_hsp_process + 4 
02a9 6fe24a00 fetch 1 ,mem_hfp_battery_state 
02aa 207a0000 rtn blank 
02ab 580002af setarg p_hfp_set_content 
02ac 67e40bc7 store 2 ,mem_zcode_temp_param1 
02ad 700bc610 jam zcode_10 ,mem_zcode_temp_param0 
02ae 202007a7 branch p_zcode_entrance 

p_hfp_set_content:
02af 1a220c00 copy rega ,contr 
02b0 efe20006 ifetch 1 ,contr 
02b1 67e445b4 store 2 ,mem_current_packet_length 
02b2 1fe27200 icopy loopcnt 
02b3 580002ea setarg mem_at_command_data 
02b4 67e4432c store 2 ,mem_at_rfcomm_data_ptr 
02b5 1fe20a00 icopy contw 
02b6 2040779f call memcpy 
02b7 20204748 branch hfp_tx_rfcomm_without_credit 

p_process_dmh_common_sub_2:
02b8 793f8000 set0 mark_fhs_eir ,mark 
02b9 6fe246ea fetch 1 ,mem_tws_state 
02ba c300360e bbit0 tws_state_enable ,process_dmh_common_packet 
02bb c301b60e bbit0 tws_state_connected ,process_dmh_common_packet 
02bc c507fba3 bmark1 mark_old_packet ,tws_handle_old_packet 
02bd 2020360e branch process_dmh_common_packet 

qspi_gpio_init:
02be 18007206 force 6 ,loopcnt 
02bf d8c04b41 arg mem_qspi_gpio_ncs1 ,contr 

qspi_gpio_init_loop:
02c0 efe20006 ifetch 1 ,contr 
02c1 e8420006 ifetcht 1 ,contr 
02c2 20405ebd call gpio_config_function 
02c3 c20002c0 loop qspi_gpio_init_loop 
02c4 20600000 rtn 

ipc_check_ack:
02c5 704b0600 jam 0 ,mem_enter_lpm_flag 
02c6 70470400 jam 0 ,mem_wake_flag 

ipc_check_ack0:
02c7 2000001e nop 30 
02c8 6fe24334 fetch 1 ,mem_ipc_mcu_state 
02c9 c001f907 beq mcu_state_stop ,setarg0 
02ca c0007905 beq mcu_state_idle ,setarg1 
02cb 202002c7 branch ipc_check_ack0 

cb_enter_hibernate:
02cc 700bc6e0 jam zcode_e0 ,mem_zcode_temp_param0 
02cd 202007a7 branch p_zcode_entrance 

cb_enter_lpm:
02ce 704b0600 jam 0 ,mem_enter_lpm_flag 
02cf 70470400 jam 0 ,mem_wake_flag 

clear_gpio_before_lpm:
02d0 df200020 arg 32 ,loopcnt 
02d1 d8c08080 arg core_gpio_conf ,contr 

lpm_setgpio_loop:
02d2 18c20a00 copy contr ,contw 
02d3 efe20006 ifetch 1 ,contr 
02d4 c01602d7 beq gpcfg_iic_scl ,lpm_setgpio_pulldown 
02d5 c01682d7 beq gpcfg_iic_sda ,lpm_setgpio_pulldown 
02d6 c08002d9 bne gpcfg_input ,lpm_setgpio_loop_end 

lpm_setgpio_pulldown:
02d7 58000080 setarg gpcfg_pulldown 
02d8 e7e20005 istore 1 ,contw 

lpm_setgpio_loop_end:
02d9 c20002d2 loop lpm_setgpio_loop 
02da 20600000 rtn 

p_lpm_dispatch:
02db c6158000 rtnmark1 mark_sco_flag 
02dc 6fe28980 fetch 1 ,0x8980 
02dd c1ff8000 rtnne 0xff 
02de da204b50 arg mem_alloc_block ,rega 
02df 2040077d call queue_is_full 
02e0 24628000 nrtn zero 
02e1 6fe24b26 fetch 1 ,mem_current_queue_len 
02e2 247a0000 nrtn blank 
02e3 6fe249f3 fetch 1 ,mem_tws_snd_op 
02e4 247a0000 nrtn blank 
02e5 6fea49f9 fetch 5 ,mem_tws_cmd_fifo 
02e6 247a0000 nrtn blank 
02e7 6fe24313 fetch 1 ,mem_hf_call_state 
02e8 c1800000 rtnne hfp_nono 
02e9 6fe20535 fetch 1 ,mem_lmp_conn_state 
02ea 67e249e2 store 1 ,mem_xlmp_conn_state 
02eb 20203c01 branch lpm_dispatch + 1 

p_shutdown_radio:
02ec 203082f8 branch p_shutdown_radio0 ,is_rx 
02ed 708955d4 jam 0xd4 ,0x8955 
02ee 20000004 nop 4 
02ef 708955d2 jam 0xd2 ,0x8955 
02f0 20000004 nop 4 
02f1 708955d1 jam 0xd1 ,0x8955 
02f2 20000004 nop 4 
02f3 6fe24291 fetch 1 ,mem_tx_power 
02f4 c00082f6 beq tx_power_3db ,p_shutdown_radio_3db 
02f5 c0020306 beq tx_power_f5db ,p_shutdown_radio_f5db 

p_shutdown_radio_8db:

p_shutdown_radio_5db:

p_shutdown_radio_3db:

p_shutdown_radio_0db:
02f6 708955d0 jam 0xd0 ,0x8955 
02f7 708956e0 jam 0xe0 ,0x8956 

p_shutdown_radio0:
02f8 18002a08 force 8 ,radio_ctrl 
02f9 18002a00 force 0 ,radio_ctrl 
02fa 7850fc00 disable is_rx 
02fb 78507c00 disable is_tx 
02fc 782f7c00 pulse packet_end 
02fd 70890200 jam 0x0 ,rfen_mdm 
02fe 70890100 jam 0x0 ,rfen_tx 
02ff 70890000 jam 0x0 ,rfen_rx 
0300 70890300 jam 0 ,rfen_sn 
0301 70890470 jam 0x70 ,rfen_msc 
0302 6fe28906 fetch 1 ,rfen_adc 
0303 793ffe00 set0 0 ,pdata 
0304 67e28906 store 1 ,rfen_adc 
0305 20600000 rtn 

p_shutdown_radio_f5db:

p_shutdown_radio_f3db:
0306 708955d0 jam 0xd0 ,0x8955 
0307 708956c0 jam 0xc0 ,0x8956 
0308 202002f8 branch p_shutdown_radio0 

p_check_51cmd_once:
0309 204071e7 call ui_ipc_get_lock 
030a da2046b4 arg mem_ipc_fifo_c512bt ,rega 
030b 204078c9 call fifo_out 
030c 1fe20400 copy pdata ,temp 
030d 204071eb call ui_ipc_put_lock 
030e 18427e00 copy temp ,pdata 
030f 207a0000 rtn blank 

p_check_51cmd_once_zcode:
0310 67e20bc7 store 1 ,mem_zcode_temp_param1 
0311 700bc6b0 jam zcode_b0 ,mem_zcode_temp_param0 
0312 202007a7 branch p_zcode_entrance 

p_tws_master_accept_switch:
0313 20400549 call send_ipc_tx_event 

p_tws_master_switch_success:
0314 70003000 jam 0 ,mem_state 
0315 204041e2 call app_bb_event_bb_disconn 
0316 20200425 branch p_hp_evt_bb_disconnect 

p_enter_snooze:
0317 700bc6e1 jam zcode_e1 ,mem_zcode_temp_param0 
0318 202007a7 branch p_zcode_entrance 

p_recover_audio:
0319 6fe2473b fetch 1 ,mem_vp_enable 
031a 247a0000 nrtn blank 
031b 2040479b call hfp_dac_stop 
031c c51584ae bmark1 mark_sco_flag ,p_hfp_voice_start0 
031d 6fe249e3 fetch 1 ,mem_a2dp_state 
031e c0838713 bne avdtp_identifier_start ,p_audio_stop_adac 

vp_enable_a2dp_dac:
031f 70429600 jam avd_audio_forbid ,mem_audio_allow 
0320 6fe2473b fetch 1 ,mem_vp_enable 
0321 247a0000 nrtn blank 
0322 70429601 jam avd_audio_allow ,mem_audio_allow 
0323 58000000 setarg 0 
0324 67ed1010 store 6 ,hf_dac_start_address1 
0325 704bca01 jam 1 ,mem_media_start 
0326 20207b32 branch tws_check_master_a2dp_start + 3 

p_send_tws_cmd:
0327 c030032e beq tws_sync_cmd_powr_off ,clear_tws_fifo 
0328 c030832e beq tws_sync_cmd_master_switch ,clear_tws_fifo 

p_send_tws_cmd0:
0329 d8400030 arg 0x30 ,temp 
032a 98467e00 isub temp ,pdata 
032b 67e20b08 store 1 ,mem_fifo_temp 

tws_push_cmd_fifo:
032c da2049f9 arg mem_tws_cmd_fifo ,rega 
032d 202078bd branch fifo_in 

clear_tws_fifo:
032e 704bcc00 jam 0 ,mem_master_snd_timer 
032f d8400000 arg 0 ,temp 
0330 604a49f9 storet 5 ,mem_tws_cmd_fifo 
0331 7049f300 jam 0 ,mem_tws_snd_op 
0332 20200329 branch p_send_tws_cmd0 

p_check_51cmd_stop_discovery:
0333 7043b100 jam 0 ,mem_le_adv_enable 
0334 700b0869 jam bt_evt_exit_discoverable ,mem_fifo_temp 
0335 2040485e call ipc_tx_bt_event 
0336 2020725a branch check_51cmd_stop_discovery 

p_charge_disconnect:

p_charge_full_power_off:
0337 6fe88336 fetch 4 ,core_lpm_ctrl 
0338 79207e1a set1 26 ,pdata 
0339 67e8804c store 4 ,core_lpm_reg 
033a 20203c9b branch lpm_write_ctrl 

p_tws_wait_adv:
033b 6fe20001 fetch 1 ,mem_le_adv_waitcnt 
033c 1fe0fe01 increase 1 ,pdata 
033d 67e20001 store 1 ,mem_le_adv_waitcnt 
033e 7043fa08 jam tws_channel_index ,mem_le_ch_mapped 
033f 20207bc9 branch tws_wait_adv + 5 

p_tws_send_connecting_info:
0340 7043fa08 jam tws_channel_index ,mem_le_ch_mapped 
0341 6fe246ea fetch 1 ,mem_tws_state 
0342 c2838348 bbit1 tws_state_recon ,p_tws_send_recon_adv 
0343 6fe249ef fetch 1 ,mem_tws_profile_connected 
0344 203a0348 branch p_tws_send_recon_adv ,blank 
0345 6fe24bc5 fetch 1 ,mem_tws_profile_disconnected_after_connected 
0346 243a0348 nbranch p_tws_send_recon_adv ,blank 
0347 20207a23 branch tws_send_connecting_info + 1 

p_tws_send_recon_adv:
0348 70440900 jam 0 ,mem_le_txheader 
0349 dfe00016 arg 22 ,pdata 
034a 67e2440a store 1 ,mem_le_txlen 
034b 6fec46e4 fetch 6 ,mem_tws_bdaddr 
034c 67ec440b store 6 ,mem_le_txpayload 
034d d840ffee arg tws_ble_adv_flag_power_on ,temp 
034e 6fe246ea fetch 1 ,mem_tws_state 
034f c3030351 bbit0 tws_state_master ,p_tws_send_recon_adv_set_flag 

p_tws_send_recon_adv_set_flag_master:
0350 d840ffdd arg tws_ble_adv_flag_no_connected ,temp 

p_tws_send_recon_adv_set_flag:
0351 e0440005 istoret 2 ,contw 
0352 20207a2a branch tws_send_connecting_info + 8 

p_tws_send_context_info_keymap:
0353 6fe246ea fetch 1 ,mem_tws_state 
0354 c040835a beq 0x81 ,p_tws_slave_is_found 
0355 6fe249ef fetch 1 ,mem_tws_profile_connected 
0356 203a035b branch p_tws_device_is_found ,blank 
0357 202079ef branch tws_send_context_info_keymap + 1 

p_tws_master_is_found:
0358 700b080b jam tws_evt_master_found ,mem_fifo_temp 
0359 2020035b branch p_tws_device_is_found 

p_tws_slave_is_found:
035a 700b080a jam tws_evt_slave_found ,mem_fifo_temp 

p_tws_device_is_found:
035b 7044ec38 jam adv_interval ,mem_le_adv_interval_max 
035c 7046ea00 jam 0 ,mem_tws_state 
035d 20407a38 call tws_reset_connecting 
035e 20200722 branch ipc_tx_tws_event 

p_tws_send_info_not_match:
035f 20407a38 call tws_reset_connecting 
0360 6fe249f1 fetch 1 ,mem_tws_adv_count 
0361 1fe0fe01 increase 1 ,pdata 
0362 67e249f1 store 1 ,mem_tws_adv_count 
0363 c515f9eb bmark1 mark_sco_flag ,tws_send_info_not_match_end 
0364 200003e8 nop 1000 
0365 c08186d2 bne 3 ,p_recon_tws_m_wait_connecting_state_check 
0366 7049f100 jam 0 ,mem_tws_adv_count 

p_tws_send_info_not_match_end:
0367 d8e0000f arg le_tws_adv_interval_timer ,queue 
0368 6fe444ec fetch 2 ,mem_le_adv_interval_max 
0369 202077a6 branch timer_init 

p_hp_init:
036a 6fe28339 fetch 1 ,0x8339 
036b 67e24b3a store 1 ,mem_hibernate_flag 
036c 708907e2 jam 0xe2 ,0x8907 
036d 204039f3 call initialize_radio_cont 
036e 7080970c jam 12 ,gpio_for_debug_uart 
036f 6fe48050 fetch 2 ,core_clkoff 
0370 793ffe05 set0 5 ,pdata 
0371 793ffe09 set0 9 ,pdata 
0372 793ffe0b set0 11 ,pdata 
0373 79207e07 set1 7 ,pdata 
0374 79207e0c set1 12 ,pdata 
0375 79207e06 set1 clock_off_voice_filter ,pdata 
0376 67e48050 store 2 ,core_clkoff 
0377 6fe249e2 fetch 1 ,mem_xlmp_conn_state 
0378 67e20535 store 1 ,mem_lmp_conn_state 
0379 204007de call p_kick_watchdog 
037a 70804f8a jam 0x8a ,core_lpm_isogate 
037b 20403c9b call lpm_write_ctrl 
037c 580003fc setarg p_hp_user_evt 
037d 67e442c5 store 2 ,mem_cb_bb_event_process 
037e 5800042c setarg p_hp_idle 
037f 67e442c3 store 2 ,mem_cb_idle_process 
0380 580002ce setarg cb_enter_lpm 
0381 67e442bd store 2 ,mem_cb_before_lpm 
0382 580002cc setarg cb_enter_hibernate 
0383 67e442bb store 2 ,mem_cb_before_hibernate 
0384 204002be call qspi_gpio_init 
0385 70470400 jam 0 ,mem_wake_flag 
0386 20400749 call adc_check_hvin 
0387 24358001 nbranch wake_from_power ,wake 

wake_for_lpm:
0388 6fe44b07 fetch 2 ,mem_m0_lpm_flag 
0389 79207e06 set1 6 ,pdata 
038a 67e44b07 store 2 ,mem_m0_lpm_flag 
038b 700b0866 jam bt_evt_wakeup ,mem_fifo_temp 

ipc_tx_m0:
038c 2040485e call ipc_tx_bt_event 

init_m0:
038d 7001ec00 jam 0 ,mem_otp_ucode_flag 
038e 6fe642dc fetch 3 ,mem_xip_flash_offset 
038f 207a0000 rtn blank 
0390 70801002 jam 0x02 ,core_reset 
0391 68464b13 fetcht 3 ,mem_flash_start_addr 
0392 9840fe00 iadd temp ,pdata 
0393 67e6802c store 3 ,core_flash_offset 
0394 58000002 setarg 2 
0395 79207e00 set1 0 ,pdata 
0396 20205ef3 branch enable_xip_patch 

p_parse_lmp_accepted:
0397 700bc601 jam zcode_01 ,mem_zcode_temp_param0 
0398 202007a7 branch p_zcode_entrance 

p_parse_lmp_not_accepted:
0399 700bc602 jam zcode_02 ,mem_zcode_temp_param0 
039a 202007a7 branch p_zcode_entrance 

p_slave_conn_recv_packet:
039b 2040039d call p_slave_receive_master_slot 
039c 2020355e branch slave_conn_recv_packet + 2 

p_slave_receive_master_slot:
039d 6fe20030 fetch 1 ,mem_state 
039e c30083a2 bbit0 state_insniff ,p_slave_receive_notsniff 
039f 6fe40032 fetch 2 ,mem_tsniff 
03a0 203a03a2 branch p_slave_receive_notsniff ,blank 
03a1 243703a4 nbranch p_slave_receive_sniff ,attempt 

p_slave_receive_notsniff:
03a2 20403ae8 call rf_setup_time_master_slot 
03a3 1d00c201 add clke_bt ,1 ,bt_clk 

p_slave_receive_sniff:
03a4 78287c00 enable swfine 
03a5 6fe4003e fetch 2 ,mem_rx_window 
03a6 1fe37e00 rshift pdata ,pdata 
03a7 d8400250 arg param_pll_setup_min ,temp 
03a8 20203543 branch slave_receive_sniff + 4 

p_rx_type_dispatch:
03a9 18227e00 deposit type 
03aa c00383ad beq type_hv3 ,p_process_2ev3 
03ab c00303ad beq type_2ev3 ,p_process_2ev3 
03ac 202035b2 branch rx_type_dispatch + 2 

p_process_2ev3:
03ad 7046ec01 jam 1 ,mem_tws_rcv_long_pck 
03ae c595b689 bmark0 mark_sco_flag ,ack_payload 
03af c58383b4 bmark0 mark_esco ,p_process_hv3 
03b0 6fe20308 fetch 1 ,mem_sco_flag 
03b1 c2803689 bbit1 sco_rcv_flag ,ack_payload 
03b2 6fe2473b fetch 1 ,mem_vp_enable 
03b3 243a3689 nbranch ack_payload ,blank 

p_process_hv3:
03b4 2aac0001 isolate0 psk ,radio_ctrl 
03b5 202083bc branch p_process_sco_noedr ,true 
03b6 7843fc00 disable enable_white 
03b7 7826fc00 enable decode_fec0 
03b8 1c409602 add clkn_bt ,2 ,timeup 
03b9 34530400 correlate clkn_bt ,meet 
03ba 242c36a6 nbranch error_payload ,sync 
03bb 7823fc00 enable enable_white 

p_process_sco_noedr:
03bc 7826fc00 enable decode_fec0 
03bd 7824fc00 enable enable_crc 
03be 78277c00 enable encrypt 
03bf d8a00262 arg mem_sco_indata ,contw 
03c0 6fe44303 fetch 2 ,mem_sco_rx_packet_len 
03c1 1fe27200 icopy loopcnt 

p_get_hev_data_loop:
03c2 09800008 parse demod ,bucket ,8 
03c3 19897e00 rshift3 pwindow ,pdata 
03c4 e7e20005 istore 1 ,contw 
03c5 c20003c2 loop p_get_hev_data_loop 
03c6 c583b6b6 bmark0 mark_esco ,end_of_packet 
03c7 09800010 parse demod ,bucket ,16 
03c8 7d230008 nsetflag crc_failed ,mark_esco_rxok ,mark 
03c9 202336a6 branch error_payload ,crc_failed 
03ca 6fe20308 fetch 1 ,mem_sco_flag 
03cb 79207e00 set1 sco_rcv_flag ,pdata 
03cc 67e20308 store 1 ,mem_sco_flag 
03cd 6fe246ea fetch 1 ,mem_tws_state 
03ce c0b4b689 bne 0x69 ,ack_payload 
03cf 243736b6 nbranch end_of_packet ,attempt 
03d0 20203689 branch ack_payload 

p_l2cap_init_wake:
03d1 58000365 setarg mem_l2cap_mem_end 
03d2 d8a00309 arg mem_l2cap_mem_start ,contw 
03d3 98a67200 isub contw ,loopcnt 
03d4 2040776c call clear_mem 
03d5 20758000 rtn wake 
03d6 2020487b branch l2cap_init_wake + 1 

p_avd_signal_parse_cmd:
03d7 efe20006 ifetch 1 ,contr 
03d8 18c26e00 copy contr ,rege 
03d9 1fe17e3f and pdata ,0x3f ,pdata 
03da 67e201e9 store 1 ,mem_avdtp_signal_cmd 
03db 67e249e3 store 1 ,mem_a2dp_state 
03dc 67e20b08 store 1 ,mem_fifo_temp 
03dd 20400726 call ipc_tx_a2dp_event 
03de 6fe201e9 fetch 1 ,mem_avdtp_signal_cmd 
03df 1ee20c00 copy rege ,contr 
03e0 c00303e5 beq avdtp_identifier_open ,p_avd_signal_parse_cmd_open 
03e1 c00383ea beq avdtp_identifier_start ,p_avd_signal_parse_cmd_start 
03e2 c00403f0 beq avdtp_identifier_close ,p_avd_signal_parse_cmd_close 
03e3 c00483f2 beq avdtp_identifier_suspend ,p_avd_signal_parse_cmd_suspend 
03e4 2020405e branch avd_signal_parse_cmd + 4 

p_avd_signal_parse_cmd_open:
03e5 704a2c0b jam 11 ,mem_hp_avctp_timer 
03e6 efe20006 ifetch 1 ,contr 
03e7 1feb7e00 rshift2 pdata ,pdata 
03e8 67e242a9 store 1 ,mem_opend_seid 
03e9 202040b9 branch avd_signal_parse_cmd_open_rsp 

p_avd_signal_parse_cmd_start:
03ea efe20006 ifetch 1 ,contr 
03eb 1feb7e00 rshift2 pdata ,pdata 
03ec 67e242aa store 1 ,mem_started_seid 
03ed da200002 arg 2 ,rega 
03ee 20404106 call adv_malloc_rsp_accept 
03ef 202048d4 branch l2cap_rx_reset_state 

p_avd_signal_parse_cmd_close:
03f0 20400713 call p_audio_stop_adac 
03f1 202040c6 branch avd_signal_parse_cmd_close 

p_avd_signal_parse_cmd_suspend:
03f2 204040c6 call avd_signal_parse_cmd_suspend 
03f3 c6158000 rtnmark1 mark_sco_flag 
03f4 20200713 branch p_audio_stop_adac 

p_rfc_parse_server_packet:
03f5 6fe2056f fetch 1 ,mem_rfc_frame_type 
03f6 c039e074 beq rfcomm_frame_type_ua ,rfc_parse_server_ua 
03f7 c01fe07f beq rfcomm_frame_type_sabm ,rfc_parse_server_sabm 
03f8 c029e0ab beq rfcomm_frame_type_disconn ,rfc_parse_sverver_disconnect 
03f9 c077e09b beq rfcomm_frame_type_uih ,rfc_parse_server_uih 
03fa c07fe093 beq rfcomm_frame_type_uih_credits ,rfc_parse_server_uih_credits 
03fb 20600000 rtn 

p_hp_user_evt:
03fc 1a627e00 copy regc ,pdata 
03fd c00a070c beq bt_evt_le_connected ,p_tws_pairing_slave_success 
03fe c0010425 beq bt_evt_bb_disconnected ,p_hp_evt_bb_disconnect 
03ff c001f2b6 beq bt_evt_reconn_started ,upper_init_reconnect 
0400 20600000 rtn 

p_reconnect_avdtp:
0401 6fe44292 fetch 2 ,mem_avdtpsignal_l2capch_ptr 
0402 247a0000 nrtn blank 
0403 70429a02 jam 2 ,mem_a2dp_reconnct_delay_timer 
0404 20600000 rtn 

tws_sec_link_connected:
0405 704bc400 jam 0 ,mem_slave_flag 
0406 704b0264 jam 100 ,mem_slave_poll_timer 
0407 6fe249e3 fetch 1 ,mem_a2dp_state 
0408 c1838000 rtnne avdtp_identifier_start 
0409 704b0228 jam 40 ,mem_slave_poll_timer 
040a 20600000 rtn 

hfp_send_redial:
040b 204045a4 call hfp_send_credit_return 

send_redial:
040c da204ab6 arg mem_at_redial ,rega 
040d 202002af branch p_hfp_set_content 

hfp_send_recognition:
040e 204045a4 call hfp_send_credit_return 

send_recognition:
040f da204abf arg mem_at_recognition ,rega 
0410 202002af branch p_hfp_set_content 

p_start_wait_tws_slave:
0411 704ba800 jam 0 ,mem_enable_start_sync 
0412 704bc600 jam 0 ,mem_tws_mater_listening 
0413 6fec46e4 fetch 6 ,mem_tws_bdaddr 
0414 203a0423 branch p_tws_recon_fail ,blank 
0415 7046ea45 jam 0x45 ,mem_tws_state 
0416 7049d555 jam tws_set_master ,mem_tws_role 
0417 700b0808 jam tws_evt_wait_slave ,mem_fifo_temp 
0418 20200722 branch ipc_tx_tws_event 

p_tws_refresh_slave_no_connect_wait_switch_timeout:
0419 704bc350 jam tws_slave_no_connect_wait_switch_timeout ,mem_observe_wait_connect_timer 
041a 20600000 rtn 

p_start_wait_tws_master:
041b 6fec46e4 fetch 6 ,mem_tws_bdaddr 
041c 203a0423 branch p_tws_recon_fail ,blank 

p_tws_set_slave_role:
041d 7046ea04 jam 0x04 ,mem_tws_state 
041e 20400419 call p_tws_refresh_slave_no_connect_wait_switch_timeout 
041f 7049d533 jam tws_set_slave ,mem_tws_role 
0420 700b0806 jam tws_evt_wait_master ,mem_fifo_temp 
0421 20200722 branch ipc_tx_tws_event 

p_stop_recon_tws:

p_stop_wait_tws_slave:

p_stop_wait_tws_master:
0422 7046ea00 jam 0x00 ,mem_tws_state 

p_tws_recon_fail:
0423 700b0805 jam tws_evt_recon_faile ,mem_fifo_temp 
0424 20200722 branch ipc_tx_tws_event 

p_hp_evt_bb_disconnect:
0425 700bc640 jam zcode_40 ,mem_zcode_temp_param0 
0426 202007a7 branch p_zcode_entrance 

p_check_m0_state:
0427 6fe24334 fetch 1 ,mem_ipc_mcu_state 
0428 c1818000 rtnne mcu_state_stop 
0429 70433400 jam mcu_state_idle ,mem_ipc_mcu_state 
042a 700b0866 jam bt_evt_wakeup ,mem_fifo_temp 
042b 2020485e branch ipc_tx_bt_event 

p_hp_idle:
042c 20400433 call media_queue 
042d 204004ba call check_enable_sco 
042e 20400427 call p_check_m0_state 
042f 20400179 call p_parse_l2cap + 1 
0430 20405f88 call sbc_hw_check_err 
0431 2040043e call avrcp_cmd_handle 
0432 20204827 branch ipc_rx_process 

media_queue:
0433 6fe24bc7 fetch 1 ,mem_init_a2dp_dac 
0434 245a079b ncall p_hp_stero_init ,blank 
0435 da204b69 arg mem_media_block ,rega 
0436 20400780 call queue_is_empty 
0437 207a0000 rtn blank 
0438 6fe24b68 fetch 1 ,mem_media_release 
0439 207a0000 rtn blank 
043a 6fe44b4e fetch 2 ,mem_a2dp_seq_num 
043b 1fe17eff and pdata ,0xff ,pdata 
043c 205a029d call p_save_process_info ,blank 
043d 202007a1 branch pop_media_queue 

avrcp_cmd_handle:
043e 6fe249e5 fetch 1 ,mem_avrcp_cmd_phase 
043f 207a0000 rtn blank 
0440 700bc690 jam zcode_90 ,mem_zcode_temp_param0 
0441 202007a7 branch p_zcode_entrance 

avr_register_notification_play_status:
0442 704b3b01 jam 1 ,mem_avrcp_flag 
0443 20404291 call avr_send_vd_playback_status_change 
0444 18a08bf8 increase -8 ,contw 
0445 58050000 setarg 0x050000 
0446 e7e60005 istore 3 ,contw 
0447 58000001 setarg 1 ,pdata 
0448 18a08a04 increase 4 ,contw 
0449 e7e20005 istore 1 ,contw 
044a 20600000 rtn 

a2dp_press_play_pause:
044b 700bc691 jam zcode_91 ,mem_zcode_temp_param0 
044c 202007a7 branch p_zcode_entrance 

p_connect_avrcp_timer:
044d da604a2c arg mem_hp_avctp_timer ,regc 
044e 204041d6 call timer_single_step 
044f 24740000 nrtn user 

p_upper_int_reconnect_avctp:
0450 6fe246ea fetch 1 ,mem_tws_state 
0451 c10c8000 rtneq 0x19 
0452 7046dc02 jam up_major_sm_connect_server ,mem_major_uppersm 
0453 700b0804 jam up_recnnect_audio ,mem_fifo_temp 
0454 7046dd11 jam up_sub_sm_creat_avctp ,mem_sub_uppersm 
0455 202072d4 branch upper_init_reconnect_single 

p_app_evt_100ms_loop:
0456 204007de call p_kick_watchdog 
0457 68420226 fetcht 1 ,mem_app_evt_timer_count 
0458 580000e0 setarg bt_evt_100ms_uint 
0459 9840fe00 iadd temp ,pdata 
045a 67e20b08 store 1 ,mem_fifo_temp 
045b 2040485e call ipc_tx_bt_event 

p_app_evt_100ms_loop_cycle:
045c 6fe20226 fetch 1 ,mem_app_evt_timer_count 
045d 207a0000 rtn blank 
045e 1fe0ffff increase -1 ,pdata 
045f 67e20226 store 1 ,mem_app_evt_timer_count 
0460 204041d2 call timer_l2cap_reconnect_audio 
0461 2040044d call p_connect_avrcp_timer 
0462 20400477 call check_tws_polling 
0463 2040046c call check_tws_master_sync 
0464 2040073a call check_adc_value 
0465 20400487 call check_tws_observe_connecting 
0466 20400468 call p_master_snd_timer 
0467 2020045c branch p_app_evt_100ms_loop_cycle 

p_master_snd_timer:
0468 da604bce arg mem_listen_master_timer ,regc 
0469 204041d6 call timer_single_step 
046a 24740000 nrtn user 
046b 20200471 branch p_change_to_wait_tws_slave 

check_tws_master_sync:
046c da604b05 arg mem_tws_master_sync_timer ,regc 
046d 204041d6 call timer_single_step 
046e 24740000 nrtn user 
046f 6fe246ea fetch 1 ,mem_tws_state 
0470 c1b48000 rtnne 0x69 

p_change_to_wait_tws_slave:
0471 20400411 call p_start_wait_tws_slave 
0472 20400564 call tws_clear_snd_rcv_flag 
0473 67ea49f9 store 5 ,mem_tws_cmd_fifo 
0474 6fe24296 fetch 1 ,mem_audio_allow 
0475 c1808000 rtnne avd_audio_allow 
0476 20200493 branch hp_check_a2dp_channel 

check_tws_polling:
0477 6fe24313 fetch 1 ,mem_hf_call_state 
0478 c1800000 rtnne hfp_nono 
0479 da604b02 arg mem_slave_poll_timer ,regc 
047a 204041d6 call timer_single_step 
047b 24740000 nrtn user 
047c 6fe246ea fetch 1 ,mem_tws_state 
047d c00c8480 beq 0x19 ,p_tws_switch_to_master 
047e c034848e beq 0x69 ,p_tws_master_polling 
047f 20600000 rtn 

p_tws_switch_to_master:
0480 6fe24b3d fetch 1 ,mem_rssi_low 
0481 243a0314 nbranch p_tws_master_switch_success ,blank 
0482 6fe24bc4 fetch 1 ,mem_slave_flag 
0483 243a0314 nbranch p_tws_master_switch_success ,blank 
0484 704bce0f jam 15 ,mem_listen_master_timer 
0485 20400472 call p_change_to_wait_tws_slave + 1 
0486 2020041b branch p_start_wait_tws_master 

check_tws_observe_connecting:
0487 6fe246ea fetch 1 ,mem_tws_state 
0488 c1820000 rtnne 0x04 
0489 da604bc3 arg mem_observe_wait_connect_timer ,regc 
048a 204041d6 call timer_single_step 
048b 24740000 nrtn user 
048c 700b080d jam tws_evt_slave_change_master_no_con ,mem_fifo_temp 
048d 2020035b branch p_tws_device_is_found 

p_tws_master_polling:
048e 704b020d jam tws_master_polling ,mem_slave_poll_timer 
048f 700b0832 jam tws_sync_evt_polling ,mem_fifo_temp 
0490 6fea49f9 fetch 5 ,mem_tws_cmd_fifo 
0491 247a0000 nrtn blank 
0492 2020032c branch tws_push_cmd_fifo 

hp_check_a2dp_channel:
0493 6fe24296 fetch 1 ,mem_audio_allow 
0494 c1808000 rtnne avd_audio_allow 

hp_check_audio_channel:
0495 70810705 jam 5 ,core_dac_sel 
0496 20600000 rtn 

p_a2dp_dac_init:
0497 6fe48050 fetch 2 ,core_clkoff 
0498 793ffe0b set0 clock_off_sbc ,pdata 
0499 67e48050 store 2 ,core_clkoff 
049a 204004a8 call p_hp_dac_samplefreq_sel 
049b 70810608 jam 0x08 ,core_dac_ctrl 
049c 200008fc nop 2300 
049d 58011010 setarg hf_dac_start_address1 
049e 67e48100 store 2 ,core_dac_saddr 
049f 67e48104 store 2 ,core_dac_wptr 
04a0 580017f0 setarg a2dp_dac_buffer_size 
04a1 204043fd call hp_dac_init + 7 
04a2 20400495 call hp_check_audio_channel 

p_a2dp_dac_init_end:
04a3 704b191e jam 30 ,mem_dac_loss 
04a4 70894def jam 0xef ,rf_rx_ib_lna 
04a5 70897e00 jam 0x00 ,0x897e 
04a6 704b4d53 jam 0x53 ,mem_first_buffer_cache 
04a7 202004cd branch dac_ana_enable 

p_hp_dac_samplefreq_sel:

p_hp_dac_samplefreq_sel_48k:
04a8 70896c2d jam 0x2d ,0x896c 
04a9 70896e94 jam 0x94 ,0x896e 
04aa 20204410 branch hp_dac_samplefreq_sel_48k 

p_hfp_voice_start:
04ab 70429600 jam avd_audio_forbid ,mem_audio_allow 
04ac 700b0801 jam hfp_evt_esco_start ,mem_fifo_temp 
04ad 20200724 branch ipc_tx_hfp_event 

p_hfp_voice_start0:
04ae 7080f500 jam 0 ,core_cvsd_ctrl 
04af 2040479b call hfp_dac_stop 
04b0 70429600 jam avd_audio_forbid ,mem_audio_allow 
04b1 20405fb8 call sbc_hw_wait 
04b2 70806400 jam 0 ,core_sbc_ctrl 
04b3 20405e36 call init_filter_ram 
04b4 7080f5c0 jam 0xc0 ,core_cvsd_ctrl 
04b5 204042ef call cvsd_push_0x55_to_cvsd_fifo 
04b6 20404767 call hfp_adc_init 
04b7 20404777 call hfp_dac_init 
04b8 704b3f01 jam 1 ,mem_adac_init 
04b9 20600000 rtn 

check_enable_sco:
04ba c6840000 rtnmark0 mem_sco_flag 
04bb 6fe2473b fetch 1 ,mem_vp_enable 
04bc 247a0000 nrtn blank 
04bd 6fe24b3f fetch 1 ,mem_adac_init 
04be c1810000 rtnne 2 
04bf 704b3f00 jam 0 ,mem_adac_init 
04c0 20404775 call hfp_adc_start 
04c1 204042e1 call cvsd_start 
04c2 20204797 branch hfp_dac_start + 1 

p_hfp_dac_init:
04c3 204004a8 call p_hp_dac_samplefreq_sel_48k 
04c4 70810608 jam 0x08 ,core_dac_ctrl 
04c5 58013000 setarg esco_dac_out 
04c6 67e48104 store 2 ,core_dac_wptr 
04c7 67e48100 store 2 ,core_dac_saddr 
04c8 58000e0f setarg esco_dac_len 
04c9 67e48102 store 2 ,core_dac_len 
04ca 70810705 jam 0x05 ,core_dac_sel 
04cb 70810602 jam 0x2 ,core_dac_ctrl 
04cc 70810800 jam 0 ,core_dac_lvol 

dac_ana_enable:
04cd 6fe28980 fetch 1 ,0x8980 
04ce c1428000 rtneq dac_core_cfg 
04cf 70897f1f jam 0x1f ,0x897f 
04d0 70898085 jam dac_core_cfg ,0x8980 
04d1 70897a61 jam 0x61 ,0x897a 
04d2 20600000 rtn 

p_tws_end_packet:
04d3 784efc00 disable encode_fec0 
04d4 784e7c00 disable encode_fec2 
04d5 7846fc00 disable decode_fec0 
04d6 78467c00 disable decode_fec2 
04d7 7844fc00 disable enable_crc 
04d8 78477c00 disable encrypt 
04d9 7843fc00 disable enable_white 
04da 18002a00 force 0 ,radio_ctrl 
04db 20600000 rtn 

p_tws_set_rcv_rf:
04dc 204039aa call set_freq_rx 
04dd 20403a82 call start_receiver 
04de 7826fc00 enable decode_fec0 
04df 78287c00 enable swfine 
04e0 db600af0 arg 2800 ,stop_watch 
04e1 37c18400 correlate null ,timeout 
04e2 7846fc00 disable decode_fec0 
04e3 20600000 rtn 

p_tws_set_send_rf:
04e4 6fe24291 fetch 1 ,mem_tx_power 
04e5 67e24b3c store 1 ,mem_temp_tx_power 
04e6 c08084e8 bne tx_power_3db ,p_tws_set_send_rf_common 
04e7 70429105 jam tx_power_8db ,mem_tx_power 

p_tws_set_send_rf_common:
04e8 204039b7 call set_freq_tx 
04e9 20403aea call start_transmitter 
04ea 20403afd call send_access_word 
04eb 204005b4 call p_transmit_packet 
04ec 6fe24b3c fetch 1 ,mem_temp_tx_power 
04ed 67e24291 store 1 ,mem_tx_power 
04ee 20600000 rtn 

p_tws_m_check_rcv_packet:
04ef 20400585 call tws_receive_packet_header 
04f0 20630000 rtn crc_failed 
04f1 20400567 call tws_handle_check_command 
04f2 6fe249f3 fetch 1 ,mem_tws_snd_op 
04f3 243a04f9 nbranch p_tws_m_send_packet ,blank 
04f4 684249f6 fetcht 1 ,mem_tws_rcv_op 
04f5 18417e7f and temp ,0x7f ,pdata 
04f6 243a04f9 nbranch p_tws_m_send_packet ,blank 
04f7 6fea49f9 fetch 5 ,mem_tws_cmd_fifo 
04f8 207a0000 rtn blank 

p_tws_m_send_packet:
04f9 6fe44702 fetch 2 ,mem_tws_count_poll 
04fa 1fe0fe01 increase 1 ,pdata 
04fb 67e44702 store 2 ,mem_tws_count_poll 
04fc 204004d3 call p_tws_end_packet 
04fd 20407a6c call tws_set_ack_access 
04fe 68420017 fetcht 1 ,mem_last_freq 
04ff 202004e4 branch p_tws_set_send_rf 

p_tws_m_wait_ack_process:
0500 204036b6 call end_of_packet 
0501 20407a6c call tws_set_ack_access 
0502 20407ab9 call tws_set_dynamic_freq 
0503 204004dc call p_tws_set_rcv_rf 
0504 242c0514 nbranch p_tws_m_wait_ack_process_no_sync_check ,sync 
0505 704b0528 jam tws_master_sync_timeout ,mem_tws_master_sync_timer 
0506 704bc600 jam 0 ,mem_tws_mater_listening 
0507 70470100 jam 0 ,mem_tws_loss_ack 
0508 6fe20019 fetch 1 ,mem_rx_type 
0509 c0008511 beq type_poll ,p_tws_m_wait_ack_process_bypass_crc_fail 
050a c0000511 beq type_null ,p_tws_m_wait_ack_process_bypass_crc_fail 
050b 704b1a03 jam 3 ,mem_tws_rcv_ack 
050c 6fe24b2b fetch 1 ,mem_tws_last_rcv_phone_packet_crc_fail 
050d 203a0511 branch p_tws_m_wait_ack_process_bypass_crc_fail ,blank 
050e 704b2a01 jam 1 ,mem_tws_rcv_ack_in_crc_fail 
050f c507b689 bmark1 mark_old_packet ,ack_payload 
0510 202036a0 branch error_payload_crc 

p_tws_m_wait_ack_process_bypass_crc_fail:
0511 20400558 call tws_master_connected 
0512 204004ef call p_tws_m_check_rcv_packet 
0513 20207a49 branch tws_wait_ack_process + 14 

p_tws_m_wait_ack_process_no_sync_check:
0514 20400519 call p_tws_not_rcv_ack 
0515 6fe24b2b fetch 1 ,mem_tws_last_rcv_phone_packet_crc_fail 
0516 243a7a67 nbranch tws_not_rcv_ack_error ,blank 
0517 c507b689 bmark1 mark_old_packet ,ack_payload 
0518 20207a53 branch tws_wait_ack_process_end 

p_tws_not_rcv_ack:
0519 6fe24bc6 fetch 1 ,mem_tws_mater_listening 
051a 247a0000 nrtn blank 
051b 6fe24701 fetch 1 ,mem_tws_loss_ack 
051c 1fe0fe01 increase 1 ,pdata 
051d 67e24701 store 1 ,mem_tws_loss_ack 
051e c1940000 rtnne 40 
051f 704ba800 jam 0 ,mem_enable_start_sync 
0520 704bc601 jam 1 ,mem_tws_mater_listening 
0521 70470100 jam 0 ,mem_tws_loss_ack 
0522 20600000 rtn 

p_tws_s_rcv_ack:
0523 18227e00 deposit type 
0524 67e246f9 store 1 ,mem_tws_temp 
0525 204004d3 call p_tws_end_packet 
0526 20407a6c call tws_set_ack_access 
0527 20407ab9 call tws_set_dynamic_freq 
0528 204004e4 call p_tws_set_send_rf 
0529 20407a6c call tws_set_ack_access 
052a 68420017 fetcht 1 ,mem_last_freq 
052b 204004dc call p_tws_set_rcv_rf 
052c 242c7b99 nbranch tws_slave_rcv_ack ,sync 
052d 20400585 call tws_receive_packet_header 
052e 20237b99 branch tws_slave_rcv_ack ,crc_failed 
052f 20400567 call tws_handle_check_command 
0530 20207b99 branch tws_slave_rcv_ack 

tws_check_cmd_ack:
0531 6fe249f5 fetch 1 ,mem_tws_snd_cur_arq 
0532 c4018000 rtnbit0 wack 
0533 684249f7 fetcht 1 ,mem_tws_rcv_op_nextseq 
0534 2feffe02 isolate1 seqn ,pdata 
0535 18467c01 sub temp ,1 ,null 
0536 20208538 branch tws_check_cmd_ack_0 ,true 
0537 18467c00 sub temp ,0 ,null 

tws_check_cmd_ack_0:
0538 20628000 rtn zero 
0539 2040053f call tws_clear_sent_cmd 
053a 6fe249f5 fetch 1 ,mem_tws_snd_cur_arq 
053b 793ffe03 set0 wack ,pdata 
053c 79407e02 setflip seqn ,pdata 
053d 67e249f5 store 1 ,mem_tws_snd_cur_arq 
053e 20600000 rtn 

tws_clear_sent_cmd:
053f 6fe249f3 fetch 1 ,mem_tws_snd_op 
0540 7049f300 jam 0 ,mem_tws_snd_op 
0541 1fe17e7f and pdata ,0x7f ,pdata 
0542 c0180549 beq tws_sync_evt_powr_off ,send_ipc_tx_event 
0543 c0188313 beq tws_sync_evt_master_switch ,p_tws_master_accept_switch 
0544 c01c054b beq tws_sync_evt_reset_audio ,tws_evt_reset_audio 
0545 c01d8555 beq tws_sync_evt_hfp_start_sync ,tws_evt_reset_hfp_audio 
0546 c01e8549 beq tws_sync_evt_all_profile_disconnected ,send_ipc_tx_event 
0547 c01f0549 beq tws_sync_evt_drop_one_packet ,send_ipc_tx_event 
0548 20600000 rtn 

send_ipc_tx_event:
0549 67e20b08 store 1 ,mem_fifo_temp 
054a 20200722 branch ipc_tx_tws_event 

tws_evt_reset_audio:
054b 6fe24bc6 fetch 1 ,mem_tws_mater_listening 
054c 247a0000 nrtn blank 
054d 6fe2473b fetch 1 ,mem_vp_enable 
054e 247a0000 nrtn blank 
054f 20405fb8 call sbc_hw_wait 
0550 2040442f call hp_stero_init 
0551 20405f88 call sbc_hw_check_err 
0552 704ba801 jam 1 ,mem_enable_start_sync 
0553 58000038 setarg tws_sync_evt_reset_audio 
0554 20200549 branch send_ipc_tx_event 

tws_evt_reset_hfp_audio:
0555 704bbc01 jam 1 ,mem_enable_hfp_start_sync 
0556 5800003b setarg tws_sync_evt_hfp_start_sync 
0557 20200549 branch send_ipc_tx_event 

tws_master_connected:
0558 6fe246ea fetch 1 ,mem_tws_state 
0559 c3828000 rtnbit1 tws_state_master_listening 
055a 704b020d jam 13 ,mem_slave_poll_timer 
055b 2040055d call tws_set_master_connected 
055c 20200493 branch hp_check_a2dp_channel 

tws_set_master_connected:
055d 7046ea69 jam 0x69 ,mem_tws_state 
055e 704bcc01 jam 1 ,mem_master_snd_timer 
055f 7049d555 jam tws_set_master ,mem_tws_role 
0560 700b0809 jam tws_evt_master_connected ,mem_fifo_temp 
0561 20200722 branch ipc_tx_tws_event 

tws_clear_flag_state:
0562 7049ef00 jam 0 ,mem_tws_profile_connected 
0563 7046ea00 jam 0 ,mem_tws_state 

tws_clear_snd_rcv_flag:
0564 58000000 setarg 0 
0565 67ec49f3 store 6 ,mem_tws_snd_op 
0566 20600000 rtn 

tws_handle_check_command:
0567 20400591 call tws_receive_packet_payload_check 
0568 20630000 rtn crc_failed 
0569 78567c00 disable user2 
056a 20400531 call tws_check_cmd_ack 
056b 684249f6 fetcht 1 ,mem_tws_rcv_op 
056c 18417e7f and temp ,0x7f ,pdata 
056d 243a056f nbranch tws_handle_command ,blank 
056e 20600000 rtn 

tws_handle_command:
056f 284ffe07 isolate1 7 ,temp 
0570 58000000 setarg 0 
0571 7d20fe00 nsetflag true ,0 ,pdata 
0572 67e249f4 store 1 ,mem_tws_snd_op_nextseq 
0573 6fe249f8 fetch 1 ,mem_tws_rcv_old_seq 
0574 98467c00 isub temp ,null 
0575 20628000 rtn zero 
0576 604249f8 storet 1 ,mem_tws_rcv_old_seq 
0577 18417e7f and temp ,0x7f ,pdata 
0578 67e20b08 store 1 ,mem_fifo_temp 
0579 6fe246ea fetch 1 ,mem_tws_state 
057a 1fe67c19 sub pdata ,0x19 ,null 
057b 20428405 call tws_sec_link_connected ,zero 
057c 6fe20b08 fetch 1 ,mem_fifo_temp 
057d c0180580 beq tws_sync_evt_powr_off ,tws_handle_command0 
057e c0188580 beq tws_sync_evt_master_switch ,tws_handle_command0 
057f 20200582 branch tws_handle_command1 

tws_handle_command0:
0580 704ba800 jam 0 ,mem_enable_start_sync 
0581 704bcc00 jam 0 ,mem_master_snd_timer 

tws_handle_command1:
0582 c01c054b beq tws_sync_evt_reset_audio ,tws_evt_reset_audio 
0583 c01d8555 beq tws_sync_evt_hfp_start_sync ,tws_evt_reset_hfp_audio 
0584 20200722 branch ipc_tx_tws_event 

tws_receive_packet_header:
0585 1c230400 rshift bt_clk ,temp 
0586 18419c40 or temp ,0x40 ,white_init 
0587 7823fc00 enable enable_white 
0588 78257c00 enable enable_hec 
0589 7825fc00 enable decode_fec1 
058a 0980000a parse demod ,bucket ,10 
058b 19837e00 rshift pwindow ,pdata 
058c 67e449f6 store 2 ,mem_tws_rcv_op 
058d 09800008 parse demod ,bucket ,8 
058e 7845fc00 disable decode_fec1 
058f 78457c00 disable enable_hec 
0590 20600000 rtn 

tws_receive_packet_payload_check:
0591 684249f6 fetcht 1 ,mem_tws_rcv_op 
0592 18417e7f and temp ,0x7f ,pdata 
0593 c01c0599 beq tws_sync_evt_reset_audio ,tws_receive_reset_audio 
0594 c01d059b beq tws_sync_evt_audio_process_info ,tws_receive_audio_process_info 
0595 c01d8597 beq tws_sync_evt_hfp_start_sync ,tws_receive_hfp_start_sync 
0596 20600000 rtn 

tws_receive_hfp_start_sync:
0597 d8a04bbd arg mem_hfp_start_sync_buffer ,contw 
0598 2020059c branch tws_receive_packet_payload 

tws_receive_reset_audio:
0599 d8a04baa arg mem_start_sync_buffer ,contw 
059a 2020059c branch tws_receive_packet_payload 

tws_receive_audio_process_info:
059b d8a04bb6 arg mem_process_sync_receive_buffer ,contw 

tws_receive_packet_payload:
059c df200006 arg 6 ,loopcnt 
059d 78267c00 enable decode_fec2 
059e 78277c00 enable encrypt 
059f 7824fc00 enable enable_crc 

tws_process_dmh_data:
05a0 09800008 parse demod ,bucket ,8 
05a1 19897e00 rshift3 pwindow ,pdata 
05a2 e7e20005 istore 1 ,contw 
05a3 c20005a0 loop tws_process_dmh_data 

tws_process_dmh_data_end:
05a4 09800010 parse demod ,bucket ,16 
05a5 202336a0 branch error_payload_crc ,crc_failed 
05a6 20600000 rtn 

tws_hfp_start_sync_set_clk_before_send_packet:
05a7 580002bc setarg 700 
05a8 9d00fe00 iadd clke_bt ,pdata 
05a9 67e84bbd store 4 ,mem_hfp_start_sync_clk 
05aa 202005c2 branch tws_transmit_packet_body 

tws_reset_audio_set_clk_before_send_packet:
05ab 580001ae setarg 430 
05ac 9d00fe00 iadd clke_bt ,pdata 
05ad 67e84bac store 4 ,mem_start_play_clk 
05ae 6fe44b4e fetch 2 ,mem_a2dp_seq_num 
05af 68424b71 fetcht 1 ,mem_media_cur_len 
05b0 9840fe00 iadd temp ,pdata 
05b1 1fe0fe03 increase 3 ,pdata 
05b2 67e44baa store 2 ,mem_target_start_seq 
05b3 202005c2 branch tws_transmit_packet_body 

p_transmit_packet:
05b4 6fe249f3 fetch 1 ,mem_tws_snd_op 
05b5 243a05c2 nbranch tws_transmit_packet_body ,blank 
05b6 da2049f9 arg mem_tws_cmd_fifo ,rega 
05b7 204078c9 call fifo_out 
05b8 203a05c2 branch tws_transmit_packet_body ,blank 
05b9 684249f5 fetcht 1 ,mem_tws_snd_cur_arq 
05ba 79200403 set1 wack ,temp 
05bb 284ffe02 isolate1 seqn ,temp 
05bc 604249f5 storet 1 ,mem_tws_snd_cur_arq 
05bd 7920fe07 setflag true ,7 ,pdata 
05be 67e249f3 store 1 ,mem_tws_snd_op 
05bf 1fe17e7f and pdata ,0x7f ,pdata 
05c0 c01c05ab beq tws_sync_evt_reset_audio ,tws_reset_audio_set_clk_before_send_packet 
05c1 c01d85a7 beq tws_sync_evt_hfp_start_sync ,tws_hfp_start_sync_set_clk_before_send_packet 

tws_transmit_packet_body:
05c2 1c230400 rshift bt_clk ,temp 
05c3 18419c40 or temp ,0x40 ,white_init 
05c4 7823fc00 enable enable_white 
05c5 78257c00 enable enable_hec 
05c6 782dfc00 enable encode_fec1 
05c7 6fe449f3 fetch 2 ,mem_tws_snd_op 
05c8 0800860a inject mod ,10 
05c9 78247c00 enable enable_parity 
05ca 08008608 inject mod ,8 
05cb 784dfc00 disable encode_fec1 
05cc 78447c00 disable enable_parity 
05cd 78457c00 disable enable_hec 
05ce 793faa02 set0 psk3m ,radio_ctrl 
05cf 6fe249f3 fetch 1 ,mem_tws_snd_op 
05d0 1fe17e7f and pdata ,0x7f ,pdata 
05d1 c01c05d7 beq tws_sync_evt_reset_audio ,tws_transmit_packet_payload_reset_audio 
05d2 c01d05d9 beq tws_sync_evt_audio_process_info ,tws_transmit_packet_payload_audio_process_info 
05d3 c01d85d5 beq tws_sync_evt_hfp_start_sync ,tws_transmit_packet_payload_hfp_start_sync 
05d4 202036b6 branch end_of_packet 

tws_transmit_packet_payload_hfp_start_sync:
05d5 d8c04bbd arg mem_hfp_start_sync_buffer ,contr 
05d6 202005da branch tws_transmit_packet_payload_prepare 

tws_transmit_packet_payload_reset_audio:
05d7 d8c04baa arg mem_start_sync_buffer ,contr 
05d8 202005da branch tws_transmit_packet_payload_prepare 

tws_transmit_packet_payload_audio_process_info:
05d9 d8c04bb0 arg mem_process_sync_buffer ,contr 

tws_transmit_packet_payload_prepare:
05da df200006 arg 6 ,loopcnt 

tws_transmit_packet_payload_body:
05db 78277c00 enable encrypt 
05dc 7824fc00 enable enable_crc 
05dd 782e7c00 enable encode_fec2 

tws_transmit_stuff_hci_loop:
05de efe20006 ifetch 1 ,contr 
05df 08008608 inject mod ,8 
05e0 c20005de loop tws_transmit_stuff_hci_loop 

tws_transmit_end:
05e1 78247c00 enable enable_parity 
05e2 08008610 inject mod ,16 
05e3 78447c00 disable enable_parity 
05e4 202036b6 branch end_of_packet 

p_letx_setfreq:
05e5 203685e7 branch p_le_rf_tx_enable ,match 
05e6 20204e76 branch letx_setfreq + 2 

p_le_rf_tx_enable:
05e7 6fe28906 fetch 1 ,rfen_adc 
05e8 79207e00 set1 0 ,pdata 
05e9 67e28906 store 1 ,rfen_adc 
05ea 202039be branch rf_tx_enable + 1 

p_set_freq_tx:
05eb 60420017 storet 1 ,mem_last_freq 
05ec 1840a200 add temp ,0 ,rega 
05ed 204039fd call rf_write_freq 
05ee 58000250 setarg param_pll_setup_min 
05ef 20403b27 call sleep 
05f0 6fe28906 fetch 1 ,rfen_adc 
05f1 79207e00 set1 0 ,pdata 
05f2 67e28906 store 1 ,rfen_adc 
05f3 7089003c jam 0x3c ,rfen_rx 
05f4 708901e0 jam 0xe0 ,rfen_tx 
05f5 2000000a nop 10 
05f6 70890201 jam 0x01 ,rfen_mdm 
05f7 7089023d jam 0x3d ,rfen_mdm 
05f8 2000000a nop 10 
05f9 708903b7 jam 0xb7 ,rfen_sn 
05fa 2000000a nop 10 
05fb 7089027d jam 0x7d ,rfen_mdm 
05fc 6fe24291 fetch 1 ,mem_tx_power 
05fd c000060a beq tx_power_0db ,p_set_tx_power_0db 
05fe c0020605 beq tx_power_f5db ,p_set_tx_power_f5db 

p_rx_high_sens:
05ff 70894cfb jam 0xfb ,0x894c 
0600 70894def jam 0xef ,0x894d 
0601 70894eec jam 0xec ,0x894e 
0602 70894f5e jam 0x5e ,0x894f 
0603 c000860c beq tx_power_3db ,p_set_tx_power_3db 

p_set_tx_power_5db:
0604 202039d5 branch set_tx_power_5db 

p_set_tx_power_f5db:
0605 20400610 call p_rx_low_sens 
0606 708956cc jam 0xcc ,0x8956 
0607 204039e1 call txon_common 
0608 708955d8 jam 0xd8 ,0x8955 
0609 20600000 rtn 

p_set_tx_power_0db:
060a 20400610 call p_rx_low_sens 
060b 202039cd branch set_tx_power_0db 

p_set_tx_power_3db:
060c 708956f7 jam 0xf7 ,0x8956 
060d 204039e1 call txon_common 
060e 708955df jam 0xdf ,0x8955 
060f 20600000 rtn 

p_rx_low_sens:
0610 70894c5b jam 0x5b ,0x894c 
0611 70894d96 jam 0x96 ,0x894d 
0612 70894e2c jam 0x2c ,0x894e 
0613 70894f46 jam 0x46 ,0x894f 
0614 20600000 rtn 

p_initialize_radio_cont:
0615 70894bba jam 0xba ,0x894b 
0616 6fe24291 fetch 1 ,mem_tx_power 
0617 c0008622 beq tx_power_3db ,p_initialize_radio_cont_3db 
0618 c0020627 beq tx_power_f5db ,p_initialize_radio_cont_f5db 
0619 c0010622 beq tx_power_5db ,p_initialize_radio_cont_5db 
061a c002861f beq tx_power_8db ,p_initialize_radio_cont_8db 

p_initialize_radio_cont_0db:
061b 5888e0d0 setarg 0x88e0d0 
061c 67e68955 store 3 ,0x8955 
061d 5800106c setarg 0x106c 
061e 20200625 branch p_initialize_radio_cont_common2 

p_initialize_radio_cont_8db:
061f 58cce0d0 setarg 0xcce0d0 
0620 67e68955 store 3 ,0x8955 
0621 20200624 branch p_initialize_radio_cont_common 

p_initialize_radio_cont_3db:

p_initialize_radio_cont_5db:
0622 5888e0d0 setarg 0x88e0d0 
0623 67e68955 store 3 ,0x8955 

p_initialize_radio_cont_common:
0624 5800103c setarg 0x103c 

p_initialize_radio_cont_common2:
0625 67e48958 store 2 ,0x8958 
0626 202039f4 branch initialize_radio_cont + 1 

p_initialize_radio_cont_f3db:

p_initialize_radio_cont_f5db:
0627 5888c0d0 setarg 0x88c0d0 
0628 67e68955 store 3 ,0x8955 
0629 5800106c setarg 0x106c 
062a 67e48958 store 2 ,0x8958 
062b 202039f4 branch initialize_radio_cont + 1 

p_tws_m_wait_connecting:
062c 6fe24b06 fetch 1 ,mem_enter_lpm_flag 
062d 207a0000 rtn blank 
062e 7049f100 jam 0 ,mem_tws_adv_count 
062f 202006d2 branch p_recon_tws_m_wait_connecting_state_check 

p_tws_check_master_a2dp_start:
0630 7046ea19 jam 0x19 ,mem_tws_state 
0631 6fe24297 fetch 1 ,mem_audio_state 
0632 c0838636 bne 7 ,p_tws_check_master_a2dp_start0 
0633 70429601 jam 1 ,mem_audio_allow 
0634 7049e307 jam avdtp_identifier_start ,mem_a2dp_state 
0635 2040031f call vp_enable_a2dp_dac 

p_tws_check_master_a2dp_start0:
0636 70429700 jam 0 ,mem_audio_state 
0637 7049b255 jam 0x55 ,mem_tws_record_state 
0638 20400663 call p_nv_update_tws_addr 
0639 700b0807 jam tws_evt_slave_connected ,mem_fifo_temp 
063a 20400722 call ipc_tx_tws_event 
063b 704b02b4 jam tws_slave_polling ,mem_slave_poll_timer 
063c 704bc401 jam 1 ,mem_slave_flag 
063d 6fe20030 fetch 1 ,mem_state 
063e c4000000 rtnbit0 state_inconn 
063f 684446c1 fetcht 2 ,mem_ui_state_map 
0640 18418403 or temp ,0x03 ,temp 
0641 604446c1 storet 2 ,mem_ui_state_map 
0642 c4008000 rtnbit0 state_insniff 
0643 79200405 set1 ui_state_bt_sniff ,temp 
0644 604446c1 storet 2 ,mem_ui_state_map 
0645 20600000 rtn 

p_tws_check_header:
0646 78547c00 disable user 
0647 20407b41 call tws_check_bdaddr_is_match 
0648 2422864f nbranch p_tws_reset_connecting ,zero 
0649 6fe20bb9 fetch 1 ,mem_tws_context_offset 
064a 6842036d fetcht 1 ,mem_le_rxbuf + 8 
064b 98467c00 isub temp ,null 
064c 2422864f nbranch p_tws_reset_connecting ,zero 
064d 78347c00 enable user 
064e 20600000 rtn 

p_tws_reset_connecting:
064f 20407a38 call tws_reset_connecting 

p_clear_context:
0650 d8a00030 arg mem_state ,contw 
0651 20400653 call p_clear_mem_80 
0652 d8a04040 arg mem_context ,contw 

p_clear_mem_80:
0653 df20000a arg 10 ,loopcnt 
0654 2020775e branch memset0 

p_tws_rcv_context_info_phase_end:
0655 700bc630 jam zcode_30 ,mem_zcode_temp_param0 
0656 202007a7 branch p_zcode_entrance 

p_tws_slave_scan_adv:
0657 204007de call p_kick_watchdog 
0658 6fe249f2 fetch 1 ,mem_tws_adv_try_num 
0659 1fe0fe01 increase 1 ,pdata 
065a 67e249f2 store 1 ,mem_tws_adv_try_num 
065b c078041d beq 240 ,p_tws_set_slave_role 
065c 20207b60 branch tws_slave_scan_adv + 1 

p_tws_send_context_info_phase_end:
065d 700bc681 jam zcode_81 ,mem_zcode_temp_param0 
065e 202007a7 branch p_zcode_entrance 

p_tws_send_context_info:
065f 700bc680 jam zcode_80 ,mem_zcode_temp_param0 
0660 202007a7 branch p_zcode_entrance 

p_check_51cmd_once_continue:
0661 700bc6a0 jam zcode_a0 ,mem_zcode_temp_param0 
0662 202007a7 branch p_zcode_entrance 

p_nv_update_tws_addr:
0663 6fec46e4 fetch 6 ,mem_tws_bdaddr 
0664 67ec4140 store 6 ,mem_lap 
0665 6fe249b2 fetch 1 ,mem_tws_record_state 
0666 1fe17e0f and_into 0x0f ,pdata 
0667 1fe1fe50 or_into 0x50 ,pdata 

p_nv_update_tws_reconn_info:
0668 67e249b2 store 1 ,mem_tws_record_state 
0669 6fec0040 fetch 6 ,mem_plap 
066a e7ec0005 istore 6 ,contw 
066b d8c04274 arg mem_link_key ,contr 
066c 20407758 call memcpy16 
066d 6fec4140 fetch 6 ,mem_lap 
066e e7ec0005 istore 6 ,contw 
066f 6fec46e4 fetch 6 ,mem_tws_bdaddr 
0670 e7ec0005 istore 6 ,contw 
0671 700b0870 jam bt_evt_dev_update_info ,mem_fifo_temp 
0672 2020485e branch ipc_tx_bt_event 

p_nv_load_tws_info:
0673 6fec49b3 fetch 6 ,mem_tws_peer_lap 
0674 67ec0040 store 6 ,mem_plap 
0675 d8a04274 arg mem_link_key ,contw 
0676 20407758 call memcpy16 
0677 efec0006 ifetch 6 ,contr 
0678 67ec4140 store 6 ,mem_lap 
0679 efec0006 ifetch 6 ,contr 
067a 67ec46e4 store 6 ,mem_tws_bdaddr 
067b efe20006 ifetch 1 ,contr 
067c 67e249d5 store 1 ,mem_tws_role 
067d 20600000 rtn 

p_reconnect_phone:
067e 6fec0040 fetch 6 ,mem_plap 
067f 203a3096 branch idle_recon_fail ,blank 
0680 67ec4286 store 6 ,mem_hci_plap 
0681 6fe446c1 fetch 2 ,mem_ui_state_map 
0682 79207e07 set1 ui_state_bt_reconnect ,pdata 
0683 67e446c1 store 2 ,mem_ui_state_map 
0684 6fe242d7 fetch 1 ,mem_app_connection_options 
0685 67e20138 store 1 ,mem_connection_options 
0686 70427001 jam 1 ,mem_link_key_exists 
0687 2040725f call check_51cmd_reconnect 
0688 700b0873 jam bt_evt_reconnect_rsp ,mem_fifo_temp 
0689 2020485e branch ipc_tx_bt_event 

p_exit_tws_state:
068a 7046ea00 jam 0 ,mem_tws_state 
068b 7049d500 jam 0 ,mem_tws_role 
068c 700b080f jam tws_evt_tws_none ,mem_fifo_temp 
068d 20200722 branch ipc_tx_tws_event 

p_tws_rcv_context_info_btclk:
068e 6fe24bce fetch 1 ,mem_listen_master_timer 
068f 243a0696 nbranch p_tws_rcv_check_is_master ,blank 
0690 6fe246ea fetch 1 ,mem_tws_state 
0691 c283869b bbit1 tws_state_recon ,p_recon_tws_scan 
0692 20407b41 call tws_check_bdaddr_is_match 
0693 2422fa38 nbranch tws_reset_connecting ,zero 
0694 20400419 call p_tws_refresh_slave_no_connect_wait_switch_timeout 
0695 20207ae7 branch tws_rcv_context_info_btclk + 1 

p_tws_rcv_check_is_master:
0696 20407b41 call tws_check_bdaddr_is_match 
0697 2422864f nbranch p_tws_reset_connecting ,zero 
0698 2040064f call p_tws_reset_connecting 
0699 704bce00 jam 0 ,mem_listen_master_timer 
069a 20200314 branch p_tws_master_switch_success 

p_recon_tws_scan:
069b 20407b41 call tws_check_bdaddr_is_match 
069c 2422864f nbranch p_tws_reset_connecting ,zero 
069d 6fe4036d fetch 2 ,mem_le_rxbuf + 8 
069e d840ff0d arg tws_ble_adv_flag_connected ,temp 
069f 98467c00 isub temp ,null 
06a0 202286a8 branch p_recon_tws_scan_arbiter_connected_adv_flag ,zero 
06a1 d840ffee arg tws_ble_adv_flag_power_on ,temp 
06a2 98467c00 isub temp ,null 
06a3 202286aa branch p_recon_tws_scan_power_on_flag ,zero 
06a4 d840ffdd arg tws_ble_adv_flag_no_connected ,temp 
06a5 98467c00 isub temp ,null 
06a6 202286a9 branch p_recon_tws_scan_arbiter_noconnect_adv_flag ,zero 
06a7 20207a38 branch tws_reset_connecting 

p_recon_tws_scan_arbiter_connected_adv_flag:
06a8 202006b7 branch get_tws_rcv_context_info_btclk 

p_recon_tws_scan_arbiter_noconnect_adv_flag:
06a9 20200358 branch p_tws_master_is_found 

p_recon_tws_scan_power_on_flag:
06aa 204006ae call p_tws_state_check_arbiter_in_reconnect 
06ab 2020fa38 branch tws_reset_connecting ,true 
06ac 20407b37 call tws_send_info_request 
06ad 20200358 branch p_tws_master_is_found 

p_tws_state_check_arbiter_in_reconnect:
06ae 6fe246ea fetch 1 ,mem_tws_state 
06af 2feffe06 isolate1 tws_state_master ,pdata 
06b0 24608000 nrtn true 
06b1 202006b2 branch p_tws_state_check_in_reconnect 

p_tws_state_check_in_reconnect:
06b2 6fe246ea fetch 1 ,mem_tws_state 
06b3 2feffe07 isolate1 tws_state_recon ,pdata 
06b4 24608000 nrtn true 
06b5 2feffe00 isolate1 tws_state_enable ,pdata 
06b6 20600000 rtn 

get_tws_rcv_context_info_btclk:
06b7 2040041b call p_start_wait_tws_master 
06b8 d8c0036f arg mem_le_rxbuf + 10 ,contr 
06b9 20207aed branch tws_rcv_context_info_btclk + 7 

p_tws_s_wait_connecting:
06ba 6fe246ea fetch 1 ,mem_tws_state 
06bb c28386cd bbit1 tws_state_recon ,p_recon_tws_adv 
06bc c283062c bbit1 tws_state_master ,p_tws_m_wait_connecting 
06bd c4010000 rtnbit0 tws_state_connecting 
06be d8e00003 arg le_scan_interval_timer ,queue 
06bf 204077ad call timer_check 
06c0 247a0000 nrtn blank 
06c1 6fe24bce fetch 1 ,mem_listen_master_timer 
06c2 203a06c5 branch p_generate_scan_window ,blank 
06c3 58000050 setarg 0x50 
06c4 202006cb branch p_generate_scan_window_end 

p_generate_scan_window:
06c5 180a7e00 random pdata 
06c6 1fe67c40 sub pdata ,0x40 ,null 
06c7 242106c5 nbranch p_generate_scan_window ,positive 
06c8 d8400027 arg 0x27 ,temp 
06c9 98467c00 isub temp ,null 
06ca 242106c5 nbranch p_generate_scan_window ,positive 

p_generate_scan_window_end:
06cb 67e243ac store 1 ,mem_le_scan_interval 
06cc 20207acd branch tws_s_wait_connecting + 8 

p_recon_tws_adv:

p_check_have_link_in_connecting:
06cd 20403257 call context_get_next 
06ce 1f227c00 copy loopcnt ,null 
06cf 24628000 nrtn zero 
06d0 204006d6 call p_recon_tws_m_wait_connecting 
06d1 20207aca branch tws_s_wait_connecting + 5 

p_recon_tws_m_wait_connecting_state_check:
06d2 6fe246ea fetch 1 ,mem_tws_state 
06d3 c4000000 rtnbit0 tws_state_enable 
06d4 c4010000 rtnbit0 tws_state_connecting 
06d5 c4030000 rtnbit0 tws_state_master 

p_recon_tws_m_wait_connecting:
06d6 d8e0000f arg le_tws_adv_interval_timer ,queue 
06d7 204077ad call timer_check 
06d8 247a0000 nrtn blank 
06d9 202079cb branch tws_m_wait_connecting + 8 

p_check_attempt:
06da 6fe246ea fetch 1 ,mem_tws_state 
06db c30006e2 bbit0 tws_state_enable ,p_check_attempt_normal 
06dc c51586de bmark1 mark_sco_flag ,p_check_attempt0 
06dd c026b770 beq 0x4d ,check_attempt_nomore 

p_check_attempt0:
06de c28306e2 bbit1 tws_state_master ,p_check_attempt_normal 
06df 6fe20030 fetch 1 ,mem_state 
06e0 c28086e2 bbit1 state_insniff ,p_check_attempt_normal 
06e1 20203770 branch check_attempt_nomore 

p_check_attempt_normal:
06e2 20203766 branch check_attempt + 1 

p_le_send_adv_ind:
06e3 6fe243b1 fetch 1 ,mem_le_adv_enable 
06e4 203a4f56 branch le_send_adv_ind + 1 ,blank 
06e5 700bc672 jam zcode_72 ,mem_zcode_temp_param0 
06e6 202007a7 branch p_zcode_entrance 

p_le_scan:
06e7 6fe246ea fetch 1 ,mem_tws_state 
06e8 c4008000 rtnbit0 tws_state_pairing 
06e9 d8e00003 arg le_scan_interval_timer ,queue 
06ea 204077ad call timer_check 
06eb 247a0000 nrtn blank 
06ec 6fe443ac fetch 2 ,mem_le_scan_interval 
06ed 684443ae fetcht 2 ,mem_le_scan_window 
06ee 98467e00 isub temp ,pdata 
06ef d8e00003 arg le_scan_interval_timer ,queue 
06f0 204077a6 call timer_init 
06f1 7854fc00 disable master 
06f2 20400709 call p_tws_init_adv 
06f3 2020505d branch le_scan + 13 

p_le_adv:
06f4 704b1600 jam 0 ,mem_le_adv_flag 
06f5 6fe243b1 fetch 1 ,mem_le_adv_enable 
06f6 243a51c4 nbranch le_adv + 3 ,blank 
06f7 6fe246ea fetch 1 ,mem_tws_state 
06f8 c4008000 rtnbit0 tws_state_pairing 
06f9 704b1601 jam 1 ,mem_le_adv_flag 
06fa d8e00001 arg le_adv_interval_timer ,queue 
06fb 204077ad call timer_check 
06fc 247a0000 nrtn blank 
06fd 20400702 call p_generate_adv_window 
06fe 7854fc00 disable master 
06ff 78287c00 enable swfine 
0700 20400709 call p_tws_init_adv 
0701 202051ca branch le_adv + 9 

p_generate_adv_window:
0702 180a7e00 random pdata 
0703 1fe67c38 sub pdata ,adv_interval ,null 
0704 24210702 nbranch p_generate_adv_window ,positive 

p_change_adv_window:
0705 67e444ec store 2 ,mem_le_adv_interval_max 
0706 20600000 rtn 

p_le_connected:
0707 700bc670 jam zcode_70 ,mem_zcode_temp_param0 
0708 202007a7 branch p_zcode_entrance 

p_tws_init_adv:
0709 7854fc00 disable master 
070a 58a0a9be setarg 0xa0a9be 
070b 20204e9f branch le_adv_access + 1 

p_tws_pairing_slave_success:
070c 6fe24b16 fetch 1 ,mem_le_adv_flag 
070d 207a0000 rtn blank 
070e 700bc671 jam zcode_71 ,mem_zcode_temp_param0 
070f 202007a7 branch p_zcode_entrance 

p_hfp_voice_stop:
0710 204047b1 call hfp_voice_stop + 2 
0711 700b0802 jam hfp_evt_esco_stop ,mem_fifo_temp 
0712 20400724 call ipc_tx_hfp_event 

p_audio_stop_adac:
0713 6fe28980 fetch 1 ,0x8980 
0714 c17f8000 rtneq 0xff 
0715 6fe2473b fetch 1 ,mem_vp_enable 
0716 247a0000 nrtn blank 
0717 2040479b call hfp_dac_stop 
0718 700b0878 jam bt_evt_close_adac ,mem_fifo_temp 
0719 2020485e branch ipc_tx_bt_event 

app_bt_increase_power:
071a 700b0883 jam bt_cmd_inc_power ,mem_fifo_temp 
071b 202071f8 branch ui_ipc_send_cmd 

p_ipc_init:
071c 70433501 jam 1 ,mem_ipc_enable 
071d 6fe28051 fetch 1 ,core_clkoff + 1 
071e 793ffe01 set0 1 ,pdata 
071f 67e28051 store 1 ,core_clkoff + 1 
0720 20000028 nop 40 
0721 202047c7 branch ipc_init + 3 

ipc_tx_tws_event:
0722 5800010c setarg 0x010c 
0723 20200727 branch ipc_tx_event 

ipc_tx_hfp_event:
0724 5800010b setarg 0x010b 
0725 20200727 branch ipc_tx_event 

ipc_tx_a2dp_event:
0726 5800010a setarg 0x010a 

ipc_tx_event:
0727 67e44bcf store 2 ,mem_ipc_tx_buf 
0728 68420b08 fetcht 1 ,mem_fifo_temp 
0729 e0420005 istoret 1 ,contw 

ipc_tx_data:
072a 6fe24bd0 fetch 1 ,mem_ipc_tx_buf + 1 
072b 1fe0fe02 increase 2 ,pdata 
072c 67e24339 store 1 ,mem_ipc_tx_data_len 
072d 58004bcf setarg mem_ipc_tx_buf 
072e 2020486f branch ipc_tx_buffer 

p_ipc_rx_process:
072f 6fe24335 fetch 1 ,mem_ipc_enable 
0730 207a0000 rtn blank 
0731 204047e7 call ipc_rx_items_inquire 
0732 20628000 rtn zero 
0733 1fe20c00 icopy contr 
0734 204047df call ipc_rx_byte_read 
0735 c0020737 beq ipc_type_spp ,ipc_rx_spp 
0736 2020482e branch ipc_rx_process + 7 

ipc_rx_spp:
0737 60c60bc7 storer contr ,3 ,mem_zcode_temp_param1 
0738 700bc660 jam zcode_60 ,mem_zcode_temp_param0 
0739 202007a7 branch p_zcode_entrance 

check_adc_value:
073a 6fe2473b fetch 1 ,mem_vp_enable 
073b 247a0000 nrtn blank 
073c da604a26 arg mem_bat_read_timer ,regc 
073d 204041d6 call timer_single_step 
073e 24740000 nrtn user 
073f 6fe24b39 fetch 1 ,mem_adc_flag 
0740 203a0749 branch adc_check_hvin ,blank 
0741 704a2608 jam adc_disable_count ,mem_bat_read_timer 
0742 704b3900 jam 0 ,mem_adc_flag 
0743 68448352 fetcht 2 ,core_sumdata 
0744 60444a23 storet 2 ,mem_adc_current_value 
0745 6fe28906 fetch 1 ,rfen_adc 
0746 1fe17e83 and_into 0x83 ,pdata 
0747 67e28906 store 1 ,rfen_adc 
0748 20600000 rtn 

adc_check_hvin:
0749 704b3901 jam 1 ,mem_adc_flag 
074a 704a2602 jam adc_enable_count ,mem_bat_read_timer 

enable_adc_check_hvin:
074b 708971af jam 0xaf ,rf_adc_mode 
074c 6fe28063 fetch 1 ,core_sum_en 
074d 79207e07 set1 7 ,pdata 
074e 67e28063 store 1 ,core_sum_en 
074f 6fe28906 fetch 1 ,rfen_adc 
0750 1fe1fe7c or_into 0x7c ,pdata 
0751 67e28906 store 1 ,rfen_adc 
0752 708972aa jam 0xaa ,rf_adc_gc 
0753 20600000 rtn 

queue_get_wrtie_ptr:
0754 1a20fe04 add rega ,block_wptr_offset ,pdata 
0755 e844003f ifetcht 2 ,pdata 
0756 efe60002 ifetch 3 ,temp 
0757 20207773 branch get_pdata_contw 

queue_unit_increase:
0758 1a208406 add rega ,block_end_offset ,temp 
0759 efe40002 ifetch 2 ,temp 
075a 9a667c00 isub regc ,null 
075b 24628000 nrtn zero 
075c 1a208400 add rega ,block_header_offset ,temp 
075d ea640002 ifetchr regc ,2 ,temp 
075e 20600000 rtn 

queue_insert:
075f 1a20fe04 add rega ,block_wptr_offset ,pdata 
0760 e844003f ifetcht 2 ,pdata 
0761 e2460002 istorer regb ,3 ,temp 
0762 1840a603 add temp ,3 ,regc 
0763 20400758 call queue_unit_increase 
0764 1a20fe04 add rega ,block_wptr_offset ,pdata 
0765 e264003f istorer regc ,2 ,pdata 
0766 1a208408 add rega ,block_cur_len_offset ,temp 
0767 efe20002 ifetch 1 ,temp 
0768 1fe0fe01 increase 1 ,pdata 
0769 e7e20002 istore 1 ,temp 
076a 20600000 rtn 

queue_get_read_ptr:
076b 1a20fe02 add rega ,block_rptr_offset ,pdata 
076c e844003f ifetcht 2 ,pdata 
076d efe60002 ifetch 3 ,temp 
076e 20207776 branch get_pdata_contr 

queue_free:

queue_delete:
076f 1a20fe02 add rega ,block_rptr_offset ,pdata 
0770 e844003f ifetcht 2 ,pdata 
0771 ea460002 ifetchr regb ,3 ,temp 
0772 58000000 setarg 0 
0773 e7e60002 istore 3 ,temp 
0774 1840a603 add temp ,3 ,regc 
0775 20400758 call queue_unit_increase 
0776 1a20fe02 add rega ,block_rptr_offset ,pdata 
0777 e264003f istorer regc ,2 ,pdata 
0778 1a208408 add rega ,block_cur_len_offset ,temp 
0779 efe20002 ifetch 1 ,temp 
077a 1fe0ffff increase -1 ,pdata 
077b e7e20002 istore 1 ,temp 
077c 20600000 rtn 

queue_is_full:
077d 20400780 call queue_get_len 
077e 1fe67c05 sub pdata ,block_max_num ,null 
077f 20600000 rtn 

queue_get_len:

queue_is_empty:
0780 1a20a208 increase block_cur_len_offset ,rega 
0781 efe20011 ifetch 1 ,rega 
0782 20600000 rtn 

push_l2cap_queue:
0783 58000000 setarg 0 
0784 67e40309 store 2 ,mem_l2cap_rxbuff1_len 
0785 da204b50 arg mem_alloc_block ,rega 
0786 2040076f call queue_delete 
0787 da204b81 arg mem_lcp_block ,rega 
0788 2020075f branch queue_insert 

pop_l2cap_queue:
0789 da204b81 arg mem_lcp_block ,rega 
078a 2040076f call queue_delete 
078b da204b50 arg mem_alloc_block ,rega 
078c 2020075f branch queue_insert 

push_media_queue:
078d 58000000 setarg 0 
078e 67e40309 store 2 ,mem_l2cap_rxbuff1_len 
078f da204b50 arg mem_alloc_block ,rega 
0790 2040076f call queue_delete 
0791 da204b69 arg mem_media_block ,rega 
0792 2020075f branch queue_insert 

clear_media_buffer:
0793 da204b69 arg mem_media_block ,rega 
0794 20400780 call queue_get_len 
0795 1fe27200 copy pdata ,loopcnt 
0796 207a0000 rtn blank 
0797 704bc901 jam 1 ,mem_media_lock 

clear_media_queue_loop:
0798 204007a1 call pop_media_queue 
0799 c2000798 loop clear_media_queue_loop 
079a 704bc900 jam 0 ,mem_media_lock 

p_hp_stero_init:
079b 704bc700 jam 0 ,mem_init_a2dp_dac 
079c 6fe2473b fetch 1 ,mem_vp_enable 
079d 247a0000 nrtn blank 
079e 6fe24296 fetch 1 ,mem_audio_allow 
079f 207a0000 rtn blank 
07a0 2020442f branch hp_stero_init 

pop_media_queue:
07a1 da204b69 arg mem_media_block ,rega 
07a2 2040076f call queue_delete 
07a3 da204b50 arg mem_alloc_block ,rega 
07a4 2040075f call queue_insert 
07a5 704b6800 jam 0 ,mem_media_release 
07a6 20600000 rtn 

p_zcode_entrance:
07a7 68420bc6 fetcht 1 ,mem_zcode_temp_param0 
07a8 18518400 rshift4 temp ,temp 
07a9 6fe24b29 fetch 1 ,mem_zcode_current_number 
07aa 98467c00 isub temp ,null 
07ab 202287cc branch p_zcode_run ,zero 
07ac 60424b29 storet 1 ,mem_zcode_current_number 

p_wait_lock_qspi:
07ad 2000000a nop 10 
07ae 6fe24b2c fetch 1 ,mem_lock_qspi 
07af 243a07ad nbranch p_wait_lock_qspi ,blank 
07b0 204007d2 call m0_pause 
07b1 200000a0 nop 160 
07b2 18408401 increase 1 ,temp 
07b3 58000100 setarg zcode_buff_size 
07b4 984f8400 imul32 temp ,temp 
07b5 6fe642dc fetch 3 ,mem_xip_flash_offset 
07b6 98467e00 isub temp ,pdata 
07b7 68464b13 fetcht 3 ,mem_flash_start_addr 
07b8 9840fe00 iadd temp ,pdata 
07b9 1fe0fffc increase -4 ,pdata 
07ba 67e60b4d store 3 ,mem_flash_address 
07bb 58000100 setarg zcode_buff_size 
07bc 67e40b52 store 2 ,mem_flash_trans_length 
07bd 58001f00 setarg mem_zcode_buff 
07be 67e40b50 store 2 ,mem_flash_data_address 
07bf 6fe280a0 fetch 1 ,core_qspi_ctrl 
07c0 1fe22200 copy pdata ,rega 
07c1 20405f01 call qspi_nmode 
07c2 20405f26 call qspi_read + 1 
07c3 1a227e00 copy rega ,pdata 
07c4 67e280a0 store 1 ,core_qspi_ctrl 
07c5 58001f00 setarg mem_zcode_buff 
07c6 67e4424c store 2 ,mem_patch_ptr 
07c7 70424e40 jam zcode_code_size ,mem_patch_len 
07c8 20405c7e call load_ucode 
07c9 204007ce call m0_continue 
07ca 58000000 setarg 0 
07cb 67e8424c store 4 ,mem_patch_ptr 

p_zcode_run:
07cc 6fe20bc6 fetch 1 ,mem_zcode_temp_param0 
07cd 20200001 branch p_zcode 

m0_continue:
07ce 6fe6802c fetch 3 ,core_flash_offset 
07cf 207a0000 rtn blank 
07d0 70802601 jam 1 ,core_scs_wdata 
07d1 202007d5 branch m0_set_dhcsr 

m0_pause:
07d2 6fe6802c fetch 3 ,core_flash_offset 
07d3 207a0000 rtn blank 
07d4 70802603 jam 3 ,core_scs_wdata 

m0_set_dhcsr:
07d5 58a05f00 setarg 0xa05f00 
07d6 67e68027 store 3 ,core_scs_wdata + 1 
07d7 5800edf2 setarg 0xedf2 

write_scs:
07d8 1fe1a201 or pdata ,1 ,rega 

write_scs_loop:
07d9 6224802a storer rega ,2 ,core_scs_addr 
07da 20000002 nop 2 

wait_scs:
07db 6fe28308 fetch 1 ,core_misc_status 
07dc c3818000 rtnbit1 3 
07dd 202007d9 branch write_scs_loop 

p_kick_watchdog:
07de 6fe28043 fetch 1 ,core_config 
07df 79207e03 set1 3 ,pdata 
07e0 67e28043 store 1 ,core_config 
07e1 70800401 jam 0x01 ,0x8004 
07e2 20600000 rtn 
org 0x3000

start:
3000 20403b63 call lpmstate 

soft_reset:
3001 44804000 bpatch patch00_0 ,mem_patch00 
3002 20800000 clear_stack 
3003 204039e8 call initialize_radio 
3004 20405d08 call iicd_init_30clk 
3005 20403b2e call init_param 
3006 20404875 call l2cap_init 
3007 4480c000 bpatch patch00_1 ,mem_patch00 
3008 20405ff4 call rfc_init 
3009 20405436 call init_lmp 
300a 20407163 call ui_init 
300b 204047c4 call ipc_init 
300c 20404138 call app_init 
300d 44814000 bpatch patch00_2 ,mem_patch00 
300e 2055c13f call app_lpm_init ,wake 
300f 20406a18 call sp_initialize 
3010 20406a05 call publickey_init 
3011 2055bbd7 call lpm_recover_clk ,wake 

sp_cal_loop:
3012 20406b73 call sp_calc_sequence 
3013 6fe246a0 fetch 1 ,mem_ssp_enable 
3014 c0003017 beq 0 ,main_loop 
3015 6fe245f7 fetch 1 ,mem_sp_local_key_invalid 
3016 203a3012 branch sp_cal_loop ,blank 

main_loop:
3017 4481c000 bpatch patch00_3 ,mem_patch00 
3018 20406b73 call sp_calc_sequence 
3019 20406f46 call sp_calc_sequence_256 
301a 20406a08 call publickey_calc 
301b 20404dfb call le_dispatch 
301c 44824000 bpatch patch00_4 ,mem_patch00 

main_loop_lable:
301d 2040303f call idle_dispatch 
301e 20404146 call app_process_idle 
301f 20403099 call inquiry_dispatch 
3020 4482c000 bpatch patch00_5 ,mem_patch00 
3021 20403339 call inquiry_scan_dispatch 
3022 204033aa call page_scan_dispatch 
3023 20403027 call connection_dispatch 
3024 20407ac2 call tws_s_conecting 
3025 20403c00 call lpm_dispatch 
3026 20203017 branch main_loop 

connection_dispatch:
3027 2040302c call connection_incontext 
3028 c6848000 rtnmark0 mark_context 
3029 793f8009 set0 mark_context ,mark 
302a 2040324f call context_save 
302b 20204e5f branch le_disable 

connection_incontext:
302c 44834000 bpatch patch00_6 ,mem_patch00 
302d 2040328f call context_search_insniff 
302e 2422b035 nbranch connection_nosniff ,zero 
302f 20403232 call context_load 
3030 1a208c01 add rega ,coffset_mode ,contr 
3031 efe20006 ifetch 1 ,contr 
3032 c2804e00 bbit1 mode_le ,le_conn_dispatch 
3033 c280b185 bbit1 mode_master ,master_dispatch 
3034 2020340f branch slave_dispatch 

connection_nosniff:
3035 4483c000 bpatch patch00_7 ,mem_patch00 
3036 20403257 call context_get_next 
3037 1f227c00 copy loopcnt ,null 
3038 20628000 rtn zero 
3039 20403232 call context_load 
303a 6fe20030 fetch 1 ,mem_state 
303b c281b0f1 bbit1 state_inpage ,master_page 
303c 6fe20031 fetch 1 ,mem_mode 
303d c280b185 bbit1 mode_master ,master_dispatch 
303e 2020340f branch slave_dispatch 

idle_dispatch:
303f 6fe24284 fetch 1 ,mem_hci_cmd 
3040 207a0000 rtn blank 
3041 c000b04f beq hci_cmd_inquiry ,idle_inquiry 
3042 c0013054 beq hci_cmd_inquiry_cancel ,idle_inquiry_cancel 
3043 c001b057 beq hci_cmd_remote_name_req ,idle_remote_name_req 
3044 c002b05c beq hci_cmd_create_conn ,idle_create_conn 
3045 c00db04c beq hci_cmd_le_create_conn ,idle_le_create_conn 
3046 20403288 call context_search_conn_handle 
3047 20628000 rtn zero 
3048 2040328b call context_search_plap 
3049 20628000 rtn zero 

idle_exit:
304a 70428400 jam 0 ,mem_hci_cmd 
304b 20600000 rtn 

idle_le_create_conn:
304c 7005011b jam hci_cmd_le_create_conn ,mem_cmd_le_create_conn 
304d 70428400 jam 0 ,mem_hci_cmd 
304e 20600000 rtn 

idle_inquiry:
304f 7920001c set1 mark_inquiry_on ,mark 
3050 793f801e set0 mark_inquiry_trainb ,mark 
3051 700096ff jam param_ninquiry ,mem_ninqy_index 
3052 7000941f jam 31 ,mem_nfreq_index_inq 
3053 2020304a branch idle_exit 

idle_inquiry_cancel:
3054 793f801c set0 mark_inquiry_on ,mark 
3055 18003600 force 0 ,stop_watch 
3056 2020304a branch idle_exit 

idle_remote_name_req:
3057 2040328b call context_search_plap 
3058 20628000 rtn zero 
3059 18000401 force lmp_name_req ,temp 
305a 70013905 jam 5 ,mem_nameres_cnt 
305b 20203067 branch idle_start_page 

idle_create_conn:
305c 44844001 bpatch patch01_0 ,mem_patch01 
305d 6fe24132 fetch 1 ,mem_device_option 
305e c000b063 beq dvc_op_hci ,idle_create_conn_hci 

idle_create_conn_device:
305f 6fec4286 fetch 6 ,mem_hci_plap 
3060 203a304a branch idle_exit ,blank 
3061 70005502 jam conn_sm_wait_features_res ,mem_reconn_lmp_sm 
3062 20203066 branch idle_create_conn_cont 

idle_create_conn_hci:
3063 6fec4286 fetch 6 ,mem_hci_plap 
3064 203a304a branch idle_exit ,blank 
3065 67ec0040 store 6 ,mem_plap 

idle_create_conn_cont:
3066 18000425 force lmp_version_req ,temp 

idle_start_page:
3067 4484c001 bpatch patch01_1 ,mem_patch01 
3068 6fe200b4 fetch 1 ,mem_page_mode 
3069 203a306d branch idle_page_mode_r0 ,blank 
306a 1fe9fe00 lshift3 pdata ,pdata 
306b 1ff27e00 lshift4 pdata ,pdata 
306c 1fe0ffff increase -1 ,pdata 

idle_page_mode_r0:
306d 67e24146 store 1 ,mem_npage 
306e 67e200b3 store 1 ,mem_npage_index 
306f 7000951f jam 31 ,mem_nfreq_index_page 
3070 793f800c set0 mark_page_trainb ,mark 
3071 2040326a call context_new 
3072 2422b08b nbranch idle_page_fail ,zero 
3073 20403b08 call get_free_amaddr 
3074 67e20077 store 1 ,mem_amaddr 
3075 6042007c storet 1 ,mem_lmo_opcode2 
3076 6fec4286 fetch 6 ,mem_hci_plap 
3077 67ec0040 store 6 ,mem_plap 
3078 44854001 bpatch patch01_2 ,mem_patch01 
3079 18007e00 force 0 ,pdata 
307a 2841fe01 compare lmp_name_req ,temp ,0xff 
307b 7d20fe05 nsetflag true ,state_init_seq ,pdata 
307c 79207e03 set1 state_inpage ,pdata 
307d 67e20030 store 1 ,mem_state 
307e 18007e00 force 0 ,pdata 
307f 7920fe04 setflag true ,smap_name_req ,pdata 
3080 67e2004c store 1 ,mem_state_map 
3081 58000000 setarg 0 
3082 79207e01 set1 mode_master ,pdata 
3083 67e20031 store 1 ,mem_mode 
3084 7834fc00 enable master 
3085 2040324f call context_save 
3086 7854fc00 disable master 
3087 18000e04 force page_length_timer ,queue 
3088 6fe44159 fetch 2 ,mem_page_to 
3089 204077a6 call timer_init 
308a 2020304a branch idle_exit 

idle_page_fail:
308b 4485c001 bpatch patch01_3 ,mem_patch01 
308c 6fec4286 fetch 6 ,mem_hci_plap 
308d 67ec0040 store 6 ,mem_plap 
308e 2841fe01 compare lmp_name_req ,temp ,0xff 
308f 2020b092 branch idle_name_fail ,true 
3090 18000407 force hci_error_memory_full ,temp 
3091 2020304a branch idle_exit 

idle_name_fail:
3092 d8a000c4 arg mem_tmp_buffer ,contw 
3093 df200008 arg 8 ,loopcnt 
3094 2040775e call memset0 
3095 18000e07 force hci_error_memory_full ,queue 

idle_recon_fail:
3096 700b0804 jam bt_evt_reconn_failed ,mem_fifo_temp 
3097 204071ee call ui_ipc_send_event 
3098 2020304a branch idle_exit 

inquiry_dispatch:
3099 c68e0000 rtnmark0 mark_inquiry_on 
309a 18000e02 force inquiry_length_timer ,queue 
309b 204077ad call timer_check 
309c 7d3a001c nsetflag blank ,mark_inquiry_on ,mark 
309d 243a309f nbranch inquiry_start ,blank 
309e 20600000 rtn 

inquiry_start:
309f 44864001 bpatch patch01_4 ,mem_patch01 
30a0 6844415b fetcht 2 ,mem_inq_window 
30a1 18000e04 force 4 ,queue 
30a2 20403791 call sniff_check_window 
30a3 20740000 rtn user 
30a4 2040392f call afh_clear 
30a5 18004800 force 0 ,freq_mode 

inquiry_restart:
30a6 20618000 rtn timeout 
30a7 793f800b set0 mark_fhs_already_good ,mark 
30a8 793f8000 set0 mark_fhs_eir ,mark 

inquiry_rx_restart:
30a9 1c40c201 add clkn_bt ,1 ,bt_clk 
30aa 280ffe1e isolate1 mark_inquiry_trainb ,mark 
30ab 7920c802 setflag true ,2 ,freq_mode 
30ac 2c200400 compare 0x00 ,bt_clk ,0x02 
30ad 2420b0c8 nbranch inquiry_receive ,true 

inquiry_transmit:
30ae 4486c001 bpatch patch01_5 ,mem_patch01 
30af 6fe20012 fetch 1 ,mem_inquiry_transmit 
30b0 1fe0fe01 increase 1 ,pdata 
30b1 67e20012 store 1 ,mem_inquiry_transmit 
30b2 20403963 call fetch_giac 
30b3 2040395d call tx_radio_freq 
30b4 2040397d call fetch_diac 
30b5 20403aea call start_transmitter 
30b6 20403aef call start_tx_native 
30b7 20403afd call send_access_word 
30b8 204036b6 call end_of_packet 
30b9 204030bb call inquiry_check_train 
30ba 202030a6 branch inquiry_restart 

inquiry_check_train:
30bb 44874001 bpatch patch01_6 ,mem_patch01 
30bc 6fe20094 fetch 1 ,mem_nfreq_index_inq 
30bd 1fe0ffff increase -1 ,pdata 
30be 67e20094 store 1 ,mem_nfreq_index_inq 
30bf 20610000 rtn positive 
30c0 7000941f jam 31 ,mem_nfreq_index_inq 
30c1 6fe20096 fetch 1 ,mem_ninqy_index 
30c2 1fe0ffff increase -1 ,pdata 
30c3 67e20096 store 1 ,mem_ninqy_index 
30c4 20610000 rtn positive 
30c5 7940001e setflip mark_inquiry_trainb ,mark 
30c6 700096ff jam param_ninquiry ,mem_ninqy_index 
30c7 20600000 rtn 

inquiry_receive:
30c8 4487c001 bpatch patch01_7 ,mem_patch01 
30c9 20403963 call fetch_giac 
30ca 20403957 call rx_radio_freq 
30cb 2040397d call fetch_diac 
30cc 20403af4 call start_rx_native 
30cd 20403a82 call start_receiver 
30ce 20403aa8 call wait_access_clkn_rt 
30cf 202c30d2 branch inquiry_sync ,sync 
30d0 204030bb call inquiry_check_train 
30d1 202030a9 branch inquiry_rx_restart 

inquiry_sync:
30d2 44884002 bpatch patch02_0 ,mem_patch02 
30d3 20403a37 call save_rssi 
30d4 20403b04 call scan_mode_whiten 
30d5 20403566 call receive_packet_whitened 
30d6 793f8001 set0 mark_rxbuf_inuse ,mark 
30d7 c6858000 rtnmark0 mark_fhs_already_good 

inquiry_receive_rtn:
30d8 4488c002 bpatch patch02_1 ,mem_patch02 

inquiry_receive_eir_rtn:
30d9 6fe20013 fetch 1 ,mem_inquiry_rcv 
30da 1fe0fe01 increase 1 ,pdata 
30db 67e20013 store 1 ,mem_inquiry_rcv 
30dc 20600000 rtn 

inquiry_receive_eir:
30dd 793f800b set0 mark_fhs_already_good ,mark 
30de 204030ec call rf_setup_time_slave_slot_eir 
30df 20403963 call fetch_giac 
30e0 20403957 call rx_radio_freq 
30e1 20403476 call init_rx_packet_flags 
30e2 20403af4 call start_rx_native 
30e3 20403a82 call start_receiver 
30e4 20403aa8 call wait_access_clkn_rt 
30e5 202c30e7 branch inquiry_receive_eir_packet ,sync 
30e6 20600000 rtn 

inquiry_receive_eir_packet:
30e7 20403b04 call scan_mode_whiten 
30e8 20403566 call receive_packet_whitened 
30e9 793f8001 set0 mark_rxbuf_inuse ,mark 
30ea 202330d8 branch inquiry_receive_rtn ,crc_failed 
30eb 202030d9 branch inquiry_receive_eir_rtn 

rf_setup_time_slave_slot_eir:
30ec d9600600 arg param_rf_setup ,timeup 

rf_setup_time_eir:
30ed 34730200 until clkn_rt ,meet 
30ee 1c417e03 and clkn_bt ,3 ,pdata 
30ef c080b0ed bne 1 ,rf_setup_time_eir 
30f0 20600000 rtn 

master_page:
30f1 44894002 bpatch patch02_2 ,mem_patch02 
30f2 7834fc00 enable master 
30f3 78387c00 enable clknt 
30f4 6fe44155 fetch 2 ,mem_page_interval 
30f5 203a30f9 branch master_page_no_interval ,blank 
30f6 18000e0d force page_interval_timer ,queue 
30f7 204077ad call timer_check 
30f8 247a0000 nrtn blank 

master_page_no_interval:
30f9 4489c002 bpatch patch02_3 ,mem_patch02 
30fa 68444157 fetcht 2 ,mem_page_window 
30fb 18000e28 force 40 ,queue 
30fc 20403791 call sniff_check_window 
30fd 20343133 branch page_exit ,user 
30fe 18000e04 force page_length_timer ,queue 
30ff 204077ad call timer_check 
3100 243a310f nbranch page_start ,blank 
3101 6fe2004c fetch 1 ,mem_state_map 
3102 c2823105 bbit1 smap_name_req ,master_npage_timeout 
3103 18000404 force hci_error_page_timeout ,temp 
3104 20203109 branch master_page_timeout 

master_npage_timeout:
3105 d8a000c4 arg mem_tmp_buffer ,contw 
3106 df200008 arg 8 ,loopcnt 
3107 2040775e call memset0 
3108 18000e04 force hci_error_page_timeout ,queue 

master_page_timeout:
3109 448a4002 bpatch patch02_4 ,mem_patch02 
310a 70003000 jam 0 ,mem_state 
310b 20405437 call init_lmp_work 
310c 700b0813 jam bt_evt_reconn_page_timeout ,mem_fifo_temp 
310d 204071ee call ui_ipc_send_event 
310e 20203133 branch page_exit 

page_start:
310f 448ac002 bpatch patch02_5 ,mem_patch02 
3110 18001600 force 0 ,timeup 
3111 34730200 until clkn_rt ,meet 
3112 6fe200b5 fetch 1 ,mem_page_clk 
3113 1fe0ffff increase -1 ,pdata 
3114 9c42fe00 ixor clkn_bt ,pdata 
3115 2fe00600 compare 0 ,pdata ,3 
3116 2420b10f nbranch page_start ,true 
3117 18827e00 deposit am_addr 
3118 67e2014c store 1 ,mem_fhs_am_addr 
3119 18004c00 force 0 ,n_tx_slot 
311a 18004800 force 0 ,freq_mode 

page_restart:
311b 448b4002 bpatch patch02_6 ,mem_patch02 
311c 2021b133 branch page_exit ,timeout 
311d 20403967 call fetch_page_bt_adr 
311e d9600600 arg param_rf_setup ,timeup 
311f 34730200 until clkn_rt ,meet 

page_rx_restart:
3120 448bc002 bpatch patch02_7 ,mem_patch02 
3121 6fe800b5 fetch 4 ,mem_page_clk 
3122 98004200 iforce bt_clk 
3123 1fe0fe01 increase 1 ,pdata 
3124 67e800b5 store 4 ,mem_page_clk 
3125 280ffe0c isolate1 mark_page_trainb ,mark 
3126 7920c802 setflag true ,2 ,freq_mode 
3127 2c200400 compare 0x00 ,bt_clk ,0x02 
3128 2420b147 nbranch page_receive ,true 
3129 6fe2000c fetch 1 ,mem_page_transmit 
312a 1fe0fe01 increase 1 ,pdata 
312b 67e2000c store 1 ,mem_page_transmit 
312c 2040395d call tx_radio_freq 
312d 20403aea call start_transmitter 
312e 20403aef call start_tx_native 
312f 20403afd call send_access_word 
3130 204036b6 call end_of_packet 
3131 20403139 call page_check_train 
3132 2020311b branch page_restart 

master_dispatch_exit:

page_exit:
3133 448c4003 bpatch patch03_0 ,mem_patch03 
3134 7854fc00 disable master 
3135 6fe44155 fetch 2 ,mem_page_interval 
3136 207a0000 rtn blank 
3137 18000e0d force page_interval_timer ,queue 
3138 202077a6 branch timer_init 

page_check_train:
3139 448cc003 bpatch patch03_1 ,mem_patch03 
313a 6fe20095 fetch 1 ,mem_nfreq_index_page 
313b 1fe0ffff increase -1 ,pdata 
313c 67e20095 store 1 ,mem_nfreq_index_page 
313d 20610000 rtn positive 
313e 7000951f jam 31 ,mem_nfreq_index_page 
313f 6fe200b3 fetch 1 ,mem_npage_index 
3140 1fe0ffff increase -1 ,pdata 
3141 67e200b3 store 1 ,mem_npage_index 
3142 20610000 rtn positive 
3143 7940000c setflip mark_page_trainb ,mark 
3144 6fe24146 fetch 1 ,mem_npage 
3145 67e200b3 store 1 ,mem_npage_index 
3146 20600000 rtn 

page_receive:
3147 448d4003 bpatch patch03_2 ,mem_patch03 
3148 20403957 call rx_radio_freq 
3149 20403af4 call start_rx_native 
314a 20403a82 call start_receiver 
314b 20403aa8 call wait_access_clkn_rt 
314c 202c314f branch page_sync ,sync 
314d 20403139 call page_check_train 
314e 20203120 branch page_rx_restart 

page_sync:
314f 204036b6 call end_of_packet 
3150 6fe2000d fetch 1 ,mem_page_rcv 
3151 1fe0fe01 increase 1 ,pdata 
3152 67e2000d store 1 ,mem_page_rcv 
3153 18003600 force 0 ,stop_watch 
3154 6fe800b5 fetch 4 ,mem_page_clk 

page_send_fhs:
3155 448dc003 bpatch patch03_3 ,mem_patch03 
3156 20403ae8 call rf_setup_time_master_slot 
3157 20403967 call fetch_page_bt_adr 
3158 1cc0cc01 increase 1 ,n_tx_slot 

page_send_fhs_continue:
3159 1c2143fd and_into 0x1fd ,bt_clk 
315a 1c8149fc and_into 0x1fc ,freq_mode 
315b 2040395d call tx_radio_freq 
315c 20403aea call start_transmitter 
315d 20403aef call start_tx_native 
315e 20403afd call send_access_word 
315f 1c427e00 deposit clkn_bt 
3160 67e8012c store 4 ,mem_clkn_bt 
3161 18000800 force 0 ,am_addr 
3162 18000202 force type_fhs ,type 
3163 20403b04 call scan_mode_whiten 
3164 204037e3 call transmit_packet_whitened 

page_wait_fhs_reply:
3165 448e4003 bpatch patch03_4 ,mem_patch03 
3166 20403ae6 call rf_setup_time_slave_slot 
3167 1c21c202 or_into 0x02 ,bt_clk 
3168 1c8149fc and_into 0x1fc ,freq_mode 
3169 20403957 call rx_radio_freq 
316a 20403af4 call start_rx_native 
316b 20403a82 call start_receiver 
316c 20403aa8 call wait_access_clkn_rt 
316d 204c36b6 call end_of_packet ,sync 
316e 202c3174 branch page_wait_fhs_reply_ok ,sync 
316f 6fe20010 fetch 1 ,mem_fhs_wait_counter 
3170 203a311b branch page_restart ,blank 
3171 1fe0ffff increase -1 ,pdata 
3172 67e20010 store 1 ,mem_fhs_wait_counter 
3173 20203155 branch page_send_fhs 

page_wait_fhs_reply_ok:
3174 448ec003 bpatch patch03_5 ,mem_patch03 
3175 6fe2000e fetch 1 ,mem_page_rcv_fhs 
3176 1fe0fe01 increase 1 ,pdata 
3177 67e2000e store 1 ,mem_page_rcv_fhs 
3178 20403481 call prepare_newconn 

master_newconn_loop:
3179 20403333 call master_newconn_once 
317a 202c317e branch newconn_poll_responded ,sync 
317b 2040349f call new_conn_timeout 
317c 243a3179 nbranch master_newconn_loop ,blank 
317d 2020311b branch page_restart 

newconn_poll_responded:
317e 448f4003 bpatch patch03_6 ,mem_patch03 
317f 6fe20030 fetch 1 ,mem_state 
3180 793ffe03 set0 state_inpage ,pdata 
3181 67e20030 store 1 ,mem_state 
3182 2040348c call newconn_init 

disable_master:
3183 7854fc00 disable master 
3184 20600000 rtn 

master_dispatch:
3185 448fc003 bpatch patch03_7 ,mem_patch03 
3186 7834fc00 enable master 
3187 78387c00 enable clknt 
3188 20403208 call role_switch_master 
3189 20740000 rtn user 
318a 20403d2f call load_context_to_esco 
318b 2040432e call pop_cvsd_data_send 
318c 20403cf0 call check_bt_disabled 
318d 20403ae8 call rf_setup_time_master_slot 
318e 1c40c201 add clkn_bt ,1 ,bt_clk 
318f 2040396d call fetch_self_bt_adr 
3190 18004803 force 0x03 ,freq_mode 
3191 20406209 call scheduler_tx_l2cap_pkt 
3192 204034d4 call prepare_tx 
3193 2040395d call tx_radio_freq 
3194 20403aea call start_transmitter 
3195 20403aef call start_tx_native 
3196 20403afd call send_access_word 
3197 204037df call transmit_packet 

master_loop:
3198 44904004 bpatch patch04_0 ,mem_patch04 
3199 2040544a call parse_lmp 
319a 20404342 call process_cmd 
319b 20403325 call master_conn_recv_packet 
319c 2436b1a2 nbranch master_notmatch ,match 
319d 20403b21 call supervision_flush 
319e 2040379a call parse_l2cap 
319f 6fe2000f fetch 1 ,mem_master_rcvcnt 
31a0 1fe0fe01 increase 1 ,pdata 
31a1 67e2000f store 1 ,mem_master_rcvcnt 

master_notmatch:
31a2 4490c004 bpatch patch04_1 ,mem_patch04 
31a3 204061eb call scheduler_process 
31a4 204031ae call check_master_disconnect 
31a5 24748000 nrtn master 
31a6 20403765 call check_attempt 
31a7 243a31ab nbranch master_attempt ,blank 

master_exit:
31a8 7854fc00 disable master 
31a9 2040431d call push_cvsd_data_to_dec 
31aa 20203d1d branch load_context_to_acl 

master_attempt:
31ab 204034d4 call prepare_tx 
31ac 2040331b call master_conn_send_packet 
31ad 20203198 branch master_loop 

check_master_disconnect:
31ae 2036b1b1 branch check_master_match ,match 
31af 20403b18 call supervision_update 
31b0 202131bf branch master_disconnect ,positive 

check_master_match:
31b1 204031ce call check_disconnect_timeout 
31b2 243431bf nbranch master_disconnect ,user 
31b3 6fe2004c fetch 1 ,mem_state_map 
31b4 c4020000 rtnbit0 smap_name_req 
31b5 c3818000 rtnbit1 smap_name_res 
31b6 6fe2004b fetch 1 ,mem_op 
31b7 c3818000 rtnbit1 op_disconn 
31b8 204031d6 call conn_timer_expired 
31b9 247a0000 nrtn blank 
31ba 6fe20139 fetch 1 ,mem_nameres_cnt 
31bb 1fe0ffff increase -1 ,pdata 
31bc 67e20139 store 1 ,mem_nameres_cnt 
31bd 247a0000 nrtn blank 
31be 202057ef branch lmp_disconnect 

master_disconnect:
31bf 44914004 bpatch patch04_2 ,mem_patch04 
31c0 204034a7 call quit_connection 
31c1 7854fc00 disable master 
31c2 6fe2004c fetch 1 ,mem_state_map 
31c3 c28231c9 bbit1 smap_name_req ,master_name_disconnect 
31c4 6fe20030 fetch 1 ,mem_state 
31c5 c30231c8 bbit0 state_conn_comp ,master_disconnect_quiet 
31c6 68420046 fetcht 1 ,mem_conn_handle 
31c7 20600000 rtn 

master_disconnect_quiet:
31c8 20600000 rtn 

master_name_disconnect:
31c9 18000e00 force hci_success ,queue 

master_name_error:
31ca 18000e04 force hci_error_page_timeout ,queue 
31cb d8a000c4 arg mem_tmp_buffer ,contw 
31cc df200008 arg 8 ,loopcnt 
31cd 2020775e branch memset0 

check_disconnect_timeout:
31ce 4491c004 bpatch patch04_3 ,mem_patch04 
31cf 78347c00 enable user 
31d0 6fe2004b fetch 1 ,mem_op 
31d1 c4018000 rtnbit0 op_disconn 
31d2 204031d6 call conn_timer_expired 
31d3 247a0000 nrtn blank 
31d4 78547c00 disable user 
31d5 20600000 rtn 

conn_timer_expired:
31d6 6fe20072 fetch 1 ,mem_conn_timer 
31d7 1fe0ffff increase -1 ,pdata 
31d8 67e20072 store 1 ,mem_conn_timer 
31d9 20600000 rtn 

linkkey_ready:
31da 44924004 bpatch patch04_4 ,mem_patch04 
31db 6fe20030 fetch 1 ,mem_state 
31dc c283b1e5 bbit1 state_linkkey ,linkkey_set 
31dd 6fe24132 fetch 1 ,mem_device_option 
31de c000b1e5 beq dvc_op_hci ,linkkey_send_hci 
31df 6fe20a26 fetch 1 ,mem_pairing_auth 
31e0 203a31e5 branch linkkey_set ,blank 
31e1 700a2600 jam defalt_pairing_auth ,mem_pairing_auth 
31e2 700b0818 jam bt_evt_linkkey_generate ,mem_fifo_temp 
31e3 204071ee call ui_ipc_send_event 
31e4 202031e5 branch linkkey_set 

linkkey_send_hci:

linkkey_set:
31e5 4492c004 bpatch patch04_5 ,mem_patch04 
31e6 20403282 call context_traverse_linkkey 
31e7 6fe20030 fetch 1 ,mem_state 
31e8 79207e07 set1 state_linkkey ,pdata 
31e9 67e20030 store 1 ,mem_state 

linkkey_set_continue:
31ea 20600000 rtn 

generate_linkkey_continue:
31eb 700a2601 jam pairing_auth ,mem_pairing_auth 

clear_linkstate:
31ec 6fe20030 fetch 1 ,mem_state 
31ed 793ffe07 set0 state_linkkey ,pdata 
31ee 67e20030 store 1 ,mem_state 
31ef 20600000 rtn 

role_switch_check:
31f0 44934004 bpatch patch04_6 ,mem_patch04 
31f1 78547c00 disable user 
31f2 6fe40032 fetch 2 ,mem_tsniff 
31f3 d840ffff arg 0xffff ,temp 
31f4 98467c00 isub temp ,null 
31f5 24628000 nrtn zero 
31f6 6fe80034 fetch 4 ,mem_sniff_anchor 
31f7 203831fa branch role_switch_clkn ,clknt 
31f8 9d067e00 isub clke_bt ,pdata 
31f9 202031fb branch role_switch_clke 

role_switch_clkn:
31fa 9c467e00 isub clkn_bt ,pdata 

role_switch_clke:
31fb 1fe67c04 sub pdata ,4 ,null 
31fc 24610000 nrtn positive 
31fd 18007e00 force 0 ,pdata 
31fe 67e40032 store 2 ,mem_tsniff 
31ff 20207903 branch enable_user 

role_switch_prepare:
3200 1fe20400 copy pdata ,temp 
3201 4493c004 bpatch patch04_7 ,mem_patch04 
3202 60480034 storet 4 ,mem_sniff_anchor 

role_switch_prepare0:
3203 7045a201 jam switch_flag_accept ,mem_switch_flag 
3204 5800ffff setarg 0xffff 
3205 67e40032 store 2 ,mem_tsniff 
3206 70007301 jam 1 ,mem_sniff_attempt 
3207 20600000 rtn 

role_switch_master:
3208 44944005 bpatch patch05_0 ,mem_patch05 
3209 204031f0 call role_switch_check 
320a 24740000 nrtn user 
320b 78547c00 disable user 
320c 70001120 jam param_newconnto ,mem_newconnto_counter 
320d 793f800b set0 mark_fhs_already_good ,mark 

roles_waitfhs_loop:
320e 20403ae8 call rf_setup_time_master_slot 
320f 20403327 call master_recv_packet 
3210 c505b21b bmark1 mark_fhs_already_good ,roles_replyto_fhs 
3211 2040349f call new_conn_timeout 
3212 243a320e nbranch roles_waitfhs_loop ,blank 

role_switch_fail_master:
3213 4494c005 bpatch patch05_1 ,mem_patch05 
3214 78547c00 disable user 
3215 1c427e00 deposit clkn_bt 
3216 67e84168 store 4 ,mem_next_btclk 
3217 78387c00 enable clknt 
3218 7834fc00 enable master 
3219 700b082a jam bt_evt_switch_fail_master ,mem_fifo_temp 
321a 202071ee branch ui_ipc_send_event 

roles_replyto_fhs:
321b 44954005 bpatch patch05_2 ,mem_patch05 
321c 20403ae6 call rf_setup_time_slave_slot 
321d d8200010 arg type_id ,type 
321e 2040331d call master_send_packet 
321f 78587c00 disable clknt 
3220 7854fc00 disable master 
3221 204038a4 call apply_switch_clke 
3222 20403481 call prepare_newconn 

roles_newconns_loop:
3223 4495c005 bpatch patch05_3 ,mem_patch05 
3224 204034c7 call slave_newconn_once 
3225 2036b229 branch roles_newconns_responded ,match 
3226 2040349f call new_conn_timeout 
3227 243a3223 nbranch roles_newconns_loop ,blank 
3228 20203213 branch role_switch_fail_master 

roles_newconns_responded:
3229 18000401 force 1 ,temp 
322a 6fe20031 fetch 1 ,mem_mode 
322b 793ffe01 set0 mode_master ,pdata 
322c 67e20031 store 1 ,mem_mode 
322d 20403b21 call supervision_flush 
322e 204038cd call calc_clke_offset 
322f 78347c00 enable user 
3230 700b082b jam bt_evt_switch_success_master ,mem_fifo_temp 
3231 202071ee branch ui_ipc_send_event 

context_load:
3232 44964005 bpatch patch05_4 ,mem_patch05 
3233 79200009 set1 mark_context ,mark 
3234 6224001e storer rega ,2 ,mem_context_ptr 
3235 18007250 force context_size ,loopcnt 
3236 d8a004ad arg mem_le_state ,contw 
3237 1a208c01 add rega ,coffset_mode ,contr 
3238 efe20006 ifetch 1 ,contr 
3239 1a220c00 copy rega ,contr 
323a c2807792 bbit1 mode_le ,memcpy_fast 
323b d8a00030 arg mem_state ,contw 
323c 20407792 call memcpy_fast 
323d 78577c00 disable attempt 
323e 6fe20077 fetch 1 ,mem_amaddr 
323f 98000800 iforce am_addr 
3240 70009201 jam 1 ,mem_current_sniff_attempt 
3241 2034b243 branch context_load_master ,master 
3242 70009201 jam 1 ,mem_current_sniff_attempt 

context_load_master:
3243 6fe20030 fetch 1 ,mem_state 
3244 c4008000 rtnbit0 state_insniff 
3245 6fe24311 fetch 1 ,mem_esco_abnormal_attempt 
3246 203a324a branch context_load_normal ,blank 
3247 70431100 jam 0 ,mem_esco_abnormal_attempt 
3248 70009202 jam 2 ,mem_current_sniff_attempt 
3249 2020324c branch context_load_end 

context_load_normal:
324a 6fe20073 fetch 1 ,mem_sniff_attempt 
324b 67e20092 store 1 ,mem_current_sniff_attempt 

context_load_end:
324c 6fe20074 fetch 1 ,mem_sniff_timeout 
324d 67e20093 store 1 ,mem_current_sniff_timeout 
324e 20600000 rtn 

context_save:
324f 4496c005 bpatch patch05_5 ,mem_patch05 
3250 6fe4001e fetch 2 ,mem_context_ptr 
3251 98000a00 iforce contw 
3252 18007250 force context_size ,loopcnt 
3253 d8c004ad arg mem_le_state ,contr 
3254 203b7792 branch memcpy_fast ,le 
3255 d8c00030 arg mem_state ,contr 
3256 20207792 branch memcpy_fast 

context_get_next:
3257 68420015 fetcht 1 ,mem_current_context 
3258 df200003 arg context_num ,loopcnt 

context_get_next_loop:
3259 18408401 increase 1 ,temp 
325a 2841fe03 compare context_num ,temp ,0xff 
325b 2420b25d nbranch context_get_next_cont ,true 
325c d8400000 arg 0 ,temp 

context_get_next_cont:
325d 60420015 storet 1 ,mem_current_context 
325e 184ffe50 mul32 temp ,context_size ,pdata 
325f da204040 arg mem_context ,rega 
3260 9a20a200 iadd rega ,rega 
3261 efe20011 ifetch 1 ,rega 
3262 c300b266 bbit0 state_insniff ,context_get_next_nosniff 
3263 18c08c01 increase 1 ,contr 
3264 efe40006 ifetch 2 ,contr 
3265 243a3268 nbranch context_get_next_sniff ,blank 

context_get_next_nosniff:
3266 c3800000 rtnbit1 state_inconn 
3267 c3818000 rtnbit1 state_inpage 

context_get_next_sniff:
3268 c2003259 loop context_get_next_loop 
3269 20600000 rtn 

context_new:
326a 44974005 bpatch patch05_6 ,mem_patch05 
326b da60329b arg context_search_empty ,regc 
326c 20403292 call context_search 
326d 24628000 nrtn zero 
326e 6224001e storer rega ,2 ,mem_context_ptr 
326f 18007c00 force 0 ,null 
3270 20600000 rtn 

context_check_all_wack:
3271 20403d1a call check_amaddr_is_esco 
3272 2020b279 branch context_check_esco_wack ,true 
3273 6fe4001e fetch 2 ,mem_context_ptr 
3274 1fe08a17 add pdata ,coffset_arq ,contw 
3275 6fe20047 fetch 1 ,mem_cur_arq 
3276 e7e20005 istore 1 ,contw 
3277 da6032dd arg context_check_a_wack ,regc 
3278 20203292 branch context_search 

context_check_esco_wack:
3279 6fe20047 fetch 1 ,mem_cur_arq 
327a 2feffe03 isolate1 wack ,pdata 
327b 2020b27e branch context_esco_wack ,true 
327c 18007c01 force 1 ,null 
327d 20600000 rtn 

context_esco_wack:
327e 18007c00 force 0 ,null 
327f 20600000 rtn 

context_check_idle:
3280 da6032da arg context_check_inconn ,regc 
3281 20203292 branch context_search 

context_traverse_linkkey:
3282 6844001e fetcht 2 ,mem_context_ptr 
3283 da603310 arg context_traverse_clearkey ,regc 
3284 20203292 branch context_search 

context_traverse_max_slot:
3285 6844001e fetcht 2 ,mem_context_ptr 
3286 da603303 arg context_traverse_mslot ,regc 
3287 20203292 branch context_search 

context_search_conn_handle:
3288 68424285 fetcht 1 ,mem_hci_conn_handle 

context_search_conn_handle2:
3289 da6032a6 arg context_search_handle ,regc 
328a 20203292 branch context_search 

context_search_plap:
328b 4497c005 bpatch patch05_7 ,mem_patch05 
328c 684c4286 fetcht 6 ,mem_hci_plap 

context_search_plap2:
328d da60329f arg context_search_lap ,regc 
328e 20203292 branch context_search 

context_search_insniff:
328f da6032ac arg context_search_sniff ,regc 
3290 20203292 branch context_search 

context_search_sniff_window:
3291 da6032fa arg context_search_window ,regc 

context_search:
3292 44984006 bpatch patch06_0 ,mem_patch06 
3293 da204040 arg mem_context ,rega 
3294 18007203 force context_num ,loopcnt 

context_search_loop:
3295 efe20011 ifetch 1 ,rega 
3296 1a627a00 copy regc ,pc 

context_search_next:
3297 1a20a250 increase context_size ,rega 
3298 c2003295 loop context_search_loop 
3299 18007c01 force 1 ,null 
329a 20600000 rtn 

context_search_empty:
329b c2803297 bbit1 state_inconn ,context_search_next 
329c c281b297 bbit1 state_inpage ,context_search_next 
329d 18007c00 force 0 ,null 
329e 20600000 rtn 

context_search_lap:
329f c281b2a1 bbit1 state_inpage ,context_search_lap_cont 
32a0 c3003297 bbit0 state_inconn ,context_search_next 

context_search_lap_cont:
32a1 1a208c10 add rega ,coffset_plap ,contr 
32a2 efec0006 ifetch 6 ,contr 
32a3 98467c00 isub temp ,null 
32a4 20628000 rtn zero 
32a5 20203297 branch context_search_next 

context_search_handle:
32a6 c3003297 bbit0 state_inconn ,context_search_next 
32a7 1a208c16 add rega ,coffset_conn_handle ,contr 
32a8 efe20006 ifetch 1 ,contr 
32a9 98467c00 isub temp ,null 
32aa 20628000 rtn zero 
32ab 20203297 branch context_search_next 

context_search_sniff:
32ac c300b297 bbit0 state_insniff ,context_search_next 

context_search_sniff_loop:
32ad 204032e6 call context_get_anchor 
32ae 204032ca call sign_pdata_temp 
32af 98467e00 isub temp ,pdata 
32b0 1fe0fe01 increase 1 ,pdata 
32b1 242132bf nbranch context_search_sniff_cont ,positive 
32b2 203632b9 branch context_search_master ,user2 
32b3 c59632b9 bmark0 mark_enter_sco_sniff ,context_search_master 
32b4 6fe24332 fetch 1 ,mem_esco_test 
32b5 1fe0fe01 increase 1 ,pdata 
32b6 67e24332 store 1 ,mem_esco_test 
32b7 70431101 jam 1 ,mem_esco_abnormal_attempt 
32b8 202032c6 branch context_search_meet 

context_search_master:
32b9 98002400 iforce regb 
32ba 1a208c02 add rega ,coffset_tsniff ,contr 
32bb efe40006 ifetch 2 ,contr 
32bc 203a32c6 branch context_search_meet ,blank 
32bd 204032f4 call context_next_anchor 
32be 202032ad branch context_search_sniff_loop 

context_search_sniff_cont:
32bf c515b2c2 bmark1 mark_sco_flag ,context_search_sco_sniff 
32c0 1fe0fe05 increase 5 ,pdata 
32c1 202032c5 branch context_search_sniff_check 

context_search_sco_sniff:
32c2 1fe0fe02 increase 2 ,pdata 
32c3 24213297 nbranch context_search_next ,positive 
32c4 7920002c set1 mark_enter_sco_sniff ,mark 

context_search_sniff_check:
32c5 24213297 nbranch context_search_next ,positive 

context_search_meet:
32c6 18424200 copy temp ,bt_clk 
32c7 204032f4 call context_next_anchor 
32c8 18007c00 force 0 ,null 
32c9 20600000 rtn 

sign_pdata_temp:
32ca 1ff11600 rshift16 pdata ,timeup 
32cb 196c9600 rshift8 timeup ,timeup 
32cc 2022b2d4 branch sign_pdata_temp_p0 ,zero 
32cd 29601e0f compare 0xf ,timeup ,0xf 
32ce 24608000 nrtn true 
32cf 18511600 rshift16 temp ,timeup 
32d0 196c9600 rshift8 timeup ,timeup 
32d1 24628000 nrtn zero 
32d2 7920041c set1 28 ,temp 
32d3 20600000 rtn 

sign_pdata_temp_p0:
32d4 18511600 rshift16 temp ,timeup 
32d5 196c9600 rshift8 timeup ,timeup 
32d6 29601e0f compare 0xf ,timeup ,0xf 
32d7 24608000 nrtn true 
32d8 79207e1c set1 28 ,pdata 
32d9 20600000 rtn 

context_check_inconn:
32da c3003297 bbit0 state_inconn ,context_search_next 
32db 18007c00 force 0 ,null 
32dc 20600000 rtn 

context_check_a_wack:
32dd c3003297 bbit0 state_inconn ,context_search_next 
32de 1a208c01 add rega ,coffset_mode ,contr 
32df efe20006 ifetch 1 ,contr 
32e0 c2803297 bbit1 mode_le ,context_search_next 
32e1 1a208c17 add rega ,coffset_arq ,contr 
32e2 efe20006 ifetch 1 ,contr 
32e3 c301b297 bbit0 wack ,context_search_next 
32e4 18007c00 force 0 ,null 
32e5 20600000 rtn 

context_get_anchor:
32e6 78367c00 enable user2 
32e7 1a208c01 add rega ,coffset_mode ,contr 
32e8 e8420006 ifetcht 1 ,contr 
32e9 1c427e00 deposit clkn_bt 
32ea 284ffe01 isolate1 mode_master ,temp 
32eb 1a208c04 add rega ,coffset_sniff_anchor ,contr 
32ec e8480006 ifetcht 4 ,contr 
32ed 20608000 rtn true 
32ee 1a208c08 add rega ,coffset_clk_offset ,contr 
32ef efec0006 ifetch 6 ,contr 
32f0 204038df call calc_clke2 
32f1 1d027e00 deposit clke_bt 
32f2 78567c00 disable user2 
32f3 20600000 rtn 

context_next_anchor:
32f4 1a208c02 add rega ,coffset_tsniff ,contr 
32f5 1a208a04 add rega ,coffset_sniff_anchor ,contw 
32f6 efe40006 ifetch 2 ,contr 
32f7 98409600 iadd temp ,timeup 
32f8 e1680005 istorer timeup ,4 ,contw 
32f9 20204eb9 branch le_context_nexthop 

context_search_window:
32fa c300b297 bbit0 state_insniff ,context_search_next 
32fb 204032e6 call context_get_anchor 
32fc 9b60fe00 iadd stop_watch ,pdata 
32fd 9b60fe00 iadd stop_watch ,pdata 
32fe 98e0fe00 iadd queue ,pdata 
32ff 98467c00 isub temp ,null 
3300 24213297 nbranch context_search_next ,positive 
3301 18007c00 force 0 ,null 
3302 20600000 rtn 

context_traverse_mslot:
3303 c3003297 bbit0 state_inconn ,context_search_next 
3304 18427e00 deposit temp 
3305 9a267c00 isub rega ,null 
3306 203f3297 branch context_search_next ,null 
3307 1a208c01 add rega ,coffset_mode ,contr 
3308 efe20006 ifetch 1 ,contr 
3309 c2803297 bbit1 mode_le ,context_search_next 
330a 1a208a18 add rega ,coffset_lmp_to_send ,contw 
330b efe20005 ifetch 1 ,contw 
330c 243a3297 nbranch context_search_next ,blank 
330d 18007e2d force lmp_max_slot ,pdata 
330e e7e20005 istore 1 ,contw 
330f 20203297 branch context_search_next 

context_traverse_clearkey:
3310 c3003297 bbit0 state_inconn ,context_search_next 
3311 18427e00 deposit temp 
3312 9a267c00 isub rega ,null 
3313 203f3297 branch context_search_next ,null 
3314 1a208c01 add rega ,coffset_mode ,contr 
3315 efe20006 ifetch 1 ,contr 
3316 c2803297 bbit1 mode_le ,context_search_next 
3317 efe20011 ifetch 1 ,rega 
3318 793ffe07 set0 state_linkkey ,pdata 
3319 e7e20011 istore 1 ,rega 
331a 20203297 branch context_search_next 

master_conn_send_packet:
331b 4498c006 bpatch patch06_1 ,mem_patch06 
331c 20403ae8 call rf_setup_time_master_slot 

master_send_packet:
331d 1c40c201 add clkn_bt ,1 ,bt_clk 
331e 2040396d call fetch_self_bt_adr 
331f 18004803 force 0x03 ,freq_mode 
3320 2040395d call tx_radio_freq 
3321 20403aea call start_transmitter 
3322 20403aef call start_tx_native 
3323 20403afd call send_access_word 
3324 202037df branch transmit_packet 

master_conn_recv_packet:
3325 44994006 bpatch patch06_2 ,mem_patch06 
3326 20403ae6 call rf_setup_time_slave_slot 

master_recv_packet:
3327 1c40c201 add clkn_bt ,1 ,bt_clk 
3328 2040396d call fetch_self_bt_adr 
3329 18004803 force 0x03 ,freq_mode 
332a 20403957 call rx_radio_freq 
332b 20403476 call init_rx_packet_flags 
332c 20403a88 call prep_crypt 
332d 20403af4 call start_rx_native 
332e 20403a82 call start_receiver 

master_rx_conn_finish_packet:
332f 20403aa8 call wait_access_clkn_rt 
3330 246c0000 nrtn sync 
3331 20403a37 call save_rssi 
3332 20203564 branch receive_packet 

master_newconn_once:
3333 4499c006 bpatch patch06_3 ,mem_patch06 
3334 6fe2014c fetch 1 ,mem_fhs_am_addr 
3335 98000800 iforce am_addr 
3336 18000201 force type_poll ,type 
3337 2040331b call master_conn_send_packet 
3338 20203325 branch master_conn_recv_packet 

inquiry_scan_dispatch:
3339 6fe24133 fetch 1 ,mem_scan_mode 
333a c4000000 rtnbit0 inq_scan_mode 
333b 18000e05 force iscan_interval_timer ,queue 
333c 204077ad call timer_check 
333d 247a0000 nrtn blank 
333e 6844414d fetcht 2 ,mem_iscan_window 
333f 18000e04 force 4 ,queue 
3340 20403791 call sniff_check_window 
3341 20740000 rtn user 
3342 20403349 call inquiry_scan_start 
3343 18000e05 force iscan_interval_timer ,queue 
3344 6fe4414f fetch 2 ,mem_iscan_interval 
3345 242c77a6 nbranch timer_init ,sync 
3346 180a7e00 random pdata 
3347 9ea17e00 iand mask3ff ,pdata 
3348 202077a6 branch timer_init 

inquiry_scan_start:
3349 449a4006 bpatch patch06_4 ,mem_patch06 
334a 70014c00 jam 0 ,mem_fhs_am_addr 
334b 78587c00 disable clknt 
334c 78577c00 disable attempt 
334d 2040392f call afh_clear 
334e 1c4143fc and clkn_bt ,0x1fc ,bt_clk 
334f 18004801 force 0x01 ,freq_mode 
3350 20403963 call fetch_giac 
3351 20403957 call rx_radio_freq 
3352 7940001d setflip mark_inquiry_state ,mark 
3353 6fe20006 fetch 1 ,mem_inquiryscan_waitcnt 
3354 1fe0fe01 increase 1 ,pdata 
3355 67e20006 store 1 ,mem_inquiryscan_waitcnt 
3356 2040397d call fetch_diac 
3357 20403a82 call start_receiver 
3358 20403aaf call wait_access_forever 
3359 246c0000 nrtn sync 
335a 449ac006 bpatch patch06_5 ,mem_patch06 
335b 18003600 force 0 ,stop_watch 
335c 20403984 call shutdown_radio 
335d 6fe20007 fetch 1 ,mem_inquiryscan_rcvcnt 
335e 1fe0fe01 increase 1 ,pdata 
335f 67e20007 store 1 ,mem_inquiryscan_rcvcnt 
3360 20403963 call fetch_giac 
3361 20403ae6 call rf_setup_time_slave_slot 
3362 1c21c202 or_into 0x002 ,bt_clk 
3363 18004801 force 0x01 ,freq_mode 
3364 2040395d call tx_radio_freq 
3365 2040397d call fetch_diac 
3366 20403aea call start_transmitter 
3367 20403af8 call start_tx_external 
3368 1c427e00 deposit clkn_bt 
3369 67e8012c store 4 ,mem_clkn_bt 
336a 20403afd call send_access_word 
336b 18000202 force type_fhs ,type 
336c 18000800 force 0 ,am_addr 
336d 20403b04 call scan_mode_whiten 
336e 204037e3 call transmit_packet_whitened 
336f 20403373 call send_eir 
3370 1c2143fd and_into 0x1fd ,bt_clk 
3371 1cc0cc01 increase 1 ,n_tx_slot 
3372 20600000 rtn 

send_eir:
3373 449b4006 bpatch patch06_6 ,mem_patch06 
3374 6fe24170 fetch 1 ,mem_eir_enable 
3375 207a0000 rtn blank 
3376 d8a0017d arg mem_eir ,contw 
3377 6fe2455c fetch 1 ,mem_local_name_length 
3378 1fe27200 copy pdata ,loopcnt 
3379 1fe0fe01 increase 1 ,pdata 
337a e7e20005 istore 1 ,contw 
337b 18a20400 copy contw ,temp 
337c 1fe0fe01 increase 1 ,pdata 
337d 67e40099 store 2 ,mem_tx_len 
337e 18420a00 copy temp ,contw 
337f 58000009 setarg 0x09 
3380 e7e20005 istore 1 ,contw 
3381 d8c0455d arg mem_local_name ,contr 
3382 2040779f call memcpy 
3383 da6045d3 arg mem_all_uuid_128bits ,regc 
3384 df200004 arg 4 ,loopcnt 
3385 20403395 call get_all_uuid 
3386 da6045bd arg mem_all_uuid_16bits ,regc 
3387 df200001 arg 1 ,loopcnt 
3388 20403395 call get_all_uuid 
3389 1800020a force type_dm3 ,type 
338a 70009802 jam 2 ,mem_tx_lch 
338b 5800017d setarg mem_eir 
338c 67e4013a store 2 ,mem_txptr 
338d 20403ae6 call rf_setup_time_slave_slot 
338e 2040395d call tx_radio_freq 
338f 20403aea call start_transmitter 
3390 20403af8 call start_tx_external 
3391 20403afd call send_access_word 
3392 20403b04 call scan_mode_whiten 
3393 204037e3 call transmit_packet_whitened 
3394 20600000 rtn 

get_all_uuid:
3395 18a20400 copy contw ,temp 
3396 1a620c00 copy regc ,contr 
3397 efe20006 ifetch 1 ,contr 
3398 207a0000 rtn blank 

lshift_loop:
3399 1fe3fe00 lshift pdata ,pdata 
339a c2003399 loop lshift_loop 
339b 1fe22200 copy pdata ,rega 
339c 1fe0fe02 increase 2 ,pdata 
339d 1fe20e00 copy pdata ,queue 
339e 6fe40099 fetch 2 ,mem_tx_len 
339f 98e0fe00 iadd queue ,pdata 
33a0 67e40099 store 2 ,mem_tx_len 
33a1 18420a00 copy temp ,contw 
33a2 1a20fe01 add rega ,1 ,pdata 
33a3 e7e20005 istore 1 ,contw 
33a4 1a620c00 copy regc ,contr 
33a5 efe20006 ifetch 1 ,contr 
33a6 efe20006 ifetch 1 ,contr 
33a7 e7e20005 istore 1 ,contw 
33a8 1a227200 copy rega ,loopcnt 
33a9 2020779f branch memcpy 

page_scan_dispatch:
33aa 6fe24133 fetch 1 ,mem_scan_mode 
33ab c4008000 rtnbit0 page_scan_mode 
33ac 18000e06 force pscan_interval_timer ,queue 
33ad 204077ad call timer_check 
33ae 247a0000 nrtn blank 
33af 68444151 fetcht 2 ,mem_pscan_window 
33b0 18000e28 force 40 ,queue 
33b1 20403791 call sniff_check_window 
33b2 20740000 rtn user 
33b3 18000800 force 0 ,am_addr 
33b4 70001008 jam param_pagerespto ,mem_fhs_wait_counter 
33b5 793f800b set0 mark_fhs_already_good ,mark 
33b6 204033ba call page_scan_start 
33b7 18000e06 force pscan_interval_timer ,queue 
33b8 6fe44153 fetch 2 ,mem_pscan_interval 
33b9 202077a6 branch timer_init 

page_scan_start:
33ba 449bc006 bpatch patch06_7 ,mem_patch06 
33bb 78587c00 disable clknt 
33bc 2040392f call afh_clear 
33bd 6fe20008 fetch 1 ,mem_pagescan_waitcnt 
33be 1fe0fe01 increase 1 ,pdata 
33bf 67e20008 store 1 ,mem_pagescan_waitcnt 
33c0 18004c00 force 0 ,n_tx_slot 
33c1 2040396d call fetch_self_bt_adr 
33c2 1c40c201 add clkn_bt ,1 ,bt_clk 
33c3 18004802 force 0x02 ,freq_mode 
33c4 449c4007 bpatch patch07_0 ,mem_patch07 
33c5 20403957 call rx_radio_freq 
33c6 20403a82 call start_receiver 
33c7 20403aaf call wait_access_forever 
33c8 246c0000 nrtn sync 
33c9 20403984 call shutdown_radio 
33ca 6fe20009 fetch 1 ,mem_pagescan_rcvcnt 
33cb 1fe0fe01 increase 1 ,pdata 
33cc 67e20009 store 1 ,mem_pagescan_rcvcnt 
33cd 18003600 force 0 ,stop_watch 
33ce 20403ae6 call rf_setup_time_slave_slot 
33cf 1c21c202 or_into 0x002 ,bt_clk 
33d0 18004801 force 0x01 ,freq_mode 
33d1 2040395d call tx_radio_freq 
33d2 20403aea call start_transmitter 
33d3 20403af8 call start_tx_external 
33d4 20403afd call send_access_word 
33d5 204036b6 call end_of_packet 
33d6 18000800 force 0 ,am_addr 
33d7 d9600600 arg param_rf_setup ,timeup 
33d8 35330200 until clke_rt ,meet 
33d9 1d01d003 or_into 0x03 ,clke_bt 
33da 1c2143fd and_into 0x1fd ,bt_clk 

page_scan_wait_fhs_restart:
33db 449cc007 bpatch patch07_1 ,mem_patch07 
33dc 1cc0cc01 increase 1 ,n_tx_slot 
33dd 20403957 call rx_radio_freq 
33de 20403a82 call start_receiver 
33df 20403aa2 call wait_access_mhalfbnd 
33e0 242c33e4 nbranch page_scan_wait_fhs_again ,sync 
33e1 20403b04 call scan_mode_whiten 
33e2 20403566 call receive_packet_whitened 
33e3 c505b3eb bmark1 mark_fhs_already_good ,page_scan_reply_to_fhs 

page_scan_wait_fhs_again:
33e4 449d4007 bpatch patch07_2 ,mem_patch07 
33e5 6fe20010 fetch 1 ,mem_fhs_wait_counter 
33e6 207a0000 rtn blank 
33e7 1fe0ffff increase -1 ,pdata 
33e8 67e20010 store 1 ,mem_fhs_wait_counter 
33e9 20403ae8 call rf_setup_time_master_slot 
33ea 202033db branch page_scan_wait_fhs_restart 

page_scan_reply_to_fhs:
33eb 449dc007 bpatch patch07_3 ,mem_patch07 
33ec 793fd001 set0 1 ,clke_bt 
33ed 79205000 set1 0 ,clke_bt 
33ee 6fe2000a fetch 1 ,mem_pagescan_rcvfhscnt 
33ef 1fe0fe01 increase 1 ,pdata 
33f0 67e2000a store 1 ,mem_pagescan_rcvfhscnt 
33f1 20403ae6 call rf_setup_time_slave_slot 
33f2 1c21c202 or_into 0x02 ,bt_clk 
33f3 2040395d call tx_radio_freq 
33f4 20403aea call start_transmitter 
33f5 20403af8 call start_tx_external 
33f6 20403afd call send_access_word 
33f7 204036b6 call end_of_packet 

slave_apply_clke_bt:
33f8 2d000603 compare 0x03 ,clke_bt ,0x03 
33f9 2020b3fc branch slave_apply_clke_bt_now ,true 
33fa 37cb8200 until null ,mhalfbnd 
33fb 202033f8 branch slave_apply_clke_bt 

slave_apply_clke_bt_now:
33fc 6fe80130 fetch 4 ,mem_clke_bt 
33fd 1fe1fe03 or_into 0x03 ,pdata 
33fe 1fe25000 icopy clke_bt 

start_slave_connection:
33ff 449e4007 bpatch patch07_4 ,mem_patch07 
3400 6fec0143 fetch 6 ,extm_lap 
3401 67ec0040 store 6 ,mem_plap 
3402 20403481 call prepare_newconn 

slave_newconn_loop:
3403 204034c7 call slave_newconn_once 
3404 2036b408 branch sconn_successful ,match 
3405 2040349f call new_conn_timeout 
3406 243a3403 nbranch slave_newconn_loop ,blank 
3407 20600000 rtn 

sconn_successful:
3408 449ec007 bpatch patch07_5 ,mem_patch07 
3409 2040348c call newconn_init 
340a 2040326a call context_new 
340b 24628000 nrtn zero 
340c 70003100 jam 0 ,mem_mode 
340d 204038cd call calc_clke_offset 
340e 2020324f branch context_save 

slave_dispatch:
340f 449f4007 bpatch patch07_6 ,mem_patch07 
3410 204038db call calc_clke 
3411 2040343f call role_switch_slave 
3412 20740000 rtn user 
3413 20403d2f call load_context_to_esco 
3414 2040432e call pop_cvsd_data_send 

slave_loop:
3415 449fc007 bpatch patch07_7 ,mem_patch07 
3416 204061eb call scheduler_process 
3417 2040355c call slave_conn_recv_packet 
3418 2436b425 nbranch slave_notmatch ,match 
3419 20403b21 call supervision_flush 
341a 20406209 call scheduler_tx_l2cap_pkt 
341b 204034d4 call prepare_tx 
341c 20403430 call set_flow_flag 
341d 204037cd call slave_conn_send_packet 
341e 2040379a call parse_l2cap 
341f 2040544a call parse_lmp 
3420 20404342 call process_cmd 
3421 6fe2000b fetch 1 ,mem_slave_rcvcnt 
3422 1fe0fe01 increase 1 ,pdata 
3423 67e2000b store 1 ,mem_slave_rcvcnt 
3424 204038cd call calc_clke_offset 

slave_notmatch:
3425 44a04008 bpatch patch08_0 ,mem_patch08 
3426 20403c49 call lpm_set_mult 
3427 20403b18 call supervision_update 
3428 20213439 branch slave_disconnect ,positive 
3429 204031ce call check_disconnect_timeout 
342a 24343439 nbranch slave_disconnect ,user 
342b 20403765 call check_attempt 
342c 243a3415 nbranch slave_loop ,blank 
342d 2040431d call push_cvsd_data_to_dec 
342e 20403d1d call load_context_to_acl 
342f 202079c0 branch tws_m_conecting 

set_flow_flag:
3430 c594b435 bmark0 mark_flow ,clear_flow_flag 
3431 6fe20047 fetch 1 ,mem_cur_arq 
3432 793ffe04 set0 flowx ,pdata 
3433 67e20047 store 1 ,mem_cur_arq 
3434 20600000 rtn 

clear_flow_flag:
3435 6fe20047 fetch 1 ,mem_cur_arq 
3436 79207e04 set1 flowx ,pdata 
3437 67e20047 store 1 ,mem_cur_arq 
3438 20600000 rtn 

slave_disconnect:
3439 44a0c008 bpatch patch08_1 ,mem_patch08 
343a 70011400 jam 0 ,mem_tester_emulate 
343b 70014a00 jam 0 ,mem_debug_config 
343c 204034a7 call quit_connection 
343d 793f8011 set0 mark_testmode ,mark 
343e 202078b9 branch test_enable_white 

role_switch_slave:
343f 44a14008 bpatch patch08_2 ,mem_patch08 
3440 204031f0 call role_switch_check 
3441 24740000 nrtn user 
3442 18820400 copy am_addr ,temp 
3443 20403b08 call get_free_amaddr 
3444 67e2014c store 1 ,mem_fhs_am_addr 
3445 18420800 copy temp ,am_addr 
3446 70001120 jam param_newconnto ,mem_newconnto_counter 

roles_sendfhs_loop:
3447 44a1c008 bpatch patch08_3 ,mem_patch08 
3448 20403ae8 call rf_setup_time_master_slot 
3449 18000202 force type_fhs ,type 
344a 204037c5 call slave_send_access 
344b 1c427e00 deposit clkn_bt 
344c 67e8012c store 4 ,mem_clkn_bt 
344d 204037df call transmit_packet 
344e 20403ae6 call rf_setup_time_slave_slot 
344f 7837fc00 enable user3 
3450 2040353e call slave_receive_access 
3451 202c3459 branch roles_got_fhs_reply ,sync 
3452 20403984 call shutdown_radio 
3453 2040349f call new_conn_timeout 
3454 243a3447 nbranch roles_sendfhs_loop ,blank 
3455 c6820000 rtnmark0 mark_accept_switch 
3456 70007c34 jam lmp_slot_offset ,mem_lmo_opcode2 
3457 79200003 set1 mark_switch_initiated ,mark 
3458 20600000 rtn 

roles_got_fhs_reply:
3459 78387c00 enable clknt 
345a 20403481 call prepare_newconn 
345b 2040392f call afh_clear 

roles_newconn_loop:
345c 44a24008 bpatch patch08_4 ,mem_patch08 
345d 20403333 call master_newconn_once 
345e 202c3465 branch roles_newconn_responded ,sync 
345f 2040349f call new_conn_timeout 
3460 243a345c nbranch roles_newconn_loop ,blank 
3461 78587c00 disable clknt 
3462 1d027e00 deposit clke_bt 
3463 67e84168 store 4 ,mem_next_btclk 
3464 20600000 rtn 

roles_newconn_responded:
3465 7834fc00 enable master 
3466 c582346b bmark0 mark_accept_switch ,roles_newconn_nolmp 
3467 793f8004 set0 mark_accept_switch ,mark 
3468 70007c03 jam lmp_accepted ,mem_lmo_opcode2 
3469 70007d33 jam lmp_host_connection_req ,mem_lmi_opcode2 
346a 20405b51 call tid_set_reply 

roles_newconn_nolmp:
346b 18827e00 deposit am_addr 
346c 67e20077 store 1 ,mem_amaddr 
346d 18007e00 force 0 ,pdata 
346e 67ec0038 store 6 ,mem_clk_offset 
346f 6fe20031 fetch 1 ,mem_mode 
3470 79207e01 set1 mode_master ,pdata 
3471 67e20031 store 1 ,mem_mode 
3472 20403b21 call supervision_flush 
3473 7854fc00 disable master 
3474 78347c00 enable user 
3475 20600000 rtn 

init_rx_packet_flags:
3476 44a2c008 bpatch patch08_5 ,mem_patch08 
3477 7856fc00 disable match 
3478 793f8005 set0 mark_loopback ,mark 
3479 793f800a set0 mark_am_addr_broadcast ,mark 
347a 793f8010 set0 mark_longpacket ,mark 
347b 793f800f set0 mark_old_packet ,mark 

init_rx_packet_header_flags:
347c 6fe20047 fetch 1 ,mem_cur_arq 
347d 793ffe05 set0 arqnx ,pdata 
347e 79207e04 set1 flowx ,pdata 
347f 67e20047 store 1 ,mem_cur_arq 
3480 20600000 rtn 

prepare_newconn:
3481 44a34008 bpatch patch08_6 ,mem_patch08 
3482 70001120 jam param_newconnto ,mem_newconnto_counter 
3483 70004750 jam param_newconn_arq ,mem_cur_arq 
3484 6fe4415f fetch 2 ,mem_rx_window_init 
3485 67e4003e store 2 ,mem_rx_window 
3486 1c427e00 deposit clkn_bt 
3487 67e84168 store 4 ,mem_next_btclk 
3488 20780000 rtn clknt 
3489 1d027e00 deposit clke_bt 
348a 67e84168 store 4 ,mem_next_btclk 
348b 20600000 rtn 

newconn_init:
348c 44a3c008 bpatch patch08_7 ,mem_patch08 
348d 20405443 call init_lmp_reinit 
348e 204034a3 call new_conn_handle 
348f 67e20046 store 1 ,mem_conn_handle 
3490 58001c80 setarg param_supervision_to 
3491 67e40051 store 2 ,mem_supervision_to 
3492 6fe20030 fetch 1 ,mem_state 
3493 79207e00 set1 state_inconn ,pdata 
3494 67e20030 store 1 ,mem_state 
3495 70004b00 jam 0 ,mem_op 
3496 70004c00 jam 0 ,mem_state_map 
3497 7000aa00 jam 0 ,mem_lpm_current_mult 
3498 20203b21 branch supervision_flush 

clear_linkkey:
3499 44a44009 bpatch patch09_0 ,mem_patch09 
349a 18007e00 force 0 ,pdata 
349b 67f04274 store 8 ,mem_link_key 
349c e7f00005 istore 8 ,contw 
349d 204031ec call clear_linkstate 
349e 20203282 branch context_traverse_linkkey 

new_conn_timeout:
349f 6fe20011 fetch 1 ,mem_newconnto_counter 
34a0 1fe0ffff increase -1 ,pdata 
34a1 67e20011 store 1 ,mem_newconnto_counter 
34a2 20600000 rtn 

new_conn_handle:
34a3 6fe2416e fetch 1 ,mem_handle_num 
34a4 1fe0fe01 increase 1 ,pdata 
34a5 67e2416e store 1 ,mem_handle_num 
34a6 20600000 rtn 

quit_connection:
34a7 44a4c009 bpatch patch09_1 ,mem_patch09 
34a8 6fe24284 fetch 1 ,mem_hci_cmd 
34a9 c001b4ac beq hci_cmd_remote_name_req ,quit_connection_name 
34aa 6fe20048 fetch 1 ,mem_lmp_to_send 
34ab c080b4b0 bne lmp_name_req ,quit_connection_cont 

quit_connection_name:
34ac 20404366 call cmd_check_plap 
34ad 2422b4b0 nbranch quit_connection_cont ,zero 
34ae 204031ca call master_name_error 
34af 70428400 jam 0 ,mem_hci_cmd 

quit_connection_cont:
34b0 44a54009 bpatch patch09_2 ,mem_patch09 
34b1 204041f7 call app_disconn_reason_collect_bt 
34b2 20404342 call process_cmd 
34b3 204056c5 call lmp_exit_acl_sniff 
34b4 204054d7 call lmp_exit_sco_sniff 
34b5 700b0802 jam bt_evt_bb_disconnected ,mem_fifo_temp 
34b6 204071ee call ui_ipc_send_event 
34b7 20405437 call init_lmp_work 
34b8 20404876 call l2cap_init_work 
34b9 20406a18 call sp_initialize 
34ba 6fe20030 fetch 1 ,mem_state 
34bb 793ffe00 set0 state_inconn 
34bc 67e20030 store 1 ,mem_state 
34bd 6fe2004c fetch 1 ,mem_state_map 
34be 2fe18000 compare 0x0 ,pdata ,0xc0 
34bf 2020b4c1 branch quit_connection_not_clear_mark ,true 
34c0 793f8001 set0 mark_rxbuf_inuse ,mark 

quit_connection_not_clear_mark:
34c1 6fe20047 fetch 1 ,mem_cur_arq 
34c2 c301b4c3 bbit0 wack ,quit_connection_not_clear_tx 

quit_connection_not_clear_tx:
34c3 6fe2004b fetch 1 ,mem_op 
34c4 c4030000 rtnbit0 op_txl2cap 
34c5 793f8002 set0 mark_tx_l2cap ,mark 
34c6 20600000 rtn 

slave_newconn_once:
34c7 44a5c009 bpatch patch09_3 ,mem_patch09 
34c8 6fe2013f fetch 1 ,extm_newconn_am_addr 
34c9 207a0000 rtn blank 
34ca 1fe20800 icopy am_addr 
34cb 2040355c call slave_conn_recv_packet 
34cc 24768000 nrtn match 
34cd 18000200 force type_null ,type 
34ce 204037cd call slave_conn_send_packet 
34cf 18827e00 deposit am_addr 
34d0 67e20077 store 1 ,mem_amaddr 
34d1 18007e00 force 0 ,pdata 
34d2 67e2013f store 1 ,extm_newconn_am_addr 
34d3 20600000 rtn 

prepare_tx:
34d4 44a64009 bpatch patch09_4 ,mem_patch09 
34d5 c595b4e2 bmark0 mark_sco_flag ,prepare_tx_acl 
34d6 18000207 force type_hv3 ,type 
34d7 c59534d9 bmark0 mark_esco_edr_enable ,prepare_tx_hv3 
34d8 18000206 force type_2ev3 ,type 

prepare_tx_hv3:
34d9 c583b4e1 bmark0 mark_esco ,prepare_tx_sco 
34da 20403d1a call check_amaddr_is_esco 
34db 2420b4e2 nbranch prepare_tx_acl ,true 

prepare_tx_esco:
34dc 6fe20308 fetch 1 ,mem_sco_flag 
34dd c280b4e2 bbit1 sco_first_pck_flag ,prepare_tx_acl 
34de 79207e01 set1 sco_first_pck_flag ,pdata 
34df 67e20308 store 1 ,mem_sco_flag 
34e0 2020350c branch set_wait_ack 

prepare_tx_sco:
34e1 24770000 nrtn attempt 

prepare_tx_acl:
34e2 20403271 call context_check_all_wack 
34e3 2422b4f2 nbranch prepare_tx_no_retransmit ,zero 
34e4 6fe20047 fetch 1 ,mem_cur_arq 
34e5 c301b4fb bbit0 wack ,prepare_tx_pollnull 

prepare_tx_retransmit:
34e6 c502b4ff bmark1 mark_loopback ,prepare_tx_loopback 
34e7 6fe2014a fetch 1 ,mem_debug_config 
34e8 c2833505 bbit1 debug_tx_pattern ,prepare_tx_txpat 
34e9 6fe44166 fetch 2 ,mem_retransmission_cnt 
34ea 1fe0ffff increase -1 ,pdata 
34eb 67e44166 store 2 ,mem_retransmission_cnt 
34ec 203a34f0 branch prepare_tx_nomore_retransmit ,blank 
34ed 6fe24165 fetch 1 ,mem_last_type 
34ee 98000200 iforce type 
34ef 20600000 rtn 

prepare_tx_nomore_retransmit:
34f0 44a6c009 bpatch patch09_5 ,mem_patch09 
34f1 204036f0 call clear_got_tx 

prepare_tx_no_retransmit:
34f2 20403d1a call check_amaddr_is_esco 
34f3 2020b4fb branch prepare_tx_pollnull ,true 
34f4 204057f3 call send_lmp 
34f5 20343509 branch prepare_tx_sendlmp ,user 
34f6 6fe2004b fetch 1 ,mem_op 
34f7 c283350b bbit1 op_txl2cap ,prepare_tx_sendl2cap 
34f8 c502b4ff bmark1 mark_loopback ,prepare_tx_loopback 
34f9 6fe2014a fetch 1 ,mem_debug_config 
34fa c2833505 bbit1 debug_tx_pattern ,prepare_tx_txpat 

prepare_tx_pollnull:
34fb 18000201 force type_poll ,type 
34fc 20748000 rtn master 
34fd 18000200 force type_null ,type 
34fe 20600000 rtn 

prepare_tx_loopback:
34ff 44a74009 bpatch patch09_6 ,mem_patch09 
3500 6fe20019 fetch 1 ,mem_rx_type 
3501 98000200 iforce type 
3502 c1808000 rtnne 1 
3503 18000200 force type_null ,type 
3504 20600000 rtn 

prepare_tx_txpat:
3505 6fe2011b fetch 1 ,test_mode_packet_type 
3506 1fe1020f and pdata ,0xf ,type 
3507 79200005 set1 mark_loopback ,mark 
3508 20600000 rtn 

prepare_tx_sendlmp:
3509 18000213 force type_lmp ,type 
350a 2020350c branch set_wait_ack 

prepare_tx_sendl2cap:
350b 20403515 call tx_l2cap_type 

set_wait_ack:
350c 44a7c009 bpatch patch09_7 ,mem_patch09 
350d 68420047 fetcht 1 ,mem_cur_arq 
350e 79200403 set1 wack ,temp 
350f 60420047 storet 1 ,mem_cur_arq 
3510 18227e00 deposit type 
3511 67e24165 store 1 ,mem_last_type 
3512 5800ffff setarg 0xffff 
3513 67e44166 store 2 ,mem_retransmission_cnt 
3514 20600000 rtn 

tx_l2cap_type:
3515 44a8400a bpatch patch0a_0 ,mem_patch0a 
3516 6fe2004c fetch 1 ,mem_state_map 
3517 2feffe05 isolate1 smap_edr ,pdata 
3518 6fe40099 fetch 2 ,mem_tx_len 
3519 2020b528 branch tx_l2cap_type_edr ,true 
351a 18000203 force type_dm1 ,type 
351b 1fe67c11 sub pdata ,17 ,null 
351c 20610000 rtn positive 
351d 18000204 force type_dh1 ,type 
351e 1fe67c1b sub pdata ,27 ,null 
351f 20610000 rtn positive 
3520 1800020a force type_dm3 ,type 
3521 1fe67c79 sub pdata ,121 ,null 
3522 20610000 rtn positive 
3523 1800020e force type_dm5 ,type 
3524 1fe67ce0 sub pdata ,224 ,null 
3525 20610000 rtn positive 
3526 1800020f force type_dh5 ,type 
3527 20600000 rtn 

tx_l2cap_type_edr:
3528 18000203 force type_dm1 ,type 
3529 1fe67c11 sub pdata ,17 ,null 
352a 20610000 rtn positive 
352b 18000204 force type_dh1 ,type 
352c 1fe67c36 sub pdata ,54 ,null 
352d 20610000 rtn positive 
352e 1800020a force type_dm3 ,type 
352f d840016f arg 367 ,temp 
3530 98467c00 isub temp ,null 
3531 24610000 nrtn positive 
3532 1800020e force type_dm5 ,type 
3533 d84002a7 arg 679 ,temp 
3534 98467c00 isub temp ,null 
3535 24610000 nrtn positive 
3536 1800020f force type_dh5 ,type 
3537 20600000 rtn 

slave_receive_master_slot:
3538 6fe20030 fetch 1 ,mem_state 
3539 c300b53d bbit0 state_insniff ,slave_receive_notsniff 
353a 6fe40032 fetch 2 ,mem_tsniff 
353b 203a353d branch slave_receive_notsniff ,blank 
353c 2437353f nbranch slave_receive_sniff ,attempt 

slave_receive_notsniff:
353d 20403ae8 call rf_setup_time_master_slot 

slave_receive_access:
353e 1d00c201 add clke_bt ,1 ,bt_clk 

slave_receive_sniff:
353f 78287c00 enable swfine 
3540 6fe4003e fetch 2 ,mem_rx_window 
3541 1fe37e00 rshift pdata ,pdata 
3542 d8400500 arg param_pll_setup ,temp 
3543 9840fe00 iadd temp ,pdata 
3544 20403abd call ahead_window 
3545 20403975 call fetch_extm_bt_adr 
3546 18004803 force 0x03 ,freq_mode 
3547 20403957 call rx_radio_freq 
3548 20403476 call init_rx_packet_flags 
3549 20403a88 call prep_crypt 
354a 44a8c00a bpatch patch0a_1 ,mem_patch0a 
354b 6fe4003e fetch 2 ,mem_rx_window 
354c 1fe37e00 rshift pdata ,pdata 
354d 20403abd call ahead_window 
354e 20403a82 call start_receiver 
354f 7826fc00 enable decode_fec0 
3550 6fe4003e fetch 2 ,mem_rx_window 
3551 d84003bb arg param_clke_cal ,temp 
3552 9840b600 iadd temp ,stop_watch 
3553 37c18400 correlate null ,timeout 
3554 1b420400 copy clke ,temp 
3555 604c00a4 storet 6 ,mem_sync_clke 
3556 7846fc00 disable decode_fec0 
3557 246c0000 nrtn sync 
3558 dd2003bb arg param_clke_cal ,clke_rt 
3559 1c225000 copy bt_clk ,clke_bt 
355a 2035bba0 branch lpm_adjust_clk ,wake 
355b 20600000 rtn 

slave_conn_recv_packet:
355c 44a9400a bpatch patch0a_2 ,mem_patch0a 
355d 20403538 call slave_receive_master_slot 

tws_slave_conn_recv_packet:
355e 242c3984 nbranch shutdown_radio ,sync 
355f 20403a37 call save_rssi 
3560 c588b564 bmark0 mark_testmode ,receive_packet 
3561 6fe400b9 fetch 2 ,mem_tst_pktcnt_sync 
3562 1fe0fe01 increase 1 ,pdata 
3563 67e400b9 store 2 ,mem_tst_pktcnt_sync 

receive_packet:
3564 1c230400 rshift bt_clk ,temp 
3565 18419c40 or temp ,0x40 ,white_init 

receive_packet_whitened:
3566 44a9c00a bpatch patch0a_3 ,mem_patch0a 
3567 7823fc00 enable enable_white 
3568 78257c00 enable enable_hec 
3569 7825fc00 enable decode_fec1 
356a 09800003 parse demod ,bucket ,3 
356b 198cfe00 rshift8 pwindow ,pdata 
356c 67e20120 store 1 ,mem_temp_am_addr 
356d 09800004 parse demod ,bucket ,4 
356e 08008007 inject bucket ,7 
356f 19827e00 copy pwindow ,pdata 
3570 67e20019 store 1 ,mem_rx_type 
3571 09800003 parse demod ,bucket ,3 
3572 198cfe00 rshift8 pwindow ,pdata 
3573 67e20121 store 1 ,mem_temp_arq 
3574 6fe20019 fetch 1 ,mem_rx_type 
3575 1fe67c03 sub pdata ,3 ,null 
3576 2021357b branch receive_packet_noedr ,positive 
3577 c003b57b beq 7 ,receive_packet_noedr 
3578 6fe2004c fetch 1 ,mem_state_map 
3579 2feffe05 isolate1 smap_edr ,pdata 
357a 7920aa01 setflag true ,psk ,radio_ctrl 

receive_packet_noedr:
357b 44aa400a bpatch patch0a_4 ,mem_patch0a 
357c 09800008 parse demod ,bucket ,8 
357d 7845fc00 disable decode_fec1 
357e 78457c00 disable enable_hec 
357f 2023369a branch error_header ,crc_failed 
3580 c588b584 bmark0 mark_testmode ,receive_packet_amchk 
3581 6fe400bb fetch 2 ,mem_tst_pktcnt_hec 
3582 1fe0fe01 increase 1 ,pdata 
3583 67e400bb store 2 ,mem_tst_pktcnt_hec 

receive_packet_amchk:
3584 44aac00a bpatch patch0a_5 ,mem_patch0a 
3585 6fe20120 fetch 1 ,mem_temp_am_addr 
3586 2fe00e00 compare 0 ,pdata ,0x07 
3587 7920800a setflag true ,mark_am_addr_broadcast ,mark 
3588 2020b592 branch am_addr_ok ,true 
3589 a8800e00 icompare 0x07 ,am_addr 
358a 2020b591 branch am_addr_match ,true 
358b c583b6b6 bmark0 mark_esco ,end_of_packet 
358c 68424309 fetcht 1 ,mem_acl_amaddr 
358d a8400e00 icompare 0x7 ,temp 
358e 2420b6b6 nbranch end_of_packet ,true 
358f 20403d1d call load_context_to_acl 
3590 2040347c call init_rx_packet_header_flags 

am_addr_match:
3591 7836fc00 enable match 

am_addr_ok:
3592 44ab400a bpatch patch0a_6 ,mem_patch0a 
3593 6fe20019 fetch 1 ,mem_rx_type 
3594 1fe20200 icopy type 
3595 c50535a1 bmark1 mark_am_addr_broadcast ,arqn_bypass 
3596 68420121 fetcht 1 ,mem_temp_arq 
3597 6fe20047 fetch 1 ,mem_cur_arq 
3598 793ffe00 set0 flow ,pdata 
3599 284ffe00 isolate1 flow ,temp 
359a 7920fe00 setflag true ,flow ,pdata 
359b 284ffe01 isolate1 arqn ,temp 
359c 7920fe01 setflag true ,arqn ,pdata 
359d 67e20047 store 1 ,mem_cur_arq 
359e 284c0001 isolate0 arqn ,temp 
359f 2020b5a1 branch arqn_bypass ,true 
35a0 204036f0 call clear_got_tx 

arqn_bypass:
35a1 44abc00a bpatch patch0a_7 ,mem_patch0a 
35a2 18227e00 deposit type 
35a3 d8400000 arg 0 ,temp 
35a4 20403ab7 call reserve_slot 
35a5 c000b5db beq type_poll ,process_poll 
35a6 c00035db beq type_null ,process_null 
35a7 c00136c2 beq type_fhs ,process_fhs 
35a8 68420121 fetcht 1 ,mem_temp_arq 
35a9 6fe20047 fetch 1 ,mem_cur_arq 
35aa a8400800 icompare 0x04 ,temp 
35ab 2420b5b0 nbranch rx_type_dispatch ,true 
35ac c58535ae bmark0 mark_am_addr_broadcast ,failed_seqn 
35ad c303b5b0 bbit0 bcast1 ,rx_type_dispatch 

failed_seqn:
35ae 7920000f set1 mark_old_packet ,mark 
35af 7046ec01 jam 1 ,mem_tws_rcv_long_pck 

rx_type_dispatch:
35b0 44ac400b bpatch patch0b_0 ,mem_patch0b 
35b1 18227e00 deposit type 

rx_1slot_type_dispatch:
35b2 c001b5e2 beq type_dm1 ,process_dm1 
35b3 c00235e7 beq type_dh1 ,process_dh1 
35b4 c00435e6 beq type_3dh1 ,process_3dh1 
35b5 c003b5c0 beq type_hv3 ,process_hv3 
35b6 c00335c0 beq type_2ev3 ,process_2ev3 

rx_3slot_type_dispatch:
35b7 d8400004 arg 4 ,temp 
35b8 20403ab7 call reserve_slot 
35b9 c00535e1 beq type_dm3 ,process_dm3 
35ba c005b5e5 beq type_dh3 ,process_dh3 
35bb d8400008 arg 8 ,temp 
35bc 20403ab7 call reserve_slot 
35bd c00735e0 beq type_dm5 ,process_dm5 
35be c007b5e4 beq type_dh5 ,process_dh5 
35bf 20600000 rtn 

process_2ev3:

process_hv3:
35c0 c507b689 bmark1 mark_old_packet ,ack_payload 
35c1 2aac0001 isolate0 psk ,radio_ctrl 
35c2 2020b5c9 branch process_sco_noedr ,true 
35c3 7843fc00 disable enable_white 
35c4 7826fc00 enable decode_fec0 
35c5 1c409602 add clkn_bt ,2 ,timeup 
35c6 34530400 correlate clkn_bt ,meet 
35c7 242c36a6 nbranch error_payload ,sync 
35c8 7823fc00 enable enable_white 

process_sco_noedr:
35c9 7826fc00 enable decode_fec0 
35ca 7824fc00 enable enable_crc 
35cb 78277c00 enable encrypt 
35cc d8a00262 arg mem_sco_indata ,contw 
35cd 6fe24303 fetch 1 ,mem_sco_rx_packet_len 
35ce 1fe27200 icopy loopcnt 

get_hev_data_loop:
35cf 09800008 parse demod ,bucket ,8 
35d0 19897e00 rshift3 pwindow ,pdata 
35d1 e7e20005 istore 1 ,contw 
35d2 c20035cf loop get_hev_data_loop 
35d3 c583b6b6 bmark0 mark_esco ,end_of_packet 
35d4 09800010 parse demod ,bucket ,16 
35d5 7d230008 nsetflag crc_failed ,mark_esco_rxok ,mark 
35d6 202336a6 branch error_payload ,crc_failed 
35d7 6fe20308 fetch 1 ,mem_sco_flag 
35d8 79207e00 set1 sco_rcv_flag ,pdata 
35d9 67e20308 store 1 ,mem_sco_flag 
35da 20203689 branch ack_payload 

process_null:

process_poll:
35db 204079b3 call tws_handle_poll 
35dc 20403d1a call check_amaddr_is_esco 
35dd 2420b5df nbranch process_poll_null_end ,true 
35de 79208008 setflag true ,mark_esco_rxok ,mark 

process_poll_null_end:
35df 202036b6 branch end_of_packet 

process_dm5:
35e0 7046ec01 jam 1 ,mem_tws_rcv_long_pck 

process_dm3:
35e1 79200010 set1 mark_longpacket ,mark 

process_dm1:
35e2 78267c00 enable decode_fec2 
35e3 202035e8 branch process_dmh 

process_dh5:
35e4 7046ec01 jam 1 ,mem_tws_rcv_long_pck 

process_dh3:
35e5 79200010 set1 mark_longpacket ,mark 

process_3dh1:
35e6 79202a02 set1 psk3m ,radio_ctrl 

process_dh1:
35e7 7826fc00 enable decode_fec0 

process_dmh:
35e8 44acc00b bpatch patch0b_1 ,mem_patch0b 
35e9 c500b6b6 bmark1 mark_rxbuf_inuse ,end_of_packet 
35ea 2aac0001 isolate0 psk ,radio_ctrl 
35eb 2020b5f4 branch process_dmh_noedr ,true 
35ec 7843fc00 disable enable_white 
35ed 7826fc00 enable decode_fec0 
35ee 78467c00 disable decode_fec2 
35ef 1c409602 add clkn_bt ,2 ,timeup 
35f0 34530400 correlate clkn_bt ,meet 
35f1 242c36a6 nbranch error_payload ,sync 
35f2 79200010 set1 mark_longpacket ,mark 
35f3 7823fc00 enable enable_white 

process_dmh_noedr:
35f4 44ad400b bpatch patch0b_2 ,mem_patch0b 
35f5 78277c00 enable encrypt 
35f6 7824fc00 enable enable_crc 
35f7 09800003 parse demod ,bucket ,3 
35f8 198cfe00 rshift8 pwindow ,pdata 
35f9 67e2014b store 1 ,mem_lch_code 
35fa 09800005 parse demod ,bucket ,5 
35fb c50835ff bmark1 mark_longpacket ,process_dmh_long 
35fc 19897200 rshift3 pwindow ,loopcnt 
35fd 1f297200 rshift3 loopcnt ,loopcnt 
35fe 20203602 branch process_dmh_common 

process_dmh_long:
35ff 09800005 parse demod ,bucket ,5 
3600 19837200 rshift pwindow ,loopcnt 
3601 09800003 parse demod ,bucket ,3 

process_dmh_common:
3602 44adc00b bpatch patch0b_3 ,mem_patch0b 
3603 1f227e00 deposit loopcnt 
3604 67e4012a store 2 ,mem_len 
3605 203a364d branch process_dmh_data_end ,blank 
3606 9ea67c00 isub mask3ff ,null 
3607 202136a6 branch error_payload ,positive 
3608 44ae400b bpatch patch0b_4 ,mem_patch0b 
3609 793f8000 set0 mark_fhs_eir ,mark 
360a 6fe246ea fetch 1 ,mem_tws_state 
360b c300360e bbit0 tws_state_enable ,process_dmh_common_packet 
360c c302360e bbit0 tws_state_slave_listening ,process_dmh_common_packet 
360d c507fba3 bmark1 mark_old_packet ,tws_handle_old_packet 

process_dmh_common_packet:
360e 6fe2014b fetch 1 ,mem_lch_code 
360f 1fe17e03 and_into 0x03 ,pdata 
3610 c001b614 beq llid_lmp ,process_lmp 
3611 c001361a beq llid_l2cap_start ,process_dmh_data_l2cap_start_pkt 
3612 c000b638 beq llid_l2cap_cont ,process_dmh_data_l2cap_continue_pkt 
3613 202036a6 branch error_payload 

process_lmp:
3614 6fe4012a fetch 2 ,mem_len 
3615 1fe67c70 sub pdata ,0x70 ,null 
3616 242136a6 nbranch error_payload ,positive 
3617 c507b689 bmark1 mark_old_packet ,ack_payload 
3618 d8a005c2 arg mem_rxbuf ,contw 
3619 20203649 branch process_dmh_data 

process_dmh_data_l2cap_start_pkt:
361a 44aec00b bpatch patch0b_5 ,mem_patch0b 
361b c507b689 bmark1 mark_old_packet ,ack_payload 
361c 6fe4012a fetch 2 ,mem_len 
361d d84002e0 arg 0x2e0 ,temp 
361e 98467c00 isub temp ,null 
361f 202136a6 branch error_payload ,positive 
3620 6fe20310 fetch 1 ,mem_l2cap_rxbuff_fifo2 
3621 c08036b6 bne 0 ,end_of_packet 
3622 6fe2030f fetch 1 ,mem_l2cap_rxbuff_fifo1 
3623 c000b62e beq l2cap_inuse_buff1 ,process_dmh_data_into_buff2 

process_dmh_data_into_buff1:
3624 70030d01 jam 1 ,mem_l2cap_rxbuff_new 
3625 6fe246ea fetch 1 ,mem_tws_state 
3626 c002362a beq tws_state_slave_listening ,process_dmh_data_into_buff1_tws_slave 
3627 6fe40309 fetch 2 ,mem_l2cap_rxbuff1_len 
3628 c08036b6 bne 0 ,end_of_packet 
3629 2020362c branch process_dmh_data_into_buff1_normal 

process_dmh_data_into_buff1_tws_slave:
362a 58000000 setarg 0 
362b 67e40309 store 2 ,mem_l2cap_rxbuff1_len 

process_dmh_data_into_buff1_normal:
362c d8a01000 arg mem_l2cap_rxbuff1 ,contw 
362d 20203649 branch process_dmh_data 

process_dmh_data_into_buff2:
362e 70030d02 jam 2 ,mem_l2cap_rxbuff_new 
362f 6fe246ea fetch 1 ,mem_tws_state 
3630 c0023634 beq tws_state_slave_listening ,process_dmh_data_into_buff2_tws_slave 
3631 6fe4030b fetch 2 ,mem_l2cap_rxbuff2_len 
3632 c08036b6 bne 0 ,end_of_packet 
3633 20203636 branch process_dmh_data_into_buff2_normal 

process_dmh_data_into_buff2_tws_slave:
3634 58000000 setarg 0 
3635 67e4030b store 2 ,mem_l2cap_rxbuff2_len 

process_dmh_data_into_buff2_normal:
3636 d8a01400 arg mem_l2cap_rxbuff2 ,contw 
3637 20203649 branch process_dmh_data 

process_dmh_data_l2cap_continue_pkt:
3638 44af400b bpatch patch0b_6 ,mem_patch0b 
3639 c507b689 bmark1 mark_old_packet ,ack_payload 
363a 6fe4012a fetch 2 ,mem_len 
363b d84002e0 arg 0x2e0 ,temp 
363c 98467c00 isub temp ,null 
363d 202136a6 branch error_payload ,positive 
363e 6fe2030d fetch 1 ,mem_l2cap_rxbuff_new 
363f c000b642 beq 1 ,process_dmh_data_l2cap_continue_pkt1 
3640 c0013646 beq 2 ,process_dmh_data_l2cap_continue_pkt2 
3641 202036b6 branch end_of_packet 

process_dmh_data_l2cap_continue_pkt1:
3642 d8a01000 arg mem_l2cap_rxbuff1 ,contw 
3643 6fe40309 fetch 2 ,mem_l2cap_rxbuff1_len 
3644 98a08a00 iadd contw ,contw 
3645 20203649 branch process_dmh_data 

process_dmh_data_l2cap_continue_pkt2:
3646 d8a01400 arg mem_l2cap_rxbuff2 ,contw 
3647 6fe4030b fetch 2 ,mem_l2cap_rxbuff2_len 
3648 98a08a00 iadd contw ,contw 

process_dmh_data:
3649 09800008 parse demod ,bucket ,8 
364a 19897e00 rshift3 pwindow ,pdata 
364b e7e20005 istore 1 ,contw 
364c c2003649 loop process_dmh_data 

process_dmh_data_end:
364d 44afc00b bpatch patch0b_7 ,mem_patch0b 
364e 09800010 parse demod ,bucket ,16 
364f 202336a0 branch error_payload_crc ,crc_failed 

process_dmh_data_end0:
3650 6fe246ea fetch 1 ,mem_tws_state 
3651 c3003656 bbit0 tws_state_enable ,process_dmh_packet 
3652 c301b656 bbit0 tws_state_connected ,process_dmh_packet 
3653 c3037b83 bbit0 tws_state_master ,tws_send_ack_process 
3654 c507b689 bmark1 mark_old_packet ,ack_payload 
3655 c2837a3b bbit1 tws_state_master ,tws_wait_ack_process 

process_dmh_packet:
3656 c508b676 bmark1 mark_testmode ,process_dmh_cont 
3657 c507b6b3 bmark1 mark_old_packet ,redundant_payload 
3658 6fe2014b fetch 1 ,mem_lch_code 
3659 2fe00603 compare 3 ,pdata ,3 
365a 2020b676 branch process_dmh_cont ,true 
365b 6fe4012a fetch 2 ,mem_len 
365c 203a3676 branch process_dmh_cont ,blank 
365d 44b0400c bpatch patch0c_0 ,mem_patch0c 

process_dmh_l2cap_packet:
365e 6fe2030d fetch 1 ,mem_l2cap_rxbuff_new 
365f c000b662 beq 1 ,process_l2cap_pass_crc_buff1 
3660 c001366c beq 2 ,process_l2cap_pass_crc_buff2 
3661 20203b25 branch assert 

process_l2cap_pass_crc_buff1:
3662 6fe40309 fetch 2 ,mem_l2cap_rxbuff1_len 
3663 6844012a fetcht 2 ,mem_len 
3664 9840fe00 iadd temp ,pdata 
3665 67e40309 store 2 ,mem_l2cap_rxbuff1_len 
3666 203a3b25 branch assert ,blank 
3667 68441000 fetcht 2 ,mem_l2cap_rxbuff1 
3668 18408404 increase 4 ,temp 
3669 98467c00 isub temp ,null 
366a 2042b7b9 call l2cap_buff1_inuse ,zero 
366b 20203676 branch process_dmh_cont 

process_l2cap_pass_crc_buff2:
366c 6fe4030b fetch 2 ,mem_l2cap_rxbuff2_len 
366d 6844012a fetcht 2 ,mem_len 
366e 9840fe00 iadd temp ,pdata 
366f 67e4030b store 2 ,mem_l2cap_rxbuff2_len 
3670 203a3b25 branch assert ,blank 
3671 68441400 fetcht 2 ,mem_l2cap_rxbuff2 
3672 18408404 add temp ,4 ,temp 
3673 98467c00 isub temp ,null 
3674 2042b7bb call l2cap_buff2_inuse ,zero 
3675 20203676 branch process_dmh_cont 

process_dmh_cont:
3676 44b0c00c bpatch patch0c_1 ,mem_patch0c 
3677 6842004c fetcht 1 ,mem_state_map 
3678 6fe2014b fetch 1 ,mem_lch_code 
3679 2fe00603 compare 3 ,pdata ,0x03 
367a 79208406 setflag true ,smap_rxlmp ,temp 
367b 7d208407 nsetflag true ,smap_rxl2cap ,temp 
367c 6042004c storet 1 ,mem_state_map 
367d 2420b67f nbranch process_dmh_cont_rxbuf_not_use ,true 
367e 79200001 set1 mark_rxbuf_inuse ,mark 

process_dmh_cont_rxbuf_not_use:
367f c588b689 bmark0 mark_testmode ,ack_payload 
3680 284ffe06 isolate1 smap_rxlmp ,temp 
3681 2020b689 branch ack_payload ,true 
3682 6fe400bd fetch 2 ,mem_tst_pktcnt_crc 
3683 1fe0fe01 increase 1 ,pdata 
3684 67e400bd store 2 ,mem_tst_pktcnt_crc 
3685 79200005 set1 mark_loopback ,mark 
3686 793f8407 set0 smap_rxl2cap ,temp 
3687 793f8001 set0 mark_rxbuf_inuse ,mark 
3688 6042004c storet 1 ,mem_state_map 

ack_payload:
3689 44b1400c bpatch patch0c_2 ,mem_patch0c 
368a 68420121 fetcht 1 ,mem_temp_arq 
368b 6fe20047 fetch 1 ,mem_cur_arq 
368c 79207e05 set1 arqnx ,pdata 
368d 284ffe02 isolate1 seqn ,temp 
368e 7920fe02 setflag true ,seqn ,pdata 
368f 280ffe0a isolate1 mark_am_addr_broadcast ,mark 
3690 7920fe07 setflag true ,bcast1 ,pdata 
3691 67e20047 store 1 ,mem_cur_arq 
3692 6fe4012a fetch 2 ,mem_len 
3693 243a36b6 nbranch end_of_packet ,blank 
3694 6fe2004c fetch 1 ,mem_state_map 
3695 793ffe07 set0 smap_rxl2cap ,pdata 
3696 67e2004c store 1 ,mem_state_map 
3697 6fe2014b fetch 1 ,mem_lch_code 
3698 2fe00e01 compare 0x01 ,pdata ,0x07 
3699 202036b6 branch end_of_packet 

error_header:
369a 44b1c00c bpatch patch0c_3 ,mem_patch0c 
369b 7856fc00 disable match 
369c 6fe4001a fetch 2 ,mem_rx_hec_err 
369d 1fe0fe01 increase 1 ,pdata 
369e 67e4001a store 2 ,mem_rx_hec_err 
369f 202036b6 branch end_of_packet 

error_payload_crc:
36a0 6fe4001c fetch 2 ,mem_rx_crc_err 
36a1 1fe0fe01 increase 1 ,pdata 
36a2 67e4001c store 2 ,mem_rx_crc_err 
36a3 204036a7 call discard_pkt 
36a4 c588b6a6 bmark0 mark_testmode ,error_payload 
36a5 79200005 set1 mark_loopback ,mark 

error_payload:
36a6 202036b6 branch end_of_packet 

discard_pkt:
36a7 44b2400c bpatch patch0c_4 ,mem_patch0c 
36a8 6fe2014b fetch 1 ,mem_lch_code 
36a9 2fe00603 compare 3 ,pdata ,0x03 
36aa 2420b6af nbranch discard_pkt_l2cap ,true 

discard_pkt_lmp:
36ab 6842004c fetcht 1 ,mem_state_map 
36ac 793f8406 set0 smap_rxlmp ,temp 
36ad 6042004c storet 1 ,mem_state_map 
36ae 20600000 rtn 

discard_pkt_l2cap:
36af 6842004c fetcht 1 ,mem_state_map 
36b0 793f8407 set0 smap_rxl2cap ,temp 
36b1 6042004c storet 1 ,mem_state_map 
36b2 20600000 rtn 

redundant_payload:
36b3 6fe20047 fetch 1 ,mem_cur_arq 
36b4 79207e05 set1 arqnx ,pdata 
36b5 67e20047 store 1 ,mem_cur_arq 

end_of_packet:
36b6 44b2c00c bpatch patch0c_5 ,mem_patch0c 
36b7 784efc00 disable encode_fec0 
36b8 784e7c00 disable encode_fec2 
36b9 7846fc00 disable decode_fec0 
36ba 78467c00 disable decode_fec2 
36bb 7844fc00 disable enable_crc 
36bc 78477c00 disable encrypt 
36bd 7843fc00 disable enable_white 
36be 2030b984 branch shutdown_radio ,is_rx 
36bf 37d38200 until null ,tx_clear 
36c0 20000064 nop 100 
36c1 20203984 branch shutdown_radio 

process_fhs:
36c2 44b3400c bpatch patch0c_6 ,mem_patch0c 
36c3 7824fc00 enable enable_crc 
36c4 78267c00 enable decode_fec2 
36c5 09800048 parse demod ,bucket ,72 
36c6 2feffe3a isolate1 58 ,pdata 
36c7 79208000 setflag true ,mark_fhs_eir ,mark 
36c8 1c020400 copy bt_adr ,temp 
36c9 57e04000 ialigned bt_adr 
36ca 57e03c00 ialigned fhs0 
36cb 782afc00 pulse recalc 
36cc 380bffff setsect 2 ,0xfffff 
36cd 380cffff setsect 3 ,0x0ffff 
36ce 20000020 nop 32 
36cf 29a80000 iverify fhs_parity 
36d0 1d827e00 deposit lap 
36d1 67e60143 store 3 ,extm_lap 
36d2 1da27e00 deposit uap 
36d3 67e20146 store 1 ,extm_uap 
36d4 18424000 copy temp ,bt_adr 
36d5 2020b6d7 branch fhs_parity_ok ,true 
36d6 202036a6 branch error_payload 

fhs_parity_ok:
36d7 44b3c00c bpatch patch0c_7 ,mem_patch0c 
36d8 09800048 parse demod ,bucket ,72 
36d9 57e03e00 ialigned fhs1 
36da 57e00800 ialigned am_addr 
36db 57e05c00 ialigned nap 
36dc 57e02400 ialigned regb 
36dd 18007e00 force 0 ,pdata 
36de 09800010 parse demod ,bucket ,16 
36df 202336a6 branch error_payload ,crc_failed 
36e0 5ffffffc setarg 0x0ffffffc 
36e1 9a417e00 iand regb ,pdata 
36e2 67e80130 store 4 ,mem_clke_bt 
36e3 1ba27e00 deposit fhs_class 
36e4 67e60140 store 3 ,extm_class 
36e5 1b827e00 deposit fhs_misc 
36e6 67e2013e store 1 ,extm_fhs_misc 
36e7 18827e00 deposit am_addr 
36e8 67e2013f store 1 ,extm_newconn_am_addr 
36e9 1dc27e00 deposit nap 
36ea 67e40147 store 2 ,extm_nap 
36eb 1c227e00 deposit bt_clk 
36ec 08008220 inject rxf ,32 
36ed 28201e02 compare type_fhs ,type ,0x0f 
36ee 7920800b setflag true ,mark_fhs_already_good ,mark 
36ef 202036b6 branch end_of_packet 

clear_got_tx:
36f0 44b4400d bpatch patch0d_0 ,mem_patch0d 
36f1 6fe20047 fetch 1 ,mem_cur_arq 
36f2 c4018000 rtnbit0 wack 
36f3 793ffe03 set0 wack ,pdata 
36f4 79407e06 setflip seqnx ,pdata 
36f5 67e20047 store 1 ,mem_cur_arq 
36f6 6fe24165 fetch 1 ,mem_last_type 
36f7 c009b708 beq type_lmp ,clear_got_txlmp 
36f8 c1038000 rtneq type_hv3 
36f9 c1030000 rtneq type_2ev3 
36fa 6fe2004b fetch 1 ,mem_op 
36fb c4030000 rtnbit0 op_txl2cap ,pdata 
36fc 793ffe06 set0 op_txl2cap ,pdata 
36fd 79207e07 set1 op_pkt_comp ,pdata 
36fe 67e2004b store 1 ,mem_op 
36ff 793f8002 set0 mark_tx_l2cap ,mark 
3700 6fe24132 fetch 1 ,mem_device_option 
3701 c1008000 rtneq dvc_op_hci 
3702 6fe4434b fetch 2 ,mem_l2cap_tx_multi_offset 
3703 247a0000 nrtn blank 
3704 6fe2004b fetch 1 ,mem_op 
3705 793ffe07 set0 op_pkt_comp ,pdata 
3706 67e2004b store 1 ,mem_op 
3707 20204a49 branch l2cap_malloc_free 

clear_got_txlmp:
3708 44b4c00d bpatch patch0d_1 ,mem_patch0d 
3709 6fe2051b fetch 1 ,mem_lmo_header_opcode 
370a 1fe37e00 rshift pdata ,pdata 
370b c008b725 beq lmp_start_encryption_req ,start_encryption 
370c c009372d beq lmp_stop_encryption_req ,stop_encryption 
370d c00c56c5 beq lmp_unsniff_req ,lmp_exit_acl_sniff 
370e c03fb715 beq lmp_escape ,clear_lmp_escape 
370f c01654d7 beq lmp_remove_sco_link_req ,lmp_exit_sco_sniff 
3710 c1818000 rtnne lmp_accepted 
3711 6fe2051c fetch 1 ,mem_lmo_payload 
3712 c015b71d beq lmp_sco_link_req ,sco_link_req_by_slave 
3713 c008b718 beq lmp_start_encryption_req ,clear_send_setup_complete 
3714 20600000 rtn 

clear_lmp_escape:
3715 6fe2051c fetch 1 ,mem_lmo_payload 
3716 79207e07 set1 7 ,pdata 
3717 20600000 rtn 

clear_send_setup_complete:
3718 20748000 rtn master 
3719 6fe20030 fetch 1 ,mem_state 
371a c3820000 rtnbit1 state_conn_comp 
371b 70007c31 jam lmp_setup_complete ,mem_lmo_opcode2 
371c 20600000 rtn 

sco_link_req_by_slave:
371d 20748000 rtn master 
371e 6fe20031 fetch 1 ,mem_mode 
371f 2feffe04 isolate1 sco_req_by_slave ,pdata 
3720 2020b722 branch clean_mem_mode ,true 
3721 20600000 rtn 

clean_mem_mode:
3722 793ffe04 set0 sco_req_by_slave ,pdata 
3723 67e20031 store 1 ,mem_mode 
3724 20600000 rtn 

start_encryption:
3725 44b5400d bpatch patch0d_2 ,mem_patch0d 
3726 6fe2004c fetch 1 ,mem_state_map 
3727 79207e02 set1 smap_encryption ,pdata 
3728 67e2004c store 1 ,mem_state_map 
3729 70801101 jam 1 ,core_encrypt 
372a 6fe20030 fetch 1 ,mem_state 
372b 2feffe04 isolate1 state_conn_comp ,pdata 
372c 20600000 rtn 

stop_encryption:
372d 44b5c00d bpatch patch0d_3 ,mem_patch0d 
372e 6fe2004c fetch 1 ,mem_state_map 
372f 793ffe02 set0 smap_encryption ,pdata 
3730 67e2004c store 1 ,mem_state_map 
3731 70801100 jam 0 ,core_encrypt 
3732 20600000 rtn 

sniff_init:
3733 44b6400d bpatch patch0d_4 ,mem_patch0d 

sniff_init_sco:
3734 c595b739 bmark0 mark_sco_flag ,sniff_init_acl 
3735 1c40a200 add clkn_bt ,0 ,rega 
3736 2034b73c branch sniff_init_master ,master 
3737 1d00a200 add clke_bt ,0 ,rega 
3738 2020373c branch sniff_init_master 

sniff_init_acl:
3739 1c40a203 add clkn_bt ,3 ,rega 
373a 2034b73c branch sniff_init_master ,master 
373b 1d00a203 add clke_bt ,3 ,rega 

sniff_init_master:
373c 68440032 fetcht 2 ,mem_tsniff 
373d 1a227e00 deposit rega 
373e 793ffe1b set0 27 ,pdata 
373f 9846fc00 idiv temp 
3740 6fe40075 fetch 2 ,mem_dsniff 
3741 2040782e call wait_div_end 
3742 18072600 remainder regc 
3743 9a667e00 isub regc ,pdata 
3744 20213746 branch sniff_init_nowrap ,positive 
3745 9840fe00 iadd temp ,pdata 

sniff_init_nowrap:
3746 9a20fe00 iadd rega ,pdata 
3747 67e80034 store 4 ,mem_sniff_anchor 
3748 7045a200 jam switch_flag_init ,mem_switch_flag 
3749 6fe20030 fetch 1 ,mem_state 
374a 79207e01 set1 state_insniff ,pdata 
374b 67e20030 store 1 ,mem_state 
374c 6fe20073 fetch 1 ,mem_sniff_attempt 
374d 67e20092 store 1 ,mem_current_sniff_attempt 
374e 70416c80 jam 0x80 ,mem_seqi 
374f 58000000 setarg 0 
3750 67e64207 store 3 ,mem_sniff_rcv 
3751 67e6420a store 3 ,mem_sniff_lost 
3752 67e241f7 store 1 ,mem_sniff_unint_lost 
3753 700b080b jam bt_evt_enter_sniff ,mem_fifo_temp 
3754 204071ee call ui_ipc_send_event 
3755 6fe44161 fetch 2 ,mem_rx_window_sniff 
3756 67e4003e store 2 ,mem_rx_window 
3757 24748000 nrtn master 
3758 18808fff add am_addr ,-1 ,queue 
3759 20600000 rtn 

sniff_exit:
375a 44b6c00d bpatch patch0d_5 ,mem_patch0d 
375b 6fe20030 fetch 1 ,mem_state 
375c c4008000 rtnbit0 state_insniff 
375d 793ffe01 set0 state_insniff ,pdata 
375e 67e20030 store 1 ,mem_state 
375f 70416c7f jam 0x7f ,mem_seqi 
3760 6fe4415f fetch 2 ,mem_rx_window_init 
3761 67e4003e store 2 ,mem_rx_window 
3762 7855fc00 disable wake 
3763 700b080c jam bt_evt_exit_sniff ,mem_fifo_temp 
3764 202071ee branch ui_ipc_send_event 

check_attempt:
3765 44b7400d bpatch patch0d_6 ,mem_patch0d 
3766 78377c00 enable attempt 
3767 6fe20030 fetch 1 ,mem_state 
3768 c280b772 bbit1 state_insniff ,check_attempt_sniff 
3769 c6088000 rtnmark1 mark_testmode 
376a 6fe20047 fetch 1 ,mem_cur_arq 
376b c3818000 rtnbit1 wack 
376c 6fe20048 fetch 1 ,mem_lmp_to_send 
376d 247a0000 nrtn blank 
376e 6fe2004b fetch 1 ,mem_op 
376f c3830000 rtnbit1 op_txl2cap 

check_attempt_nomore:
3770 18007e00 force 0 ,pdata 
3771 20600000 rtn 

check_attempt_sniff:
3772 c595b784 bmark0 mark_sco_flag ,check_attempt_for_acl 
3773 6fe20092 fetch 1 ,mem_current_sniff_attempt 
3774 68424310 fetcht 1 ,mem_esco_attempt 
3775 98467c00 isub temp ,null 
3776 2022b77a branch check_attempt_sniff_change_to_acl ,zero 
3777 6fe20047 fetch 1 ,mem_cur_arq 
3778 c281b78d bbit1 wack ,check_attempt_notimeout 
3779 c584378d bmark0 mark_esco_rxok ,check_attempt_notimeout 

check_attempt_sniff_change_to_acl:
377a 20403d1d call load_context_to_acl 
377b 2434b78d nbranch check_attempt_notimeout ,master 
377c 6fe20048 fetch 1 ,mem_lmp_to_send 
377d 243a378d nbranch check_attempt_notimeout ,blank 

check_attempt_sco_master:
377e 6fe2430f fetch 1 ,mem_sco_poll 
377f 1fe0ffff increase -1 ,pdata 
3780 67e2430f store 1 ,mem_sco_poll 
3781 243a3770 nbranch check_attempt_nomore ,blank 
3782 70430f06 jam param_sco_poll ,mem_sco_poll 
3783 2020378d branch check_attempt_notimeout 

check_attempt_for_acl:
3784 6fe20092 fetch 1 ,mem_current_sniff_attempt 
3785 c080b78d bne 1 ,check_attempt_notimeout 
3786 6fe20093 fetch 1 ,mem_current_sniff_timeout 
3787 203a378d branch check_attempt_notimeout ,blank 
3788 1fe0ffff increase -1 ,pdata 
3789 67e20093 store 1 ,mem_current_sniff_timeout 
378a 6fe20047 fetch 1 ,mem_cur_arq 
378b c3818000 rtnbit1 wack 
378c 24768000 nrtn match 

check_attempt_notimeout:
378d 6fe20092 fetch 1 ,mem_current_sniff_attempt 
378e 1fe0ffff increase -1 ,pdata 
378f 67e20092 store 1 ,mem_current_sniff_attempt 
3790 20600000 rtn 

sniff_check_window:
3791 44b7c00d bpatch patch0d_7 ,mem_patch0d 
3792 78487c00 disable swfine 
3793 18423600 copy temp ,stop_watch 
3794 20403291 call context_search_sniff_window 
3795 78547c00 disable user 
3796 24628000 nrtn zero 
3797 18003600 force 0 ,stop_watch 
3798 78347c00 enable user 
3799 20600000 rtn 

parse_l2cap:
379a 44b8400e bpatch patch0e_0 ,mem_patch0e 
379b 793f8001 set0 mark_rxbuf_inuse ,mark 
379c 2040379d call parse_l2cap_buff_process 

parse_l2cap_buff_process:
379d 70031700 jam l2cap_rx_clear ,mem_l2cap_rx_done 
379e 6fe2030f fetch 1 ,mem_l2cap_rxbuff_fifo1 
379f 207a0000 rtn blank 
37a0 c000b7a3 beq l2cap_inuse_buff1 ,parse_l2cap_buff1_process 
37a1 c00137a8 beq l2cap_inuse_buff2 ,parse_l2cap_buff2_process 
37a2 20203b25 branch assert 

parse_l2cap_buff1_process:
37a3 d8c01000 arg mem_l2cap_rxbuff1 ,contr 
37a4 20404897 call process_rx_l2cap_pkt 

parse_l2cap_buff1_process1:
37a5 6fe20317 fetch 1 ,mem_l2cap_rx_done 
37a6 c000b7ad beq l2cap_rx_done ,parse_l2cap_release_buff1 
37a7 20600000 rtn 

parse_l2cap_buff2_process:
37a8 d8c01400 arg mem_l2cap_rxbuff2 ,contr 
37a9 20404897 call process_rx_l2cap_pkt 

parse_l2cap_buff2_process1:
37aa 6fe20317 fetch 1 ,mem_l2cap_rx_done 
37ab c000b7b3 beq l2cap_rx_done ,parse_l2cap_release_buff2 
37ac 20600000 rtn 

parse_l2cap_release_buff1:
37ad 6fe20310 fetch 1 ,mem_l2cap_rxbuff_fifo2 
37ae 67e2030f store 1 ,mem_l2cap_rxbuff_fifo1 
37af 70031000 jam 0 ,mem_l2cap_rxbuff_fifo2 
37b0 58000000 setarg 0 
37b1 67e40309 store 2 ,mem_l2cap_rxbuff1_len 
37b2 20600000 rtn 

parse_l2cap_release_buff2:
37b3 6fe20310 fetch 1 ,mem_l2cap_rxbuff_fifo2 
37b4 67e2030f store 1 ,mem_l2cap_rxbuff_fifo1 
37b5 70031000 jam 0 ,mem_l2cap_rxbuff_fifo2 
37b6 58000000 setarg 0 
37b7 67e4030b store 2 ,mem_l2cap_rxbuff2_len 
37b8 20600000 rtn 

l2cap_buff1_inuse:
37b9 d8400001 arg l2cap_inuse_buff1 ,temp 
37ba 202037bc branch l2cap_buff_fifo_in 

l2cap_buff2_inuse:
37bb d8400002 arg l2cap_inuse_buff2 ,temp 

l2cap_buff_fifo_in:
37bc 6fe2030f fetch 1 ,mem_l2cap_rxbuff_fifo1 
37bd c00037c1 beq 0 ,l2cap_buff_fifo_in1 
37be 6fe20310 fetch 1 ,mem_l2cap_rxbuff_fifo2 
37bf c00037c3 beq 0 ,l2cap_buff_fifo_in2 
37c0 20600000 rtn 

l2cap_buff_fifo_in1:
37c1 6042030f storet 1 ,mem_l2cap_rxbuff_fifo1 
37c2 20600000 rtn 

l2cap_buff_fifo_in2:
37c3 60420310 storet 1 ,mem_l2cap_rxbuff_fifo2 
37c4 20600000 rtn 

slave_send_access:
37c5 44b8c00e bpatch patch0e_1 ,mem_patch0e 
37c6 1d00c201 add clke_bt ,1 ,bt_clk 
37c7 20403975 call fetch_extm_bt_adr 
37c8 18004803 force 0x03 ,freq_mode 
37c9 2040395d call tx_radio_freq 
37ca 20403aea call start_transmitter 
37cb 20403af8 call start_tx_external 
37cc 20203afd branch send_access_word 

slave_conn_send_packet:
37cd 44b9400e bpatch patch0e_2 ,mem_patch0e 
37ce 6fe246ea fetch 1 ,mem_tws_state 
37cf c30037d5 bbit0 tws_state_enable ,slave_conn_send_packet_normal 
37d0 c4030000 rtnbit0 tws_state_master 
37d1 c301b7d5 bbit0 tws_state_connected ,slave_conn_send_packet_normal 
37d2 6fe246ec fetch 1 ,mem_tws_rcv_long_pck 
37d3 207a0000 rtn blank 
37d4 7046ec00 jam 0 ,mem_tws_rcv_long_pck 

slave_conn_send_packet_normal:
37d5 20403ae6 call rf_setup_time_slave_slot 
37d6 1d027e00 deposit clke_bt 
37d7 68484168 fetcht 4 ,mem_next_btclk 
37d8 98467e00 isub temp ,pdata 
37d9 c1808000 rtnne 1 
37da 28203e00 compare type_null ,type ,0x1f 
37db 2420b7de nbranch slave_conn_send_access ,true 
37dc 6fe20019 fetch 1 ,mem_rx_type 
37dd 207a0000 rtn blank 

slave_conn_send_access:
37de 204037c5 call slave_send_access 

transmit_packet:
37df 28203e10 compare type_id ,type ,0x1f 
37e0 2020b6b6 branch end_of_packet ,true 
37e1 1c230400 rshift bt_clk ,temp 
37e2 18419c40 or temp ,0x40 ,white_init 

transmit_packet_whitened:
37e3 44b9c00e bpatch patch0e_3 ,mem_patch0e 
37e4 7823fc00 enable enable_white 
37e5 78257c00 enable enable_hec 
37e6 782dfc00 enable encode_fec1 
37e7 793f8010 set0 mark_longpacket ,mark 
37e8 18827e00 deposit am_addr 
37e9 08008603 inject mod ,3 
37ea 18227e00 deposit type 
37eb 08008604 inject mod ,4 
37ec 6fe20047 fetch 1 ,mem_cur_arq 
37ed 08008004 inject bucket ,4 
37ee 08008603 inject mod ,3 
37ef 78247c00 enable enable_parity 
37f0 08008608 inject mod ,8 
37f1 784dfc00 disable encode_fec1 
37f2 78447c00 disable enable_parity 
37f3 78457c00 disable enable_hec 
37f4 793faa02 set0 psk3m ,radio_ctrl 
37f5 d8400000 arg 0 ,temp 
37f6 20403ab7 call reserve_slot 
37f7 44ba400e bpatch patch0e_4 ,mem_patch0e 
37f8 18217e1f and type ,0x1f ,pdata 
37f9 c009b838 beq type_lmp ,transmit_lmp 
37fa c00036b6 beq type_null ,end_of_packet 
37fb c000b6b6 beq type_poll ,end_of_packet 
37fc c001381c beq type_fhs ,transmit_fhs 
37fd c001b849 beq type_dm1 ,transmit_dm1 
37fe c002384f beq type_dh1 ,transmit_dh1 
37ff c003b810 beq type_hv3 ,transmit_hev 
3800 c003380a beq type_2ev3 ,transmit_2ev3 
3801 c004384e beq type_3dh1 ,transmit_3dh1 
3802 d8400004 arg 4 ,temp 
3803 20403ab7 call reserve_slot 
3804 c005384b beq type_dm3 ,transmit_dm3 
3805 c005b851 beq type_dh3 ,transmit_dh3 
3806 d8400008 arg 8 ,temp 
3807 20403ab7 call reserve_slot 
3808 c007b851 beq type_dh5 ,transmit_dh5 
3809 2020384b branch transmit_dm5 

transmit_2ev3:
380a 78477c00 disable encrypt 
380b 782efc00 enable encode_fec0 
380c 7843fc00 disable enable_white 
380d 79202a01 set1 psk ,radio_ctrl 
380e 580abeee setarg 0xabeee 
380f 08008614 inject mod ,20 

transmit_hev:
3810 7823fc00 enable enable_white 
3811 44bac00e bpatch patch0e_5 ,mem_patch0e 
3812 782efc00 enable encode_fec0 
3813 7824fc00 enable enable_crc 
3814 78277c00 enable encrypt 
3815 6f244305 fetchr loopcnt ,2 ,mem_sco_tx_packet_len 
3816 d8c0029e arg mem_sco_outdata ,contr 

transmit_ev_loop:
3817 efe20006 ifetch 1 ,contr 
3818 08008608 inject mod ,8 
3819 c2003817 loop transmit_ev_loop 
381a c503b883 bmark1 mark_esco ,transmit_end 
381b 202036b6 branch end_of_packet 

transmit_fhs:
381c 44bb400e bpatch patch0e_6 ,mem_patch0e 
381d 6fe2014c fetch 1 ,mem_fhs_am_addr 
381e 1fe20800 icopy am_addr 
381f 6fe20097 fetch 1 ,mem_fhs_misc 
3820 1fe23800 icopy fhs_misc 
3821 6fe6414a fetch 3 ,mem_class 
3822 1fe23a00 icopy fhs_class 
3823 6fe44144 fetch 2 ,mem_nap 
3824 1fe25c00 icopy nap 
3825 7824fc00 enable enable_crc 
3826 782e7c00 enable encode_fec2 
3827 1c022200 copy bt_adr ,rega 
3828 2040396d call fetch_self_bt_adr 
3829 782afc00 pulse recalc 
382a 20000020 nop 32 
382b 1c221600 copy bt_clk ,timeup 
382c 6fe8012c fetch 4 ,mem_clkn_bt 
382d 1fe24200 icopy bt_clk 
382e 53c07e00 preload fhs0 

transmit_fhs0:
382f 08008648 inject mod ,72 
3830 53e07e00 preload fhs1 
3831 08008648 inject mod ,72 
3832 19624200 copy timeup ,bt_clk 
3833 1a224000 copy rega ,bt_adr 
3834 78247c00 enable enable_parity 
3835 08008610 inject mod ,16 
3836 78447c00 disable enable_parity 
3837 202036b6 branch end_of_packet 

transmit_lmp:
3838 44bbc00e bpatch patch0e_7 ,mem_patch0e 
3839 78277c00 enable encrypt 
383a 7824fc00 enable enable_crc 
383b 782e7c00 enable encode_fec2 
383c 6fe2051a fetch 1 ,mem_lmo_header_length 
383d 1fe105f8 and pdata ,0x1f8 ,temp 
383e d8c0051a arg mem_lmo_header_length ,contr 
383f 18408408 increase 8 ,temp 

transmit_lmp_loop:
3840 1840a7b8 add temp ,-72 ,regc 
3841 24213846 nbranch transmit_lmp_finish ,positive 
3842 eff20006 ifetch 9 ,contr 
3843 08008648 inject mod ,72 
3844 1a620400 copy regc ,temp 
3845 20203840 branch transmit_lmp_loop 

transmit_lmp_finish:
3846 eff20006 ifetch 9 ,contr 
3847 08418600 iinject mod ,temp 
3848 20203883 branch transmit_end 

transmit_dm1:
3849 782e7c00 enable encode_fec2 
384a 20203854 branch transmit_dmh 

transmit_dm3:

transmit_dm5:
384b 782e7c00 enable encode_fec2 
384c 79200010 set1 mark_longpacket ,mark 
384d 20203854 branch transmit_dmh 

transmit_3dh1:
384e 79202a02 set1 psk3m ,radio_ctrl 

transmit_dh1:
384f 782efc00 enable encode_fec0 
3850 20203854 branch transmit_dmh 

transmit_dh3:

transmit_dh5:
3851 79202a02 set1 psk3m ,radio_ctrl 
3852 782efc00 enable encode_fec0 
3853 79200010 set1 mark_longpacket ,mark 

transmit_dmh:
3854 44bc400f bpatch patch0f_0 ,mem_patch0f 
3855 6fe2004c fetch 1 ,mem_state_map 
3856 c302b869 bbit0 smap_edr ,transmit_noedr 
3857 18267c03 sub type ,3 ,null 
3858 20213869 branch transmit_noedr ,positive 
3859 78477c00 disable encrypt 
385a 784e7c00 disable encode_fec2 
385b 782efc00 enable encode_fec0 
385c 7843fc00 disable enable_white 
385d 79202a01 set1 psk ,radio_ctrl 
385e 2aaffe02 isolate1 psk3m ,radio_ctrl 
385f 2020b863 branch transmit_edr3m ,true 
3860 580abeee setarg 0xabeee 
3861 08008614 inject mod ,20 
3862 20203867 branch transmit_edr_sync_end 

transmit_edr3m:
3863 585faeba setarg 0x5faeba 
3864 08008618 inject mod ,24 
3865 58000012 setarg 0x12 
3866 08008606 inject mod ,6 

transmit_edr_sync_end:
3867 7823fc00 enable enable_white 
3868 79200010 set1 mark_longpacket ,mark 

transmit_noedr:
3869 78277c00 enable encrypt 
386a 7824fc00 enable enable_crc 
386b c502b88c bmark1 mark_loopback ,transmit_loopback 
386c 6fe20098 fetch 1 ,mem_tx_lch 
386d 08008603 inject mod ,3 
386e 6fe40099 fetch 2 ,mem_tx_len 
386f 98007200 iforce loopcnt 
3870 c5083873 bmark1 mark_longpacket ,transmit_long 
3871 08008605 inject mod ,5 
3872 20203874 branch transmit_stuff 

transmit_long:
3873 0800860d inject mod ,13 

transmit_stuff:
3874 6fe24132 fetch 1 ,mem_device_option 
3875 c000b87e beq dvc_op_hci ,transmit_stuff_hci 
3876 1f227e00 deposit loopcnt 
3877 203a3883 branch transmit_end ,blank 
3878 6fe4013a fetch 2 ,mem_txptr 
3879 98000c00 iforce contr 

transmit_stuff_loop:
387a efe20006 ifetch 1 ,contr 
387b 08008608 inject mod ,8 
387c c200387a loop transmit_stuff_loop 
387d 20203883 branch transmit_end 

transmit_stuff_hci:
387e 6fe4013a fetch 2 ,mem_txptr 
387f 98000600 iforce contru 

transmit_stuff_hci_loop:
3880 efe20003 ifetch 1 ,contru 
3881 08008608 inject mod ,8 
3882 c2003880 loop transmit_stuff_hci_loop 

transmit_end:
3883 78247c00 enable enable_parity 
3884 08008610 inject mod ,16 
3885 78447c00 disable enable_parity 
3886 2040350c call set_wait_ack 
3887 6fe2004c fetch 1 ,mem_state_map 
3888 c302b6b6 bbit0 smap_edr ,end_of_packet 
3889 18007e00 force 0 ,pdata 
388a 08008606 inject mod ,6 
388b 202036b6 branch end_of_packet 

transmit_loopback:
388c 44bcc00f bpatch patch0f_1 ,mem_patch0f 
388d c5083894 bmark1 mark_longpacket ,transmit_loopback_long 

transmit_loopback_short:
388e 6fe2014b fetch 1 ,mem_lch_code 
388f 08008603 inject mod ,3 
3890 6fe2012a fetch 1 ,mem_len 
3891 98002600 iforce regc 
3892 08008605 inject mod ,5 
3893 20203899 branch transmit_loopback_cont 

transmit_loopback_long:
3894 6fe2014b fetch 1 ,mem_lch_code 
3895 08008603 inject mod ,3 
3896 6fe4012a fetch 2 ,mem_len 
3897 98002600 iforce regc 
3898 0800860d inject mod ,13 

transmit_loopback_cont:
3899 d8c005c2 arg mem_rxbuf ,contr 

transmit_loopback_loop:
389a 1a627c00 copy regc ,null 
389b 2022b8a0 branch transmit_loopback_end ,zero 
389c efe20006 ifetch 1 ,contr 
389d 08008608 inject mod ,8 
389e 1a60a7ff increase -1 ,regc 
389f 2020389a branch transmit_loopback_loop 

transmit_loopback_end:
38a0 6fe400bf fetch 2 ,mem_tst_pktcnt_dmh 
38a1 1fe0fe01 increase 1 ,pdata 
38a2 67e400bf store 2 ,mem_tst_pktcnt_dmh 
38a3 20203883 branch transmit_end 

apply_switch_clke:
38a4 6fe80130 fetch 4 ,mem_clke_bt 
38a5 1fe0a207 add pdata ,7 ,rega 
38a6 6fe4013c fetch 2 ,mem_slot_offset 
38a7 243a38aa nbranch apply_switch_nozero ,blank 
38a8 1a20a3fd increase -3 ,rega 
38a9 202038b2 branch apply_switch_wait_loop 

apply_switch_nozero:
38aa 1feffe0c mul32 pdata ,12 ,pdata 
38ab 68448040 fetcht 2 ,core_rthalfslot 
38ac 18408401 increase 1 ,temp 

apply_switch_loop:
38ad 98467e00 isub temp ,pdata 
38ae 242138b1 nbranch apply_switch_bt ,positive 
38af 1a20a3ff increase -1 ,rega 
38b0 202038ad branch apply_switch_loop 

apply_switch_bt:
38b1 1fe67e00 sub pdata ,0 ,pdata 

apply_switch_wait_loop:
38b2 37d18200 until null ,oneslot 
38b3 2c400600 compare 0 ,clkn_bt ,3 
38b4 2420b8b2 nbranch apply_switch_wait_loop ,true 
38b5 98005200 iforce clke_rt 
38b6 1a225000 copy rega ,clke_bt 
38b7 98005200 iforce clke_rt 
38b8 20600000 rtn 

calc_slot_offset:
38b9 44bd400f bpatch patch0f_2 ,mem_patch0f 
38ba 37d10200 until null ,halfslot 
38bb 1b427e00 deposit clke 
38bc 98000c00 iforce contr 
38bd 1ff17e00 rshift16 pdata ,pdata 
38be 9c467200 isub clkn_bt ,loopcnt 
38bf 1f217203 and_into 3 ,loopcnt 
38c0 2422b8c3 nbranch calc_bt_portion ,zero 
38c1 18007e00 force 0 ,pdata 
38c2 202038c7 branch calc_skip_bt 

calc_bt_portion:
38c3 d8400ea6 arg 3750 ,temp 
38c4 18007e00 force 0 ,pdata 

calc_slot_offset_loop:
38c5 9840fe00 iadd temp ,pdata 
38c6 c20038c5 loop calc_slot_offset_loop 

calc_skip_bt:
38c7 98c0fe00 iadd contr ,pdata 
38c8 1fe6fc0c div pdata ,12 
38c9 2040782e call wait_div_end 
38ca 1807fe00 quotient pdata 
38cb 67e4013c store 2 ,mem_slot_offset 
38cc 20600000 rtn 

calc_clke_offset:
38cd 44bdc00f bpatch patch0f_3 ,mem_patch0f 
38ce 1b427e00 deposit clke 
38cf 1b220400 copy clkn ,temp 
38d0 98467c00 isub temp ,null 
38d1 7d217e2c nsetflag positive ,44 ,pdata 
38d2 98460400 isub temp ,temp 
38d3 58000ea6 setarg 3750 
38d4 284c000f isolate0 15 ,temp 
38d5 2020b8d8 branch calc_clke_pos ,true 
38d6 5fff0ea6 setarg -61786 
38d7 98408400 iadd temp ,temp 

calc_clke_pos:
38d8 604c04b5 storet 6 ,mem_le_clk_offset 
38d9 604c0038 storet 6 ,mem_clk_offset 
38da 20600000 rtn 

calc_clke:
38db 78587c00 disable clknt 
38dc 6fec04b5 fetch 6 ,mem_le_clk_offset 
38dd 203b38df branch calc_clke2 ,le 

calc_clke_tws:
38de 6fec0038 fetch 6 ,mem_clk_offset 

calc_clke2:
38df 9b20e000 iadd clkn ,alarm 
38e0 1e00e00a increase 10 ,alarm 
38e1 58000ea6 setarg 3750 
38e2 9e067e00 isub alarm ,pdata 
38e3 2fec000f isolate0 15 ,pdata 
38e4 2020b8e9 branch calc_clke_pos_adj ,true 
38e5 5800f15a setarg 0xf15a 
38e6 9e00e000 iadd alarm ,alarm 

calc_clke_pos2:
38e7 1e023400 copy alarm ,clke 
38e8 20600000 rtn 

calc_clke_pos_adj:
38e9 18007c00 force 0 ,null 
38ea 202038e7 branch calc_clke_pos2 

calc_radio_freq:
38eb 44be400f bpatch patch0f_4 ,mem_patch0f 
38ec 204039a2 call set_sync_on 
38ed 1c227e00 copy bt_clk ,pdata 
38ee 1fe17f80 and_into 0x180 ,pdata 
38ef 2c800e03 compare 3 ,freq_mode ,0x07 
38f0 2420b8f4 nbranch freq_not_connection ,true 
38f1 1fe97e00 rshift3 pdata ,pdata 
38f2 9ae0fe00 iadd freq_index ,pdata 
38f3 202038f5 branch do_hop_mod_now 

freq_not_connection:
38f4 1ae27e00 copy freq_index ,pdata 

do_hop_mod_now:
38f5 1fe6fc4f div pdata ,79 
38f6 782afc00 pulse recalc 
38f7 2040782e call wait_div_end 
38f8 18072200 remainder rega 
38f9 1a2085d8 add rega ,-40 ,temp 
38fa 202138fd branch odd_half ,positive 
38fb 1a238400 lshift rega ,temp 
38fc 202038ff branch freq_result 

odd_half:
38fd 18438400 lshift temp ,temp 
38fe 18408401 increase 1 ,temp 

freq_result:
38ff 44bec00f bpatch patch0f_5 ,mem_patch0f 
3900 6fe20031 fetch 1 ,mem_mode 
3901 c301b910 bbit0 afh_change ,afh_process_con 

afh_process_0:
3902 6fe84171 fetch 4 ,mem_afh_instant 
3903 9c267c00 isub bt_clk ,null 
3904 20213910 branch afh_process_con ,positive 
3905 2040392f call afh_clear 
3906 6fe24178 fetch 1 ,mem_afh_new_mod 
3907 207a0000 rtn blank 
3908 6fe20031 fetch 1 ,mem_mode 
3909 79207e02 set1 afh_enable ,pdata 
390a 67e20031 store 1 ,mem_mode 
390b 6fea4186 fetch 5 ,mem_afh_map_new 
390c 67ea4179 store 5 ,mem_afh_map_lo 
390d efea0006 ifetch 5 ,contr 
390e 67ea417e store 5 ,mem_afh_map_hi 
390f 20403934 call afh_process_freq_map 

afh_process_con:
3910 6fe20031 fetch 1 ,mem_mode 
3911 c4010000 rtnbit0 afh_enable 
3912 2c2ffe01 isolate1 1 ,bt_clk 
3913 2020b92c branch afh_same_channel ,true 
3914 18492200 rshift3 temp ,rega 
3915 18410e07 and temp ,7 ,queue 
3916 58004179 setarg mem_afh_map_lo 
3917 9a20a200 iadd rega ,rega 
3918 efe20011 ifetch 1 ,rega 
3919 afec0000 qisolate0 pdata 
391a 2020b91d branch afh_process_1 ,true 
391b 18427e00 deposit temp 
391c 20203929 branch afh_process_end 

afh_process_1:
391d 6fe24183 fetch 1 ,mem_afh_used 
391e 1fe22400 copy pdata ,regb 
391f 1c227e00 deposit bt_clk 
3920 1fe17f80 and_into 0x180 ,pdata 
3921 1fe97e00 rshift3 pdata ,pdata 
3922 9ae0fe00 iadd freq_index ,pdata 
3923 9a46fc00 idiv regb 
3924 58004191 setarg mem_afh_map 
3925 2040782e call wait_div_end 
3926 18072200 remainder rega 
3927 9a208c00 iadd rega ,contr 
3928 efe20006 ifetch 1 ,contr 

afh_process_end:
3929 67e24184 store 1 ,mem_afh_index 
392a 98000400 iforce temp 
392b 20600000 rtn 

afh_same_channel:
392c 6fe24184 fetch 1 ,mem_afh_index 
392d 98000400 iforce temp 
392e 20600000 rtn 

afh_clear:
392f 6fe20031 fetch 1 ,mem_mode 
3930 793ffe02 set0 afh_enable ,pdata 
3931 793ffe03 set0 afh_change ,pdata 
3932 67e20031 store 1 ,mem_mode 
3933 20600000 rtn 

afh_process_freq_map:
3934 44bf400f bpatch patch0f_6 ,mem_patch0f 
3935 d8a04191 arg mem_afh_map ,contw 
3936 1800720a force 10 ,loopcnt 
3937 2040775e call memset0 
3938 d8a04191 arg mem_afh_map ,contw 
3939 18002600 force 0 ,regc 
393a 18000e02 force 2 ,queue 

process_freq_3:
393b 6fea4179 fetch 5 ,mem_afh_map_lo 
393c 98000400 iforce temp 
393d 28e1fe02 compare 2 ,queue ,0xff 
393e 2020b940 branch process_freq_1 ,true 
393f 18430400 rshift temp ,temp 

process_freq_1:
3940 284c0000 isolate0 0 ,temp 
3941 2020b944 branch process_freq_0 ,true 
3942 1a627e00 deposit regc 
3943 e7e20005 istore 1 ,contw 

process_freq_0:
3944 184b0400 rshift2 temp ,temp 
3945 1a60a602 increase 2 ,regc 
3946 2a61fc28 compare 40 ,regc ,0xfe 
3947 2420b94d nbranch process_freq_2 ,true 
3948 6fea417e fetch 5 ,mem_afh_map_hi 
3949 98000400 iforce temp 
394a 28e1fe02 compare 2 ,queue ,0xff 
394b 2020b94d branch process_freq_2 ,true 
394c 18430400 rshift temp ,temp 

process_freq_2:
394d 1a667c4e sub regc ,78 ,null 
394e 20213940 branch process_freq_1 ,positive 
394f 18002601 force 1 ,regc 
3950 18e08fff increase -1 ,queue 
3951 2422b93b nbranch process_freq_3 ,zero 
3952 da204191 arg mem_afh_map ,rega 
3953 18a27e00 deposit contw 
3954 9a267e00 isub rega ,pdata 
3955 67e24183 store 1 ,mem_afh_used 
3956 20600000 rtn 

rx_radio_freq:
3957 44bfc00f bpatch patch0f_7 ,mem_patch0f 
3958 204038eb call calc_radio_freq 
3959 6fe2014a fetch 1 ,mem_debug_config 
395a c302b95c bbit0 debug_rx_fixed_freq ,rx_radio_freq_now 
395b 68420530 fetcht 1 ,mem_rx_fixed_freq 

rx_radio_freq_now:
395c 202039aa branch set_freq_rx 

tx_radio_freq:
395d 44c04010 bpatch patch10_0 ,mem_patch10 
395e 204038eb call calc_radio_freq 
395f 6fe2014a fetch 1 ,mem_debug_config 
3960 c3023962 bbit0 debug_tx_fixed_freq ,tx_radio_freq_now 
3961 6842052f fetcht 1 ,mem_tx_fixed_freq 

tx_radio_freq_now:
3962 202039b7 branch set_freq_tx 

fetch_giac:
3963 18005a00 force 0 ,uap 
3964 6fe64147 fetch 3 ,mem_glap 
3965 98005800 iforce lap 
3966 20600000 rtn 

fetch_page_bt_adr:
3967 44c0c010 bpatch patch10_1 ,mem_patch10 
3968 6fe24289 fetch 1 ,mem_hci_puap 
3969 1fe25a00 icopy uap 
396a 6fe64286 fetch 3 ,mem_hci_plap 
396b 1fe25800 icopy lap 
396c 20600000 rtn 

fetch_self_bt_adr:
396d 44c14010 bpatch patch10_2 ,mem_patch10 
396e 6fe44144 fetch 2 ,mem_nap 
396f 1fe25c00 icopy nap 
3970 6fe24143 fetch 1 ,mem_uap 
3971 1fe25a00 icopy uap 
3972 6fe64140 fetch 3 ,mem_lap 
3973 1fe25800 icopy lap 
3974 20600000 rtn 

fetch_extm_bt_adr:
3975 44c1c010 bpatch patch10_3 ,mem_patch10 
3976 6fe40044 fetch 2 ,mem_pnap 
3977 1fe25c00 icopy nap 
3978 6fe20043 fetch 1 ,mem_puap 
3979 1fe25a00 icopy uap 
397a 6fe60040 fetch 3 ,mem_plap 
397b 1fe25800 icopy lap 
397c 20600000 rtn 

fetch_diac:
397d c5103980 bmark1 mark_all_diac ,fetch_diac_do 
397e c68e8000 rtnmark0 mark_inquiry_state 
397f c68f8000 rtnmark0 mark_periodical_diac 

fetch_diac_do:
3980 1d815900 and_into -256 ,lap 
3981 782afc00 pulse recalc 
3982 20000020 nop 32 
3983 20600000 rtn 

shutdown_radio:
3984 44c24010 bpatch patch10_4 ,mem_patch10 
3985 2030b994 branch shutdown_radio0 ,is_rx 
3986 708955d4 jam 0xd4 ,0x8955 
3987 20000004 nop 4 
3988 708955d2 jam 0xd2 ,0x8955 
3989 20000004 nop 4 
398a 708955d1 jam 0xd1 ,0x8955 
398b 20000004 nop 4 
398c 6fe24291 fetch 1 ,mem_tx_power 
398d c0003992 beq tx_power_0db ,shutdown_radio_0db 
398e c000b99f beq tx_power_3db ,shutdown_radio_3db 
398f c0013992 beq tx_power_5db ,shutdown_radio_5db 
3990 c001b99f beq tx_power_f3db ,shutdown_radio_f3db 
3991 c002399f beq tx_power_f5db ,shutdown_radio_f5db 

shutdown_radio_5db:

shutdown_radio_0db:
3992 708955d0 jam 0xd0 ,0x8955 
3993 708956e0 jam 0xe0 ,0x8956 

shutdown_radio0:
3994 18002a00 force 0 ,radio_ctrl 
3995 7850fc00 disable is_rx 
3996 78507c00 disable is_tx 
3997 782f7c00 pulse packet_end 
3998 70890200 jam 0x0 ,rfen_mdm 
3999 70890100 jam 0x0 ,rfen_tx 
399a 70890000 jam 0x0 ,rfen_rx 
399b 70890300 jam 0 ,rfen_sn 
399c 70890470 jam 0x70 ,rfen_msc 
399d 70890600 jam 0x0 ,rfen_adc 
399e 20600000 rtn 

shutdown_radio_f5db:

shutdown_radio_f3db:

shutdown_radio_3db:
399f 708955d0 jam 0xd0 ,0x8955 
39a0 708956c0 jam 0xc0 ,0x8956 
39a1 20203994 branch shutdown_radio0 

set_sync_on:
39a2 44c2c010 bpatch patch10_5 ,mem_patch10 
39a3 70890477 jam 0x77 ,rfen_msc 
39a4 70890303 jam 0x03 ,rfen_sn 
39a5 2000000a nop 10 
39a6 70890383 jam 0x83 ,rfen_sn 
39a7 7089047f jam 0x7f ,rfen_msc 
39a8 708903a7 jam 0xa7 ,rfen_sn 
39a9 20600000 rtn 

set_freq_rx:
39aa 44c34010 bpatch patch10_6 ,mem_patch10 
39ab 60420017 storet 1 ,mem_last_freq 
39ac 1840a204 add temp ,rx_freq_offset ,rega 
39ad 202039fd branch rf_write_freq 

rf_rx_enable:
39ae 44c3c010 bpatch patch10_7 ,mem_patch10 
39af 708901cf jam 0xcf ,rfen_tx 
39b0 2000000a nop 10 
39b1 708900ff jam 0xff ,rfen_rx 
39b2 708903af jam 0xaf ,rfen_sn 
39b3 708904ff jam 0xff ,rfen_msc 
39b4 2000000a nop 10 
39b5 708902a0 jam 0xa0 ,rfen_mdm 
39b6 20600000 rtn 

set_freq_tx:
39b7 44c44011 bpatch patch11_0 ,mem_patch11 
39b8 60420017 storet 1 ,mem_last_freq 
39b9 1840a200 add temp ,0 ,rega 
39ba 204039fd call rf_write_freq 
39bb 58000500 setarg param_pll_setup 
39bc 20403b27 call sleep 

rf_tx_enable:
39bd 70890601 jam 0x1 ,rfen_adc 
39be 7089003c jam 0x3c ,rfen_rx 
39bf 708901e0 jam 0xe0 ,rfen_tx 
39c0 2000000a nop 10 
39c1 70890201 jam 0x01 ,rfen_mdm 
39c2 7089023d jam 0x3d ,rfen_mdm 
39c3 2000000a nop 10 
39c4 708903b7 jam 0xb7 ,rfen_sn 
39c5 2000000a nop 10 
39c6 7089027d jam 0x7d ,rfen_mdm 
39c7 6fe24291 fetch 1 ,mem_tx_power 
39c8 c00039cd beq tx_power_0db ,set_tx_power_0db 
39c9 c000b9d1 beq tx_power_3db ,set_tx_power_3db 
39ca c00139d5 beq tx_power_5db ,set_tx_power_5db 
39cb c001b9d9 beq tx_power_f3db ,set_tx_power_f3db 
39cc c00239dd beq tx_power_f5db ,set_tx_power_f5db 

set_tx_power_0db:
39cd 708956f0 jam 0xf0 ,0x8956 
39ce 204039e1 call txon_common 
39cf 708955d8 jam 0xd8 ,0x8955 
39d0 20600000 rtn 

set_tx_power_3db:
39d1 708956df jam 0xdf ,0x8956 
39d2 204039e1 call txon_common 
39d3 708955df jam 0xdf ,0x8955 
39d4 20600000 rtn 

set_tx_power_5db:
39d5 708956ff jam 0xff ,0x8956 
39d6 204039e1 call txon_common 
39d7 708955df jam 0xdf ,0x8955 
39d8 20600000 rtn 

set_tx_power_f3db:
39d9 708956ce jam 0xce ,0x8956 
39da 204039e1 call txon_common 
39db 708955d8 jam 0xd8 ,0x8955 
39dc 20600000 rtn 

set_tx_power_f5db:
39dd 708956cb jam 0xcb ,0x8956 
39de 204039e1 call txon_common 
39df 708955d8 jam 0xd8 ,0x8955 
39e0 20600000 rtn 

txon_common:
39e1 20000004 nop 4 
39e2 708955d1 jam 0xd1 ,0x8955 
39e3 20000004 nop 4 
39e4 708955d2 jam 0xd2 ,0x8955 
39e5 20000004 nop 4 
39e6 708955d4 jam 0xd4 ,0x8955 
39e7 20600000 rtn 

initialize_radio:
39e8 70804206 jam clksel_rc ,core_clksel 

initialize_radio_wait:
39e9 6fe44163 fetch 2 ,mem_rf_init_ptr 
39ea c30739e9 bbit0 14 ,initialize_radio_wait 
39eb 98000c00 iforce contr 
39ec d8408900 arg 0x8900 ,temp 

initialize_radio_loop:
39ed efe20006 ifetch 1 ,contr 
39ee c07fb9f3 beq 0xff ,initialize_radio_cont 
39ef 98418a00 ior temp ,contw 
39f0 efe20006 ifetch 1 ,contr 
39f1 e7e20005 istore 1 ,contw 
39f2 202039ed branch initialize_radio_loop 

initialize_radio_cont:
39f3 44c4c011 bpatch patch11_1 ,mem_patch11 
39f4 20403c77 call lpm_cal_xtal_startup 
39f5 20403a4d call switchto_dpllclk 
39f6 580007d0 setarg param_dpll_start_delay 
39f7 9c40fe00 iadd clkn_bt ,pdata 
39f8 67e80134 store 4 ,mem_dpll_clkn 
39f9 79202a03 set1 reset ,radio_ctrl 
39fa 18002a00 force 0 ,radio_ctrl 
39fb 2455ba14 ncall do_rccal ,wake 
39fc 20203a27 branch set_rccal 

rf_write_freq:
39fd 44c54011 bpatch patch11_2 ,mem_patch11 
39fe 58000960 setarg 2400 
39ff 9a208400 iadd rega ,temp 
3a00 6fe2415d fetch 1 ,mem_fcomp_mul 
3a01 70895f04 jam 0x04 ,rf_pll_rstn 
3a02 984ffe00 imul32 temp ,pdata 
3a03 6842415e fetcht 1 ,mem_fcomp_div 
3a04 9846fc00 idiv temp 
3a05 2040782e call wait_div_end 
3a06 1807a200 quotient rega 
3a07 18077e00 remainder pdata 
3a08 1ff07e00 lshift16 pdata ,pdata 
3a09 1ff27e00 lshift4 pdata ,pdata 
3a0a 9846fc00 idiv temp 
3a0b 2040782e call wait_div_end 
3a0c 1807fe00 quotient pdata 
3a0d 1fed7e00 lshift8 pdata ,pdata 
3a0e 1fe3fe00 lshift pdata ,pdata 
3a0f 9a21fe00 ior rega ,pdata 
3a10 67e88960 store 4 ,rf_pll_intg 
3a11 70895f44 jam 0x44 ,rf_pll_rstn 
3a12 70895fc4 jam 0xc4 ,rf_pll_rstn 
3a13 20600000 rtn 

do_rccal:
3a14 44c5c011 bpatch patch11_3 ,mem_patch11 
3a15 70890602 jam 0x02 ,rfen_adc 
3a16 5803d090 setarg 250000 
3a17 20403b27 call sleep 
3a18 7089007f jam 0x7f ,rfen_rx 
3a19 20000082 nop 130 
3a1a 70895230 jam 0x30 ,rf_rccal_ctrl 
3a1b 708901d0 jam 0xd0 ,rfen_tx 
3a1c 70895270 jam 0x70 ,rf_rccal_ctrl 
3a1d 708952f0 jam 0xf0 ,rf_rccal_ctrl 
3a1e 18007232 force 50 ,loopcnt 

do_rccal_loop:
3a1f 6fe28990 fetch 1 ,rf_rccal_result 
3a20 c282ba22 bbit1 5 ,do_rccal_end 
3a21 c2003a1f loop do_rccal_loop 

do_rccal_end:
3a22 67e2416d store 1 ,mem_rf_rccal 
3a23 70890100 jam 0 ,rfen_tx 
3a24 70890000 jam 0 ,rfen_rx 
3a25 70890600 jam 0x00 ,rfen_adc 
3a26 20600000 rtn 

set_rccal:
3a27 44c64011 bpatch patch11_4 ,mem_patch11 
3a28 6fe2416d fetch 1 ,mem_rf_rccal 
3a29 79207e05 set1 5 ,pdata 
3a2a 67e28952 store 1 ,rf_rccal_ctrl 
3a2b 68428950 fetcht 1 ,rf_bpf_ctrim 
3a2c 18410407 and_into 7 ,temp 
3a2d 1fe9fe00 lshift3 pdata ,pdata 
3a2e 9841fe00 ior temp ,pdata 
3a2f 67e28950 store 1 ,rf_bpf_ctrim 
3a30 6fe28951 fetch 1 ,rf_bpf_ib 
3a31 793ffe00 set0 bpf_rccal ,pdata 
3a32 67e28951 store 1 ,rf_bpf_ib 
3a33 6fe28952 fetch 1 ,rf_adc_rccal 
3a34 793ffe05 set0 adc_rccal ,pdata 
3a35 67e28952 store 1 ,rf_adc_rccal 
3a36 20600000 rtn 

save_rssi:
3a37 44c6c011 bpatch patch11_5 ,mem_patch11 
3a38 6fe48991 fetch 2 ,rf_afc_d2a 
3a39 1ff1fe00 rshift4 pdata ,pdata 
3a3a 1fe97e00 rshift3 pdata ,pdata 
3a3b 1fe67e00 sub pdata ,0 ,pdata 
3a3c 1fe17eff and_into 0xff ,pdata 
3a3d 1fe6fc0a div pdata ,10 
3a3e 2040782e call wait_div_end 
3a3f 1807fe00 quotient pdata 
3a40 1ff27e00 lshift4 pdata ,pdata 
3a41 18070400 remainder temp 
3a42 9841fe00 ior temp ,pdata 
3a43 67e20018 store 1 ,mem_rssi 
3a44 20600000 rtn 

switchto_rcclk:
3a45 7080420a jam 0xa ,core_clksel 
3a46 70890500 jam 0 ,rfen_ck 
3a47 6fe68336 fetch 3 ,core_lpm_ctrl 
3a48 67e6804c store 3 ,core_lpm_reg 
3a49 70804cfc jam 0xfc ,core_lpm_reg 
3a4a 20403c9b call lpm_write_ctrl 
3a4b 200003e8 nop 1000 
3a4c 20600000 rtn 

switchto_dpllclk:
3a4d 70804206 jam clksel_rc ,core_clksel 
3a4e 6fe2896b fetch 1 ,rf_clkpll_frac + 2 
3a4f 793ffe04 set0 4 ,pdata 
3a50 793ffe05 set0 5 ,pdata 
3a51 67e2896b store 1 ,rf_clkpll_frac + 2 
3a52 70890500 jam 0x00 ,rfen_ck 
3a53 70890400 jam 0x00 ,rfen_msc 
3a54 70890470 jam 0x70 ,rfen_msc 
3a55 708905ff jam 0xff ,rfen_ck 
3a56 6fe2896b fetch 1 ,rf_clkpll_frac + 2 
3a57 79207e04 set1 4 ,pdata 
3a58 79207e05 set1 5 ,pdata 
3a59 67e2896b store 1 ,rf_clkpll_frac + 2 
3a5a 20403a80 call init_lpm_ctrl 
3a5b 6fe28968 fetch 1 ,rf_clkpll_int 
3a5c 79207e07 set1 7 ,pdata 
3a5d 67e28968 store 1 ,rf_clkpll_int 
3a5e 793ffe07 set0 7 ,pdata 
3a5f 67e28968 store 1 ,rf_clkpll_int 
3a60 79207e07 set1 7 ,pdata 
3a61 67e28968 store 1 ,rf_clkpll_int 
3a62 70804204 jam clksel_xtal ,core_clksel 
3a63 6fe2896b fetch 1 ,rf_clkpll_frac + 2 
3a64 1fe17ecf and_into 0xcf ,pdata 
3a65 67e2896b store 1 ,rf_clkpll_frac + 2 
3a66 1fe1fe30 or_into 0x30 ,pdata 
3a67 67e2896b store 1 ,rf_clkpll_frac + 2 
3a68 20600000 rtn 

check_dpll:
3a69 200003e8 nop 1000 
3a6a 70804204 jam clksel_xtal ,core_clksel 
3a6b 2000000a nop 10 
3a6c 7080cc00 jam 0x00 ,core_bist_ctrl 
3a6d 70800680 jam ccnt_start ,core_misc_ctrl 

check_dpll_loop:
3a6e 6fe28331 fetch 1 ,core_perf_status 
3a6f c300ba6e bbit0 1 ,check_dpll_loop 
3a70 6846834b fetcht 3 ,core_ccnt_counter 
3a71 70804205 jam clksel_dpll ,core_clksel 
3a72 2000000a nop 10 
3a73 70800680 jam ccnt_start ,core_misc_ctrl 

check_dpll_loop2:
3a74 6fe28331 fetch 1 ,core_perf_status 
3a75 c300ba74 bbit0 1 ,check_dpll_loop2 
3a76 6fe6834b fetch 3 ,core_ccnt_counter 
3a77 98467e00 isub temp ,pdata 
3a78 20213a7a branch check_dpll_pos ,positive 
3a79 1fe67e00 sub pdata ,0 ,pdata 

check_dpll_pos:
3a7a 67e4014d store 2 ,mem_dpll_error 
3a7b 1fe67c46 sub pdata ,70 ,null 

check_dpll_assert:
3a7c 24213a7c nbranch check_dpll_assert ,positive 
3a7d 20600000 rtn 

xtal_fast_wake:
3a7e 58000f0f setarg 0xf0f 
3a7f 20203c92 branch lpm_write_config 

init_lpm_ctrl:
3a80 5800080f setarg 0x80f 
3a81 20203c92 branch lpm_write_config 

start_receiver:
3a82 44c74011 bpatch patch11_6 ,mem_patch11 
3a83 204039ae call rf_rx_enable 
3a84 78507c00 disable is_tx 
3a85 7830fc00 enable is_rx 
3a86 782b7c00 pulse init_encrypt 
3a87 20600000 rtn 

prep_crypt:
3a88 44c7c011 bpatch patch11_7 ,mem_patch11 
3a89 6fe2004c fetch 1 ,mem_state_map 
3a8a 2feffe02 isolate1 smap_encryption ,pdata 
3a8b 7920fe00 setflag true ,0 ,pdata 
3a8c 67e28011 store 1 ,core_encrypt 
3a8d d8c00062 arg mem_kc ,contr 
3a8e eff20006 ifetch 9 ,contr 
3a8f 98006400 iforce kc_ls 
3a90 efee0006 ifetch 7 ,contr 
3a91 98006600 iforce kc_ms 
3a92 6fe20054 fetch 1 ,mem_key_size 
3a93 1fe0e9ff add pdata ,-1 ,g1l 
3a94 782d7c00 pulse kc_p_activate 
3a95 20600000 rtn 

wait_access_clke_rt:
3a96 44c84012 bpatch patch12_0 ,mem_patch12 
3a97 7826fc00 enable decode_fec0 
3a98 d9600600 arg param_conn_access ,timeup 
3a99 35330400 correlate clke_rt ,meet 

wait_access_end:
3a9a 1b427e00 deposit clke 
3a9b 67ec00a4 store 6 ,mem_sync_clke 
3a9c 7846fc00 disable decode_fec0 
3a9d 242c3984 nbranch shutdown_radio ,sync 
3a9e dd2003bb arg param_clke_cal ,clke_rt 
3a9f 1d00d001 increase 1 ,clke_bt 
3aa0 1d0151fc and_into 0x1fc ,clke_bt 
3aa1 20600000 rtn 

wait_access_mhalfbnd:
3aa2 7826fc00 enable decode_fec0 

wait_access_mhalfbnd_correlate:
3aa3 37cb8400 correlate null ,mhalfbnd 
3aa4 202c3a9a branch wait_access_end ,sync 
3aa5 2d000402 compare 0x02 ,clke_bt ,0x02 
3aa6 2420baa3 nbranch wait_access_mhalfbnd_correlate ,true 
3aa7 20203a9a branch wait_access_end 

wait_access_clkn_rt:
3aa8 44c8c012 bpatch patch12_1 ,mem_patch12 
3aa9 d9600600 arg param_conn_access ,timeup 
3aaa 7826fc00 enable decode_fec0 
3aab 34730400 correlate clkn_rt ,meet 
3aac 7846fc00 disable decode_fec0 
3aad 242c3984 nbranch shutdown_radio ,sync 
3aae 20600000 rtn 

wait_access_forever:
3aaf 44c94012 bpatch patch12_2 ,mem_patch12 
3ab0 7826fc00 enable decode_fec0 
3ab1 37c18400 correlate null ,timeout 
3ab2 7846fc00 disable decode_fec0 
3ab3 242c3984 nbranch shutdown_radio ,sync 
3ab4 dd2003bb arg param_clke_cal ,clke_rt 
3ab5 1d0151fc and_into 0x1fc ,clke_bt 
3ab6 20600000 rtn 

reserve_slot:
3ab7 1c227e00 deposit bt_clk 
3ab8 98409600 iadd temp ,timeup 
3ab9 19627e00 copy timeup ,pdata 
3aba 67e84168 store 4 ,mem_next_btclk 
3abb 18217e0f and type ,0xf ,pdata 
3abc 20600000 rtn 

ahead_window:
3abd 1fe20400 copy pdata ,temp 
3abe 44c9c012 bpatch patch12_3 ,mem_patch12 
3abf 18427e00 copy temp ,pdata 
3ac0 20407801 call clk2bt 
3ac1 1c307e00 lshift16 bt_clk ,pdata 
3ac2 79207e2c set1 44 ,pdata 
3ac3 204077e9 call clk_diff 
3ac4 793ffe2c set0 44 ,pdata 
3ac5 20403b10 call get_clk 
3ac6 204077e9 call clk_diff 
3ac7 20740000 rtn user 
3ac8 204077f3 call clk2rt 
3ac9 98003600 iforce stop_watch 
3aca 37c18200 until null ,timeout 
3acb 20600000 rtn 

setup_clk:
3acc 44ca4012 bpatch patch12_4 ,mem_patch12 
3acd 20383ad1 branch setup_clkn ,clknt 
3ace 35330200 until clke_rt ,meet 

skip_setup_clke:
3acf 1d020400 copy clke_bt ,temp 
3ad0 20203ad4 branch setup_clknbt 

setup_clkn:
3ad1 20373ad3 branch skip_setup_clkn ,attempt 
3ad2 34730200 until clkn_rt ,meet 

skip_setup_clkn:
3ad3 1c420400 copy clkn_bt ,temp 

setup_clknbt:
3ad4 20343ae0 branch setup_clk11 ,user 
3ad5 28400601 compare 1 ,temp ,3 
3ad6 2420bacc nbranch setup_clk ,true 

setup_complete:
3ad7 44cac012 bpatch patch12_5 ,mem_patch12 
3ad8 6fe20030 fetch 1 ,mem_state 
3ad9 c4000000 rtnbit0 state_inconn 
3ada 6fe84168 fetch 4 ,mem_next_btclk 
3adb 98467e00 isub temp ,pdata 
3adc 24610000 nrtn positive 
3add 1fe67cff sub pdata ,0xff ,null 
3ade 20213acc branch setup_clk ,positive 
3adf 20600000 rtn 

setup_clk11:
3ae0 28400603 compare 3 ,temp ,3 
3ae1 2420bacc nbranch setup_clk ,true 
3ae2 20203ad7 branch setup_complete 

rf_setup_time:
3ae3 44cb4012 bpatch patch12_6 ,mem_patch12 
3ae4 d9600600 arg param_rf_setup ,timeup 
3ae5 20203acc branch setup_clk 

rf_setup_time_slave_slot:
3ae6 78547c00 disable user 
3ae7 20203ae3 branch rf_setup_time 

rf_setup_time_master_slot:
3ae8 78347c00 enable user 
3ae9 20203ae3 branch rf_setup_time 

start_transmitter:
3aea 44cbc012 bpatch patch12_7 ,mem_patch12 
3aeb 20403a88 call prep_crypt 
3aec 7850fc00 disable is_rx 
3aed 78307c00 enable is_tx 
3aee 20600000 rtn 

start_tx_native:
3aef 44cc4013 bpatch patch13_0 ,mem_patch13 
3af0 d9600e43 arg param_tx_setup ,timeup 
3af1 34730200 until clkn_rt ,meet 
3af2 782b7c00 pulse init_encrypt 
3af3 20600000 rtn 

start_rx_native:
3af4 44ccc013 bpatch patch13_1 ,mem_patch13 
3af5 d9600d00 arg param_rx_setup ,timeup 
3af6 34730200 until clkn_rt ,meet 
3af7 20600000 rtn 

start_tx_external:
3af8 44cd4013 bpatch patch13_2 ,mem_patch13 
3af9 d9600e43 arg param_tx_setup ,timeup 
3afa 35330200 until clke_rt ,meet 
3afb 782b7c00 pulse init_encrypt 
3afc 20600000 rtn 

send_access_word:
3afd 44cdc013 bpatch patch13_3 ,mem_patch13 
3afe 51207e00 preload access 
3aff 782efc00 enable encode_fec0 
3b00 79202a00 set1 txgfsk ,radio_ctrl 
3b01 08008648 inject mod ,72 
3b02 784efc00 disable encode_fec0 
3b03 20600000 rtn 

scan_mode_whiten:
3b04 1ca20400 copy xin ,temp 
3b05 18418460 or_into 0x60 ,temp 
3b06 18421c00 copy temp ,white_init 
3b07 20600000 rtn 

get_free_amaddr:
3b08 44ce4013 bpatch patch13_4 ,mem_patch13 
3b09 6fe24130 fetch 1 ,mem_current_amaddr 
3b0a 1fe0fe01 increase 1 ,pdata 
3b0b c083bb0d bne param_esco_addr ,get_free_amaddr_cont 
3b0c 18007e01 force 1 ,pdata 

get_free_amaddr_cont:
3b0d 67e24130 store 1 ,mem_current_amaddr 
3b0e 98000800 iforce am_addr 
3b0f 20600000 rtn 

get_clk:
3b10 1b220400 copy clkn ,temp 
3b11 20748000 rtn master 
3b12 1b420400 copy clke ,temp 
3b13 20600000 rtn 

get_clkbt:
3b14 1c427e00 deposit clkn_bt 
3b15 20748000 rtn master 
3b16 1d027e00 deposit clke_bt 
3b17 20600000 rtn 

supervision_update:
3b18 44cec013 bpatch patch13_5 ,mem_patch13 
3b19 6848004d fetcht 4 ,mem_supervision_timer 
3b1a 20403b14 call get_clkbt 
3b1b 98461600 isub temp ,timeup 
3b1c 19627e00 deposit timeup 
3b1d 68440051 fetcht 2 ,mem_supervision_to 
3b1e 18438400 lshift temp ,temp 
3b1f 98467e00 isub temp ,pdata 
3b20 20600000 rtn 

supervision_flush:
3b21 44cf4013 bpatch patch13_6 ,mem_patch13 
3b22 20403b14 call get_clkbt 
3b23 67e8004d store 4 ,mem_supervision_timer 
3b24 20600000 rtn 

assert:
3b25 20203b25 branch assert 

loop:
3b26 20203b26 branch loop 

sleep:
3b27 207a0000 rtn blank 
3b28 1fe37e00 rshift pdata ,pdata 
3b29 1fe0fffd increase -3 ,pdata 

sleep_loop:
3b2a 1fe0ffff increase -1 ,pdata 
3b2b 2422bb2a nbranch sleep_loop ,zero 
3b2c 18007e00 force 0 ,pdata 
3b2d 20600000 rtn 

init_param:
3b2e df200010 arg 0x10 ,loopcnt 
3b2f d8a00000 arg 0 ,contw 
3b30 2040775e call memset0 
3b31 d8a004ad arg mem_le_state ,contw 
3b32 df20000a arg 10 ,loopcnt 
3b33 2040775e call memset0 
3b34 700a2300 jam 0 ,mem_sp_calc 
3b35 700b0800 jam 0 ,mem_fifo_temp 
3b36 7004fb00 jam 0 ,mem_le_testtype 
3b37 70014a00 jam 0 ,mem_debug_config 
3b38 70053500 jam 0 ,mem_lmp_conn_state 
3b39 44cfc013 bpatch patch13_7 ,mem_patch13 
3b3a 70013800 jam 0 ,mem_connection_options 
3b3b 70011400 jam 0 ,mem_tester_emulate 
3b3c 70011f00 jam 0 ,mem_tester_cnt 
3b3d 589e8b33 setarg param_glap 
3b3e 67e64147 store 3 ,mem_glap 
3b3f 58000153 setarg param_acl_pktlen 
3b40 67e4008b store 2 ,mem_acl_pktlen 
3b41 70008d1e jam param_sco_pktlen ,mem_sco_pktlen 
3b42 70008e01 jam param_acl_pktcnt ,mem_acl_pktcnt 
3b43 70009007 jam param_sco_pktcnt ,mem_sco_pktcnt 
3b44 5812e904 setarg param_hci_version 
3b45 67e60088 store 3 ,mem_hci_version 
3b46 58050e08 setarg param_lmp_version 
3b47 67e64557 store 3 ,mem_lmp_version 
3b48 58000005 setarg param_lmp_subversion 
3b49 67e4455a store 2 ,mem_lmp_subversion 
3b4a 70009760 jam 0x60 ,mem_fhs_misc 
3b4b 70416f05 jam param_max_slot ,mem_max_slot 
3b4c 70001402 jam 0x02 ,mem_fw_ver 
3b4d 6fe246a0 fetch 1 ,mem_ssp_enable 
3b4e 245a695c ncall init_memp ,blank 
3b4f 6fe244a9 fetch 1 ,mem_le_secure_connect_enable 
3b50 245a69b3 ncall init_memp_256 ,blank 
3b51 44d04014 bpatch patch14_0 ,mem_patch14 
3b52 20758000 rtn wake 
3b53 58000000 setarg 0 
3b54 67e40099 store 2 ,mem_tx_len 
3b55 1c437e00 rshift clkn_bt ,pdata 
3b56 67e84134 store 4 ,mem_last_clkn 
3b57 20600000 rtn 

init_250k:
3b58 783b7c00 enable le 
3b59 588e89be setarg 0x8e89be 
3b5a 1fed7e00 lshift8 pdata ,pdata 
3b5b 1fe1fed6 or_into 0xd6 ,pdata 
3b5c 98001200 iforce access 
3b5d 70891407 jam 7 ,0x8914 
3b5e 70890aa0 jam 0xa0 ,0x890a 
3b5f 70890d8f jam 0x8f ,0x890d 
3b60 7089110f jam 0x0f ,0x8911 
3b61 70891287 jam 0x87 ,0x8912 
3b62 20600000 rtn 

lpmstate:
3b63 5800ee21 setarg 0xee21 
3b64 67e48050 store 2 ,core_clkoff 
3b65 6fe2833c fetch 1 ,core_lpm_ldocnt 
3b66 c301dc1e bbit0 gpio_latch ,loadcode 
3b67 7835fc00 enable wake 
3b68 c303bb6e bbit0 cold_wake ,lpmwake 
3b69 7855fc00 disable wake 
3b6a 1ce27e00 deposit auxcnt 
3b6b 243a3b6e nbranch lpmwake ,blank 
3b6c d85fffff arg param_hibernate_clks ,temp 
3b6d 20203bd2 branch lpm_enter_sleep 

lpmwake:
3b6e 6fe6833a fetch 3 ,core_lpm_xtalcnt 
3b6f 67e6804c store 3 ,core_lpm_reg 
3b70 efe20006 ifetch 1 ,contr 
3b71 1fe1febf or_into isogate_mask ,pdata 
3b72 e7e20005 istore 1 ,contw 
3b73 20403c9d call lpm_write_ctrl2 
3b74 6fe2804f fetch 1 ,core_lpm_isogate 
3b75 79207e06 set1 enable_retmem ,pdata 
3b76 67e2804f store 1 ,core_lpm_isogate 
3b77 20403c9d call lpm_write_ctrl2 
3b78 2055bb82 call lpm_load_context ,wake 
3b79 6fe2804e fetch 1 ,core_lpm_reg + 2 
3b7a 793ffe03 set0 gpio_latch ,pdata 
3b7b 67e2804e store 1 ,core_lpm_reg + 2 
3b7c 20403c9d call lpm_write_ctrl2 
3b7d 6fe401ec fetch 2 ,mem_otp_ucode_flag 
3b7e c303bb80 bbit0 otp_uflag_aes ,lpmwake_nolock 
3b7f 70800608 jam lock_otp ,core_misc_ctrl 

lpmwake_nolock:
3b80 20758000 rtn wake 
3b81 20205c1e branch loadcode 

lpm_load_context:
3b82 6fe2424b fetch 1 ,mem_saved_spidctrl 
3b83 67e280ba store 1 ,core_spid_ctrl 
3b84 d8c0421b arg mem_saved_gpio ,contr 
3b85 d8a08080 arg core_gpio_conf ,contw 
3b86 20407752 call memcpy40 
3b87 6ff04243 fetch 8 ,mem_saved_mark 
3b88 98000000 iforce mark 
3b89 6ff08342 fetch 8 ,core_gpio_wakeup_low 
3b8a 67f000ab store 8 ,mem_gpio_wakeup_low 
3b8b 20405c7e call load_ucode 
3b8c 20600000 rtn 

lpm_save_context:
3b8d 18027e00 deposit mark 
3b8e 67f04243 store 8 ,mem_saved_mark 
3b8f d8c08080 arg core_gpio_conf ,contr 
3b90 d8a0421b arg mem_saved_gpio ,contw 
3b91 20407752 call memcpy40 
3b92 6fe280ba fetch 1 ,core_spid_ctrl 
3b93 67e2424b store 1 ,mem_saved_spidctrl 
3b94 20203ca3 branch lpm_write_gpio_wakeup 

lpo_calibration:
3b95 6fe280cc fetch 1 ,core_bist_ctrl 
3b96 243a3b9b nbranch lpo_cal_inited ,blank 
3b97 6fe6420d fetch 3 ,mem_clks_per_lpo 
3b98 247a0000 nrtn blank 
3b99 7080ccc0 jam 0xc0 ,core_bist_ctrl 
3b9a 70800a80 jam ccnt_start ,core_dma_start 

lpo_cal_inited:
3b9b 6fe28331 fetch 1 ,core_perf_status 
3b9c c4008000 rtnbit0 1 
3b9d 6fe6834b fetch 3 ,core_ccnt_counter 
3b9e 67e6420d store 3 ,mem_clks_per_lpo 
3b9f 20600000 rtn 

lpm_adjust_clk:
3ba0 44d0c014 bpatch patch14_1 ,mem_patch14 
3ba1 1b427e00 deposit clke 
3ba2 204077e7 call clk_diff_rt 
3ba3 684841fd fetcht 4 ,mem_sleep_counter_all 
3ba4 18467cff sub temp ,0xff ,null 
3ba5 20610000 rtn positive 
3ba6 1fed7e00 lshift8 pdata ,pdata 
3ba7 1ff27e00 lshift4 pdata ,pdata 
3ba8 9846fc00 idiv temp 
3ba9 2040782e call wait_div_end 
3baa 1807fe00 quotient pdata 
3bab d84000c8 arg param_lpm_adjmax ,temp 
3bac 2040785f call ceiling 
3bad 67e200a3 store 1 ,mem_lpm_adjust 
3bae 24343bb0 nbranch lpm_adjust_positive ,user 
3baf 1fe67e00 sub pdata ,0 ,pdata 

lpm_adjust_positive:
3bb0 6846420d fetcht 3 ,mem_clks_per_lpo 
3bb1 9840fe00 iadd temp ,pdata 
3bb2 67e6420d store 3 ,mem_clks_per_lpo 

lpm_clear_counter:
3bb3 58000000 setarg 0 
3bb4 67e841fd store 4 ,mem_sleep_counter_all 
3bb5 20600000 rtn 

lpm_hibernate:
3bb6 44d14014 bpatch patch14_2 ,mem_patch14 
3bb7 20403ca3 call lpm_write_gpio_wakeup 
3bb8 6fe88336 fetch 4 ,core_lpm_ctrl 
3bb9 793ffe0f set0 15 ,pdata 
3bba 67e8804c store 4 ,core_lpm_reg 
3bbb 20403c9b call lpm_write_ctrl 

lpm_hibernate_normal:
3bbc d85fffff arg param_hibernate_clks ,temp 
3bbd 6fe241f6 fetch 1 ,mem_lpm_hibernate_switch 
3bbe 67e2421a store 1 ,mem_lpm_xtalcnt + 4 
3bbf 6fe24218 fetch 1 ,mem_lpm_xtalcnt + 2 
3bc0 79207e07 set1 cold_wake ,pdata 
3bc1 67e24218 store 1 ,mem_lpm_xtalcnt + 2 

lpm_sleep:
3bc2 44d1c014 bpatch patch14_3 ,mem_patch14 
3bc3 6fe841fd fetch 4 ,mem_sleep_counter_all 
3bc4 9840fe00 iadd temp ,pdata 
3bc5 67e841fd store 4 ,mem_sleep_counter_all 
3bc6 20403b8d call lpm_save_context 
3bc7 6fea4216 fetch 5 ,mem_lpm_xtalcnt 
3bc8 67e8804c store 4 ,core_lpm_reg 
3bc9 1fef2200 rshift32 pdata ,rega 
3bca 37d98200 until null ,lpo_edge 
3bcb 1b227e00 deposit clkn 
3bcc 67ec4201 store 6 ,mem_sleep_clkn 
3bcd 70800502 jam lpmreg_sel_ctrl2 ,core_lpm_wr 
3bce 37d98200 until null ,lpo_edge 
3bcf 37d98200 until null ,lpo_edge 
3bd0 6222804f storer rega ,1 ,core_lpm_isogate 
3bd1 70800502 jam lpmreg_sel_ctrl2 ,core_lpm_wr 

lpm_enter_sleep:
3bd2 37d98200 until null ,lpo_edge 
3bd3 37d98200 until null ,lpo_edge 
3bd4 6048804c storet 4 ,core_lpm_reg 
3bd5 70800510 jam lpmreg_sel_counter ,core_lpm_wr 
3bd6 37df8200 until null ,never 

lpm_recover_clk:
3bd7 44d24014 bpatch patch14_4 ,mem_patch14 
3bd8 58000000 setarg 0 
3bd9 1ce27c00 copy auxcnt ,null 
3bda 2022bbe2 branch lpm_recover_timeout ,zero 
3bdb 6fe2833a fetch 1 ,core_lpm_xtalcnt 
3bdc 6842833b fetcht 1 ,core_lpm_buckcnt 
3bdd 98467c00 isub temp ,null 
3bde 20213be0 branch lpm_recover_xtal ,positive 
3bdf 18427e00 deposit temp 

lpm_recover_xtal:
3be0 9ce67e00 isub auxcnt ,pdata 
3be1 1fe0fe01 increase 1 ,pdata 

lpm_recover_timeout:
3be2 1fe0fe08 increase 8 ,pdata 
3be3 37d98200 until null ,lpo_edge 
3be4 9e20fe00 iadd lpo_time ,pdata 
3be5 684841f9 fetcht 4 ,mem_sleep_counter 
3be6 9840fe00 iadd temp ,pdata 
3be7 6846420d fetcht 3 ,mem_clks_per_lpo 
3be8 984ffe00 imul32 temp ,pdata 
3be9 1fecfe00 rshift8 pdata ,pdata 
3bea 1ff1fe00 rshift4 pdata ,pdata 
3beb 1fe0fe6e increase param_lpm_fix ,pdata 
3bec d8400ea6 arg 3750 ,temp 
3bed 9846fc00 idiv temp 
3bee 2040782e call wait_div_end 
3bef 1807fe00 quotient pdata 
3bf0 1ff07e00 lshift16 pdata ,pdata 
3bf1 18070400 remainder temp 
3bf2 9841fe00 ior temp ,pdata 
3bf3 684c4201 fetcht 6 ,mem_sleep_clkn 
3bf4 204077dc call clk_add 
3bf5 18423200 copy temp ,clkn 
3bf6 6fec4048 fetch 6 ,mem_context + coffset_clk_offset 
3bf7 204038df call calc_clke2 
3bf8 1b427e00 deposit clke 
3bf9 67ec0122 store 6 ,mem_pdatatemp 
3bfa 1ce27e00 deposit auxcnt 
3bfb e7e20005 istore 1 ,contw 
3bfc 6fe2831d fetch 1 ,core_gpio_in1 
3bfd 1fe1fef0 or_into 0xf0 ,pdata 
3bfe e7e20005 istore 1 ,contw 
3bff 20600000 rtn 

lpm_dispatch:
3c00 44d2c014 bpatch patch14_5 ,mem_patch14 
3c01 6fe24131 fetch 1 ,mem_lpm_mode 
3c02 207a0000 rtn blank 
3c03 20404a61 call l2cap_malloc_is_fifo_empty 
3c04 247a0000 nrtn blank 
3c05 204052b0 call le_fifo_check_empty 
3c06 247a0000 nrtn blank 
3c07 20403b95 call lpo_calibration 
3c08 6fe6420d fetch 3 ,mem_clks_per_lpo 
3c09 207a0000 rtn blank 
3c0a 6fe246a0 fetch 1 ,mem_ssp_enable 
3c0b 203a3c0e branch lpm_no_ssp ,blank 
3c0c 6fe245f7 fetch 1 ,mem_sp_local_key_invalid 
3c0d 207a0000 rtn blank 

lpm_no_ssp:
3c0e 20403cb4 call lpm_check_wake_lock 
3c0f 247a0000 nrtn blank 
3c10 6fe24040 fetch 1 ,mem_context 
3c11 2fe00e03 compare 3 ,pdata ,0x7 
3c12 2420bc36 nbranch lpm_dispatch_unconn ,true 
3c13 6fe44042 fetch 2 ,mem_context + coffset_tsniff 
3c14 207a0000 rtn blank 
3c15 20758000 rtn wake 
3c16 44d34014 bpatch patch14_6 ,mem_patch14 
3c17 204047ee call ipc_check_enter_lpm 
3c18 247a0000 nrtn blank 
3c19 684200aa fetcht 1 ,mem_lpm_current_mult 
3c1a 6fe44042 fetch 2 ,mem_context + coffset_tsniff 
3c1b 984ffe00 imul32 temp ,pdata 
3c1c 18518400 rshift4 temp ,temp 
3c1d 184b0400 rshift2 temp ,temp 
3c1e 98467e00 isub temp ,pdata 
3c1f 68484044 fetcht 4 ,mem_context + coffset_sniff_anchor 
3c20 9840fe00 iadd temp ,pdata 
3c21 684241f5 fetcht 1 ,mem_lpm_overhead 
3c22 98467e00 isub temp ,pdata 
3c23 1ff06000 lshift16 pdata ,alarm 
3c24 44d3c014 bpatch patch14_7 ,mem_patch14 
3c25 6fe4404e fetch 2 ,mem_context + coffset_rx_window 
3c26 1fe37e00 rshift pdata ,pdata 
3c27 20407801 call clk2bt 
3c28 1e027e00 deposit alarm 
3c29 204077e9 call clk_diff 
3c2a 1b420400 copy clke ,temp 
3c2b 204077e7 call clk_diff_rt 
3c2c 20740000 rtn user 

lpm_dispatch_sleep:
3c2d 204077fa call clk2lpo 

lpm_dispatch_lpo:
3c2e 44d44015 bpatch patch15_0 ,mem_patch15 
3c2f 6fe24216 fetch 1 ,mem_lpm_xtalcnt 
3c30 98467c00 isub temp ,null 
3c31 20213bb3 branch lpm_clear_counter ,positive 
3c32 604841f9 storet 4 ,mem_sleep_counter 
3c33 20404180 call app_will_enter_lpm 
3c34 684841f9 fetcht 4 ,mem_sleep_counter 
3c35 20203bc2 branch lpm_sleep 

lpm_dispatch_unconn:
3c36 44d4c015 bpatch patch15_1 ,mem_patch15 
3c37 6fe24040 fetch 1 ,mem_context 
3c38 c3800000 rtnbit1 state_inconn 
3c39 c3818000 rtnbit1 state_inpage 
3c3a 6fe246a0 fetch 1 ,mem_ssp_enable 
3c3b 203a3c3e branch lpm_unconn_nossp ,blank 
3c3c 6fe245f7 fetch 1 ,mem_sp_local_key_invalid 
3c3d 207a0000 rtn blank 

lpm_unconn_nossp:
3c3e 6fe243b1 fetch 1 ,mem_le_adv_enable 
3c3f 243a3c42 nbranch lpm_unconn_cont ,blank 
3c40 6fe24133 fetch 1 ,mem_scan_mode 
3c41 207a0000 rtn blank 

lpm_unconn_cont:
3c42 6fe441f3 fetch 2 ,mem_lpm_interval 
3c43 207a0000 rtn blank 

lpm_sleep_btclk:
3c44 684241f5 fetcht 1 ,mem_lpm_overhead 
3c45 98467e00 isub temp ,pdata 
3c46 d8401d4c arg 7500 ,temp 
3c47 984ffe00 imul32 temp ,pdata 
3c48 20203c2d branch lpm_dispatch_sleep 

lpm_set_mult:
3c49 44d54015 bpatch patch15_2 ,mem_patch15 
3c4a 7855fc00 disable wake 
3c4b 6fe20030 fetch 1 ,mem_state 
3c4c c4008000 rtnbit0 state_insniff 
3c4d 2436bc62 nbranch lpm_not_match ,match 
3c4e 20403c5d call lpm_match 
3c4f 6fe44161 fetch 2 ,mem_rx_window_sniff 
3c50 67e4003e store 2 ,mem_rx_window 
3c51 6fe20047 fetch 1 ,mem_cur_arq 
3c52 c281bc70 bbit1 wack ,lpm_mult_short 
3c53 c586bc70 bmark0 mark_lpm_mult_enable ,lpm_mult_short 
3c54 20404a61 call l2cap_malloc_is_fifo_empty 
3c55 243a3c70 nbranch lpm_mult_short ,blank 

lpm_mult_wait_timeout:
3c56 7000aa00 jam 0 ,mem_lpm_current_mult 
3c57 c586bc70 bmark0 mark_lpm_mult_enable ,lpm_mult_short 
3c58 6fe24212 fetch 1 ,mem_lpm_mult_cnt 
3c59 203a3c74 branch lpm_mult_long ,blank 
3c5a 1fe0ffff increase -1 ,pdata 
3c5b 67e24212 store 1 ,mem_lpm_mult_cnt 
3c5c 20600000 rtn 

lpm_match:
3c5d 7041f700 jam 0 ,mem_sniff_unint_lost 
3c5e 6fe64207 fetch 3 ,mem_sniff_rcv 
3c5f 1fe0fe01 increase 1 ,pdata 
3c60 67e64207 store 3 ,mem_sniff_rcv 
3c61 20600000 rtn 

lpm_not_match:
3c62 44d5c015 bpatch patch15_3 ,mem_patch15 
3c63 68444161 fetcht 2 ,mem_rx_window_sniff 
3c64 18430400 rshift temp ,temp 
3c65 6fe4003e fetch 2 ,mem_rx_window 
3c66 9840fe00 iadd temp ,pdata 
3c67 67e4003e store 2 ,mem_rx_window 

lpm_lost:
3c68 7000aa00 jam 0 ,mem_lpm_current_mult 
3c69 6fe6420a fetch 3 ,mem_sniff_lost 
3c6a 1fe0fe01 increase 1 ,pdata 
3c6b 67e6420a store 3 ,mem_sniff_lost 
3c6c 6fe241f7 fetch 1 ,mem_sniff_unint_lost 
3c6d 1fe0fe01 increase 1 ,pdata 
3c6e 67e241f7 store 1 ,mem_sniff_unint_lost 
3c6f 20600000 rtn 

lpm_mult_short:
3c70 7000aa00 jam 0 ,mem_lpm_current_mult 
3c71 6fe24211 fetch 1 ,mem_lpm_mult_timeout 
3c72 67e24212 store 1 ,mem_lpm_mult_cnt 
3c73 20600000 rtn 

lpm_mult_long:
3c74 68424210 fetcht 1 ,mem_lpm_mult 
3c75 604200aa storet 1 ,mem_lpm_current_mult 
3c76 20600000 rtn 

lpm_cal_xtal_startup:
3c77 44d64015 bpatch patch15_4 ,mem_patch15 
3c78 6fe24216 fetch 1 ,mem_lpm_xtalcnt 
3c79 247a0000 nrtn blank 
3c7a 70804206 jam clksel_rc ,core_clksel 
3c7b 20403a7e call xtal_fast_wake 
3c7c 580003e8 setarg 1000 
3c7d 9e20e000 iadd lpo_time ,alarm 
3c7e 07e00000 snooze 
3c7f 1e227e00 deposit lpo_time 
3c80 20002ee0 nop 12000 
3c81 20002ee0 nop 12000 
3c82 20002ee0 nop 12000 
3c83 20002ee0 nop 12000 
3c84 20002ee0 nop 12000 
3c85 20002ee0 nop 12000 
3c86 20002ee0 nop 12000 
3c87 20002ee0 nop 12000 
3c88 20002ee0 nop 12000 
3c89 9e067e00 isub alarm ,pdata 
3c8a 1fe0fe30 add pdata ,0x30 ,pdata 
3c8b d84000ff arg 0xff ,temp 
3c8c 2040785f call ceiling 
3c8d 67e24216 store 1 ,mem_lpm_xtalcnt 
3c8e 20007530 nop 30000 
3c8f 20007530 nop 30000 
3c90 20007530 nop 30000 
3c91 20600000 rtn 

lpm_write_config:
3c92 d8a00fff arg 0xfff ,contw 
3c93 98a10a00 iand contw ,contw 
3c94 6fe24213 fetch 1 ,mem_lpm_config 
3c95 1fe17ef0 and_into 0xf0 ,pdata 
3c96 1fed7e00 lshift8 pdata ,pdata 
3c97 98a1fe00 ior contw ,pdata 
3c98 67e4804c store 2 ,core_lpm_reg 
3c99 efe40006 ifetch 2 ,contr 
3c9a e7e40005 istore 2 ,contw 

lpm_write_ctrl:
3c9b 58000001 setarg lpmreg_sel_ctrl 
3c9c 20203c9e branch lpm_write 

lpm_write_ctrl2:
3c9d 58000002 setarg lpmreg_sel_ctrl2 

lpm_write:
3c9e 37d98200 until null ,lpo_edge 
3c9f 67e28005 store 1 ,core_lpm_wr 
3ca0 37d98200 until null ,lpo_edge 
3ca1 37d98200 until null ,lpo_edge 
3ca2 20600000 rtn 

lpm_write_gpio_wakeup:
3ca3 44d6c015 bpatch patch15_5 ,mem_patch15 
3ca4 6fe800ab fetch 4 ,mem_gpio_wakeup_low 
3ca5 67e8804c store 4 ,core_lpm_reg 
3ca6 58000004 setarg lpmreg_sel_gpiolow 
3ca7 20403c9e call lpm_write 
3ca8 6fe800af fetch 4 ,mem_gpio_wakeup_high 
3ca9 67e8804c store 4 ,core_lpm_reg 
3caa 58000008 setarg lpmreg_sel_gpiohigh 
3cab 20203c9e branch lpm_write 

lpm_get_wake_lock:
3cac 6fe441f1 fetch 2 ,mem_lpm_wake_lock 
3cad f9207e00 qset1 pdata 
3cae 67e441f1 store 2 ,mem_lpm_wake_lock 
3caf 20600000 rtn 

lpm_put_wake_lock:
3cb0 6fe441f1 fetch 2 ,mem_lpm_wake_lock 
3cb1 f93ffe00 qset0 pdata 
3cb2 67e441f1 store 2 ,mem_lpm_wake_lock 
3cb3 20600000 rtn 

lpm_check_wake_lock:
3cb4 44d74015 bpatch patch15_6 ,mem_patch15 
3cb5 2040417e call app_check_wake_lock 
3cb6 6fe441f1 fetch 2 ,mem_lpm_wake_lock 
3cb7 1fe22200 copy pdata ,rega 
3cb8 6fe2004c fetch 1 ,mem_state_map 
3cb9 2feffe06 isolate1 smap_rxlmp ,pdata 
3cba 7920a20b setflag true ,wake_lock_lmp_rx ,rega 
3cbb 6fe20078 fetch 1 ,mem_lmo_opcode1 
3cbc 6842007c fetcht 1 ,mem_lmo_opcode2 
3cbd 9840fe00 iadd temp ,pdata 
3cbe 68420048 fetcht 1 ,mem_lmp_to_send 
3cbf 9840fe00 iadd temp ,pdata 
3cc0 7d3a220a nsetflag blank ,wake_lock_lmp_tx ,rega 
3cc1 44d7c015 bpatch patch15_7 ,mem_patch15 
3cc2 6fe40309 fetch 2 ,mem_l2cap_rxbuff1_len 
3cc3 6844030b fetcht 2 ,mem_l2cap_rxbuff2_len 
3cc4 9840fe00 iadd temp ,pdata 
3cc5 7d3a220d nsetflag blank ,wake_lock_l2cap_rx ,rega 
3cc6 6fea46af fetch 5 ,mem_ipc_fifo_bt2c51 
3cc7 7d3a220f nsetflag blank ,wake_lock_ipc_bt2c51 ,rega 
3cc8 6fea46b4 fetch 5 ,mem_ipc_fifo_c512bt 
3cc9 7d3a220e nsetflag blank ,wake_lock_ipc_c512bt ,rega 
3cca 6fe24284 fetch 1 ,mem_hci_cmd 
3ccb 7d3a2208 nsetflag blank ,wake_lock_cmd ,rega 
3ccc 6fe24132 fetch 1 ,mem_device_option 
3ccd 2fe1fe0a compare dvc_op_module ,pdata ,0xff 
3cce 2040bcd6 call lpm_uart_wake_lock ,true 
3ccf 44d84016 bpatch patch16_0 ,mem_patch16 
3cd0 6fe24132 fetch 1 ,mem_device_option 
3cd1 c080bcdb bne dvc_op_hci ,lpm_check_wake_lock_nothci 
3cd2 20403cd6 call lpm_uart_wake_lock 
3cd3 6fe24270 fetch 1 ,mem_link_key_exists 
3cd4 793a2203 setflag blank ,wake_link_key_exists ,rega 
3cd5 20203cdd branch lpm_check_wake_lock_end 

lpm_uart_wake_lock:
3cd6 6fe48312 fetch 2 ,core_uart_rx_items 
3cd7 7d3a2206 nsetflag blank ,wake_lock_uart_rx ,rega 
3cd8 6fe4830e fetch 2 ,core_uart_tx_items 
3cd9 7d3a2205 nsetflag blank ,wake_lock_uart_tx ,rega 
3cda 20600000 rtn 

lpm_check_wake_lock_nothci:
3cdb 5ffffff8 setarg -8 
3cdc 9a212200 iand rega ,rega 

lpm_check_wake_lock_end:
3cdd 1a227e00 copy rega ,pdata 
3cde 67e441f1 store 2 ,mem_lpm_wake_lock 
3cdf 207a0000 rtn blank 
3ce0 20768000 rtn match 
3ce1 7835fc00 enable wake 
3ce2 20600000 rtn 

lpm_shut_down:
3ce3 6fe88336 fetch 4 ,core_lpm_ctrl 
3ce4 793ffe1b set0 27 ,pdata 
3ce5 67e8804c store 4 ,core_lpm_reg 
3ce6 20403c9b call lpm_write_ctrl 
3ce7 20203b25 branch assert 

lpm_enable_exen_output:
3ce8 6fe8833a fetch 4 ,core_lpm_xtalcnt 
3ce9 79207e14 set1 20 ,pdata 
3cea 67e8804c store 4 ,core_lpm_reg 
3ceb 20203c9d branch lpm_write_ctrl2 

lpm_disable_exen_output:
3cec 6fe8833a fetch 4 ,core_lpm_xtalcnt 
3ced 793ffe14 set0 20 ,pdata 
3cee 67e8804c store 4 ,core_lpm_reg 
3cef 20203c9d branch lpm_write_ctrl2 

check_bt_disabled:
3cf0 6fe441ef fetch 2 ,mem_chip_functions 
3cf1 c2803b25 bbit1 bt_disabled ,assert 
3cf2 20600000 rtn 

check_ble_disabled:
3cf3 6fe441ef fetch 2 ,mem_chip_functions 
3cf4 c280bb25 bbit1 ble_disabled ,assert 
3cf5 20600000 rtn 

check_module_disabled:
3cf6 6fe441ef fetch 2 ,mem_chip_functions 
3cf7 c2813b25 bbit1 module_disable ,assert 
3cf8 20600000 rtn 

test_init:
3cf9 58003d02 setarg test_proc 
3cfa 67e442c1 store 2 ,mem_cb_bt_process 
3cfb 58003d08 setarg test_sleep 
3cfc 67e442c5 store 2 ,mem_cb_bb_event_process 
3cfd 58003d02 setarg test_proc 
3cfe 67e442c3 store 2 ,mem_cb_idle_process 
3cff 20758000 rtn wake 
3d00 7046b901 jam ui_led_start ,mem_led_switch 
3d01 20600000 rtn 

test_proc:
3d02 6fe20030 fetch 1 ,mem_state 
3d03 c300d7b9 bbit0 state_insniff ,check_test_cond 
3d04 7920000d set1 mark_lpm_mult_enable ,mark 
3d05 6fec4207 fetch 6 ,mem_sniff_rcv 
3d06 67ec455d store 6 ,mem_local_name 
3d07 202071a2 branch ui_led_blink_stop 

test_sleep:
3d08 1a627e00 deposit regc 
3d09 c1880000 rtnne bt_evt_button_long_pressed 

test_sleep_loop:
3d0a 20407177 call ui_button_polling 
3d0b 6fe246bb fetch 1 ,mem_ui_button_last_state 
3d0c c000bd0a beq 1 ,test_sleep_loop 
3d0d 204071a6 call ui_led_off 
3d0e 20203bb6 branch lpm_hibernate 

test_tx:
3d0f 18000402 force 2 ,temp 
3d10 184085fe increase -2 ,temp 
3d11 204039a2 call set_sync_on 
3d12 204039b7 call set_freq_tx 
3d13 7843fc00 disable enable_white 
3d14 782efc00 enable encode_fec0 
3d15 79202a00 set1 txgfsk ,radio_ctrl 
3d16 20403aea call start_transmitter 

test_tx_loop:
3d17 6fe20000 fetch 1 ,0 
3d18 08008608 inject mod ,8 
3d19 20203d17 branch test_tx_loop 

check_amaddr_is_esco:
3d1a 6fe2430a fetch 1 ,mem_esco_amaddr 
3d1b a881fe00 icompare 0xff ,am_addr 
3d1c 20600000 rtn 

load_context_to_acl:
3d1d c6838000 rtnmark0 mark_esco 

load_context_to_acl_no_mark:
3d1e 20403d1a call check_amaddr_is_esco 
3d1f 24608000 nrtn true 

load_to_acl:
3d20 204036f0 call clear_got_tx 
3d21 6fe20047 fetch 1 ,mem_cur_arq 
3d22 67e2430b store 1 ,mem_esco_arq 
3d23 6fe2430c fetch 1 ,mem_acl_arq 
3d24 67e20047 store 1 ,mem_cur_arq 
3d25 6fe24309 fetch 1 ,mem_acl_amaddr 
3d26 98000800 iforce am_addr 
3d27 6fe24165 fetch 1 ,mem_last_type 
3d28 67e2430d store 1 ,mem_last_type_esco 
3d29 6fe2430e fetch 1 ,mem_last_type_acl 
3d2a 67e24165 store 1 ,mem_last_type 
3d2b 5800ffff setarg 0xffff 
3d2c 67e44166 store 2 ,mem_retransmission_cnt 
3d2d 79200008 set1 mark_esco_rxok ,mark 
3d2e 20600000 rtn 

load_context_to_esco:
3d2f c6838000 rtnmark0 mark_esco 
3d30 c6958000 rtnmark0 mark_sco_flag 
3d31 c6960000 rtnmark0 mark_enter_sco_sniff 

load_context_to_esco0:
3d32 6fe20047 fetch 1 ,mem_cur_arq 
3d33 67e2430c store 1 ,mem_acl_arq 
3d34 6fe2430b fetch 1 ,mem_esco_arq 
3d35 67e20047 store 1 ,mem_cur_arq 
3d36 18827e00 deposit am_addr 
3d37 67e24309 store 1 ,mem_acl_amaddr 
3d38 6fe2430a fetch 1 ,mem_esco_amaddr 
3d39 98000800 iforce am_addr 
3d3a 793f8008 set0 mark_esco_rxok ,mark 
3d3b 6fe24165 fetch 1 ,mem_last_type 
3d3c 67e2430e store 1 ,mem_last_type_acl 
3d3d 6fe2430d fetch 1 ,mem_last_type_esco 
3d3e 67e24165 store 1 ,mem_last_type 
3d3f 70030800 jam 0 ,mem_sco_flag 
3d40 20600000 rtn 

g24_dispatch:
3d41 44d8c016 bpatch patch16_1 ,mem_patch16 
3d42 6fe24b75 fetch 1 ,mem_24g_exit_flag 
3d43 207a0000 rtn blank 
3d44 704b7601 jam 1 ,mem_24g_tx_flag 
3d45 6fe24b73 fetch 1 ,mem_24g_fast_tx 
3d46 243a3d54 nbranch g24_dispatch_fast_tx ,blank 
3d47 68484b8a fetcht 4 ,mem_24g_tx_btclk 
3d48 1c427e00 copy clkn_bt ,pdata 
3d49 98467c00 isub temp ,null 
3d4a 24413d5a ncall g24_timer_timeout ,positive 
3d4b 1fe22400 copy pdata ,regb 
3d4c 6fe84b8a fetch 4 ,mem_24g_tx_btclk 
3d4d 68424b8e fetcht 1 ,mem_24g_interval 
3d4e 98408400 iadd temp ,temp 
3d4f 1a427e00 copy regb ,pdata 
3d50 98467c00 isub temp ,null 
3d51 24213d41 nbranch g24_dispatch ,positive 
3d52 793ffe1c set0 28 ,pdata 
3d53 67e84b8a store 4 ,mem_24g_tx_btclk 

g24_dispatch_fast_tx:
3d54 704b7300 jam 0 ,mem_24g_fast_tx 
3d55 20403d5d call g24_prepare_data 
3d56 24343e22 nbranch g24_enter_lpm ,user 

g24_tx_dispatch:
3d57 20403daa call g24_tx_data 

g24_exit_dispatch:
3d58 704b7600 jam 0 ,mem_24g_tx_flag 
3d59 20600000 rtn 

g24_timer_timeout:
3d5a 20628000 rtn zero 
3d5b 79207e1c set1 28 ,pdata 
3d5c 20600000 rtn 

g24_prepare_data:
3d5d 44d94016 bpatch patch16_2 ,mem_patch16 
3d5e 6fe24b70 fetch 1 ,mem_24g_ensure 
3d5f c000f903 beq ensure_on_24g ,enable_user 
3d60 6fe24ba0 fetch 1 ,mem_24g_pairing_sm 
3d61 c0ffbde7 bne state_24g_pairing_success ,g24_pairing_sm 
3d62 20403d66 call g24_package_data 
3d63 24740000 nrtn user 

g24_enable_tx_retry:
3d64 704b7001 jam ensure_on_24g ,mem_24g_ensure 
3d65 20600000 rtn 

g24_package_data:
3d66 20403d97 call g24_queue_get 
3d67 24740000 nrtn user 
3d68 704bab00 jam 0 ,mem_24g_abort_flag 
3d69 e842003f ifetcht 1 ,pdata 
3d6a 60424bed storet 1 ,mem_24g_pac_len 
3d6b 18427200 copy temp ,loopcnt 
3d6c 1fe0fe01 increase 1 ,pdata 
3d6d 1fe20c00 copy pdata ,contr 
3d6e d8a04bad arg mem_24g_common_temp ,contw 
3d6f 2040779f call memcpy 
3d70 da204bad arg mem_24g_common_temp ,rega 
3d71 68424bed fetcht 1 ,mem_24g_pac_len 
3d72 20203d73 branch g24_put_data_in_buff 

g24_put_data_in_buff:
3d73 6fe24b76 fetch 1 ,mem_24g_tx_flag 
3d74 207a0000 rtn blank 
3d75 60424b20 storet 1 ,mem_24g_datalen 
3d76 18427200 copy temp ,loopcnt 
3d77 d8a04b22 arg mem_24g_txdata ,contw 
3d78 1a220c00 copy rega ,contr 
3d79 2020779f branch memcpy 

g24_queue_init:
3d7a 704bee00 jam 0 ,mem_queue_ele_num 
3d7b 58004bf3 setarg mem_queue_start 
3d7c 67e44bef store 2 ,mem_queue_read 
3d7d 67e44bf1 store 2 ,mem_queue_write 
3d7e 20600000 rtn 

g24_queue_clear:
3d7f 20203d7a branch g24_queue_init 

g24_queue_put:
3d80 78547c00 disable user 
3d81 6fe24bee fetch 1 ,mem_queue_ele_num 
3d82 2fe1fe03 compare queue_ele_count ,pdata ,0xff 
3d83 20608000 rtn true 
3d84 78347c00 enable user 
3d85 6fe44bf1 fetch 2 ,mem_queue_write 
3d86 1fe20a00 copy pdata ,contw 
3d87 18420c00 copy temp ,contr 
3d88 2040779f call memcpy 
3d89 6fe24bee fetch 1 ,mem_queue_ele_num 
3d8a 1fe0fe01 increase 1 ,pdata 
3d8b 67e24bee store 1 ,mem_queue_ele_num 
3d8c 58004bf1 setarg mem_queue_write 
3d8d 20203d8e branch g24_queue_increase 

g24_queue_increase:
3d8e 1fe22200 copy pdata ,rega 
3d8f d8404c53 arg mem_queue_end ,temp 
3d90 efe40011 ifetch 2 ,rega 
3d91 1fe0fe20 increase queue_ele_length ,pdata 
3d92 98467c00 isub temp ,null 
3d93 24213d95 nbranch g24_queue_put_end ,positive 
3d94 58004bf3 setarg mem_queue_start 

g24_queue_put_end:
3d95 e7e40011 istore 2 ,rega 
3d96 20600000 rtn 

g24_queue_get:
3d97 78547c00 disable user 
3d98 6fe24bee fetch 1 ,mem_queue_ele_num 
3d99 207a0000 rtn blank 
3d9a 78347c00 enable user 
3d9b 6fe24bee fetch 1 ,mem_queue_ele_num 
3d9c 1fe0ffff increase -1 ,pdata 
3d9d 67e24bee store 1 ,mem_queue_ele_num 
3d9e 6fe44bef fetch 2 ,mem_queue_read 
3d9f 67e44c53 store 2 ,mem_queue_temp 
3da0 58004bef setarg mem_queue_read 
3da1 20403d8e call g24_queue_increase 
3da2 6fe44c53 fetch 2 ,mem_queue_temp 
3da3 20600000 rtn 

g24_queue_read_point:
3da4 78547c00 disable user 
3da5 6fe24bee fetch 1 ,mem_queue_ele_num 
3da6 207a0000 rtn blank 
3da7 78347c00 enable user 
3da8 6fe44bef fetch 2 ,mem_queue_read 
3da9 20600000 rtn 

g24_tx_data:
3daa 44d9c016 bpatch patch16_3 ,mem_patch16 
3dab 704ba10a jam 10 ,mem_24g_enter_lpm_timer 
3dac 20403ed6 call g24_prepare_tx 
3dad 704b7700 jam 0 ,mem_24g_retry 

g24_tx_data_loop:
3dae 20403dbc call g24_tx_and_receive_ack 
3daf 242c3dc0 nbranch g24_tx_data_retry ,sync 
3db0 20403e9a call g24_check_rx_data 
3db1 20343dc0 branch g24_tx_data_retry ,user 

g24_tx_next_data:
3db2 6fe24ba0 fetch 1 ,mem_24g_pairing_sm 
3db3 c0ffbdfc bne state_24g_pairing_success ,g24_paring_mode 
3db4 6fe24b1f fetch 1 ,mem_24g_pid 
3db5 1fe0fe01 increase 1 ,pdata 
3db6 67e24b1f store 1 ,mem_24g_pid 

g24_tx_abandon:
3db7 58000000 setarg 0 
3db8 67e24b71 store 1 ,mem_24g_txfail_cnt 
3db9 67e24b74 store 1 ,mem_24g_fast_hop 
3dba 704b7000 jam ensure_off_24g ,mem_24g_ensure 
3dbb 20203dd5 branch g24_max_interval 

g24_tx_and_receive_ack:
3dbc 20403e36 call g24_set_freq_tx 
3dbd 20403e39 call g24_tx 
3dbe 20403e4a call g24_rx 
3dbf 20203984 branch shutdown_radio 

g24_tx_data_retry:
3dc0 44da4016 bpatch patch16_4 ,mem_patch16 
3dc1 6fe24b72 fetch 1 ,mem_24g_get_ack_fail 
3dc2 1fe0fe01 increase 1 ,pdata 
3dc3 67e24b72 store 1 ,mem_24g_get_ack_fail 
3dc4 6fe24ba0 fetch 1 ,mem_24g_pairing_sm 
3dc5 c0ffbdda bne state_24g_pairing_success ,g24_tx_paring_retry 
3dc6 6fe24b74 fetch 1 ,mem_24g_fast_hop 
3dc7 245a3f0a ncall g24_ch ,blank 
3dc8 6fe24b77 fetch 1 ,mem_24g_retry 
3dc9 1fe0fe01 increase 1 ,pdata 
3dca 67e24b77 store 1 ,mem_24g_retry 
3dcb 200001f4 nop 500 
3dcc c081bdae bne retry_24g ,g24_tx_data_loop 
3dcd 6fe24b71 fetch 1 ,mem_24g_txfail_cnt 
3dce 1fe0fe01 increase 1 ,pdata 
3dcf 67e24b71 store 1 ,mem_24g_txfail_cnt 
3dd0 c0103db7 beq 0x20 ,g24_tx_abandon 
3dd1 6fe24b74 fetch 1 ,mem_24g_fast_hop 
3dd2 205a3f0a call g24_ch ,blank 
3dd3 704b7401 jam 1 ,mem_24g_fast_hop 
3dd4 20203dd7 branch g24_min_interval 

g24_max_interval:
3dd5 6fe24b90 fetch 1 ,mem_24g_interval_max 
3dd6 20203dd8 branch g24_updata_interval 

g24_min_interval:
3dd7 6fe24b8f fetch 1 ,mem_24g_interval_min 

g24_updata_interval:
3dd8 67e24b8e store 1 ,mem_24g_interval 
3dd9 20600000 rtn 

g24_tx_paring_retry:
3dda 6fe24b72 fetch 1 ,mem_24g_get_ack_fail 
3ddb c07fbddd beq 0xff ,g24_dongle_no_exit 
3ddc 20203dd7 branch g24_min_interval 

g24_dongle_no_exit:
3ddd 44dac016 bpatch patch16_5 ,mem_patch16 
3dde 704b7200 jam 0 ,mem_24g_get_ack_fail 
3ddf 704ba001 jam state_24g_pairing_1 ,mem_24g_pairing_sm 
3de0 20203e26 branch g24_lpm_long_sleep 

g24_start_pairing_sm1:
3de1 20403f03 call g24_init 
3de2 704b7501 jam 1 ,mem_24g_exit_flag 
3de3 6fec4b98 fetch 6 ,mem_24g_paring_addr 
3de4 67ec4b92 store 6 ,mem_24g_addr 

g24_set_pairing_sm_1:
3de5 704ba001 jam state_24g_pairing_1 ,mem_24g_pairing_sm 
3de6 20600000 rtn 

g24_pairing_sm:
3de7 c000bdeb beq state_24g_pairing_1 ,g24_pairing_sm_1 
3de8 c0013dee beq state_24g_pairing_2 ,g24_pairing_sm_2 
3de9 c001bdf1 beq state_24g_pairing_3 ,g24_pairing_sm_3 
3dea 20203b25 branch assert 

g24_pairing_sm_1:
3deb 704ba011 jam state_24g_pairing_1_waiting_ack ,mem_24g_pairing_sm 
3dec 704badaa jam 0xaa ,mem_24g_common_temp 
3ded 20203df3 branch g24_pairing_sm_common 

g24_pairing_sm_2:
3dee 704ba012 jam state_24g_pairing_2_waiting_ack ,mem_24g_pairing_sm 
3def 704bad55 jam 0x55 ,mem_24g_common_temp 
3df0 20203df3 branch g24_pairing_sm_common 

g24_pairing_sm_3:
3df1 704ba013 jam state_24g_pairing_3_waiting_ack ,mem_24g_pairing_sm 
3df2 704bad22 jam 0x22 ,mem_24g_common_temp 

g24_pairing_sm_common:
3df3 704bae01 jam 1 ,mem_24g_common_temp + 1 
3df4 6fe84140 fetch 4 ,mem_lap 
3df5 67e84baf store 4 ,mem_24g_common_temp + 2 

g24_put_pairing_data_in_buff:
3df6 704bb300 jam 0 ,mem_24g_common_temp + 6 
3df7 da204bad arg mem_24g_common_temp ,rega 
3df8 d8400007 arg 7 ,temp 
3df9 20403d73 call g24_put_data_in_buff 
3dfa 20407903 call enable_user 
3dfb 20203d64 branch g24_enable_tx_retry 

g24_paring_mode:
3dfc 44db4016 bpatch patch16_6 ,mem_patch16 
3dfd 6fe24ba0 fetch 1 ,mem_24g_pairing_sm 
3dfe c17f8000 rtneq state_24g_pairing_success 
3dff c008be03 beq state_24g_pairing_1_waiting_ack ,g24_pairing_sm_1_waiting_ack 
3e00 c0093e05 beq state_24g_pairing_2_waiting_ack ,g24_pairing_sm_2_waiting_ack 
3e01 c009be07 beq state_24g_pairing_3_waiting_ack ,g24_pairing_sm_3_waiting_ack 
3e02 20600000 rtn 

g24_pairing_sm_1_waiting_ack:
3e03 704ba002 jam state_24g_pairing_2 ,mem_24g_pairing_sm 
3e04 20203db7 branch g24_tx_abandon 

g24_pairing_sm_2_waiting_ack:
3e05 704ba003 jam state_24g_pairing_3 ,mem_24g_pairing_sm 
3e06 20203db7 branch g24_tx_abandon 

g24_pairing_sm_3_waiting_ack:
3e07 704ba0ff jam state_24g_pairing_success ,mem_24g_pairing_sm 
3e08 700b083a jam bt_evt_24g_pairing_complete ,mem_fifo_temp 
3e09 204071ee call ui_ipc_send_event 
3e0a d8400008 arg 8 ,temp 
3e0b da204bcd arg mem_24g_payload_rxbuf ,rega 
3e0c da400070 arg g24_dongle_addr ,regb 
3e0d 20405d58 call iicd_write_eep_data 
3e0e 58002ee0 setarg 12000 
3e0f 20403b27 call sleep 
3e10 6fec4bcf fetch 6 ,mem_24g_payload_rxbuf + 2 
3e11 67ec4b92 store 6 ,mem_24g_addr 
3e12 704b9e00 jam 0 ,mem_24g_pairing_flag 
3e13 704b9f01 jam 1 ,mem_24g_pairing_timer_flag 
3e14 20203db7 branch g24_tx_abandon 

g24_send_abort_packet:
3e15 704bab01 jam 1 ,mem_24g_abort_flag 
3e16 6fe24b21 fetch 1 ,mem_24g_data_type 
3e17 1fe1fe10 or_into abort_data ,pdata 
3e18 67e24bad store 1 ,mem_24g_common_temp 
3e19 6fe24bac fetch 1 ,mem_24g_data_pid 
3e1a 67e24bb5 store 1 ,mem_24g_common_temp + 8 
3e1b 1fe0fe01 increase 1 ,pdata 
3e1c 67e24bac store 1 ,mem_24g_data_pid 
3e1d d8400009 arg 9 ,temp 
3e1e da204bad arg mem_24g_common_temp ,rega 
3e1f 20403d73 call g24_put_data_in_buff 
3e20 20403d64 call g24_enable_tx_retry 
3e21 20203d57 branch g24_tx_dispatch 

g24_enter_lpm:
3e22 44dbc016 bpatch patch16_7 ,mem_patch16 
3e23 6fe24bab fetch 1 ,mem_24g_abort_flag 
3e24 203a3e15 branch g24_send_abort_packet ,blank 
3e25 20203e26 branch g24_lpm_long_sleep 

g24_lpm_long_sleep:
3e26 20403b95 call lpo_calibration 
3e27 6fe6420d fetch 3 ,mem_clks_per_lpo 
3e28 207a0000 rtn blank 
3e29 44dc4017 bpatch patch17_0 ,mem_patch17 
3e2a 6ff04ba3 fetch 8 ,mem_24g_enter_hibernate 
3e2b 204077fa call clk2lpo 
3e2c 604841f9 storet 4 ,mem_sleep_counter 
3e2d 6fe24ba2 fetch 1 ,mem_24g_enter_hibernate_flag 
3e2e c000be31 beq 1 ,g24_lpm_enter_hibernate 
3e2f 704ba201 jam 1 ,mem_24g_enter_hibernate_flag 
3e30 20203bc2 branch lpm_sleep 

g24_lpm_enter_hibernate:
3e31 1ce27e00 deposit auxcnt 
3e32 203a3e35 branch g24_lpm_enter_hibernate2 ,blank 
3e33 704ba200 jam 0 ,mem_24g_enter_hibernate_flag 
3e34 20203bc2 branch lpm_sleep 

g24_lpm_enter_hibernate2:
3e35 2020727a branch check_51cmd_hibernate 

g24_set_freq_tx:
3e36 204039a2 call set_sync_on 
3e37 68424b78 fetcht 1 ,mem_24g_ch 
3e38 202039b7 branch set_freq_tx 

g24_tx:
3e39 79202a00 set1 txgfsk ,radio_ctrl 
3e3a 7846fc00 disable decode_fec0 
3e3b 782efc00 enable encode_fec0 
3e3c 78307c00 enable is_tx 
3e3d 7850fc00 disable is_rx 
3e3e 7843fc00 disable enable_white 
3e3f 20404e5b call le_enable 
3e40 6fe24b42 fetch 1 ,mem_24g_txlen 
3e41 1fe27200 copy pdata ,loopcnt 
3e42 da204b43 arg mem_24g_txpayload ,rega 

g24_tx_loop:
3e43 efe20011 ifetch 1 ,rega 
3e44 08008608 inject mod ,8 
3e45 1a20a201 increase 1 ,rega 
3e46 c2003e43 loop g24_tx_loop 
3e47 37d38200 until null ,tx_clear 
3e48 20000064 nop 100 
3e49 20600000 rtn 

g24_rx:
3e4a 18002a00 force 0 ,radio_ctrl 
3e4b 68424b78 fetcht 1 ,mem_24g_ch 
3e4c 20403f06 call g24_set_freq_rx 
3e4d 204039ae call rf_rx_enable 
3e4e 784efc00 disable encode_fec0 
3e4f 7826fc00 enable decode_fec0 
3e50 7830fc00 enable is_rx 
3e51 78507c00 disable is_tx 
3e52 7843fc00 disable enable_white 
3e53 20404e5b call le_enable 
3e54 6fe84b92 fetch 4 ,mem_24g_addr 
3e55 98001200 iforce access 
3e56 78287c00 enable swfine 
3e57 6fe44b6e fetch 2 ,mem_24g_rx_window 
3e58 98003600 iforce stop_watch 
3e59 37c18400 correlate null ,timeout 

g24_rx_sync:
3e5a 44dcc017 bpatch patch17_1 ,mem_patch17 
3e5b 242c3e64 nbranch g24_rssi_noise ,sync 
3e5c 20403e7f call g24_rssi_signal 
3e5d df200024 arg 0x24 ,loopcnt 
3e5e d8a04ad0 arg mem_24g_rxbuf ,contw 

g24_rx_loop:
3e5f 09800008 parse demod ,bucket ,8 
3e60 19897e00 rshift3 pwindow ,pdata 
3e61 e7e20005 istore 1 ,contw 
3e62 c2003e5f loop g24_rx_loop 
3e63 20600000 rtn 

g24_rssi_noise:
3e64 20403a37 call save_rssi 
3e65 203a3984 branch shutdown_radio ,blank 
3e66 98002200 iforce rega 
3e67 6fe24b79 fetch 1 ,mem_24g_current_ch_number 
3e68 1fe9a400 lshift3 pdata ,regb 
3e69 58004ca6 setarg mem_rssi_noise_buf 
3e6a 9a408c00 iadd regb ,contr 
3e6b eff00006 ifetch 8 ,contr 
3e6c 1fec8400 rshift8 pdata ,temp 
3e6d 58004ca6 setarg mem_rssi_noise_buf 
3e6e 9a408a00 iadd regb ,contw 
3e6f e04e0005 istoret 7 ,contw 
3e70 1a227e00 deposit rega 
3e71 e7e20005 istore 1 ,contw 
3e72 20203984 branch shutdown_radio 

g24_rssi_noise_avg:
3e73 d8400000 arg 0 ,temp 
3e74 df200008 arg 8 ,loopcnt 
3e75 6fe24b79 fetch 1 ,mem_24g_current_ch_number 
3e76 1fe9a400 lshift3 pdata ,regb 
3e77 58004ca6 setarg mem_rssi_noise_buf 
3e78 9a408c00 iadd regb ,contr 

g24_rssi_noise_avg_loop:
3e79 efe20006 ifetch 1 ,contr 
3e7a 98408400 iadd temp ,temp 
3e7b c2003e79 loop g24_rssi_noise_avg_loop 
3e7c 18497e00 rshift3 temp ,pdata 
3e7d 67e24ce6 store 1 ,mem_rssi_noise_avg 
3e7e 20600000 rtn 

g24_rssi_signal:
3e7f 20403a37 call save_rssi 
3e80 207a0000 rtn blank 
3e81 98002200 iforce rega 
3e82 6fe24b79 fetch 1 ,mem_24g_current_ch_number 
3e83 1fe9a400 lshift3 pdata ,regb 
3e84 58004cc6 setarg mem_rssi_signal_buf 
3e85 9a408c00 iadd regb ,contr 
3e86 eff00006 ifetch 8 ,contr 
3e87 1fec8400 rshift8 pdata ,temp 
3e88 58004cc6 setarg mem_rssi_signal_buf 
3e89 9a408a00 iadd regb ,contw 
3e8a e04e0005 istoret 7 ,contw 
3e8b 1a227e00 deposit rega 
3e8c e7e20005 istore 1 ,contw 
3e8d 20600000 rtn 

g24_rssi_signal_avg:
3e8e d8400000 arg 0 ,temp 
3e8f df200008 arg 8 ,loopcnt 
3e90 6fe24b79 fetch 1 ,mem_24g_current_ch_number 
3e91 1fe9a400 lshift3 pdata ,regb 
3e92 58004cc6 setarg mem_rssi_signal_buf 
3e93 9a408c00 iadd regb ,contr 

g24_rssi_signal_avg_loop:
3e94 efe20006 ifetch 1 ,contr 
3e95 98408400 iadd temp ,temp 
3e96 c2003e94 loop g24_rssi_signal_avg_loop 
3e97 18497e00 rshift3 temp ,pdata 
3e98 67e24ce7 store 1 ,mem_rssi_signal_avg 
3e99 20600000 rtn 

g24_check_rx_data:
3e9a 6fe24ad0 fetch 1 ,mem_24g_rxbuf 
3e9b 68424b21 fetcht 1 ,mem_24g_data_type 
3e9c 98467c00 isub temp ,null 
3e9d 2422f903 nbranch enable_user ,zero 
3e9e 6fe24ad1 fetch 1 ,mem_24g_rxbuf + 1 
3e9f 1fe97e00 rshift3 pdata ,pdata 
3ea0 67e24b18 store 1 ,mem_24g_rxdata_length 
3ea1 1fe0fe01 increase 1 ,pdata 
3ea2 d8c04ad1 arg mem_24g_rxbuf + 1 ,contr 
3ea3 98c08c00 iadd contr ,contr 
3ea4 efe40006 ifetch 2 ,contr 
3ea5 67e44b19 store 2 ,mem_24g_rx_crc 
3ea6 6fe24b91 fetch 1 ,mem_24g_addr_length 
3ea7 1fe27200 copy pdata ,loopcnt 
3ea8 d8a04af4 arg mem_24g_rxdata ,contw 
3ea9 d8c04b92 arg mem_24g_addr ,contr 
3eaa 2040779f call memcpy 
3eab 18a22200 copy contw ,rega 
3eac 6fe24b18 fetch 1 ,mem_24g_rxdata_length 
3ead 1fe0fe02 increase 2 ,pdata 
3eae 1fe27200 copy pdata ,loopcnt 
3eaf d8c04ad0 arg mem_24g_rxbuf ,contr 
3eb0 1a220a00 copy rega ,contw 
3eb1 2040779f call memcpy 
3eb2 6fe24b18 fetch 1 ,mem_24g_rxdata_length 
3eb3 68424b91 fetcht 1 ,mem_24g_addr_length 
3eb4 9840fe00 iadd temp ,pdata 
3eb5 1fe0fe02 increase 2 ,pdata 
3eb6 1fe9fe00 lshift3 pdata ,pdata 
3eb7 1fe27200 copy pdata ,loopcnt 
3eb8 d8c04af4 arg mem_24g_rxdata ,contr 
3eb9 20403ec4 call gencrc 
3eba 6fe44b1d fetch 2 ,mem_24g_crc 
3ebb 68444b19 fetcht 2 ,mem_24g_rx_crc 
3ebc 98467c00 isub temp ,null 
3ebd 2422f903 nbranch enable_user ,zero 
3ebe 6fe24b18 fetch 1 ,mem_24g_rxdata_length 
3ebf 1fe27200 copy pdata ,loopcnt 
3ec0 d8c04ad2 arg mem_24g_rxbuf + 2 ,contr 
3ec1 d8a04bcd arg mem_24g_payload_rxbuf ,contw 
3ec2 2040779f call memcpy 
3ec3 202078ec branch disable_user 

gencrc:
3ec4 5800ffff setarg 0xffff 
3ec5 d8a01021 arg 0x1021 ,contw 
3ec6 da200000 arg 0 ,rega 

crc_loop:
3ec7 1a217c07 and rega ,7 ,null 
3ec8 2422beca nbranch crc_nofetch ,zero 
3ec9 e8420006 ifetcht 1 ,contr 

crc_nofetch:
3eca c287bed4 bbit1 15 ,crc_b15 
3ecb 284c0000 isolate0 0 ,temp 

crc_shift:
3ecc 1fe3fe00 lshift pdata ,pdata 
3ecd 2020becf branch crc_noxor ,true 
3ece 98a2fe00 ixor contw ,pdata 

crc_noxor:
3ecf 18430400 rshift temp ,temp 
3ed0 1a20a201 increase 1 ,rega 
3ed1 c2003ec7 loop crc_loop 
3ed2 67e44b1d store 2 ,mem_24g_crc 
3ed3 20600000 rtn 

crc_b15:
3ed4 284ffe00 isolate1 0 ,temp 
3ed5 20203ecc branch crc_shift 

g24_prepare_tx:
3ed6 704b4205 jam 5 ,mem_24g_txlen 
3ed7 6fe24b91 fetch 1 ,mem_24g_addr_length 
3ed8 68424b42 fetcht 1 ,mem_24g_txlen 
3ed9 9840fe00 iadd temp ,pdata 
3eda 68424b20 fetcht 1 ,mem_24g_datalen 
3edb 9840fe00 iadd temp ,pdata 
3edc 67e24b42 store 1 ,mem_24g_txlen 
3edd 6fe24b92 fetch 1 ,mem_24g_addr 
3ede c3003ee1 bbit0 0 ,g24_prepare_tx_55 
3edf 580000aa setarg 0xaa 
3ee0 20203ee2 branch g24_prepare_tx_premable 

g24_prepare_tx_55:
3ee1 58000055 setarg 0x55 

g24_prepare_tx_premable:
3ee2 67e24b43 store 1 ,mem_24g_txpayload 
3ee3 6fe24b91 fetch 1 ,mem_24g_addr_length 
3ee4 1fe27200 copy pdata ,loopcnt 
3ee5 d8a04b44 arg mem_24g_txpayload + 1 ,contw 
3ee6 d8c04b92 arg mem_24g_addr ,contr 
3ee7 2040779f call memcpy 
3ee8 6fe24b21 fetch 1 ,mem_24g_data_type 
3ee9 e7e20005 istore 1 ,contw 
3eea 6fe24b20 fetch 1 ,mem_24g_datalen 
3eeb 1fe9fe00 lshift3 pdata ,pdata 
3eec 68424b1f fetcht 1 ,mem_24g_pid 
3eed 18410403 and temp ,0x03 ,temp 
3eee 18438400 lshift temp ,temp 
3eef 9841fe00 ior temp ,pdata 
3ef0 1fe0fe00 add pdata ,with_ack_24g ,pdata 
3ef1 e7e20005 istore 1 ,contw 
3ef2 18a22200 copy contw ,rega 
3ef3 6fe24b20 fetch 1 ,mem_24g_datalen 
3ef4 1fe27200 copy pdata ,loopcnt 
3ef5 d8c04b22 arg mem_24g_txdata ,contr 
3ef6 1a220a00 copy rega ,contw 
3ef7 2040779f call memcpy 
3ef8 18a22400 copy contw ,regb 
3ef9 6fe24b42 fetch 1 ,mem_24g_txlen 
3efa 1fe0fffd increase -3 ,pdata 
3efb 1fe9fe00 lshift3 pdata ,pdata 
3efc 1fe27200 copy pdata ,loopcnt 
3efd d8c04b44 arg mem_24g_txpayload + 1 ,contr 
3efe 20403ec4 call gencrc 
3eff df200002 arg 2 ,loopcnt 
3f00 d8c04b1d arg mem_24g_crc ,contr 
3f01 1a420a00 copy regb ,contw 
3f02 2020779f branch memcpy 

g24_init:
3f03 704b1f00 jam 0 ,mem_24g_pid 
3f04 704b784e jam g24_pair_ch ,mem_24g_ch 
3f05 20600000 rtn 

g24_set_freq_rx:
3f06 60420017 storet 1 ,mem_last_freq 
3f07 1840a204 add temp ,rx_freq_offset ,rega 
3f08 70096d07 jam 0x07 ,0x96d 
3f09 202039fd branch rf_write_freq 

g24_ch:
3f0a 68424b79 fetcht 1 ,mem_24g_current_ch_number 
3f0b 20403f10 call g24_ch_calc 
3f0c 18408401 increase 1 ,temp 
3f0d 18410403 and_into 3 ,temp 
3f0e 60424b79 storet 1 ,mem_24g_current_ch_number 
3f0f 20600000 rtn 

g24_ch_calc:
3f10 6fe24b92 fetch 1 ,mem_24g_addr 
3f11 1fe17e03 and_into 0x03 ,pdata 
3f12 1fefa204 mul32 pdata ,4 ,rega 
3f13 58004b7a setarg mem_24g_ch_map1 
3f14 9a20fe00 iadd rega ,pdata 
3f15 98408c00 iadd temp ,contr 
3f16 efe20006 ifetch 1 ,contr 
3f17 67e24b78 store 1 ,mem_24g_ch 
3f18 20600000 rtn 

g24_check_cmd_start:
3f19 704ba0ff jam state_24g_pairing_success ,mem_24g_pairing_sm 
3f1a 20203f29 branch g24_start_24g_mode 

g24_check_cmd_stop:
3f1b 704ba0ff jam state_24g_pairing_success ,mem_24g_pairing_sm 
3f1c 704b7500 jam 0 ,mem_24g_exit_flag 
3f1d 700b083b jam bt_evt_24g_attempt_fail ,mem_fifo_temp 
3f1e 202071ee branch ui_ipc_send_event 

g24_check_cmd_pairing:
3f1f 6fe24b9e fetch 1 ,mem_24g_pairing_flag 
3f20 247a0000 nrtn blank 
3f21 704b9e01 jam 1 ,mem_24g_pairing_flag 
3f22 20203de1 branch g24_start_pairing_sm1 

g24_check_51cmd_test:
3f23 20600000 rtn 

g24_attemp_tx_data_retry:
3f24 6fe44c55 fetch 2 ,mem_24g_check_dongle_times 
3f25 1fe0fe01 increase 1 ,pdata 
3f26 67e44c55 store 2 ,mem_24g_check_dongle_times 
3f27 20403f0a call g24_ch 
3f28 20203f33 branch g24_tx_attemp_dongle_loop 

g24_start_24g_mode:
3f29 20403f03 call g24_init 
3f2a 6fe24ba0 fetch 1 ,mem_24g_pairing_sm 
3f2b c1ff8000 rtnne state_24g_pairing_success 
3f2c 704b7601 jam 1 ,mem_24g_tx_flag 
3f2d da204bad arg mem_24g_common_temp ,rega 
3f2e d8400008 arg 8 ,temp 
3f2f 20403d73 call g24_put_data_in_buff 
3f30 20403ed6 call g24_prepare_tx 

g24_tx_attemp_dongle:
3f31 58000000 setarg 0 
3f32 67e44c55 store 2 ,mem_24g_check_dongle_times 

g24_tx_attemp_dongle_loop:
3f33 20004e20 nop 20000 
3f34 6fe44c55 fetch 2 ,mem_24g_check_dongle_times 
3f35 c07fbf1b beq 0xff ,g24_check_cmd_stop 
3f36 20403dbc call g24_tx_and_receive_ack 
3f37 242c3f24 nbranch g24_attemp_tx_data_retry ,sync 
3f38 20403e9a call g24_check_rx_data 
3f39 20343f24 branch g24_attemp_tx_data_retry ,user 

g24_start_24g_mode_1:
3f3a 44dd4017 bpatch patch17_2 ,mem_patch17 
3f3b 704b7501 jam 1 ,mem_24g_exit_flag 
3f3c 704b9e00 jam 0 ,mem_24g_pairing_flag 
3f3d 704c5500 jam 0 ,mem_24g_check_dongle_times 
3f3e 700b083c jam bt_evt_24g_attempt_success ,mem_fifo_temp 
3f3f 202071ee branch ui_ipc_send_event 

g24_open_24g:
3f40 20403f03 call g24_init 
3f41 704ba0ff jam state_24g_pairing_success ,mem_24g_pairing_sm 
3f42 20203f3a branch g24_start_24g_mode_1 

g24_dongle_work_mode:
3f43 44ddc017 bpatch patch17_3 ,mem_patch17 
3f44 6fe24c82 fetch 1 ,mem_dongle_work_mode 
3f45 c1800000 rtnne dongle_work 
3f46 20403f49 call g24_dongle_work_init 
3f47 20403f53 call g24_channel_process 
3f48 20203f78 branch g24_rx_check 

g24_dongle_work_init:
3f49 6fe24c81 fetch 1 ,mem_dongle_mode_init 
3f4a c3800000 rtnbit1 dongle_work 
3f4b 79207e00 set1 dongle_work ,pdata 
3f4c 67e24c81 store 1 ,mem_dongle_mode_init 
3f4d 704b9e00 jam 0 ,mem_24g_pairing_flag 
3f4e 704ca000 jam 0 ,mem_24g_rx_interrupt 
3f4f 704a9700 jam 0 ,mem_usb_tx_enable 
3f50 704c9d01 jam 1 ,mem_24g_abort_packet 
3f51 20403fcc call g24_dongle_init 
3f52 20203f83 branch g24_rf_buf_release 

g24_channel_process:
3f53 6fe24c9d fetch 1 ,mem_24g_abort_packet 
3f54 1fe67c01 sub pdata ,1 ,null 
3f55 2022bf6f branch g24_dongle_rf_rssi_process ,zero 
3f56 68484ca1 fetcht 4 ,mem_dongle_tx_btclk 
3f57 1c427e00 copy clkn_bt ,pdata 
3f58 98467c00 isub temp ,null 
3f59 24413d5a ncall g24_timer_timeout ,positive 
3f5a 1fe22400 copy pdata ,regb 
3f5b 6fe84ca1 fetch 4 ,mem_dongle_tx_btclk 
3f5c 68424ca5 fetcht 1 ,mem_dongle_interval 
3f5d 98408400 iadd temp ,temp 
3f5e 1a427e00 copy regb ,pdata 
3f5f 98467c00 isub temp ,null 
3f60 24610000 nrtn positive 
3f61 793ffe1c set0 28 ,pdata 
3f62 67e84ca1 store 4 ,mem_dongle_tx_btclk 
3f63 6fe24c9f fetch 1 ,mem_24g_rf_receive 
3f64 243a3f6d nbranch g24_dongle_rf_receive_data ,blank 

g24_24g_rf_hop:
3f65 20403f0a call g24_ch 
3f66 6fe24c9e fetch 1 ,mem_24g_rf_laststa 
3f67 1fe0fe01 increase 1 ,pdata 
3f68 67e24c9e store 1 ,mem_24g_rf_laststa 
3f69 c1810000 rtnne 2 
3f6a 704c9e00 jam 0 ,mem_24g_rf_laststa 
3f6b 704c9d01 jam 1 ,mem_24g_abort_packet 
3f6c 20600000 rtn 

g24_dongle_rf_receive_data:
3f6d 704c9f00 jam 0 ,mem_24g_rf_receive 
3f6e 20600000 rtn 

g24_dongle_rf_rssi_process:
3f6f 20403e73 call g24_rssi_noise_avg 
3f70 20403e8e call g24_rssi_signal_avg 
3f71 6fe24ce6 fetch 1 ,mem_rssi_noise_avg 
3f72 68424ce7 fetcht 1 ,mem_rssi_signal_avg 
3f73 98467e00 isub temp ,pdata 
3f74 67e24ce8 store 1 ,mem_rssi_snr_opposite 
3f75 1fe67c40 sub pdata ,rssi_sensitivity ,null 
3f76 24610000 nrtn positive 
3f77 20203f0a branch g24_ch 

g24_rx_check:
3f78 20403f82 call g24_rx_interrupt_clear 
3f79 20403f8c call g24_rx_data 
3f7a 6fe24ca0 fetch 1 ,mem_24g_rx_interrupt 
3f7b 203a3f82 branch g24_rx_interrupt_clear ,blank 
3f7c 44de4017 bpatch patch17_4 ,mem_patch17 
3f7d 6fe24c57 fetch 1 ,mem_24g_rxdata_temp 
3f7e 1fe17e0f and_into 0x0f ,pdata 
3f7f c000bf89 beq 0x01 ,p_24g_data_type1 
3f80 c0013f8a beq 0x02 ,p_24g_data_type2 
3f81 c0023f8b beq 0x04 ,p_24g_data_type4 

g24_rx_interrupt_clear:
3f82 704ca000 jam 0 ,mem_24g_rx_interrupt 

g24_rf_buf_release:
3f83 d8a04b22 arg mem_24g_txdata ,contw 
3f84 df200004 arg 4 ,loopcnt 
3f85 2040775e call memset0 
3f86 d8a04ad0 arg mem_24g_rxbuf ,contw 
3f87 df200024 arg 36 ,loopcnt 
3f88 2020776c branch clear_mem 

p_24g_data_type1:
3f89 20600000 rtn 

p_24g_data_type2:
3f8a 20600000 rtn 

p_24g_data_type4:
3f8b 20600000 rtn 

g24_rx_data:
3f8c 20403e4a call g24_rx 
3f8d 20403e36 call g24_set_freq_tx 

g24_rxdata_read_control:
3f8e 6fe24ad0 fetch 1 ,mem_24g_rxbuf 
3f8f 67e24b21 store 1 ,mem_24g_data_type 
3f90 6fe24ad1 fetch 1 ,mem_24g_rxbuf + 1 
3f91 1fe97e00 rshift3 pdata ,pdata 
3f92 67e24b18 store 1 ,mem_24g_rxdata_length 
3f93 6fe24b18 fetch 1 ,mem_24g_rxdata_length 
3f94 1fe0fe01 increase 1 ,pdata 
3f95 d8c04ad1 arg mem_24g_rxbuf + 1 ,contr 
3f96 98c08c00 iadd contr ,contr 
3f97 efe40006 ifetch 2 ,contr 
3f98 67e44b19 store 2 ,mem_24g_rx_crc 
3f99 6fe24b91 fetch 1 ,mem_24g_addr_length 
3f9a 1fe27200 copy pdata ,loopcnt 
3f9b d8a04af4 arg mem_24g_rxdata ,contw 
3f9c d8c04b92 arg mem_24g_addr ,contr 
3f9d 2040779f call memcpy 
3f9e 18a22200 copy contw ,rega 
3f9f 6fe24b18 fetch 1 ,mem_24g_rxdata_length 
3fa0 1fe0fe02 increase 2 ,pdata 
3fa1 1fe27200 copy pdata ,loopcnt 
3fa2 d8c04ad0 arg mem_24g_rxbuf ,contr 
3fa3 1a220a00 copy rega ,contw 
3fa4 2040779f call memcpy 
3fa5 6fe24b18 fetch 1 ,mem_24g_rxdata_length 
3fa6 68424b91 fetcht 1 ,mem_24g_addr_length 
3fa7 9840fe00 iadd temp ,pdata 
3fa8 1fe0fe02 increase 2 ,pdata 
3fa9 1fe9fe00 lshift3 pdata ,pdata 
3faa 1fe27200 copy pdata ,loopcnt 
3fab d8c04af4 arg mem_24g_rxdata ,contr 
3fac 20403ec4 call gencrc 
3fad 6fe44b1d fetch 2 ,mem_24g_crc 
3fae 68444b19 fetcht 2 ,mem_24g_rx_crc 
3faf 98467c00 isub temp ,null 
3fb0 2422b984 nbranch shutdown_radio ,zero 

g24_tx_ack:
3fb1 44dec017 bpatch patch17_5 ,mem_patch17 
3fb2 704b2000 jam 0 ,mem_24g_datalen 
3fb3 6fe24ceb fetch 1 ,mem_24g_get_user_defined_flag 
3fb4 245a3fc6 ncall g24_tx_ack_payload_usb ,blank 
3fb5 6fe24b9e fetch 1 ,mem_24g_pairing_flag 
3fb6 245a3fc1 ncall g24_tx_ack_payload_bind ,blank 
3fb7 20403ed6 call g24_prepare_tx 
3fb8 20403e39 call g24_tx 
3fb9 20403984 call shutdown_radio 
3fba 6fe24b18 fetch 1 ,mem_24g_rxdata_length 
3fbb 1fe27200 copy pdata ,loopcnt 
3fbc d8c04ad2 arg mem_24g_rxbuf + 2 ,contr 
3fbd d8a04c57 arg mem_24g_rxdata_temp ,contw 
3fbe 2040779f call memcpy 
3fbf 704ca001 jam 1 ,mem_24g_rx_interrupt 
3fc0 20600000 rtn 

g24_tx_ack_payload_bind:
3fc1 704b2008 jam 0x08 ,mem_24g_datalen 
3fc2 df200008 arg 0x08 ,loopcnt 
3fc3 d8c04c96 arg mem_24g_bind_payload ,contr 
3fc4 d8a04b22 arg mem_24g_txdata ,contw 
3fc5 2020779f branch memcpy 

g24_tx_ack_payload_usb:
3fc6 704ceb00 jam 0 ,mem_24g_get_user_defined_flag 
3fc7 704b2010 jam 0x10 ,mem_24g_datalen 
3fc8 df200010 arg 0x10 ,loopcnt 
3fc9 d8c04cec arg mem_24g_get_user_defined_data ,contr 
3fca d8a04b22 arg mem_24g_txdata ,contw 
3fcb 2020779f branch memcpy 

g24_dongle_init:
3fcc 704b1f00 jam 0 ,mem_24g_pid 
3fcd 6fec4c7b fetch 6 ,mem_24g_dongle_private_addr 
3fce 67ec4b92 store 6 ,mem_24g_addr 
3fcf 20203f0a branch g24_ch 

g24_dongle_bind_mode:
3fd0 6fe24c82 fetch 1 ,mem_dongle_work_mode 
3fd1 c1808000 rtnne dongle_bind 
3fd2 20403fd4 call g24_dongle_bind_init 
3fd3 20203fe1 branch g24_dongle_bind_data_process 

g24_dongle_bind_init:
3fd4 6fe24c81 fetch 1 ,mem_dongle_mode_init 
3fd5 c3808000 rtnbit1 dongle_bind 
3fd6 79207e01 set1 dongle_bind ,pdata 
3fd7 67e24c81 store 1 ,mem_dongle_mode_init 
3fd8 704b9e01 jam 1 ,mem_24g_pairing_flag 
3fd9 704b1f00 jam 0 ,mem_24g_pid 
3fda 704b784e jam g24_pair_ch ,mem_24g_ch 
3fdb 6fec4b98 fetch 6 ,mem_24g_paring_addr 
3fdc 67ec4b92 store 6 ,mem_24g_addr 
3fdd 704c8300 jam 0 ,mem_dongle_ms_bind_step 
3fde 704c8400 jam 0 ,mem_dongle_kb_bind_step 
3fdf 704c8500 jam 0 ,mem_dongle_bind_device_status 
3fe0 20600000 rtn 

g24_dongle_bind_data_process:
3fe1 44df4017 bpatch patch17_6 ,mem_patch17 
3fe2 20403fee call g24_dongle_bind_data_clear 
3fe3 20403f8c call g24_rx_data 
3fe4 6fe24ca0 fetch 1 ,mem_24g_rx_interrupt 
3fe5 203a3fee branch g24_dongle_bind_data_clear ,blank 
3fe6 d8c04c57 arg mem_24g_rxdata_temp ,contr 
3fe7 d8a04c86 arg mem_24g_bind_rf_data ,contw 
3fe8 df200007 arg 7 ,loopcnt 
3fe9 2040779f call memcpy 
3fea 6fe24c86 fetch 1 ,mem_24g_bind_rf_data 
3feb c0553ff0 beq datatype_bind ,g24_dongle_bind_first_step 
3fec c02abffd beq datatype_config ,g24_dongle_bind_second_step 
3fed c011400d beq datatype_ok ,g24_dongle_bind_third_step 

g24_dongle_bind_data_clear:
3fee 704ca000 jam 0 ,mem_24g_rx_interrupt 
3fef 20203f83 branch g24_rf_buf_release 

g24_dongle_bind_first_step:
3ff0 6fe24c87 fetch 1 ,mem_24g_bind_rf_data + 1 
3ff1 c000bff4 beq bind_mouse ,g24_dongle_bind_first_step_mouse 
3ff2 c0013ffa beq bind_keyboard ,g24_dongle_bind_first_step_keyboard 
3ff3 20600000 rtn 

g24_dongle_bind_first_step_mouse:
3ff4 704c8301 jam 1 ,mem_dongle_ms_bind_step 

g24_dongle_bind_ms_payload_cfg:
3ff5 704c9601 jam datatype_mouse ,mem_24g_bind_payload 

g24_dongle_bind_payload_cfg:
3ff6 704c9780 jam 0x80 ,mem_24g_bind_payload + 1 
3ff7 6fec4c7b fetch 6 ,mem_24g_dongle_private_addr 
3ff8 67ec4c98 store 6 ,mem_24g_bind_payload + 2 
3ff9 20600000 rtn 

g24_dongle_bind_first_step_keyboard:
3ffa 704c8401 jam 1 ,mem_dongle_kb_bind_step 

g24_dongle_bind_kb_payload_cfg:
3ffb 704c9602 jam datatype_keyboard ,mem_24g_bind_payload 
3ffc 20203ff6 branch g24_dongle_bind_payload_cfg 

g24_dongle_bind_second_step:
3ffd 6fe24c87 fetch 1 ,mem_24g_bind_rf_data + 1 
3ffe c000c001 beq bind_mouse ,g24_dongle_bind_second_step_mouse 
3fff c0014007 beq bind_keyboard ,g24_dongle_bind_second_step_keyboard 
4000 20600000 rtn 

g24_dongle_bind_second_step_mouse:
4001 20403ff5 call g24_dongle_bind_ms_payload_cfg 
4002 6fe24c83 fetch 1 ,mem_dongle_ms_bind_step 
4003 c000c005 beq 1 ,g24_dongle_ms_bind_step_set2 
4004 20600000 rtn 

g24_dongle_ms_bind_step_set2:
4005 704c8302 jam 2 ,mem_dongle_ms_bind_step 
4006 20600000 rtn 

g24_dongle_bind_second_step_keyboard:
4007 20403ffb call g24_dongle_bind_kb_payload_cfg 
4008 6fe24c84 fetch 1 ,mem_dongle_kb_bind_step 
4009 c000c00b beq 1 ,g24_dongle_kb_bind_step_set2 
400a 20600000 rtn 

g24_dongle_kb_bind_step_set2:
400b 704c8402 jam 2 ,mem_dongle_kb_bind_step 
400c 20600000 rtn 

g24_dongle_bind_third_step:
400d 6fe24c87 fetch 1 ,mem_24g_bind_rf_data + 1 
400e c000c011 beq bind_mouse ,g24_dongle_bind_third_step_mouse 
400f c001401b beq bind_keyboard ,g24_dongle_bind_third_step_keyboard 
4010 20600000 rtn 

g24_dongle_bind_third_step_mouse:
4011 6fe24c83 fetch 1 ,mem_dongle_ms_bind_step 
4012 c0014014 beq 2 ,g24_dongle_ms_bind_step_success 
4013 20600000 rtn 

g24_dongle_ms_bind_step_success:
4014 6fe24c85 fetch 1 ,mem_dongle_bind_device_status 
4015 1fe1fe01 or_into 0x01 ,pdata 
4016 67e24c85 store 1 ,mem_dongle_bind_device_status 

g24_dongle_bind_exit:
4017 58000000 setarg 0 
4018 67e24c84 store 1 ,mem_dongle_kb_bind_step 
4019 67e24c83 store 1 ,mem_dongle_ms_bind_step 
401a 20203fee branch g24_dongle_bind_data_clear 

g24_dongle_bind_third_step_keyboard:
401b 6fe24c84 fetch 1 ,mem_dongle_kb_bind_step 
401c c080401e bne 0 ,g24_dongle_kb_bind_step_success 
401d 20600000 rtn 

g24_dongle_kb_bind_step_success:
401e 6fe24c85 fetch 1 ,mem_dongle_bind_device_status 
401f 1fe1fe02 or_into 0x02 ,pdata 
4020 67e24c85 store 1 ,mem_dongle_bind_device_status 
4021 20204017 branch g24_dongle_bind_exit 

l2cap_call_proc_avdtp:
4022 44dfc017 bpatch patch17_7 ,mem_patch17 
4023 20404a5a call l2cap_malloc_is_fifo_full 
4024 247a0000 nrtn blank 
4025 6fe40311 fetch 2 ,mem_l2cap_payload_ptr 
4026 1fe20c00 copy pdata ,contr 
4027 efe20006 ifetch 1 ,contr 
4028 1fe104f0 and pdata ,0xf0 ,temp 
4029 18518400 rshift4 temp ,temp 
402a 604201ea storet 1 ,mem_transaction_label 
402b 1fe12203 and pdata ,0x3 ,rega 
402c 1fe17e0c and pdata ,0xc ,pdata 
402d c0804100 bne avdtp_packet_type_single ,avd_signal_prase_uncomplete 
402e 1a227e00 copy rega ,pdata 
402f c000405a beq avdtp_message_type_cmd ,avd_signal_parse_cmd 
4030 c000c0e4 beq avdtp_messgae_type_general_reject ,avd_signal_parse_general_reject 
4031 c00140e5 beq avdtp_messgae_type_rsp_accept ,avd_signal_parse_rsp_accept 
4032 c001c0e4 beq avdtp_messgae_type_rsp_reject ,avd_signal_parse_rsp_reject 
4033 20203b25 branch assert 

l2cap_call_proc_avdtp_media:
4034 44e04018 bpatch patch18_0 ,mem_patch18 
4035 6fe24296 fetch 1 ,mem_audio_allow 
4036 c00048d4 beq avd_audio_forbid ,l2cap_rx_reset_state 
4037 20405fbf call sbc_hw_check_busy 
4038 24628000 nrtn zero 
4039 6fe24297 fetch 1 ,mem_audio_state 
403a c000403d beq 0 ,l2cap_call_proc_avdtp_media_pass_reset 
403b 70429700 jam 0 ,mem_audio_state 
403c 202048d4 branch l2cap_rx_reset_state 

l2cap_call_proc_avdtp_media_pass_reset:
403d 20405fc3 call dac_hw_get_count 
403e d8403ff0 arg hf_dac_buffer_size ,temp 
403f 18430400 rshift temp ,temp 
4040 98467c00 isub temp ,null 
4041 20610000 rtn positive 
4042 20405f94 call sbc_update_dac_wptr 
4043 6fe40311 fetch 2 ,mem_l2cap_payload_ptr 
4044 1fe08c0c add pdata ,12 ,contr 
4045 da20000c arg 12 ,rega 

avd_media_get_offset_loop:
4046 efe20006 ifetch 1 ,contr 
4047 1a20a201 increase 1 ,rega 
4048 c0004046 beq 0 ,avd_media_get_offset_loop 
4049 efe20006 ifetch 1 ,contr 
404a c0ce3b25 bne 0x9c ,assert 
404b 70806408 jam 0x8 ,core_sbc_ctrl 
404c 6fe40313 fetch 2 ,mem_l2cap_rx_pkt_length 
404d 9a267e00 isub rega ,pdata 
404e 67e48112 store 2 ,core_sbc_swp 
404f 6fe40311 fetch 2 ,mem_l2cap_payload_ptr 
4050 9a20fe00 iadd rega ,pdata 
4051 67e4810a store 2 ,core_sbc_saddr 
4052 58000400 setarg 0x400 
4053 67e4810e store 2 ,core_sbc_slen 
4054 70800b02 jam 0x02 ,core_sbc_clr 
4055 20000001 nop 1 
4056 70800b00 jam 0 ,core_sbc_clr 
4057 70806409 jam 0x9 ,core_sbc_ctrl 
4058 70429701 jam 1 ,mem_audio_state 
4059 20205f88 branch sbc_hw_check_err 

avd_signal_parse_cmd:
405a 44e0c018 bpatch patch18_1 ,mem_patch18 
405b efe20006 ifetch 1 ,contr 
405c 1fe17e3f and pdata ,0x3f ,pdata 
405d 67e201e9 store 1 ,mem_avdtp_signal_cmd 
405e c000c06c beq avdtp_identifier_discover ,avd_signal_parse_cmd_discover 
405f c0014074 beq avdtp_identifier_get_capabilities ,avd_signal_parse_cmd_get_cap 
4060 c001c08a beq avdtp_identifier_set_configuration ,avd_signal_parse_cmd_set_conf 
4061 c00240e3 beq avdtp_identifier_get_configuration ,avd_signal_parse_cmd_get_conf 
4062 c002c0e3 beq avdtp_identifier_reconfigure ,avd_signal_parse_cmd_reconfig 
4063 c00340b5 beq avdtp_identifier_open ,avd_signal_parse_cmd_open 
4064 c003c0bc beq avdtp_identifier_start ,avd_signal_parse_cmd_start 
4065 c00440c6 beq avdtp_identifier_close ,avd_signal_parse_cmd_close 
4066 c004c0c6 beq avdtp_identifier_suspend ,avd_signal_parse_cmd_suspend 
4067 c00540e3 beq avdtp_identifier_abort ,avd_signal_parse_cmd_abort 
4068 c005c0e3 beq avdtp_identifier_security_control ,avd_signal_parse_cmd_security_control 
4069 c00640cd beq avdtp_identifier_get_all_capabilities ,avd_signal_parse_cmd_get_all_cap 
406a c006c0e3 beq avdtp_identifier_delayreport ,avd_signal_parse_cmd_delayreport 
406b 20203b25 branch assert 

avd_signal_parse_cmd_discover:
406c da200004 arg 4 ,rega 
406d 20404106 call adv_malloc_rsp_accept 
406e 58000001 setarg avdtp_sep1 
406f 1febfe00 lshift2 pdata ,pdata 
4070 e7e20005 istore 1 ,contw 
4071 58000008 setarg avdtp_sep1_config 
4072 e7e20005 istore 1 ,contw 
4073 202048d4 branch l2cap_rx_reset_state 

avd_signal_parse_cmd_get_cap:
4074 efe20006 ifetch 1 ,contr 
4075 1feb7e00 rshift2 pdata ,pdata 
4076 c080c101 bne avdtp_sep1 ,adv_signal_rsp_reject 
4077 da200010 arg 16 ,rega 
4078 20404106 call adv_malloc_rsp_accept 
4079 58000001 setarg avdtp_category_media_trans 
407a e7e20005 istore 1 ,contw 
407b 58000000 setarg 0 
407c e7e20005 istore 1 ,contw 
407d 58000004 setarg avdtp_category_contect_protect 
407e e7e20005 istore 1 ,contw 
407f 58000002 setarg 2 
4080 e7e20005 istore 1 ,contw 
4081 58000002 setarg avd_cptype_scms_t 
4082 e7e40005 istore 2 ,contw 
4083 58000007 setarg avdtp_category_media_codec 
4084 e7e20005 istore 1 ,contw 
4085 58000006 setarg 0x06 
4086 e7e20005 istore 1 ,contw 
4087 6fec429b fetch 6 ,mem_avdtp_codec_type 
4088 e7ec0005 istore 6 ,contw 
4089 202048d4 branch l2cap_rx_reset_state 

avd_signal_parse_cmd_set_conf:
408a 18c27e00 copy contr ,pdata 
408b 6a240313 fetchr rega ,2 ,mem_l2cap_rx_pkt_length 
408c 9a20a200 iadd rega ,rega 
408d 1a20a3fe increase -2 ,rega 
408e 1fe20c00 copy pdata ,contr 
408f efe40006 ifetch 2 ,contr 

adv_analy_conf_loop:
4090 18c27e00 copy contr ,pdata 
4091 9a267c00 isub rega ,null 
4092 2021409d branch adv_analy_conf_rsp ,positive 
4093 efe20006 ifetch 1 ,contr 
4094 60c40b25 storer contr ,2 ,mem_contr 
4095 d8400007 arg avdtp_category_media_codec ,temp 
4096 98467c00 isub temp ,null 
4097 2042c0a0 call adv_analy_conf_codec_cap ,zero 
4098 6fe40b25 fetch 2 ,mem_contr 
4099 1fe20c00 copy pdata ,contr 
409a efe20006 ifetch 1 ,contr 
409b 98c08c00 iadd contr ,contr 
409c 20204090 branch adv_analy_conf_loop 

adv_analy_conf_rsp:
409d da200002 arg 2 ,rega 
409e 20404106 call adv_malloc_rsp_accept 
409f 202048d4 branch l2cap_rx_reset_state 

adv_analy_conf_codec_cap:
40a0 18c08c02 increase 2 ,contr 
40a1 efe20006 ifetch 1 ,contr 
40a2 67e242a1 store 1 ,mem_conf_codec_type 
40a3 efe20006 ifetch 1 ,contr 
40a4 1fe1040f and pdata ,0xf ,temp 
40a5 604242a2 storet 1 ,mem_conf_channel_mode 
40a6 1ff1fe00 rshift4 pdata ,pdata 
40a7 67e242a3 store 1 ,mem_conf_sample_freq 
40a8 efe20006 ifetch 1 ,contr 
40a9 1fe10403 and pdata ,0x3 ,temp 
40aa 604242a4 storet 1 ,mem_conf_allocation_method 
40ab 1fe104c0 and pdata ,0xc0 ,temp 
40ac 184b0400 rshift2 temp ,temp 
40ad 604242a5 storet 1 ,mem_conf_subbands 
40ae 1ff1fe00 rshift4 pdata ,pdata 
40af 67e242a6 store 1 ,mem_conf_blocklen 
40b0 efe20006 ifetch 1 ,contr 
40b1 67e242a7 store 1 ,mem_conf_min_poolval 
40b2 efe20006 ifetch 1 ,contr 
40b3 67e242a8 store 1 ,mem_conf_max_poolval 
40b4 20600000 rtn 

avd_signal_parse_cmd_open:
40b5 efe20006 ifetch 1 ,contr 
40b6 1feb7e00 rshift2 pdata ,pdata 
40b7 67e242a9 store 1 ,mem_opend_seid 
40b8 70429601 jam avd_audio_allow ,mem_audio_allow 

avd_signal_parse_cmd_open_rsp:
40b9 da200002 arg 2 ,rega 
40ba 20404106 call adv_malloc_rsp_accept 
40bb 202048d4 branch l2cap_rx_reset_state 

avd_signal_parse_cmd_start:
40bc efe20006 ifetch 1 ,contr 
40bd 1feb7e00 rshift2 pdata ,pdata 
40be 67e242aa store 1 ,mem_started_seid 
40bf 20405fb8 call sbc_hw_wait 
40c0 2040442f call hp_stero_init 
40c1 70429601 jam avd_audio_allow ,mem_audio_allow 
40c2 20405f88 call sbc_hw_check_err 
40c3 da200002 arg 2 ,rega 
40c4 20404106 call adv_malloc_rsp_accept 
40c5 202048d4 branch l2cap_rx_reset_state 

avd_signal_parse_cmd_suspend:

avd_signal_parse_cmd_close:
40c6 efe20006 ifetch 1 ,contr 
40c7 1feb7e00 rshift2 pdata ,pdata 
40c8 67e242aa store 1 ,mem_started_seid 
40c9 da200002 arg 2 ,rega 
40ca 20404106 call adv_malloc_rsp_accept 
40cb 70429600 jam avd_audio_forbid ,mem_audio_allow 
40cc 202048d4 branch l2cap_rx_reset_state 

avd_signal_parse_cmd_get_all_cap:
40cd efe20006 ifetch 1 ,contr 
40ce 1feb7e00 rshift2 pdata ,pdata 
40cf c080c101 bne avdtp_sep1 ,adv_signal_rsp_reject 
40d0 da200010 arg 16 ,rega 
40d1 20404106 call adv_malloc_rsp_accept 
40d2 58000001 setarg avdtp_category_media_trans 
40d3 e7e20005 istore 1 ,contw 
40d4 58000000 setarg 0 
40d5 e7e20005 istore 1 ,contw 
40d6 58000004 setarg avdtp_category_contect_protect 
40d7 e7e20005 istore 1 ,contw 
40d8 58000002 setarg 2 
40d9 e7e20005 istore 1 ,contw 
40da 58000002 setarg avd_cptype_scms_t 
40db e7e40005 istore 2 ,contw 
40dc 58000007 setarg avdtp_category_media_codec 
40dd e7e20005 istore 1 ,contw 
40de 58000006 setarg 0x06 
40df e7e20005 istore 1 ,contw 
40e0 6fec429b fetch 6 ,mem_avdtp_codec_type 
40e1 e7ec0005 istore 6 ,contw 
40e2 202048d4 branch l2cap_rx_reset_state 

avd_signal_parse_cmd_get_conf:

avd_signal_parse_cmd_reconfig:

avd_signal_parse_cmd_abort:

avd_signal_parse_cmd_security_control:

avd_signal_parse_cmd_delayreport:
40e3 20203b25 branch assert 

avd_signal_parse_general_reject:

avd_signal_parse_rsp_reject:
40e4 202048d4 branch l2cap_rx_reset_state 

avd_signal_parse_rsp_accept:
40e5 efe20006 ifetch 1 ,contr 
40e6 1fe17e3f and pdata ,0x3f ,pdata 
40e7 67e201e9 store 1 ,mem_avdtp_signal_cmd 
40e8 c000c0ed beq avdtp_identifier_discover ,avd_signal_parse_rsp_accept_discover 
40e9 c00140f4 beq avdtp_identifier_get_capabilities ,avd_signal_parse_rsp_accept_getcap 
40ea c001c0f8 beq avdtp_identifier_set_configuration ,avd_signal_parse_rsp_accept_setconf 
40eb c00340fc beq avdtp_identifier_open ,avd_sginal_parse_rsp_accept_open 
40ec 202048d4 branch l2cap_rx_reset_state 

avd_signal_parse_rsp_accept_discover:
40ed efe20006 ifetch 1 ,contr 
40ee 1feb7e00 rshift2 pdata ,pdata 
40ef 67e24298 store 1 ,mem_audio_src_endpoint 
40f0 efe20006 ifetch 1 ,contr 
40f1 202048d4 branch l2cap_rx_reset_state 

avd_signal_src_inuse:
40f2 204072bf call upper_reset_sm 
40f3 202048d4 branch l2cap_rx_reset_state 

avd_signal_parse_rsp_accept_getcap:
40f4 6fe24299 fetch 1 ,mem_audio_src_endpoint_state 
40f5 79207e00 set1 avd_src_endpoint_getcap ,pdata 
40f6 67e24299 store 1 ,mem_audio_src_endpoint_state 
40f7 202048d4 branch l2cap_rx_reset_state 

avd_signal_parse_rsp_accept_setconf:
40f8 6fe24299 fetch 1 ,mem_audio_src_endpoint_state 
40f9 79207e01 set1 avd_src_endpoint_setconf ,pdata 
40fa 67e24299 store 1 ,mem_audio_src_endpoint_state 
40fb 202048d4 branch l2cap_rx_reset_state 

avd_sginal_parse_rsp_accept_open:
40fc 6fe24299 fetch 1 ,mem_audio_src_endpoint_state 
40fd 79207e02 set1 avd_src_endpoint_open ,pdata 
40fe 67e24299 store 1 ,mem_audio_src_endpoint_state 
40ff 202048d4 branch l2cap_rx_reset_state 

avd_signal_prase_uncomplete:
4100 20204100 branch avd_signal_prase_uncomplete 

adv_signal_rsp_reject:
4101 44e14018 bpatch patch18_2 ,mem_patch18 
4102 da200002 arg 2 ,rega 
4103 20404aab call l2cap_malloc_server_channel 
4104 58000003 setarg avdtp_messgae_type_rsp_reject 
4105 20204109 branch adv_org_res 

adv_malloc_rsp_accept:
4106 44e1c018 bpatch patch18_3 ,mem_patch18 
4107 20404aab call l2cap_malloc_server_channel 
4108 58000002 setarg avdtp_messgae_type_rsp_accept 

adv_org_res:
4109 684201ea fetcht 1 ,mem_transaction_label 
410a 18520400 lshift4 temp ,temp 
410b 9841fe00 ior temp ,pdata 
410c e7e20005 istore 1 ,contw 
410d 6fe201e9 fetch 1 ,mem_avdtp_signal_cmd 
410e e7e20005 istore 1 ,contw 
410f 20600000 rtn 

adv_malloc_cmd:
4110 6fe201ea fetch 1 ,mem_transaction_label 
4111 1fe0fe01 increase 1 ,pdata 
4112 67e201ea store 1 ,mem_transaction_label 
4113 6b044292 fetchr regd ,2 ,mem_avdtpsignal_l2capch_ptr 
4114 20404aab call l2cap_malloc_server_channel 
4115 58000000 setarg avdtp_message_type_cmd 
4116 20204109 branch adv_org_res 

adv_signal_send_discover:
4117 7001e901 jam avdtp_identifier_discover ,mem_avdtp_signal_cmd 
4118 da200002 arg 2 ,rega 
4119 20204110 branch adv_malloc_cmd 

avd_signal_send_getcap:
411a 7001e902 jam avdtp_identifier_get_capabilities ,mem_avdtp_signal_cmd 
411b da200003 arg 3 ,rega 
411c 20404110 call adv_malloc_cmd 
411d 6fe24298 fetch 1 ,mem_audio_src_endpoint 
411e 1febfe00 lshift2 pdata ,pdata 
411f e7e20005 istore 1 ,contw 
4120 20600000 rtn 

avd_signal_send_setconf:
4121 7001e903 jam avdtp_identifier_set_configuration ,mem_avdtp_signal_cmd 
4122 da20000e arg 14 ,rega 
4123 20404110 call adv_malloc_cmd 
4124 6fe24298 fetch 1 ,mem_audio_src_endpoint 
4125 1febfe00 lshift2 pdata ,pdata 
4126 e7e20005 istore 1 ,contw 
4127 e7e20005 istore 1 ,contw 
4128 58070001 setarg 0x070001 
4129 e7e60005 istore 3 ,contw 
412a 58000006 setarg 0x000006 
412b e7e60005 istore 3 ,contw 
412c 58081521 setarg 0x081521 
412d e7e60005 istore 3 ,contw 
412e 58000023 setarg 35 
412f e7e20005 istore 1 ,contw 
4130 20600000 rtn 

avd_signal_send_open:
4131 7001e906 jam avdtp_identifier_open ,mem_avdtp_signal_cmd 
4132 da200003 arg 3 ,rega 
4133 20404110 call adv_malloc_cmd 
4134 6fe24298 fetch 1 ,mem_audio_src_endpoint 
4135 1febfe00 lshift2 pdata ,pdata 
4136 e7e20005 istore 1 ,contw 
4137 20600000 rtn 

app_init:
4138 44e24018 bpatch patch18_4 ,mem_patch18 
4139 6fe24132 fetch 1 ,mem_device_option 
413a 203a4138 branch app_init ,blank 
413b c000c341 beq dvc_op_hci ,hci_init 
413c c07fbcf9 beq dvc_op_test ,test_init 
413d c007c464 beq dvc_op_headset ,hfp_hsp_init 
413e 20600000 rtn 

app_lpm_init:
413f 44e2c018 bpatch patch18_5 ,mem_patch18 
4140 70011400 jam 0 ,mem_tester_emulate 
4141 70014a00 jam 0 ,mem_debug_config 
4142 70014b00 jam 0 ,mem_lch_code 
4143 58000000 setarg 0 
4144 67ea0a1f store 5 ,mem_sp_state_start 
4145 20600000 rtn 

app_process_idle:
4146 20407167 call ui_dispatch 
4147 20407206 call check_51cmd 
4148 2040414f call app_process_bb_event 
4149 6fe442c3 fetch 2 ,mem_cb_idle_process 
414a 20207897 branch callback_func 

app_process_bt:
414b 6fe442c1 fetch 2 ,mem_cb_bt_process 
414c 20207897 branch callback_func 

app_process_ble:
414d 6fe442bf fetch 2 ,mem_cb_le_process 
414e 20207897 branch callback_func 

app_process_bb_event:
414f 44e34018 bpatch patch18_6 ,mem_patch18 
4150 da2046af arg mem_ipc_fifo_bt2c51 ,rega 
4151 204078c9 call fifo_out 
4152 207a0000 rtn blank 
4153 1fe22600 copy pdata ,regc 
4154 20404158 call app_event_normal_process 
4155 2020417c branch app_process_bb_event_priority 

app_discard_event:
4156 da600000 arg 0 ,regc 
4157 20600000 rtn 

app_event_normal_process:
4158 c000c169 beq bt_evt_bb_connected ,app_evt_bt_conn 
4159 c00841af beq bt_evt_button_long_pressed ,app_evt_button_long_pressed 
415a c002c18d beq bt_evt_setup_complete ,app_evt_setup_complete 
415b c0094194 beq bt_evt_hid_handshake ,app_evt_hid_handshake 
415c c00341ab beq bt_evt_hid_connected ,app_bb_event_hid_connected 
415d c00241dd beq bt_evt_reconn_failed ,app_bb_event_reconn_failed 
415e c00141e2 beq bt_evt_bb_disconnected ,app_bb_event_bb_disconn 
415f c009c1dd beq bt_evt_reconn_page_timeout ,app_bb_event_reconn_failed 
4160 c00a41a3 beq bt_evt_le_connected ,app_le_event_bb_connected 
4161 c00ac1a7 beq bt_evt_le_disconnected ,app_le_event_bb_disconn 
4162 c001c186 beq bt_evt_reconn_started ,app_event_reconn_start 
4163 c005c198 beq bt_evt_enter_sniff ,app_event_enter_sniff 
4164 c006419f beq bt_evt_exit_sniff ,app_event_exit_sniff 
4165 c00c4182 beq bt_evt_linkkey_generate ,app_event_linkkey_generate 
4166 c0154172 beq bt_evt_switch_fail_master ,app_event_switch_fail_master 
4167 c015c170 beq bt_evt_switch_success_master ,app_event_switch_success 
4168 20600000 rtn 

app_evt_bt_conn:
4169 6fe446c1 fetch 2 ,mem_ui_state_map 
416a 79207e00 set1 ui_state_bt_connected ,pdata 
416b 67e446c1 store 2 ,mem_ui_state_map 
416c 6fe442da fetch app_disc_rsn_size ,mem_app_disconn_reason_flag 
416d 793ffe00 set0 app_disc_by_button ,pdata 
416e 67e442da store app_disc_rsn_size ,mem_app_disconn_reason_flag 
416f 20600000 rtn 

app_event_switch_success:
4170 70022500 jam 0 ,mem_switch_fail_master_count 
4171 20600000 rtn 

app_event_switch_fail_master:
4172 6fe20225 fetch 1 ,mem_switch_fail_master_count 
4173 1fe0fe01 increase 1 ,pdata 
4174 67e20225 store 1 ,mem_switch_fail_master_count 
4175 1fe67c01 sub pdata ,1 ,null 
4176 20214228 branch app_bt_role_switch ,positive 
4177 70022500 jam 0 ,mem_switch_fail_master_count 
4178 6fe442da fetch app_disc_rsn_size ,mem_app_disconn_reason_flag 
4179 79207e09 set1 app_disc_switch_fail ,pdata 
417a 67e442da store app_disc_rsn_size ,mem_app_disconn_reason_flag 
417b 20204231 branch app_bt_disconnect 

app_process_bb_event_priority:
417c 6fe442c5 fetch 2 ,mem_cb_bb_event_process 
417d 20207897 branch callback_func 

app_check_wake_lock:
417e 6fe442b9 fetch 2 ,mem_cb_check_wakelock 
417f 20207897 branch callback_func 

app_will_enter_lpm:
4180 6fe442bd fetch 2 ,mem_cb_before_lpm 
4181 20207897 branch callback_func 

app_event_linkkey_generate:
4182 6fe442da fetch app_disc_rsn_size ,mem_app_disconn_reason_flag 
4183 79207e01 set1 app_disc_after_pairing ,pdata 
4184 67e442da store app_disc_rsn_size ,mem_app_disconn_reason_flag 
4185 20204253 branch app_bt_store_reconn_info 

app_event_reconn_start:
4186 6fe446c1 fetch 2 ,mem_ui_state_map 
4187 79207e07 set1 ui_state_bt_reconnect ,pdata 
4188 67e446c1 store 2 ,mem_ui_state_map 
4189 6fe442da fetch app_disc_rsn_size ,mem_app_disconn_reason_flag 
418a 79207e02 set1 app_disc_after_reconn ,pdata 
418b 67e442da store app_disc_rsn_size ,mem_app_disconn_reason_flag 
418c 20600000 rtn 

app_evt_setup_complete:
418d 6fe446c1 fetch 2 ,mem_ui_state_map 
418e 79207e01 set1 ui_state_bt_setup_complete ,pdata 
418f 67e446c1 store 2 ,mem_ui_state_map 
4190 6fe442da fetch app_disc_rsn_size ,mem_app_disconn_reason_flag 
4191 79207e04 set1 app_disc_after_setup_done ,pdata 
4192 67e442da store app_disc_rsn_size ,mem_app_disconn_reason_flag 
4193 20600000 rtn 

app_evt_hid_handshake:
4194 6fe446c1 fetch 2 ,mem_ui_state_map 
4195 79207e03 set1 ui_state_bt_hid_handshake ,pdata 
4196 67e446c1 store 2 ,mem_ui_state_map 
4197 20600000 rtn 

app_event_enter_sniff:
4198 6fe446c1 fetch 2 ,mem_ui_state_map 
4199 79207e05 set1 ui_state_bt_sniff ,pdata 
419a 67e446c1 store 2 ,mem_ui_state_map 
419b 6fe442da fetch app_disc_rsn_size ,mem_app_disconn_reason_flag 
419c 79207e03 set1 app_disc_after_sniff ,pdata 
419d 67e442da store app_disc_rsn_size ,mem_app_disconn_reason_flag 
419e 20600000 rtn 

app_event_exit_sniff:
419f 6fe446c1 fetch 2 ,mem_ui_state_map 
41a0 793ffe05 set0 ui_state_bt_sniff ,pdata 
41a1 67e446c1 store 2 ,mem_ui_state_map 
41a2 20600000 rtn 

app_le_event_bb_connected:
41a3 6fe446c1 fetch 2 ,mem_ui_state_map 
41a4 79207e09 set1 ui_state_ble_connected ,pdata 
41a5 67e446c1 store 2 ,mem_ui_state_map 
41a6 20600000 rtn 

app_le_event_bb_disconn:
41a7 6fe446c1 fetch 2 ,mem_ui_state_map 
41a8 793ffe09 set0 ui_state_ble_connected ,pdata 
41a9 67e446c1 store 2 ,mem_ui_state_map 
41aa 20204257 branch app_lpm_mult_disable 

app_bb_event_hid_connected:
41ab 6fe446c1 fetch 2 ,mem_ui_state_map 
41ac 79207e02 set1 ui_state_bt_hid_conn ,pdata 
41ad 67e446c1 store 2 ,mem_ui_state_map 
41ae 20600000 rtn 

app_evt_button_long_pressed:
41af 6fe442da fetch app_disc_rsn_size ,mem_app_disconn_reason_flag 
41b0 79207e00 set1 app_disc_by_button ,pdata 
41b1 67e442da store app_disc_rsn_size ,mem_app_disconn_reason_flag 
41b2 20600000 rtn 

app_evt_timer:
41b3 67e20226 store 1 ,mem_app_evt_timer_count 
41b4 44e3c018 bpatch patch18_7 ,mem_patch18 

app_evt_100ms_loop:
41b5 6fe20226 fetch 1 ,mem_app_evt_timer_count 
41b6 207a0000 rtn blank 
41b7 1fe0ffff increase -1 ,pdata 
41b8 67e20226 store 1 ,mem_app_evt_timer_count 
41b9 204041bc call app_check_tws_master_connected_timeout 
41ba 204041c5 call app_check_tws_pairing_timeout 
41bb 202041b5 branch app_evt_100ms_loop 

app_check_tws_master_connected_timeout:
41bc 6fe446f1 fetch 2 ,mem_wait_connected_timeout_count 
41bd 207a0000 rtn blank 
41be 1fe0fe01 increase 1 ,pdata 
41bf 67e446f1 store 2 ,mem_wait_connected_timeout_count 
41c0 247a0000 nrtn blank 
41c1 6fe246ea fetch 1 ,mem_tws_state 
41c2 793ffe03 set0 tws_state_connected ,pdata 
41c3 67e246ea store 1 ,mem_tws_state 
41c4 20600000 rtn 

app_check_tws_pairing_timeout:
41c5 6fe446ed fetch 2 ,mem_tws_pairing_timeout_count 
41c6 207a0000 rtn blank 
41c7 1fe0fe01 increase 1 ,pdata 
41c8 67e446ed store 2 ,mem_tws_pairing_timeout_count 
41c9 247a0000 nrtn blank 
41ca 6fe246ea fetch 1 ,mem_tws_state 
41cb 793ffe01 set0 tws_state_pairing ,pdata 
41cc 67e246ea store 1 ,mem_tws_state 
41cd 20600000 rtn 

timer_l2cap_nochannel_disconnect:
41ce da604395 arg mem_l2cap_channel_disconnect_timer ,regc 
41cf 204041d6 call timer_single_step 
41d0 24740000 nrtn user 
41d1 20204231 branch app_bt_disconnect 

timer_l2cap_reconnect_audio:
41d2 da60429a arg mem_a2dp_reconnct_delay_timer ,regc 
41d3 204041d6 call timer_single_step 
41d4 24740000 nrtn user 
41d5 202072c5 branch upper_int_reconnect_audio 

timer_single_step:
41d6 78547c00 disable user 
41d7 efe20013 ifetch 1 ,regc 
41d8 207a0000 rtn blank 
41d9 1fe0ffff increase -1 ,pdata 
41da e7e20013 istore 1 ,regc 
41db 247a0000 nrtn blank 
41dc 20207903 branch enable_user 

app_bb_event_reconn_failed:
41dd 204041f4 call app_disconn_reason_flag_clear 
41de 6fe446c1 fetch 2 ,mem_ui_state_map 
41df 793ffe07 set0 ui_state_bt_reconnect ,pdata 
41e0 67e446c1 store 2 ,mem_ui_state_map 
41e1 20600000 rtn 

app_bb_event_bb_disconn:
41e2 6fe446c1 fetch 2 ,mem_ui_state_map 
41e3 c283c1e6 bbit1 ui_state_bt_reconnect ,app_bb_event_bb_reconn_disconn 
41e4 2fec0001 isolate0 ui_state_bt_setup_complete ,pdata 
41e5 2040c156 call app_discard_event ,true 

app_bb_event_bb_reconn_disconn:
41e6 6fe446c1 fetch 2 ,mem_ui_state_map 
41e7 793ffe00 set0 ui_state_bt_connected ,pdata 
41e8 793ffe01 set0 ui_state_bt_setup_complete ,pdata 
41e9 793ffe02 set0 ui_state_bt_hid_conn ,pdata 
41ea 793ffe03 set0 ui_state_bt_hid_handshake ,pdata 
41eb 793ffe04 set0 ui_state_bt_spp_conn ,pdata 
41ec 67e446c1 store 2 ,mem_ui_state_map 
41ed 20407a8e call tws_clear_connected_info 
41ee 20204257 branch app_lpm_mult_disable 

app_bb_hibernate:
41ef 204041f1 call app_disconn_reason_clear 
41f0 2020424b branch app_enter_hibernate 

app_event_do_nothing:

app_disconn_reason_clear:
41f1 58000000 setarg 0 
41f2 67e442d8 store app_disc_rsn_size ,mem_app_disconn_reason 
41f3 20600000 rtn 

app_disconn_reason_flag_clear:
41f4 58000000 setarg 0 
41f5 67e442da store app_disc_rsn_size ,mem_app_disconn_reason_flag 
41f6 20600000 rtn 

app_disconn_reason_collect_bt:
41f7 6fe442da fetch app_disc_rsn_size ,mem_app_disconn_reason_flag 
41f8 67e442d8 store app_disc_rsn_size ,mem_app_disconn_reason 
41f9 58000000 setarg 0 
41fa 67e442da store app_disc_rsn_size ,mem_app_disconn_reason_flag 
41fb 20600000 rtn 

app_disconn_reason_collect_ble:
41fc 6fe442da fetch app_disc_rsn_size ,mem_app_disconn_reason_flag 
41fd 79207e07 set1 app_disc_ble ,pdata 
41fe 67e442d8 store app_disc_rsn_size ,mem_app_disconn_reason 
41ff 58000000 setarg 0 
4200 67e442da store app_disc_rsn_size ,mem_app_disconn_reason_flag 
4201 20600000 rtn 

app_le_check_reconn_target:
4202 6fe24456 fetch 1 ,mem_ltk_exists 
4203 203a4206 branch app_le_check_reconn_target_none ,blank 
4204 20404249 call app_led_on 
4205 20204238 branch app_ble_start_direct_adv 

app_le_check_reconn_target_none:
4206 20404248 call app_led_start_blink 
4207 2020423e branch app_ble_start_adv 

app_check_plap:
4208 44e44019 bpatch patch19_0 ,mem_patch19 
4209 da400210 arg mem_check_plap_temp ,regb 
420a da60420c arg app_check_one_plap ,regc 
420b 20203292 branch context_search 

app_check_one_plap:
420c d8400000 arg 0 ,temp 
420d c3004210 bbit0 state_inconn ,app_check_one_plap_next 
420e 1a208c10 add rega ,coffset_plap ,contr 
420f e84c0006 ifetcht 6 ,contr 

app_check_one_plap_next:
4210 18427e00 copy temp ,pdata 
4211 245a4215 ncall app_check_one_plap_device_exist ,blank 
4212 e04c0012 istoret 6 ,regb 
4213 1a40a406 increase 6 ,regb 
4214 20203297 branch context_search_next 

app_check_one_plap_device_exist:
4215 6fe242c7 fetch 1 ,mem_device_nums 
4216 1fe0fe01 increase 1 ,pdata 
4217 67e242c7 store 1 ,mem_device_nums 
4218 20600000 rtn 

app_check_conn_device_nums_addr:
4219 7042c700 jam 0 ,mem_device_nums 
421a 20204208 branch app_check_plap 

app_check_sniff:
421b 6fe246c1 fetch 1 ,mem_ui_state_map 
421c 2feffe05 isolate1 ui_state_bt_sniff ,pdata 
421d 20600000 rtn 

app_get_lpm_wake_lock:
421e d8e00009 arg wake_lock_app ,queue 
421f 20203cac branch lpm_get_wake_lock 

app_put_lpm_wake_lock:
4220 d8e00009 arg wake_lock_app ,queue 
4221 20203cb0 branch lpm_put_wake_lock 

app_l2cap_flow_control_enable:
4222 7043a501 jam l2cap_flow_ctrl_enable ,mem_l2cap_flow_ctrl_flag 
4223 20600000 rtn 

app_l2cap_flow_control_disable:
4224 7043a500 jam l2cap_flow_ctrl_disable ,mem_l2cap_flow_ctrl_flag 
4225 20600000 rtn 

app_bt_set_pincode:
4226 700b080a jam bt_cmd_set_pin_code ,mem_fifo_temp 
4227 202071f8 branch ui_ipc_send_cmd 

app_bt_role_switch:
4228 700b081d jam bt_cmd_role_switch ,mem_fifo_temp 
4229 202071f8 branch ui_ipc_send_cmd 

app_bt_start_reconnect:
422a 6fe242d7 fetch 1 ,mem_app_connection_options 
422b 67e20138 store 1 ,mem_connection_options 
422c 70427001 jam 1 ,mem_link_key_exists 
422d 700b0803 jam bt_cmd_reconnect ,mem_fifo_temp 
422e 202071f8 branch ui_ipc_send_cmd 

app_bt_reconnect_cancel:
422f 700b081e jam bt_cmd_bb_reconn_cancel ,mem_fifo_temp 
4230 202071f8 branch ui_ipc_send_cmd 

app_bt_disconnect:
4231 700b0804 jam bt_cmd_disconnect ,mem_fifo_temp 
4232 202071f8 branch ui_ipc_send_cmd 

app_bt_start_discovery_short:
4233 20404248 call app_led_start_blink 

app_bt_start_discovery:
4234 700b0801 jam bt_cmd_start_discovery ,mem_fifo_temp 
4235 202071f8 branch ui_ipc_send_cmd 

app_bt_stop_discovery:
4236 700b0802 jam bt_cmd_stop_discovery ,mem_fifo_temp 
4237 202071f8 branch ui_ipc_send_cmd 

app_ble_start_direct_adv:
4238 700b080f jam bt_cmd_start_direct_adv ,mem_fifo_temp 
4239 202071f8 branch ui_ipc_send_cmd 

app_ble_stop_direct_adv:
423a 700b0810 jam bt_cmd_stop_direct_adv ,mem_fifo_temp 
423b 202071f8 branch ui_ipc_send_cmd 

app_ble_stop_adv:
423c 700b080e jam bt_cmd_stop_adv ,mem_fifo_temp 
423d 202071f8 branch ui_ipc_send_cmd 

app_ble_start_adv:
423e 700b080d jam bt_cmd_start_adv ,mem_fifo_temp 
423f 202071f8 branch ui_ipc_send_cmd 

app_ble_start_scan:
4240 700b0817 jam bt_cmd_le_start_scan ,mem_fifo_temp 
4241 202071f8 branch ui_ipc_send_cmd 

app_ble_stop_scan:
4242 700b0818 jam bt_cmd_le_stop_scan ,mem_fifo_temp 
4243 202071f8 branch ui_ipc_send_cmd 

app_ble_start_conn:
4244 700b0816 jam bt_cmd_le_start_conn ,mem_fifo_temp 
4245 202071f8 branch ui_ipc_send_cmd 

app_ble_disconnect:
4246 700b0811 jam bt_cmd_le_disconnect ,mem_fifo_temp 
4247 202071f8 branch ui_ipc_send_cmd 

app_led_start_blink:
4248 202071b1 branch ui_led_blink_start 

app_led_on:
4249 202071ab branch ui_led_on 

app_led_stop_blink:

app_led_off:
424a 202071a2 branch ui_led_blink_stop 

app_enter_hibernate:
424b 700b0819 jam bt_cmd_enter_hibernate ,mem_fifo_temp 
424c 202071f8 branch ui_ipc_send_cmd 

app_bt_sniff_exit:
424d 700b0806 jam bt_cmd_exit_sniff ,mem_fifo_temp 
424e 202071f8 branch ui_ipc_send_cmd 

app_bt_enter_sniff:
424f 700b0805 jam bt_cmd_enter_sniff ,mem_fifo_temp 
4250 202071f8 branch ui_ipc_send_cmd 

app_ble_store_reconn_info:
4251 700b081f jam bt_cmd_store_reconn_info_le ,mem_fifo_temp 
4252 202071f8 branch ui_ipc_send_cmd 

app_bt_store_reconn_info:
4253 700b0820 jam bt_cmd_store_reconn_info_bt ,mem_fifo_temp 
4254 202071f8 branch ui_ipc_send_cmd 

app_lpm_mult_enable:
4255 7920000d set1 mark_lpm_mult_enable ,mark 
4256 20600000 rtn 

app_lpm_mult_disable:
4257 793f800d set0 mark_lpm_mult_enable ,mark 
4258 20600000 rtn 

app_bt_esco_req:
4259 700b0823 jam bt_cmd_est_esco_req ,mem_fifo_temp 
425a 202071f8 branch ui_ipc_send_cmd 

app_bt_rmv_esco_req:
425b 700b0824 jam bt_cmd_rmv_esco_req ,mem_fifo_temp 
425c 202071f8 branch ui_ipc_send_cmd 

app_bt_sco_req:
425d 700b0825 jam bt_cmd_est_sco_req ,mem_fifo_temp 
425e 202071f8 branch ui_ipc_send_cmd 

app_bt_rmv_sco_req:
425f 700b0826 jam bt_cmd_rmv_sco_req ,mem_fifo_temp 
4260 202071f8 branch ui_ipc_send_cmd 

l2cap_call_proc_avctp:
4261 202048d4 branch l2cap_rx_reset_state 

avc_send_get_cap:
4262 20600000 rtn 

avc_malloc_tx_buff:
4263 44e4c019 bpatch patch19_1 ,mem_patch19 
4264 6fe242e6 fetch 1 ,mem_avctp_trans_lable 
4265 1fe0fe01 increase 1 ,pdata 
4266 67e242e6 store 1 ,mem_avctp_trans_lable 
4267 20404aab call l2cap_malloc_server_channel 
4268 6fe242e6 fetch 1 ,mem_avctp_trans_lable 
4269 1fe17e0f and pdata ,0xf ,pdata 
426a 1ff27e00 lshift4 pdata ,pdata 
426b e7e20005 istore 1 ,contw 
426c 58000e11 setarg actp_profile_identifier_avrcp 
426d e7e40005 istore 2 ,contw 
426e 20600000 rtn 

avc_send_avr_vd_get_cap:
426f 44e54019 bpatch patch19_2 ,mem_patch19 
4270 6fe442e8 fetch 2 ,mem_avr_l2capch_ptr 
4271 207a0000 rtn blank 
4272 1fe23000 copy pdata ,regd 
4273 1b008c01 add regd ,offset_lc_state ,contr 
4274 efe20006 ifetch 1 ,contr 
4275 c19f8000 rtnne 0x3f 
4276 6fe242e7 fetch 1 ,mem_avr_state 
4277 c3800000 rtnbit1 avctp_get_cap_req 

avr_send_vd_get_cap:
4278 6fe242e7 fetch 1 ,mem_avr_state 
4279 79207e00 set1 avctp_get_cap_req ,pdata 
427a 67e242e7 store 1 ,mem_avr_state 
427b da20000e arg 14 ,rega 
427c 20404263 call avc_malloc_tx_buff 
427d 58000001 setarg avrcp_cmd_type_status 
427e e7e20005 istore 1 ,contw 
427f 58000009 setarg avrcp_submit_type_panel 
4280 1fe9fe00 lshift3 pdata ,pdata 
4281 1fe2fe00 xor pdata ,avrcp_submit_id_0 ,pdata 
4282 e7e20005 istore 1 ,contw 
4283 58000000 setarg avrcp_opera_code_vendor_dependent 
4284 e7e20005 istore 1 ,contw 
4285 58581900 setarg avrcp_op_company_sig 
4286 e7e60005 istore 3 ,contw 
4287 58000010 setarg avrcp_op_pdu_get_cap 
4288 e7e20005 istore 1 ,contw 
4289 58000000 setarg avrcp_op_packet_type_non_fra 
428a e7e20005 istore 1 ,contw 
428b 58000001 setarg 1 
428c 1ff0fe00 byteswap pdata ,pdata 
428d e7e40005 istore 2 ,contw 
428e 58000003 setarg avrcp_op_cap_evt_support 

istore_byte:
428f e7e20005 istore 1 ,contw 
4290 20600000 rtn 

avr_send_vd_playback_status_change:
4291 6fe442e8 fetch 2 ,mem_avr_l2capch_ptr 
4292 207a0000 rtn blank 
4293 1fe23000 copy pdata ,regd 
4294 da200012 arg 18 ,rega 
4295 20404263 call avc_malloc_tx_buff 
4296 58000003 setarg avrcp_cmd_type_notify 
4297 e7e20005 istore 1 ,contw 
4298 58000009 setarg avrcp_submit_type_panel 
4299 1fe9fe00 lshift3 pdata ,pdata 
429a 1fe2fe00 xor pdata ,avrcp_submit_id_0 ,pdata 
429b e7e20005 istore 1 ,contw 
429c 58000000 setarg avrcp_opera_code_vendor_dependent 
429d e7e20005 istore 1 ,contw 
429e 58581900 setarg avrcp_op_company_sig 
429f e7e60005 istore 3 ,contw 
42a0 58000031 setarg avrcp_op_pdu_rigister_notify 
42a1 e7e20005 istore 1 ,contw 
42a2 e7e20005 istore 1 ,contw 
42a3 58000000 setarg avrcp_op_packet_type_non_fra 
42a4 58000005 setarg 5 
42a5 e7e40005 istore 2 ,contw 
42a6 58000001 setarg avrcp_op_cap_evt_status_chnaged 
42a7 e7e20005 istore 1 ,contw 
42a8 58000000 setarg 0 
42a9 e7e80005 istore 4 ,contw 
42aa 20600000 rtn 

avrcp_press:

arc_send_ct:
42ab 6fe442e8 fetch 2 ,mem_avr_l2capch_ptr 
42ac 207a0000 rtn blank 
42ad 1fe23000 copy pdata ,regd 
42ae da200008 arg 8 ,rega 
42af 20404263 call avc_malloc_tx_buff 
42b0 58000000 setarg avrcp_cmd_type_control 
42b1 e7e20005 istore 1 ,contw 
42b2 58000009 setarg avrcp_submit_type_panel 
42b3 1fe9fe00 lshift3 pdata ,pdata 
42b4 1fe2fe00 xor pdata ,avrcp_submit_id_0 ,pdata 
42b5 e7e20005 istore 1 ,contw 
42b6 5800007c setarg avrcp_opera_code_pass_through 
42b7 e7e20005 istore 1 ,contw 
42b8 1ee27e00 copy rege ,pdata 
42b9 e7e20005 istore 1 ,contw 
42ba 58000000 setarg 0 
42bb e7e20005 istore 1 ,contw 
42bc 20600000 rtn 

cvsd_init:
42bd 44e5c019 bpatch patch19_3 ,mem_patch19 
42be 20405e36 call init_filter_ram 
42bf 58010000 setarg pcm_in_buffer_addr 
42c0 67e480fc store 2 ,core_pcmin_saddr 
42c1 58000708 setarg cvsd_in_max_len 
42c2 1fe3f200 lshift pdata ,loopcnt 
42c3 d8a10000 arg pcm_in_buffer_addr ,contw 
42c4 204042f6 call cvsd_set_0x00 
42c5 58012000 setarg cvsd_out_buffer_addr 
42c6 67e480f8 store 2 ,core_cvsdout_saddr 
42c7 67e442f0 store 2 ,mem_cvsd_out_addr_ptr 
42c8 df200708 arg cvsd_in_max_len ,loopcnt 
42c9 9f20fe00 iadd loopcnt ,pdata 
42ca 67e442ee store 2 ,mem_cvsd_out_addr_end 
42cb d8a12000 arg cvsd_out_buffer_addr ,contw 
42cc 204042f2 call cvsd_set_0x55 
42cd 58012710 setarg cvsd_in_buffer_addr 
42ce 67e480f6 store 2 ,core_cvsdin_saddr 
42cf 67e442ec store 2 ,mem_cvsd_in_addr_ptr 
42d0 df200708 arg cvsd_in_max_len ,loopcnt 
42d1 9f20fe00 iadd loopcnt ,pdata 
42d2 67e442ea store 2 ,mem_cvsd_in_addr_end 
42d3 d8a12710 arg cvsd_in_buffer_addr ,contw 
42d4 204042f2 call cvsd_set_0x55 
42d5 58011000 setarg pcm_out_buffer_addr 
42d6 67e480fe store 2 ,core_pcmout_saddr 
42d7 58000708 setarg cvsd_in_max_len 
42d8 1fe3f200 lshift pdata ,loopcnt 
42d9 d8a11000 arg pcm_out_buffer_addr ,contw 
42da 204042f6 call cvsd_set_0x00 
42db 58000708 setarg cvsd_in_max_len 

cvsd_init_end:
42dc 1fe0ffff increase -1 ,pdata 
42dd 67e480fa store 2 ,core_cvsd_len 
42de 580000c0 setarg 0xc0 
42df 67e280f5 store 1 ,core_cvsd_ctrl 
42e0 20600000 rtn 

cvsd_start:
42e1 44e64019 bpatch patch19_4 ,mem_patch19 
42e2 6fe280f5 fetch 1 ,core_cvsd_ctrl 
42e3 79207e00 set1 cvsd_enable ,pdata 
42e4 79207e07 set1 cvsd_dma_enable ,pdata 

cvsd_write_ctrl:
42e5 67e280f5 store 1 ,core_cvsd_ctrl 
42e6 20600000 rtn 

cvsd_stop:
42e7 44e6c019 bpatch patch19_5 ,mem_patch19 
42e8 6fe280f5 fetch 1 ,core_cvsd_ctrl 
42e9 793ffe00 set0 cvsd_enable ,pdata 
42ea 793ffe07 set0 cvsd_dma_enable ,pdata 
42eb 202042e5 branch cvsd_write_ctrl 

cvsd_read_pcmout_ptr:
42ec 6fe28360 fetch 1 ,core_scs_rdata + 2 
42ed 6fe48364 fetch 2 ,core_pcmout_ptr 
42ee 20600000 rtn 

cvsd_push_0x55_to_cvsd_fifo:
42ef 58000168 setarg cvsd_max_packet_len 
42f0 204042f8 call cvsd_push_cvsd_in_fifo_ptr 
42f1 df200168 arg cvsd_max_packet_len ,loopcnt 

cvsd_set_0x55:
42f2 58000055 setarg 0x55 

cvsd_set_mem_loop:
42f3 e7e20005 istore 1 ,contw 
42f4 c20042f3 loop cvsd_set_mem_loop 
42f5 20600000 rtn 

cvsd_set_0x00:
42f6 58000000 setarg 0 
42f7 202042f3 branch cvsd_set_mem_loop 

cvsd_push_cvsd_in_fifo_ptr:
42f8 6a2442ec fetchr rega ,2 ,mem_cvsd_in_addr_ptr 
42f9 9a20fe00 iadd rega ,pdata 
42fa 684442ea fetcht 2 ,mem_cvsd_in_addr_end 
42fb 98467c00 isub temp ,null 
42fc 242142fe nbranch cvsd_push_cvsd_in_fifo_end ,positive 
42fd 6fe480f6 fetch 2 ,core_cvsdin_saddr 

cvsd_push_cvsd_in_fifo_end:
42fe 67e442ec store 2 ,mem_cvsd_in_addr_ptr 
42ff 6fe280f5 fetch 1 ,core_cvsd_ctrl 
4300 c3034302 bbit0 cvsd_sel_mram ,cvsd_push_cvsd_in_fifo_xram 

cvsd_push_cvsd_in_fifo_mram:
4301 79202210 set1 mram_high_bit ,rega 

cvsd_push_cvsd_in_fifo_xram:
4302 1a220a00 copy rega ,contw 
4303 20600000 rtn 

cvsd_get_cvsd_out_ptr:
4304 6a2442f0 fetchr rega ,2 ,mem_cvsd_out_addr_ptr 
4305 6fe280f5 fetch 1 ,core_cvsd_ctrl 
4306 c3034308 bbit0 cvsd_sel_mram ,cvsd_get_cvsd_out_xram 
4307 79202210 set1 mram_high_bit ,rega 

cvsd_get_cvsd_out_xram:
4308 20204313 branch cvsd_push_cvsd_out_fifo_xram 

cvsd_pop_cvsd_out_fifo_ptr:
4309 6a2442f0 fetchr rega ,2 ,mem_cvsd_out_addr_ptr 
430a 9a20fe00 iadd rega ,pdata 
430b 684442ee fetcht 2 ,mem_cvsd_out_addr_end 
430c 98467c00 isub temp ,null 
430d 2421430f nbranch cvsd_push_cvsd_out_fifo_end ,positive 
430e 6fe480f8 fetch 2 ,core_cvsdout_saddr 

cvsd_push_cvsd_out_fifo_end:
430f 67e442f0 store 2 ,mem_cvsd_out_addr_ptr 
4310 6fe280f5 fetch 1 ,core_cvsd_ctrl 
4311 c3034313 bbit0 cvsd_sel_mram ,cvsd_push_cvsd_out_fifo_xram 

cvsd_push_cvsd_out_fifo_mram:
4312 79202210 set1 mram_high_bit ,rega 

cvsd_push_cvsd_out_fifo_xram:
4313 1a220c00 copy rega ,contr 
4314 20600000 rtn 

cvsd_check_decoded_data:
4315 6fe280f5 fetch 1 ,core_cvsd_ctrl 
4316 c4000000 rtnbit0 cvsd_enable 
4317 204042ec call cvsd_read_pcmout_ptr 
4318 793ffe10 set0 16 ,pdata 
4319 68448104 fetcht 2 ,core_dac_wptr 
431a 98467c00 isub temp ,null 
431b 20628000 rtn zero 
431c 2020478b branch hfp_dac_updatewptr 

push_cvsd_data_to_dec:
431d 44e74019 bpatch patch19_6 ,mem_patch19 
431e 20404315 call cvsd_check_decoded_data 
431f c6958000 rtnmark0 mark_sco_flag 
4320 6fe44303 fetch 2 ,mem_sco_rx_packet_len 
4321 204042f8 call cvsd_push_cvsd_in_fifo_ptr 
4322 6f244303 fetchr loopcnt ,2 ,mem_sco_rx_packet_len 
4323 6fe20308 fetch 1 ,mem_sco_flag 
4324 c30042f2 bbit0 sco_rcv_flag ,cvsd_set_0x55 
4325 d8c00262 arg mem_sco_indata ,contr 
4326 2020779f branch memcpy 

pop_cvsd_data:
4327 44e7c019 bpatch patch19_7 ,mem_patch19 
4328 20404309 call cvsd_pop_cvsd_out_fifo_ptr 
4329 18c22200 copy contr ,rega 
432a 6f244305 fetchr loopcnt ,2 ,mem_sco_tx_packet_len 
432b d8a0029e arg mem_sco_outdata ,contw 
432c 1a220c00 copy rega ,contr 
432d 2020779f branch memcpy 

pop_cvsd_data_send:
432e 44e8401a bpatch patch1a_0 ,mem_patch1a 
432f c6958000 rtnmark0 mark_sco_flag 
4330 6fe442ee fetch 2 ,mem_cvsd_out_addr_end 
4331 684480f8 fetcht 2 ,core_cvsdout_saddr 
4332 98467200 isub temp ,loopcnt 
4333 684442f0 fetcht 2 ,mem_cvsd_out_addr_ptr 
4334 6fe48368 fetch 2 ,core_cvsdout_ptr 
4335 98462200 isub temp ,rega 
4336 20628000 rtn zero 
4337 2021433d branch check_decoded_data_len ,positive 
4338 1fe22200 icopy rega 
4339 18427e00 copy temp ,pdata 
433a 9a262200 isub rega ,rega 
433b 1f227e00 copy loopcnt ,pdata 
433c 9a262200 isub rega ,rega 

check_decoded_data_len:
433d 6fe44305 fetch 2 ,mem_sco_tx_packet_len 
433e 9a267c00 isub rega ,null 
433f 20610000 rtn positive 
4340 20204327 branch pop_cvsd_data 

hci_init:
4341 20600000 rtn 

process_cmd:
4342 6fe24284 fetch 1 ,mem_hci_cmd 
4343 207a0000 rtn blank 
4344 6fe2007c fetch 1 ,mem_lmo_opcode2 
4345 247a0000 nrtn blank 
4346 20404366 call cmd_check_plap 
4347 2422c355 nbranch process_cmd_conn_handle ,zero 
4348 6fe24284 fetch 1 ,mem_hci_cmd 
4349 c001c37c beq hci_cmd_remote_name_req ,cmd_namereq 
434a c004c382 beq hci_cmd_pair ,cmd_pair 
434b c005438e beq hci_cmd_nopair ,cmd_nopair 
434c c005c394 beq hci_cmd_linkkey ,cmd_has_key 
434d c006439e beq hci_cmd_nokey ,cmd_no_key 
434e c00443dc beq hci_cmd_reject_conn ,cmd_disconn 
434f c00c4374 beq hci_cmd_role_switch ,cmd_role_switch 
4350 c003c36e beq hci_cmd_accept_conn ,cmd_accept_conn 
4351 c00cc372 beq hci_cmd_accept_with_switch ,cmd_accept_with_switch 
4352 c00d43f3 beq hci_cmd_detach ,cmd_detach 
4353 c00943bc beq hci_cmd_in_sniff ,cmd_in_sniff 
4354 c009c3d4 beq hci_cmd_exit_sniff ,cmd_exit_sniff 

process_cmd_conn_handle:
4355 2040436a call cmd_check_handle 
4356 247a0000 nrtn blank 
4357 6fe24284 fetch 1 ,mem_hci_cmd 
4358 c006c3a7 beq hci_cmd_auth ,cmd_auth 
4359 c007c3b0 beq hci_cmd_startencrypt ,cmd_start_encrypt 
435a c00743b2 beq hci_cmd_stopencrypt ,cmd_stop_encrypt 
435b c00843da beq hci_cmd_setup_sco ,cmd_setup_sco 
435c c008c3de beq hci_cmd_disconn_sco ,cmd_disconn_sco 
435d c00e43e3 beq hci_cmd_accept_sco_conn ,cmd_accept_sco_conn 
435e c00243b4 beq hci_cmd_remote_feature_req ,cmd_feature_req 
435f c00ac3b7 beq hci_cmd_remote_ext_features_req ,cmd_ext_feature_req 
4360 c00a43ba beq hci_cmd_remote_version_req ,cmd_version_req 
4361 c00b43f1 beq hci_cmd_io_cap ,cmd_io_cap 
4362 c1830000 rtnne hci_cmd_disconn 
4363 204057ef call lmp_disconnect 

cmd_exit:
4364 70428400 jam 0 ,mem_hci_cmd 
4365 20600000 rtn 

cmd_check_plap:
4366 6fec4286 fetch 6 ,mem_hci_plap 
4367 684c0040 fetcht 6 ,mem_plap 
4368 98467c00 isub temp ,null 
4369 20600000 rtn 

cmd_check_handle:
436a 6fe24285 fetch 1 ,mem_hci_conn_handle 
436b 68420046 fetcht 1 ,mem_conn_handle 
436c 98467e00 isub temp ,pdata 
436d 20600000 rtn 

cmd_accept_conn:
436e 70007c03 jam lmp_accepted ,mem_lmo_opcode2 
436f 70007d33 jam lmp_host_connection_req ,mem_lmi_opcode2 
4370 20405b51 call tid_set_reply 
4371 20204364 branch cmd_exit 

cmd_accept_with_switch:
4372 2034c3e3 branch cmd_accept_sco_conn ,master 
4373 79200004 set1 mark_accept_switch ,mark 

cmd_role_switch:
4374 70007c34 jam lmp_slot_offset ,mem_lmo_opcode2 
4375 79200003 set1 mark_switch_initiated ,mark 
4376 2434c364 nbranch cmd_exit ,master 
4377 70007c13 jam lmp_switch_req ,mem_lmo_opcode2 
4378 6fe20138 fetch 1 ,mem_connection_options 
4379 793ffe02 set0 connection_switch ,pdata 
437a 67e20138 store 1 ,mem_connection_options 
437b 20204364 branch cmd_exit 

cmd_namereq:
437c 70007c01 jam lmp_name_req ,mem_lmo_opcode2 
437d 70005300 jam 0 ,mem_name_offset 
437e 20204364 branch cmd_exit 

cmd_ssp:
437f 700a2201 jam sp_flag_commit ,mem_master_sp_flag 
4380 700a2012 jam sp_master_stat_start_skip ,mem_master_sp_state 
4381 20204364 branch cmd_exit 

cmd_pair:
4382 6fe2004b fetch 1 ,mem_op 
4383 c2814387 bbit1 op_inrand_req ,cmd_pair_passive 
4384 20405b48 call tid_initiate 
4385 70007c08 jam lmp_in_rand ,mem_lmo_opcode2 
4386 20204364 branch cmd_exit 

cmd_pair_passive:
4387 793ffe02 set0 op_inrand_req ,pdata 
4388 67e2004b store 1 ,mem_op 
4389 204057ea call lmp_accept_inrand 
438a 58000000 setarg 0 
438b 7934fe01 setflag master ,smap_lmptid ,pdata 
438c 67e2007f store 1 ,mem_lmo_tid2 
438d 20204364 branch cmd_exit 

cmd_nopair:
438e 70052e18 jam pairing_not_allowed ,mem_disconn_reason_send 
438f 70007c07 jam lmp_detach ,mem_lmo_opcode2 
4390 6fe20030 fetch 1 ,mem_state 
4391 c2804364 bbit1 state_inconn ,cmd_exit 
4392 18000418 force hci_error_pairing_not_allowed ,temp 
4393 20204364 branch cmd_exit 

cmd_has_key:
4394 204031e5 call linkkey_set 
4395 6fe2004b fetch 1 ,mem_op 
4396 c280c3ad bbit1 op_auth_req ,cmd_send_aurand 
4397 c280439a bbit1 op_send_sres ,cmd_send_sres 
4398 c2814387 bbit1 op_inrand_req ,cmd_pair_passive 
4399 20204364 branch cmd_exit 

cmd_send_sres:
439a 793ffe00 set0 op_send_sres ,pdata 
439b 67e2004b store 1 ,mem_op 
439c 70007c0c jam lmp_sres ,mem_lmo_opcode2 
439d 20204364 branch cmd_exit 

cmd_no_key:
439e 6fe2004b fetch 1 ,mem_op 
439f c28043a1 bbit1 op_send_sres ,cmd_no_key_reject 
43a0 20204364 branch cmd_exit 

cmd_no_key_reject:
43a1 793ffe00 set0 op_send_sres ,pdata 
43a2 67e2004b store 1 ,mem_op 
43a3 70007c04 jam lmp_not_accepted ,mem_lmo_opcode2 
43a4 70007d0b jam lmp_au_rand ,mem_lmi_opcode2 
43a5 70007e06 jam key_missing ,mem_lmo_reason2 
43a6 20204364 branch cmd_exit 

cmd_auth:
43a7 6fe2004b fetch 1 ,mem_op 
43a8 79207e01 set1 op_auth_req ,pdata 
43a9 67e2004b store 1 ,mem_op 
43aa 6fe20030 fetch 1 ,mem_state 
43ab c283c3ad bbit1 state_linkkey ,cmd_auth_sendaurand 
43ac 20204364 branch cmd_exit 

cmd_send_aurand:

cmd_auth_sendaurand:
43ad 20405b48 call tid_initiate 
43ae 70007c0b jam lmp_au_rand ,mem_lmo_opcode2 
43af 20204364 branch cmd_exit 

cmd_start_encrypt:
43b0 70007c0f jam lmp_encryption_mode_req ,mem_lmo_opcode2 
43b1 20204364 branch cmd_exit 

cmd_stop_encrypt:
43b2 70007c0f jam lmp_encryption_mode_req ,mem_lmo_opcode2 
43b3 20204364 branch cmd_exit 

cmd_feature_req:
43b4 70007c27 jam lmp_features_req ,mem_lmo_opcode2 
43b5 70428450 jam hci_cmd_wait_remote_feature ,mem_hci_cmd 
43b6 20600000 rtn 

cmd_ext_feature_req:
43b7 70007c83 jam lmp_ext_features_req ,mem_lmo_opcode2 
43b8 70428451 jam hci_cmd_wait_remote_ext_feature ,mem_hci_cmd 
43b9 20600000 rtn 

cmd_version_req:
43ba 70007c25 jam lmp_version_req ,mem_lmo_opcode2 
43bb 20204364 branch cmd_exit 

cmd_in_sniff:
43bc 70007c17 jam lmp_sniff_req ,mem_lmo_opcode2 
43bd 58000000 setarg 0 
43be 67e401e3 store 2 ,mem_acl_dsniff 
43bf 6fe442b3 fetch 2 ,mem_sniff_param_interval 
43c0 1fe3fe00 lshift pdata ,pdata 
43c1 67e401e5 store 2 ,mem_acl_tsniff 
43c2 6fe242b5 fetch 1 ,mem_sniff_param_attempt 
43c3 67e201e7 store 1 ,mem_acl_attempt 
43c4 6fe242b7 fetch 1 ,mem_sniff_param_timeout 
43c5 67e201e8 store 1 ,mem_acl_timeout 
43c6 d8a0053c arg mem_sniff_payload ,contw 
43c7 58000000 setarg 0 
43c8 2d0ffe1b isolate1 27 ,clke_bt 
43c9 7920fe01 setflag true ,1 ,pdata 
43ca e7e20005 istore 1 ,contw 
43cb 58000000 setarg 0 
43cc e7e40005 istore 2 ,contw 
43cd 6fe442b3 fetch 2 ,mem_sniff_param_interval 
43ce e7e40005 istore 2 ,contw 
43cf 6fe242b5 fetch 1 ,mem_sniff_param_attempt 
43d0 e7e40005 istore 2 ,contw 
43d1 6fe242b7 fetch 1 ,mem_sniff_param_timeout 
43d2 e7e40005 istore 2 ,contw 
43d3 20204364 branch cmd_exit 

cmd_exit_sniff:
43d4 70007c18 jam lmp_unsniff_req ,mem_lmo_opcode2 
43d5 20204364 branch cmd_exit 

cmd_setup_esco:
43d6 204034a3 call new_conn_handle 
43d7 67e242fa store 1 ,mem_sco_handle 
43d8 70007c8c jam lmp_ext_esco_link_req ,mem_lmo_opcode2 
43d9 20204364 branch cmd_exit 

cmd_setup_sco:
43da 70007c2b jam lmp_sco_link_req ,mem_lmo_opcode2 
43db 20204364 branch cmd_exit 

cmd_disconn:
43dc 204057ef call lmp_disconnect 
43dd 20204364 branch cmd_exit 

cmd_disconn_esco:

cmd_disconn_sco:
43de 70007c2c jam lmp_remove_sco_link_req ,mem_lmo_opcode2 
43df c583c364 bmark0 mark_esco ,cmd_exit 
43e0 70007c8d jam lmp_ext_remove_esco_req ,mem_lmo_opcode2 
43e1 70052e13 jam 0x13 ,mem_disconn_reason_send 
43e2 20204364 branch cmd_exit 

cmd_accept_sco_conn:
43e3 2034c3ea branch cmd_accept_sco_conn_master ,master 
43e4 70007c03 jam lmp_accepted ,mem_lmo_opcode2 
43e5 70007d2b jam lmp_sco_link_req ,mem_lmi_opcode2 
43e6 c583c364 bmark0 mark_esco ,cmd_exit 
43e7 70007c81 jam lmp_ext_accepted ,mem_lmo_opcode2 
43e8 70007d8c jam lmp_ext_esco_link_req ,mem_lmi_opcode2 
43e9 20204364 branch cmd_exit 

cmd_accept_sco_conn_master:
43ea 204034a3 call new_conn_handle 
43eb 67e242fa store 1 ,mem_sco_handle 
43ec 6fe20046 fetch 1 ,mem_conn_handle 
43ed 67e242f9 store 1 ,mem_sco_asso_handle 
43ee 70007c2b jam lmp_sco_link_req ,mem_lmo_opcode2 
43ef c583c364 bmark0 mark_esco ,cmd_exit 
43f0 20600000 rtn 

cmd_io_cap:
43f1 70007c9a jam lmp_io_cap_res ,mem_lmo_opcode2 
43f2 20204364 branch cmd_exit 

cmd_detach:
43f3 70007c07 jam lmp_detach ,mem_lmo_opcode2 
43f4 70052e13 jam other_end_terminated ,mem_disconn_reason_send 
43f5 20204364 branch cmd_exit 

hp_dac_init:
43f6 44e8c01a bpatch patch1a_1 ,mem_patch1a 
43f7 70810608 jam 0x08 ,core_dac_ctrl 
43f8 200008fc nop 2300 
43f9 58010010 setarg hf_dac_start_address 
43fa 67e48100 store 2 ,core_dac_saddr 
43fb 67e48104 store 2 ,core_dac_wptr 
43fc 58003ff0 setarg hf_dac_buffer_size 
43fd 1fe0ffff increase -1 ,pdata 
43fe 67e48102 store 2 ,core_dac_len 
43ff 62228107 storer rega ,1 ,core_dac_sel 
4400 70810618 jam 0x18 ,core_dac_ctrl 

hp_dac_reinit:
4401 2000000a nop 10 
4402 70810608 jam 0x08 ,core_dac_ctrl 
4403 70810800 jam 0 ,core_dac_lvol 
4404 70810900 jam 0 ,core_dac_rvol 
4405 20404409 call hp_dac_samplefreq_sel 
4406 200008fc nop 2300 
4407 70810603 jam 0x03 ,core_dac_ctrl 
4408 20600000 rtn 

hp_dac_samplefreq_sel:
4409 6fe242a3 fetch 1 ,mem_conf_sample_freq 
440a c2804410 bbit1 0 ,hp_dac_samplefreq_sel_48k 
440b c280c40c bbit1 1 ,hp_dac_samplefreq_sel_44k 

hp_dac_samplefreq_sel_44k:
440c 6fe2894d fetch 1 ,rf_rx_ib_lna 
440d 793ffe00 set0 0 ,pdata 
440e 67e2894d store 1 ,rf_rx_ib_lna 
440f 20600000 rtn 

hp_dac_samplefreq_sel_48k:
4410 6fe2894d fetch 1 ,rf_rx_ib_lna 
4411 79207e00 set1 0 ,pdata 
4412 67e2894d store 1 ,rf_rx_ib_lna 
4413 20600000 rtn 

hp_scb_init:
4414 44e9401a bpatch patch1a_2 ,mem_patch1a 
4415 70806400 jam 0 ,core_sbc_ctrl 
4416 58004bf0 setarg hf_sbc_src_start_address 
4417 67e4810a store 2 ,core_sbc_saddr 
4418 58000000 setarg 0 
4419 67e48112 store 2 ,core_sbc_swp 
441a 58000400 setarg hf_sbc_src_buffer_size 
441b 67e4810e store 2 ,core_sbc_slen 
441c 58010010 setarg hf_sbc_des_start_address 
441d 67e4810c store 2 ,core_sbc_daddr 
441e 58003ff0 setarg hf_sbc_des_buffer_size 
441f 67e48110 store 2 ,core_sbc_dlen 

hp_scb_init_end:
4420 6fe28006 fetch 1 ,core_misc_ctrl 
4421 1fe2fe60 xor pdata ,0x60 ,pdata 
4422 67e28006 store 1 ,core_misc_ctrl 
4423 20000005 nop 5 
4424 6fe28006 fetch 1 ,core_misc_ctrl 
4425 1fe17e9f and pdata ,0x9f ,pdata 
4426 67e28006 store 1 ,core_misc_ctrl 
4427 70806408 jam 0x8 ,core_sbc_ctrl 
4428 70800b86 jam 0x86 ,core_sbc_clr 
4429 70806409 jam 0x9 ,core_sbc_ctrl 
442a 20205f88 branch sbc_hw_check_err 

hp_sbc_stop:
442b 70806400 jam 0 ,core_sbc_ctrl 
442c 20600000 rtn 

hp_sco_init:
442d da20000d arg 0xd ,rega 
442e 20204430 branch hp_hw_init_common 

hp_stero_init:
442f da200000 arg 0 ,rega 

hp_hw_init_common:
4430 204043f6 call hp_dac_init 
4431 20204414 branch hp_scb_init 

load_audio_test:
4432 da201000 arg 0x1000 ,rega 
4433 2040728a call ui_load_audio_from_flash 
4434 6fe48104 fetch 2 ,core_dac_wptr 
4435 9a40a200 iadd regb ,rega 
4436 20405f7e call update_dac_wptr 
4437 67e48104 store 2 ,core_dac_wptr 
4438 6fe40260 fetch 2 ,mem_audio_offset 
4439 243a4432 nbranch load_audio_test ,blank 
443a 20600000 rtn 

l2cap_call_proc_hid:
443b 2040443d call hid_rx_process 
443c 202048d4 branch l2cap_rx_reset_state 

hid_rx_process:
443d 44e9c01a bpatch patch1a_3 ,mem_patch1a 
443e 6fe40311 fetch 2 ,mem_l2cap_payload_ptr 
443f 1fe20c00 copy pdata ,contr 
4440 efe20006 ifetch 1 ,contr 
4441 1fe1040f and pdata ,0x0f ,temp 
4442 1ff1fe00 rshift4 pdata ,pdata 
4443 c004c456 beq hid_type_set_idle ,hid_rx_process_handshake 
4444 c003c456 beq hid_type_set_protocol ,hid_rx_process_handshake 
4445 c005445d beq hid_type_data ,hid_rx_process_data 
4446 c002c451 beq hid_type_set_report ,hid_rx_process_set_report 
4447 c000c449 beq hid_type_control ,hid_rx_process_hid_control 
4448 20600000 rtn 

hid_rx_process_hid_control:
4449 44ea401a bpatch patch1a_4 ,mem_patch1a 
444a 18427e00 copy temp ,pdata 
444b c002c44e beq hid_control_p_virtualcableunplug ,hid_rx_process_virtual_cable_unplug 
444c c001c450 beq hid_control_p_suspend ,hid_rx_process_suspend 
444d 20600000 rtn 

hid_rx_process_virtual_cable_unplug:
444e 700b0827 jam bt_evt_virtual_cable_unplug ,mem_fifo_temp 
444f 202071ee branch ui_ipc_send_event 

hid_rx_process_suspend:
4450 20600000 rtn 

hid_rx_process_set_report:
4451 da200001 arg 0x01 ,rega 
4452 20404aab call l2cap_malloc_server_channel 
4453 58000000 setarg 0x00 
4454 e7e20005 istore 1 ,contw 
4455 20600000 rtn 

hid_rx_process_handshake:
4456 44eac01a bpatch patch1a_5 ,mem_patch1a 
4457 da200001 arg 1 ,rega 
4458 20404aab call l2cap_malloc_server_channel 
4459 58000000 setarg 0 
445a e7e20005 istore 1 ,contw 
445b 700b0812 jam bt_evt_hid_handshake ,mem_fifo_temp 
445c 202071ee branch ui_ipc_send_event 

hid_rx_process_data:
445d 44eb401a bpatch patch1a_6 ,mem_patch1a 
445e efe20006 ifetch 1 ,contr 
445f c000c461 beq hid_report_id_kb ,hid_rx_process_data_hid_kb 
4460 20600000 rtn 

hid_rx_process_data_hid_kb:
4461 44ebc01a bpatch patch1a_7 ,mem_patch1a 
4462 18c22200 copy contr ,rega 
4463 20600000 rtn 

hfp_hsp_init:
4464 20404466 call hfp_clear_parms 
4465 20600000 rtn 

hfp_clear_parms:
4466 44ec401b bpatch patch1b_0 ,mem_patch1b 
4467 70431200 jam hf_state_waiting_rfcomm_conn ,mem_hf_state 
4468 70431300 jam hfp_nono ,mem_hf_call_state 
4469 70431400 jam hf_cmd_idle ,mem_hf_command 
446a 7043270a jam hfp_default_mic_vlm ,mem_hf_vlm_mic 
446b 7043250a jam hfp_default_speaker ,mem_hf_vlm_speaker 
446c 20404473 call hfp_clear_sco_params 
446d 58000000 setarg 0 
446e 67e445b9 store 2 ,mem_rfc_server_state 
446f 58004325 setarg mem_xmem_hf_state_end 
4470 d8a04312 arg mem_xmem_hf_state_start ,contw 
4471 98a67200 isub contw ,loopcnt 
4472 2020776c branch clear_mem 

hfp_clear_sco_params:
4473 c6158000 rtnmark1 mark_sco_flag 
4474 58004312 setarg mem_xmem_sco_end 
4475 d8a042f9 arg mem_xmem_sco_start ,contw 
4476 98a67200 isub contw ,loopcnt 
4477 2020776c branch clear_mem 

hfp_hsp_reset:
4478 20404466 call hfp_clear_parms 
4479 700b0861 jam bt_evt_hfp_disconnected ,mem_fifo_temp 
447a 202071ee branch ui_ipc_send_event 

hfp_cb_bb_event_process:
447b 1a627e00 copy regc ,pdata 
447c c00544aa beq bt_evt_pincode_req ,hfp_evt_pincode_req 
447d c000c4a7 beq bt_evt_bb_connected ,hfp_evt_bb_connect 
447e c00144a8 beq bt_evt_bb_disconnected ,hfp_evt_bb_disconnect 
447f c0314481 beq bt_evt_hfp_indicators_update ,hfp_evt_update_state 
4480 20600000 rtn 

hfp_evt_update_state:
4481 58000001 setarg hfp_cievind_call 
4482 204044a3 call hfp_get_indicator_value 
4483 c0004486 beq ciev_call_no ,hfp_update_state_nocallactive 
4484 c000c492 beq ciev_call_act ,hfp_update_state_callactived 
4485 20600000 rtn 

hfp_update_state_nocallactive:
4486 44ecc01b bpatch patch1b_1 ,mem_patch1b 
4487 58000002 setarg hfp_cievind_callsettup 
4488 204044a3 call hfp_get_indicator_value 
4489 c000c48e beq ciev_callst_img ,hfp_update_incomming 
448a c0014490 beq ciev_callst_oug ,hfp_update_outgoing 
448b c001c490 beq ciev_callst_re_altd ,hfp_update_outgoing 
448c 70431300 jam hfp_nono ,mem_hf_call_state 
448d 20600000 rtn 

hfp_update_incomming:
448e 70431301 jam hfp_incomming ,mem_hf_call_state 
448f 20600000 rtn 

hfp_update_outgoing:
4490 70431302 jam hfp_outgoing ,mem_hf_call_state 
4491 20600000 rtn 

hfp_update_state_callactived:
4492 44ed401b bpatch patch1b_2 ,mem_patch1b 
4493 58000003 setarg hfp_cievind_callheld 
4494 204044a3 call hfp_get_indicator_value 
4495 c000449c beq ciev_held_no ,hfp_update_state_nocallheld 
4496 70431306 jam hfp_calmulty ,mem_hf_call_state 
4497 20600000 rtn 

hfp_update_callincomming:
4498 70431304 jam hfp_callimg ,mem_hf_call_state 
4499 20600000 rtn 

hfp_update_calloutgoing:
449a 70431305 jam hfp_callogg ,mem_hf_call_state 
449b 20600000 rtn 

hfp_update_state_nocallheld:
449c 58000002 setarg hfp_cievind_callsettup 
449d 204044a3 call hfp_get_indicator_value 
449e c000c498 beq ciev_callst_img ,hfp_update_callincomming 
449f c001449a beq ciev_callst_oug ,hfp_update_calloutgoing 
44a0 c001c49a beq ciev_callst_re_altd ,hfp_update_calloutgoing 
44a1 70431303 jam hfp_callactive ,mem_hf_call_state 
44a2 20600000 rtn 

hfp_get_indicator_value:
44a3 d8c0431e arg mem_ag_indicator ,contr 
44a4 98c08c00 iadd contr ,contr 
44a5 efe20006 ifetch 1 ,contr 
44a6 20600000 rtn 

hfp_evt_bb_connect:
44a7 20204236 branch app_bt_stop_discovery 

hfp_evt_bb_disconnect:
44a8 20404478 call hfp_hsp_reset 
44a9 20204234 branch app_bt_start_discovery 

hfp_evt_pincode_req:
44aa 7046cb04 jam 4 ,mem_pin_length 
44ab 58003030 setarg 0x3030 
44ac 67e446cc store 2 ,mem_pin 
44ad e7e40005 istore 2 ,contw 
44ae 20204226 branch app_bt_set_pincode 

hfp_cb_idle_process:
44af 20600000 rtn 

hfp_send_answer_call:
44b0 204045a4 call hfp_send_credit_return 

send_ata:
44b1 580002ea setarg mem_at_command_data 
44b2 67e4432c store 2 ,mem_at_rfcomm_data_ptr 
44b3 1fe20a00 icopy contw 
44b4 58415441 setarg 0x415441 
44b5 e7e60005 istore 3 ,contw 
44b6 5800000d setarg 0x0D 
44b7 e7e20005 istore 1 ,contw 
44b8 58000004 setarg 0x04 
44b9 202044eb branch send_at_cmd_body_end 

hfp_send_hang_up:
44ba 204045a4 call hfp_send_credit_return 

send_at_chup:
44bb 580002ea setarg mem_at_command_data 
44bc 67e4432c store 2 ,mem_at_rfcomm_data_ptr 
44bd 1fe20a00 icopy contw 
44be 582b5441 setarg 0x2b5441 
44bf e7e60005 istore 3 ,contw 
44c0 58554843 setarg 0x554843 
44c1 e7e60005 istore 3 ,contw 
44c2 58000d50 setarg 0x0D50 
44c3 e7e40005 istore 2 ,contw 
44c4 58000008 setarg 0x08 
44c5 202044eb branch send_at_cmd_body_end 

hfp_increase_vgs:
44c6 6fe24325 fetch 1 ,mem_hf_vlm_speaker 
44c7 c007c4d0 beq hfp_speaker_max_vlm ,send_at_vgs 
44c8 1fe0fe01 increase 1 ,pdata 
44c9 67e24325 store 1 ,mem_hf_vlm_speaker 
44ca 202044d0 branch send_at_vgs 

hfp_decrease_vgs:
44cb 6fe24325 fetch 1 ,mem_hf_vlm_speaker 
44cc 203a44d0 branch send_at_vgs ,blank 
44cd 1fe0ffff increase -1 ,pdata 
44ce 67e24325 store 1 ,mem_hf_vlm_speaker 
44cf 202044d0 branch send_at_vgs 

send_at_vgs:
44d0 44edc01b bpatch patch1b_3 ,mem_patch1b 
44d1 204045a4 call hfp_send_credit_return 
44d2 580002ea setarg mem_at_command_data 
44d3 67e4432c store 2 ,mem_at_rfcomm_data_ptr 
44d4 1fe20a00 icopy contw 
44d5 582b5441 setarg 0x2b5441 
44d6 e7e60005 istore 3 ,contw 
44d7 58534756 setarg 0x534756 
44d8 e7e60005 istore 3 ,contw 
44d9 5800003d setarg 0x3d 
44da e7e20005 istore 1 ,contw 
44db 6fe24325 fetch 1 ,mem_hf_vlm_speaker 
44dc 1fe67c09 sub pdata ,9 ,null 
44dd 202144e6 branch send_at_vgs_body_one_byte ,positive 

send_at_vgs_body_two_byte:
44de d8400031 arg 0x31 ,temp 
44df e0420005 istoret 1 ,contw 
44e0 1fe0fe26 add pdata ,38 ,pdata 
44e1 e7e20005 istore 1 ,contw 
44e2 5800000d setarg 0x0d 
44e3 e7e20005 istore 1 ,contw 
44e4 5800000a setarg 0x0a 
44e5 202044eb branch send_at_cmd_body_end 

send_at_vgs_body_one_byte:
44e6 1fe0fe30 add pdata ,0x30 ,pdata 
44e7 e7e20005 istore 1 ,contw 
44e8 5800000d setarg 0x0d 
44e9 e7e20005 istore 1 ,contw 
44ea 58000009 setarg 0x09 

send_at_cmd_body_end:
44eb 67e445b4 store 2 ,mem_current_packet_length 
44ec 20204748 branch hfp_tx_rfcomm_without_credit 

hfp_increase_vgm:
44ed 6fe24327 fetch 1 ,mem_hf_vlm_mic 
44ee c007c4f6 beq hfp_mic_max_vlm ,send_at_vgm 
44ef 1fe0fe01 increase 1 ,pdata 
44f0 67e24327 store 1 ,mem_hf_vlm_mic 
44f1 202044f6 branch send_at_vgm 

hfp_decrease_vgm:
44f2 6fe24327 fetch 1 ,mem_hf_vlm_mic 
44f3 203a44f6 branch send_at_vgm ,blank 
44f4 1fe0ffff increase -1 ,pdata 
44f5 67e24327 store 1 ,mem_hf_vlm_mic 

send_at_vgm:
44f6 44ee401b bpatch patch1b_4 ,mem_patch1b 
44f7 70431404 jam hf_wait_vgm_ok ,mem_hf_command 
44f8 204045a4 call hfp_send_credit_return 

send_at_vgm_body:
44f9 580002ea setarg mem_at_command_data 
44fa 67e4432c store 2 ,mem_at_rfcomm_data_ptr 
44fb 1fe20a00 icopy contw 
44fc 582b5441 setarg 0x2b5441 
44fd e7e60005 istore 3 ,contw 
44fe 584d4756 setarg 0x4d4756 
44ff e7e60005 istore 3 ,contw 
4500 5800003d setarg 0x3d 
4501 e7e20005 istore 1 ,contw 
4502 6fe24327 fetch 1 ,mem_hf_vlm_mic 
4503 1fe67c09 sub pdata ,9 ,null 
4504 2021450d branch send_at_vgm_body_one_byte ,positive 

send_at_vgm_body_two_byte:
4505 d8400031 arg 0x31 ,temp 
4506 e0420005 istoret 1 ,contw 
4507 1fe0fe26 add pdata ,38 ,pdata 
4508 e7e20005 istore 1 ,contw 
4509 5800000d setarg 0x0d 
450a e7e20005 istore 1 ,contw 
450b 5800000a setarg 0x0a 
450c 202044eb branch send_at_cmd_body_end 

send_at_vgm_body_one_byte:
450d 1fe0fe30 add pdata ,0x30 ,pdata 
450e e7e20005 istore 1 ,contw 
450f 5800000d setarg 0x0d 
4510 e7e20005 istore 1 ,contw 
4511 58000009 setarg 0x09 
4512 202044eb branch send_at_cmd_body_end 

hfp_hsp_process:
4513 44eec01b bpatch patch1b_5 ,mem_patch1b 
4514 20404a61 call l2cap_malloc_is_fifo_empty 
4515 247a0000 nrtn blank 
4516 6fe24312 fetch 1 ,mem_hf_state 
4517 c0054542 beq hf_state_hf_send_receive_info ,hfp_send_receive_info 
4518 c1058000 rtneq hf_state_waiting_ag_info 
4519 c0064552 beq hf_state_hf_send_at_clip ,hfp_send_enable_cli 
451a c1068000 rtneq hf_state_waiting_at_clip 
451b c0074562 beq hf_state_hf_send_at_ccwa ,hfp_send_enable_call_waiting 
451c c1078000 rtneq hf_state_waiting_at_ccwa 
451d c0004529 beq hf_state_waiting_rfcomm_conn ,hfp_waiting_rfcomm 
451e c000c52e beq hf_state_hf_send_feature ,hfp_send_feature 
451f c1010000 rtneq hf_state_waiting_ag_feature_ok 
4520 c001c572 beq hf_state_hf_send_indicators ,hfp_send_indicators 
4521 c1020000 rtneq hf_state_waiting_ag_indicators_ok 
4522 c002c582 beq hf_state_hf_send_curr_status ,hfp_send_curr_status 
4523 c1030000 rtneq hf_state_waiting_ag_status_ok 
4524 c003c590 beq hf_state_hf_send_update_status ,hfp_send_update_status 
4525 c1040000 rtneq hf_state_waiting_ag_update_status_ok 
4526 c004c528 beq hf_state_connected ,hfp_connected 
4527 20600000 rtn 

hfp_connected:
4528 20600000 rtn 

hfp_waiting_rfcomm:
4529 6fe445b9 fetch 2 ,mem_rfc_server_state 
452a 1fe17ee0 and pdata ,0xe0 ,pdata 
452b c1f00000 rtnne 0xe0 
452c 70431201 jam hf_state_hf_send_feature ,mem_hf_state 
452d 20600000 rtn 

hfp_send_feature:
452e 6fe445b0 fetch 2 ,mem_remote_credits 
452f 207a0000 rtn blank 
4530 204045a4 call hfp_send_credit_return 
4531 70431202 jam hf_state_waiting_ag_feature_ok ,mem_hf_state 

send_at_brsf:
4532 5800000b setarg 0x0b 
4533 67e445b4 store 2 ,mem_current_packet_length 
4534 580002ea setarg mem_at_command_data 
4535 67e4432c store 2 ,mem_at_rfcomm_data_ptr 
4536 1fe20a00 icopy contw 
4537 582b5441 setarg 0x2B5441 
4538 e7e60005 istore 3 ,contw 
4539 58535242 setarg 0x535242 
453a e7e60005 istore 3 ,contw 
453b 58003d46 setarg 0x3D46 
453c e7e40005 istore 2 ,contw 
453d 6fe4432e fetch 2 ,memui_hf_brsf_feature 
453e e7e40005 istore 2 ,contw 
453f 5800000d setarg 0x0D 
4540 e7e20005 istore 1 ,contw 
4541 20204748 branch hfp_tx_rfcomm_without_credit 

hfp_send_receive_info:
4542 204045a4 call hfp_send_credit_return 
4543 7043120b jam hf_state_waiting_ag_info ,mem_hf_state 

send_at_chld:
4544 5800000a setarg 0x0a 
4545 67e445b4 store 2 ,mem_current_packet_length 
4546 580002ea setarg mem_at_command_data 
4547 67e4432c store 2 ,mem_at_rfcomm_data_ptr 
4548 1fe20a00 icopy contw 
4549 58005441 setarg 0x5441 
454a e7e40005 istore 2 ,contw 
454b 5848432b setarg 0x48432b 
454c e7e60005 istore 3 ,contw 
454d 583d444c setarg 0x3d444c 
454e e7e60005 istore 3 ,contw 
454f 58000d3f setarg 0x0d3f 
4550 e7e40005 istore 2 ,contw 
4551 20204748 branch hfp_tx_rfcomm_without_credit 

hfp_send_enable_cli:
4552 204045a4 call hfp_send_credit_return 
4553 7043120d jam hf_state_waiting_at_clip ,mem_hf_state 

send_at_clip:
4554 5800000a setarg 0x0a 
4555 67e445b4 store 2 ,mem_current_packet_length 
4556 580002ea setarg mem_at_command_data 
4557 67e4432c store 2 ,mem_at_rfcomm_data_ptr 
4558 1fe20a00 icopy contw 
4559 58005441 setarg 0x5441 
455a e7e40005 istore 2 ,contw 
455b 584c432b setarg 0x4c432b 
455c e7e60005 istore 3 ,contw 
455d 583d5049 setarg 0x3d5049 
455e e7e60005 istore 3 ,contw 
455f 58000d31 setarg 0x0d31 
4560 e7e40005 istore 2 ,contw 
4561 20204748 branch hfp_tx_rfcomm_without_credit 

hfp_send_enable_call_waiting:
4562 204045a4 call hfp_send_credit_return 
4563 7043120f jam hf_state_waiting_at_ccwa ,mem_hf_state 

send_at_ccwa:
4564 5800000a setarg 0x0a 
4565 67e445b4 store 2 ,mem_current_packet_length 
4566 580002ea setarg mem_at_command_data 
4567 67e4432c store 2 ,mem_at_rfcomm_data_ptr 
4568 1fe20a00 icopy contw 
4569 58005441 setarg 0x5441 
456a e7e40005 istore 2 ,contw 
456b 5843432b setarg 0x43432b 
456c e7e60005 istore 3 ,contw 
456d 583d4157 setarg 0x3d4157 
456e e7e60005 istore 3 ,contw 
456f 58000d31 setarg 0x0d31 
4570 e7e40005 istore 2 ,contw 
4571 20204748 branch hfp_tx_rfcomm_without_credit 

hfp_send_indicators:
4572 204045a4 call hfp_send_credit_return 
4573 70431204 jam hf_state_waiting_ag_indicators_ok ,mem_hf_state 

send_at_cind:
4574 5800000a setarg 0x0a 
4575 67e445b4 store 2 ,mem_current_packet_length 
4576 580002ea setarg mem_at_command_data 
4577 67e4432c store 2 ,mem_at_rfcomm_data_ptr 
4578 1fe20a00 icopy contw 
4579 582b5441 setarg 0x2B5441 
457a e7e60005 istore 3 ,contw 
457b 584e4943 setarg 0x4e4943 
457c e7e60005 istore 3 ,contw 
457d 583f3d44 setarg 0x3f3D44 
457e e7e60005 istore 3 ,contw 
457f 5800000d setarg 0x0D 
4580 e7e20005 istore 1 ,contw 
4581 20204748 branch hfp_tx_rfcomm_without_credit 

hfp_send_curr_status:
4582 204045a4 call hfp_send_credit_return 
4583 70431206 jam hf_state_waiting_ag_status_ok ,mem_hf_state 

send_at_cind2:
4584 58000009 setarg 0x09 
4585 67e445b4 store 2 ,mem_current_packet_length 
4586 580002ea setarg mem_at_command_data 
4587 67e4432c store 2 ,mem_at_rfcomm_data_ptr 
4588 1fe20a00 icopy contw 
4589 582b5441 setarg 0x2B5441 
458a e7e60005 istore 3 ,contw 
458b 584e4943 setarg 0x4e4943 
458c e7e60005 istore 3 ,contw 
458d 580d3f44 setarg 0x0d3f44 
458e e7e60005 istore 3 ,contw 
458f 20204748 branch hfp_tx_rfcomm_without_credit 

hfp_send_update_status:
4590 204045a4 call hfp_send_credit_return 
4591 70431208 jam hf_state_waiting_ag_update_status_ok ,mem_hf_state 

send_at_cmer:
4592 58000010 setarg 0x10 
4593 67e445b4 store 2 ,mem_current_packet_length 
4594 580002ea setarg mem_at_command_data 
4595 67e4432c store 2 ,mem_at_rfcomm_data_ptr 
4596 1fe20a00 icopy contw 
4597 582b5441 setarg 0x2B5441 
4598 e7e60005 istore 3 ,contw 
4599 58454d43 setarg 0x454d43 
459a e7e60005 istore 3 ,contw 
459b 58333d52 setarg 0x333d52 
459c e7e60005 istore 3 ,contw 
459d 582c302c setarg 0x2c302c 
459e e7e60005 istore 3 ,contw 
459f 58312c30 setarg 0x312c30 
45a0 e7e60005 istore 3 ,contw 
45a1 5800000d setarg 0x0d 
45a2 e7e20005 istore 1 ,contw 
45a3 20204748 branch hfp_tx_rfcomm_without_credit 

hfp_send_credit_return:
45a4 44ef401b bpatch patch1b_6 ,mem_patch1b 
45a5 204061d9 call rfc_get_rfcomm_snd_adss 
45a6 6b0445b7 fetchr regd ,2 ,mem_rfc_l2capch_ptr 
45a7 20206106 branch rfc_send_uih_without_payload 

hfp_check_result_code_start:

hfp_check_result_code_end:
45a8 78547c00 disable user 

hfp_check_result_code:
45a9 18e27e00 copy queue ,pdata 
45aa 1fe0fffe increase -2 ,pdata 
45ab 24610000 nrtn positive 
45ac 18e08fff increase -1 ,queue 
45ad efe20006 ifetch 1 ,contr 
45ae c086c5a9 bne 0x0D ,hfp_check_result_code 
45af 18e08fff increase -1 ,queue 
45b0 efe20006 ifetch 1 ,contr 
45b1 c08545a9 bne 0x0A ,hfp_check_result_code 
45b2 78347c00 enable user 
45b3 20600000 rtn 

hfp_process_rfcomm_packet:
45b4 44efc01b bpatch patch1b_7 ,mem_patch1b 
45b5 18e27e00 deposit queue 
45b6 20628000 rtn zero 
45b7 68444328 fetcht 2 ,mem_at_payload_ptr 
45b8 18420c00 copy temp ,contr 
45b9 204045a8 call hfp_check_result_code_start 
45ba 24740000 nrtn user 
45bb 18c27e00 copy contr ,pdata 
45bc 67e4432a store 2 ,mem_at_command_ptr 
45bd 204045a8 call hfp_check_result_code_end 
45be 24740000 nrtn user 
45bf 18c27e00 copy contr ,pdata 
45c0 67e44328 store 2 ,mem_at_payload_ptr 
45c1 20404730 call hfp_handle_at_result_code 
45c2 202045b4 branch hfp_process_rfcomm_packet 

hfp_translate_ascii_to_hex:
45c3 44f0401c bpatch patch1c_0 ,mem_patch1c 
45c4 204045d4 call hfp_findcomma 
45c5 18c08dfe increase -2 ,contr 
45c6 18c22200 copy contr ,rega 
45c7 18002401 force 1 ,regb 
45c8 18000400 force 0 ,temp 

hfp_translate_calculate:
45c9 efe20011 ifetch 1 ,rega 
45ca 1a20a3ff increase -1 ,rega 
45cb c11e8000 rtneq 0x3d 
45cc c11d0000 rtneq 0x3a 
45cd c1160000 rtneq 0x2c 
45ce c01045c9 beq 0x20 ,hfp_translate_calculate 
45cf 1fe0ffd0 pincrease -48 
45d0 9a4ffe00 imul32 regb ,pdata 
45d1 98408400 iadd temp ,temp 
45d2 1a4fa40a mul32 regb ,10 ,regb 
45d3 202045c9 branch hfp_translate_calculate 

hfp_findcomma:
45d4 efe20006 ifetch 1 ,contr 
45d5 c1068000 rtneq 0x0d 
45d6 c1160000 rtneq 0x2c 
45d7 202045d4 branch hfp_findcomma 

hfp_is_result_error:
45d8 6fe4432a fetch 2 ,mem_at_command_ptr 
45d9 1fe20c00 icopy contr 
45da efe20006 ifetch 1 ,contr 
45db c1a28000 rtnne 0x45 
45dc efe20006 ifetch 1 ,contr 
45dd c1a90000 rtnne 0x52 
45de efe20006 ifetch 1 ,contr 
45df c1a90000 rtnne 0x52 
45e0 efe20006 ifetch 1 ,contr 
45e1 c1a78000 rtnne 0x4F 
45e2 efe20006 ifetch 1 ,contr 
45e3 c1a90000 rtnne 0x52 
45e4 78347c00 enable user 
45e5 204046d8 call hfp_result_ok_cmd 
45e6 20600000 rtn 

hfp_is_result_ring:
45e7 6fe4432a fetch 2 ,mem_at_command_ptr 
45e8 1fe20c00 icopy contr 
45e9 efe20006 ifetch 1 ,contr 
45ea c1a90000 rtnne 0x52 
45eb efe20006 ifetch 1 ,contr 
45ec c1a48000 rtnne 0x49 
45ed efe20006 ifetch 1 ,contr 
45ee c1a70000 rtnne 0x4e 
45ef efe20006 ifetch 1 ,contr 
45f0 c1a38000 rtnne 0x47 
45f1 78347c00 enable user 
45f2 20600000 rtn 

hfp_is_result_ciev:
45f3 6fe4432a fetch 2 ,mem_at_command_ptr 
45f4 1fe20c00 icopy contr 
45f5 efe20006 ifetch 1 ,contr 
45f6 c1958000 rtnne 0x2b 
45f7 efe20006 ifetch 1 ,contr 
45f8 c1a18000 rtnne 0x43 
45f9 efe20006 ifetch 1 ,contr 
45fa c1a48000 rtnne 0x49 
45fb efe20006 ifetch 1 ,contr 
45fc c1a28000 rtnne 0x45 
45fd efe20006 ifetch 1 ,contr 
45fe c1ab0000 rtnne 0x56 
45ff 78347c00 enable user 
4600 204045c3 call hfp_translate_ascii_to_hex 
4601 1a20a202 increase 2 ,rega 
4602 58004317 setarg mem_ag_indicator_map 
4603 98408400 iadd temp ,temp 
4604 184085ff increase -1 ,temp 
4605 efe20002 ifetch 1 ,temp 
4606 d840431e arg mem_ag_indicator ,temp 
4607 9840fe00 iadd temp ,pdata 
4608 67e4432a store 2 ,mem_at_command_ptr 
4609 1a220c00 copy rega ,contr 
460a 204045d4 call hfp_findcomma 
460b 204045c3 call hfp_translate_ascii_to_hex 
460c 6fe4432a fetch 2 ,mem_at_command_ptr 
460d e042003f istoret 1 ,pdata 
460e 700b0862 jam bt_evt_hfp_indicators_update ,mem_fifo_temp 
460f 202071ee branch ui_ipc_send_event 

hfp_is_result_cind:
4610 6fe4432a fetch 2 ,mem_at_command_ptr 
4611 1fe20c00 icopy contr 
4612 efe20006 ifetch 1 ,contr 
4613 c1958000 rtnne 0x2b 
4614 efe20006 ifetch 1 ,contr 
4615 c1a18000 rtnne 0x43 
4616 efe20006 ifetch 1 ,contr 
4617 c1a48000 rtnne 0x49 
4618 efe20006 ifetch 1 ,contr 
4619 c1a70000 rtnne 0x4e 
461a efe20006 ifetch 1 ,contr 
461b c1a20000 rtnne 0x44 
461c 78347c00 enable user 
461d 18c08c02 increase 2 ,contr 
461e efe20006 ifetch 1 ,contr 
461f c014463e beq 0x28 ,hfp_is_result_cind0 
4620 20204621 branch hfp_is_result_cind1 

hfp_is_result_cind1:
4621 44f0c01c bpatch patch1c_1 ,mem_patch1c 
4622 18007207 force 7 ,loopcnt 
4623 60c4432a storer contr ,2 ,mem_at_command_ptr 

hfp_is_result_cind1_loopcnt:
4624 6fe4432a fetch 2 ,mem_at_command_ptr 
4625 1fe20c00 icopy contr 
4626 204045c3 call hfp_translate_ascii_to_hex 
4627 1a20a202 increase 2 ,rega 
4628 1a220c00 copy rega ,contr 
4629 204045d4 call hfp_findcomma 
462a 18c27e00 copy contr ,pdata 
462b 67e4432a store 2 ,mem_at_command_ptr 
462c 18422200 copy temp ,rega 
462d 1f220400 copy loopcnt ,temp 
462e 18460407 sub temp ,7 ,temp 
462f 20404637 call hfp_get_indicator_index 
4630 d840431e arg mem_ag_indicator ,temp 
4631 98408400 iadd temp ,temp 
4632 1a227e00 copy rega ,pdata 
4633 e7e20002 istore 1 ,temp 
4634 c2004624 loop hfp_is_result_cind1_loopcnt 
4635 700b0862 jam bt_evt_hfp_indicators_update ,mem_fifo_temp 
4636 202071ee branch ui_ipc_send_event 

hfp_get_indicator_index:
4637 58004317 setarg mem_ag_indicator_map 
4638 98408400 iadd temp ,temp 
4639 efe20002 ifetch 1 ,temp 
463a 20600000 rtn 

hfp_find_double_quote:
463b efe20006 ifetch 1 ,contr 
463c c1110000 rtneq 0x22 
463d 2020463b branch hfp_find_double_quote 

hfp_is_result_cind0:
463e 44f1401c bpatch patch1c_2 ,mem_patch1c 
463f 18007207 force 7 ,loopcnt 

hfp_is_result_cind0_loopcnt:
4640 2040463b call hfp_find_double_quote 
4641 60c4432a storer contr ,2 ,mem_at_command_ptr 
4642 2040464e call hfp_indicator_service 
4643 2036464b branch hfp_is_result_cind0_loopcnt_end ,user2 
4644 2040466c call hfp_indicator_call_callheld_callsetup 
4645 2036464b branch hfp_is_result_cind0_loopcnt_end ,user2 
4646 20404699 call hfp_indicator_signal 
4647 2036464b branch hfp_is_result_cind0_loopcnt_end ,user2 
4648 2040468b call hfp_indicator_roam 
4649 2036464b branch hfp_is_result_cind0_loopcnt_end ,user2 
464a 2040465c call hfp_indicator_battchg 

hfp_is_result_cind0_loopcnt_end:
464b 2040463b call hfp_find_double_quote 
464c c2004640 loop hfp_is_result_cind0_loopcnt 
464d 20600000 rtn 

hfp_indicator_service:
464e 78567c00 disable user2 
464f 6fe4432a fetch 2 ,mem_at_command_ptr 
4650 1fe20c00 icopy contr 
4651 efe20006 ifetch 1 ,contr 
4652 c1b98000 rtnne 0x73 
4653 efe20006 ifetch 1 ,contr 
4654 c1b28000 rtnne 0x65 
4655 efe20006 ifetch 1 ,contr 
4656 c1b90000 rtnne 0x72 
4657 efe20006 ifetch 1 ,contr 
4658 c1bb0000 rtnne 0x76 
4659 78367c00 enable user2 
465a 18002200 force hfp_cievind_service ,rega 
465b 20204684 branch hfp_indicator_store 

hfp_indicator_battchg:
465c 78567c00 disable user2 
465d 6fe4432a fetch 2 ,mem_at_command_ptr 
465e 1fe20c00 icopy contr 
465f efe20006 ifetch 1 ,contr 
4660 c1b10000 rtnne 0x62 
4661 efe20006 ifetch 1 ,contr 
4662 c1b08000 rtnne 0x61 
4663 efe20006 ifetch 1 ,contr 
4664 c1ba0000 rtnne 0x74 
4665 efe20006 ifetch 1 ,contr 
4666 c1ba0000 rtnne 0x74 
4667 efe20006 ifetch 1 ,contr 
4668 c1b18000 rtnne 0x63 
4669 78367c00 enable user2 
466a 18002206 force hfp_cievind_battcha ,rega 
466b 20204684 branch hfp_indicator_store 

hfp_indicator_call_callheld_callsetup:
466c 44f1c01c bpatch patch1c_3 ,mem_patch1c 
466d 78567c00 disable user2 
466e 6fe4432a fetch 2 ,mem_at_command_ptr 
466f 1fe20c00 icopy contr 
4670 efe20006 ifetch 1 ,contr 
4671 c1b18000 rtnne 0x63 
4672 efe20006 ifetch 1 ,contr 
4673 c1b08000 rtnne 0x61 
4674 efe20006 ifetch 1 ,contr 
4675 c1b60000 rtnne 0x6c 
4676 efe20006 ifetch 1 ,contr 
4677 c1b60000 rtnne 0x6c 
4678 efe20006 ifetch 1 ,contr 
4679 78367c00 enable user2 
467a c0344683 beq 0x68 ,hfp_indicator_callheld 
467b c0114680 beq 0x22 ,hfp_indicator_call 
467c c039c67e beq 0x73 ,hfp_indicator_callsetup 
467d 20600000 rtn 

hfp_indicator_callsetup:
467e 18002202 force hfp_cievind_callsettup ,rega 
467f 20204684 branch hfp_indicator_store 

hfp_indicator_call:
4680 18c08dff increase -1 ,contr 
4681 18002201 force hfp_cievind_call ,rega 
4682 20204684 branch hfp_indicator_store 

hfp_indicator_callheld:
4683 18002203 force hfp_cievind_callheld ,rega 

hfp_indicator_store:
4684 1f227e00 copy loopcnt ,pdata 
4685 1fe67e07 sub pdata ,7 ,pdata 
4686 d8404317 arg mem_ag_indicator_map ,temp 
4687 98408400 iadd temp ,temp 
4688 1a227e00 copy rega ,pdata 
4689 e7e20002 istore 1 ,temp 
468a 20600000 rtn 

hfp_indicator_roam:
468b 78567c00 disable user2 
468c 6fe4432a fetch 2 ,mem_at_command_ptr 
468d 1fe20c00 icopy contr 
468e efe20006 ifetch 1 ,contr 
468f c1b90000 rtnne 0x72 
4690 efe20006 ifetch 1 ,contr 
4691 c1b78000 rtnne 0x6f 
4692 efe20006 ifetch 1 ,contr 
4693 c1b08000 rtnne 0x61 
4694 efe20006 ifetch 1 ,contr 
4695 c1b68000 rtnne 0x6d 
4696 78367c00 enable user2 
4697 18002205 force hfp_cievind_roam ,rega 
4698 20204684 branch hfp_indicator_store 

hfp_indicator_signal:
4699 78567c00 disable user2 
469a 6fe4432a fetch 2 ,mem_at_command_ptr 
469b 1fe20c00 icopy contr 
469c efe20006 ifetch 1 ,contr 
469d c1b98000 rtnne 0x73 
469e efe20006 ifetch 1 ,contr 
469f c1b48000 rtnne 0x69 
46a0 efe20006 ifetch 1 ,contr 
46a1 c1b38000 rtnne 0x67 
46a2 efe20006 ifetch 1 ,contr 
46a3 c1b70000 rtnne 0x6e 
46a4 78367c00 enable user2 
46a5 18002204 force hfp_cievind_signal ,rega 
46a6 20204684 branch hfp_indicator_store 

hfp_is_result_brsf:
46a7 6fe4432a fetch 2 ,mem_at_command_ptr 
46a8 1fe20c00 icopy contr 
46a9 efe20006 ifetch 1 ,contr 
46aa c1958000 rtnne 0x2b 
46ab efe20006 ifetch 1 ,contr 
46ac c1a10000 rtnne 0x42 
46ad efe20006 ifetch 1 ,contr 
46ae c1a90000 rtnne 0x52 
46af efe20006 ifetch 1 ,contr 
46b0 c1a98000 rtnne 0x53 
46b1 efe20006 ifetch 1 ,contr 
46b2 c1a30000 rtnne 0x46 
46b3 78347c00 enable user 
46b4 204045c3 call hfp_translate_ascii_to_hex 
46b5 60444315 storet 2 ,mem_agoption 
46b6 20600000 rtn 

hfp_is_result_chld:
46b7 6fe4432a fetch 2 ,mem_at_command_ptr 
46b8 1fe20c00 icopy contr 
46b9 efe20006 ifetch 1 ,contr 
46ba c1958000 rtnne 0x2b 
46bb efe20006 ifetch 1 ,contr 
46bc c1a18000 rtnne 0x43 
46bd efe20006 ifetch 1 ,contr 
46be c1a40000 rtnne 0x48 
46bf efe20006 ifetch 1 ,contr 
46c0 c1a60000 rtnne 0x4c 
46c1 efe20006 ifetch 1 ,contr 
46c2 c1a20000 rtnne 0x44 
46c3 78347c00 enable user 
46c4 20600000 rtn 

hfp_is_result_ok:
46c5 6fe4432a fetch 2 ,mem_at_command_ptr 
46c6 1fe20c00 icopy contr 
46c7 efe20006 ifetch 1 ,contr 
46c8 c1a78000 rtnne 0x4F 
46c9 efe20006 ifetch 1 ,contr 
46ca c1a58000 rtnne 0x4B 
46cb 78347c00 enable user 
46cc 204046d8 call hfp_result_ok_cmd 

hfp_result_ok_handle:
46cd 44f2401c bpatch patch1c_4 ,mem_patch1c 
46ce 6fe24312 fetch 1 ,mem_hf_state 
46cf c00446e9 beq hf_state_waiting_ag_update_status_ok ,hfp_ag_update_status_ok 
46d0 c005c6eb beq hf_state_waiting_ag_info ,hfp_ag_receive_info_ok 
46d1 c006c6ed beq hf_state_waiting_at_clip ,hfp_ag_enable_clip_ok 
46d2 c007c6ef beq hf_state_waiting_at_ccwa ,hfp_ag_enable_call_waiting_ok 
46d3 c00146e3 beq hf_state_waiting_ag_feature_ok ,hfp_ag_feature_ok 
46d4 c00246e5 beq hf_state_waiting_ag_indicators_ok ,hfp_ag_indicators_ok 
46d5 c00346e7 beq hf_state_waiting_ag_status_ok ,hfp_ag_status_ok 
46d6 c00446e9 beq hf_state_waiting_ag_update_status_ok ,hfp_ag_update_status_ok 
46d7 20600000 rtn 

hfp_result_ok_cmd:
46d8 44f2c01c bpatch patch1c_5 ,mem_patch1c 
46d9 6fe24314 fetch 1 ,mem_hf_command 
46da c000c6df beq hf_wait_accept_call_ok ,hfp_acceptcall 
46db c00146df beq hf_wait_hangup_ok ,hfp_hangup 
46dc c001c6e1 beq hf_wait_vgs_ok ,hfp_vgs_ok 
46dd c00246df beq hf_wait_vgm_ok ,hfp_vgm_ok 
46de 20600000 rtn 

hfp_acceptcall:

hfp_hangup:

hfp_vgm_ok:
46df 70431400 jam hf_cmd_idle ,mem_hf_command 
46e0 20600000 rtn 

hfp_vgs_ok:
46e1 70431400 jam hf_cmd_idle ,mem_hf_command 
46e2 20600000 rtn 

hfp_ag_feature_ok:
46e3 70431203 jam hf_state_hf_send_indicators ,mem_hf_state 
46e4 20600000 rtn 

hfp_ag_indicators_ok:
46e5 70431205 jam hf_state_hf_send_curr_status ,mem_hf_state 
46e6 20600000 rtn 

hfp_ag_status_ok:
46e7 70431207 jam hf_state_hf_send_update_status ,mem_hf_state 
46e8 20600000 rtn 

hfp_ag_update_status_ok:
46e9 7043120a jam hf_state_hf_send_receive_info ,mem_hf_state 
46ea 20600000 rtn 

hfp_ag_receive_info_ok:
46eb 7043120c jam hf_state_hf_send_at_clip ,mem_hf_state 
46ec 20600000 rtn 

hfp_ag_enable_clip_ok:
46ed 7043120e jam hf_state_hf_send_at_ccwa ,mem_hf_state 
46ee 20600000 rtn 

hfp_ag_enable_call_waiting_ok:
46ef 204044d0 call send_at_vgs 
46f0 70431209 jam hf_state_connected ,mem_hf_state 
46f1 700b0860 jam bt_evt_hfp_connected ,mem_fifo_temp 
46f2 202071ee branch ui_ipc_send_event 

hfp_is_result_vgm_vgs:
46f3 6fe4432a fetch 2 ,mem_at_command_ptr 
46f4 1fe20c00 icopy contr 
46f5 efe20006 ifetch 1 ,contr 
46f6 c1958000 rtnne 0x2b 
46f7 efe20006 ifetch 1 ,contr 
46f8 c1ab0000 rtnne 0x56 
46f9 efe20006 ifetch 1 ,contr 
46fa c1a38000 rtnne 0x47 
46fb efe20006 ifetch 1 ,contr 
46fc 78347c00 enable user 
46fd c026c703 beq 0x4d ,hfp_vgm_changed 
46fe c029c700 beq 0x53 ,hfp_vgs_changed 
46ff 20600000 rtn 

hfp_vgs_changed:
4700 204045c3 call hfp_translate_ascii_to_hex 
4701 60424325 storet 1 ,mem_hf_vlm_speaker 
4702 20600000 rtn 

hfp_vgm_changed:
4703 204045c3 call hfp_translate_ascii_to_hex 
4704 60424327 storet 1 ,mem_hf_vlm_mic 
4705 20600000 rtn 

hfp_is_result_ccwa:
4706 6fe4432a fetch 2 ,mem_at_command_ptr 
4707 1fe20c00 icopy contr 
4708 efe20006 ifetch 1 ,contr 
4709 c1958000 rtnne 0x2b 
470a efe20006 ifetch 1 ,contr 
470b c1a18000 rtnne 0x43 
470c efe20006 ifetch 1 ,contr 
470d c1a18000 rtnne 0x43 
470e efe20006 ifetch 1 ,contr 
470f c1ab8000 rtnne 0x57 
4710 efe20006 ifetch 1 ,contr 
4711 c1a08000 rtnne 0x41 
4712 78347c00 enable user 
4713 20204722 branch hfp_is_result_clip_loop 

hfp_is_result_clip:
4714 44f3401c bpatch patch1c_6 ,mem_patch1c 
4715 6fe4432a fetch 2 ,mem_at_command_ptr 
4716 1fe20c00 icopy contr 
4717 efe20006 ifetch 1 ,contr 
4718 c1958000 rtnne 0x2b 
4719 efe20006 ifetch 1 ,contr 
471a c1a18000 rtnne 0x43 
471b efe20006 ifetch 1 ,contr 
471c c1a60000 rtnne 0x4c 
471d efe20006 ifetch 1 ,contr 
471e c1a48000 rtnne 0x49 
471f efe20006 ifetch 1 ,contr 
4720 c1a80000 rtnne 0x50 
4721 78347c00 enable user 

hfp_is_result_clip_loop:
4722 efe20006 ifetch 1 ,contr 
4723 c0914722 bne 0x22 ,hfp_is_result_clip_loop 
4724 18002200 force 0 ,rega 
4725 18002430 force 0x30 ,regb 
4726 d8a002db arg mem_phone_number ,contw 

hfp_is_result_clip_phone_num:
4727 efe20006 ifetch 1 ,contr 
4728 c011472d beq 0x22 ,hfp_is_result_clip_end 
4729 1a20a201 increase 1 ,rega 
472a 9a467e00 isub regb ,pdata 
472b e7e20005 istore 1 ,contw 
472c 20204727 branch hfp_is_result_clip_phone_num 

hfp_is_result_clip_end:
472d 1a227e00 deposit rega 
472e 67e202da store 1 ,mem_phone_num_len 
472f 20600000 rtn 

hfp_handle_at_result_code:
4730 44f3c01c bpatch patch1c_7 ,mem_patch1c 
4731 78547c00 disable user 
4732 204046c5 call hfp_is_result_ok 
4733 20740000 rtn user 
4734 204045d8 call hfp_is_result_error 
4735 20740000 rtn user 
4736 204046a7 call hfp_is_result_brsf 
4737 20740000 rtn user 
4738 204045f3 call hfp_is_result_ciev 
4739 20740000 rtn user 
473a 204045e7 call hfp_is_result_ring 
473b 20740000 rtn user 
473c 20404610 call hfp_is_result_cind 
473d 20740000 rtn user 
473e 204046b7 call hfp_is_result_chld 
473f 20740000 rtn user 
4740 204046f3 call hfp_is_result_vgm_vgs 
4741 20740000 rtn user 
4742 20404714 call hfp_is_result_clip 
4743 20740000 rtn user 
4744 20404706 call hfp_is_result_ccwa 
4745 20740000 rtn user 
4746 6fe44330 fetch 2 ,mem_cb_hfp_result_code 
4747 20207897 branch callback_func 

hfp_tx_rfcomm_without_credit:
4748 44f4401d bpatch patch1d_0 ,mem_patch1d 
4749 6fe445b0 fetch 2 ,mem_remote_credits 
474a 207a0000 rtn blank 
474b 1fe0ffff increase -1 ,pdata 
474c 67e445b0 store 2 ,mem_remote_credits 
474d 6b0445b7 fetchr regd ,2 ,mem_rfc_l2capch_ptr 
474e 6fe245ae fetch 1 ,mem_hiufcs_spp 
474f 67e20581 store 1 ,mem_rfcomm_send_fcs 
4750 580000ef setarg rsp_tx_uih 
4751 67e20580 store 1 ,mem_rfcomm_send_frame_type 
4752 204061d9 call rfc_get_rfcomm_snd_adss 
4753 6fe445b4 fetch 2 ,mem_current_packet_length 
4754 1fe0fe04 increase 4 ,pdata 
4755 1fe22200 icopy rega 
4756 20404aab call l2cap_malloc_server_channel 
4757 6fe2057f fetch 1 ,mem_rfcomm_send_adss 
4758 e7e20005 istore 1 ,contw 
4759 6fe20580 fetch 1 ,mem_rfcomm_send_frame_type 
475a e7e20005 istore 1 ,contw 
475b 2040611c call rfc_tx_write_length 
475c 6fe445b4 fetch 2 ,mem_current_packet_length 
475d 1fe27200 copy pdata ,loopcnt 
475e 6fe4432c fetch 2 ,mem_at_rfcomm_data_ptr 
475f 1fe20c00 copy pdata ,contr 
4760 2040779f call memcpy 
4761 6fe20581 fetch 1 ,mem_rfcomm_send_fcs 
4762 e7e20005 istore 1 ,contw 
4763 7045b200 jam 0 ,mem_credit_given 
4764 58000000 setarg 0 
4765 67e445b4 store 2 ,mem_current_packet_length 
4766 20600000 rtn 

hfp_adc_init:
4767 44f4c01d bpatch patch1d_1 ,mem_patch1d 
4768 6fe480fc fetch 2 ,core_pcmin_saddr 
4769 67e4803c store 2 ,core_adcd_saddr 
476a 6a2480fa fetchr rega ,2 ,core_cvsd_len 
476b 1a20a201 increase 1 ,rega 
476c 1a23a200 lshift rega ,rega 
476d 1a20a3ff increase -1 ,rega 
476e 9a20fe00 iadd rega ,pdata 
476f 67e4803e store 2 ,core_adcd_eaddr 
4770 70803808 jam 0x08 ,core_adcd_dcoff 
4771 58000000 setarg 0 
4772 67e4803a store 2 ,core_adcd_delay 

hfp_adc_stop:
4773 70803b50 jam 0x50 ,core_adcd_ctrl 
4774 20600000 rtn 

hfp_adc_start:
4775 70803bd0 jam 0xd0 ,core_adcd_ctrl 
4776 20600000 rtn 

hfp_dac_init:
4777 44f5401d bpatch patch1d_2 ,mem_patch1d 
4778 70810638 jam 0x38 ,core_dac_ctrl 
4779 200008fc nop 2300 
477a 70810608 jam 0x08 ,core_dac_ctrl 
477b 6fe480fe fetch 2 ,core_pcmout_saddr 
477c 67e48104 store 2 ,core_dac_wptr 
477d 67e48100 store 2 ,core_dac_saddr 
477e 6fe480fa fetch 2 ,core_cvsd_len 
477f 1fe0fe01 increase 1 ,pdata 
4780 1fe3fe00 lshift pdata ,pdata 
4781 1fe0ffff increase -1 ,pdata 
4782 67e48102 store 2 ,core_dac_len 
4783 7081070d jam 0x0d ,core_dac_sel 
4784 70810618 jam 0x18 ,core_dac_ctrl 
4785 2000000a nop 10 
4786 70810608 jam 0x08 ,core_dac_ctrl 
4787 70810606 jam 0x6 ,core_dac_ctrl 
4788 70810800 jam 0 ,core_dac_lvol 
4789 70810900 jam 0 ,core_dac_rvol 
478a 20600000 rtn 

hfp_dac_updatewptr:
478b 67e48104 store 2 ,core_dac_wptr 
478c 204047b3 call hfp_get_vol 
478d 6fe28108 fetch 1 ,core_dac_lvol 
478e 20205f9f branch audio_voice_adjust_common 

hfp_clear_dac_mem:
478f 6f248102 fetchr loopcnt ,2 ,core_dac_len 
4790 1f20f201 increase 1 ,loopcnt 
4791 68a48100 fetchr contw ,2 ,core_dac_saddr 
4792 6fe28106 fetch 1 ,core_dac_ctrl 
4793 c300c2f6 bbit0 dac_mram_sel ,cvsd_set_0x00 
4794 79200a10 set1 mram_high_bit ,contw 
4795 202042f6 branch cvsd_set_0x00 

hfp_dac_start:
4796 2040478f call hfp_clear_dac_mem 
4797 6fe28106 fetch 1 ,core_dac_ctrl 
4798 79207e00 set1 dac_enable ,pdata 

hfp_dac_ctrl_cfg:
4799 67e28106 store 1 ,core_dac_ctrl 
479a 20600000 rtn 

hfp_dac_stop:
479b 6fe28106 fetch 1 ,core_dac_ctrl 
479c 793ffe00 set0 dac_enable ,pdata 
479d 79207e03 set1 dac_mutu ,pdata 
479e 20204799 branch hfp_dac_ctrl_cfg 

hfp_voice_start:
479f 44f5c01d bpatch patch1d_3 ,mem_patch1d 
47a0 70429600 jam avd_audio_forbid ,mem_audio_allow 
47a1 20405fb8 call sbc_hw_wait 
47a2 70806400 jam 0 ,core_sbc_ctrl 
47a3 6fe2894d fetch 1 ,rf_rx_ib_lna 
47a4 79207e00 set1 0 ,pdata 
47a5 67e2894d store 1 ,rf_rx_ib_lna 
47a6 200007d0 nop 2000 
47a7 204042bd call cvsd_init 
47a8 204042ef call cvsd_push_0x55_to_cvsd_fifo 
47a9 20404767 call hfp_adc_init 
47aa 20404777 call hfp_dac_init 
47ab 20404775 call hfp_adc_start 
47ac 200003e8 nop 1000 
47ad 204042e1 call cvsd_start 
47ae 20204796 branch hfp_dac_start 

hfp_voice_stop:
47af 44f6401d bpatch patch1d_4 ,mem_patch1d 
47b0 2040479b call hfp_dac_stop 
47b1 20404773 call hfp_adc_stop 
47b2 202042e7 branch cvsd_stop 

hfp_get_vol:
47b3 44f6c01d bpatch patch1d_5 ,mem_patch1d 
47b4 6fe24325 fetch 1 ,mem_hf_vlm_speaker 
47b5 c007c7b9 beq hfp_speaker_max_vlm ,hfp_get_max_vol 
47b6 1fe0fe01 increase 1 ,pdata 
47b7 1fe98400 lshift3 pdata ,temp 
47b8 20600000 rtn 

hfp_get_max_vol:
47b9 d8400080 arg 0x80 ,temp 
47ba 20600000 rtn 

hfp_adjust_max_volume:
47bb 70810880 jam 0x80 ,core_dac_lvol 
47bc 70810980 jam 0x80 ,core_dac_rvol 

send_evt_max_vol:
47bd 700b0863 jam bt_evt_hfp_up_to_max_vlm ,mem_fifo_temp 
47be 202071ee branch ui_ipc_send_event 

hfp_adjust_mute:
47bf 6fe28106 fetch 1 ,core_dac_ctrl 
47c0 79207e03 set1 dac_mutu ,pdata 
47c1 67e28106 store 1 ,core_dac_ctrl 
47c2 700b0864 jam bt_evt_hfp_down_to_min_vlm ,mem_fifo_temp 
47c3 202071ee branch ui_ipc_send_event 

ipc_init:
47c4 44f7401d bpatch patch1d_6 ,mem_patch1d 
47c5 6fe24335 fetch 1 ,mem_ipc_enable 
47c6 207a0000 rtn blank 
47c7 70433400 jam mcu_state_idle ,mem_ipc_mcu_state 
47c8 70433300 jam mcu_phase_idle ,mem_ipc_mcu_phase 
47c9 204047d1 call ipc_clear_mem_block 
47ca 58010350 setarg ipc_to_m0_buf_start_addr 
47cb 67e70308 store 3 ,ipc_to_m0_wptr_addr 
47cc 67e7030c store 3 ,ipc_to_m0_rptr_addr 
47cd 58010000 setarg ipc_to_bt_buf_start_addr 
47ce 67e70300 store 3 ,ipc_to_bt_wptr_addr 
47cf 67e70304 store 3 ,ipc_to_bt_rptr_addr 
47d0 20600000 rtn 

ipc_clear_mem_block:
47d1 44f7c01d bpatch patch1d_7 ,mem_patch1d 
47d2 58010500 setarg ipc_mem_elock_end 
47d3 d8a10000 arg ipc_mem_block_start ,contw 
47d4 98a67200 isub contw ,loopcnt 
47d5 2020776c branch clear_mem 

ipc_rx_block_read:
47d6 44f8401e bpatch patch1e_0 ,mem_patch1e 
47d7 204047df call ipc_rx_byte_read 
47d8 e7e20005 istore 1 ,contw 
47d9 c20047d6 loop ipc_rx_block_read 
47da 18a22600 copy contw ,regc 

ipc_rx_block_read_end:
47db 204047e2 call ipc_rx_rptr_loopback 
47dc 18c27e00 deposit contr 
47dd 67e70304 store 3 ,ipc_to_bt_rptr_addr 
47de 20600000 rtn 

ipc_rx_byte_read:
47df 204047e2 call ipc_rx_rptr_loopback 
47e0 efe20006 ifetch 1 ,contr 
47e1 20600000 rtn 

ipc_rx_rptr_loopback:
47e2 58010300 setarg ipc_to_bt_buf_end_addr 
47e3 98c67c00 isub contr ,null 
47e4 24628000 nrtn zero 
47e5 d8c10000 arg ipc_to_bt_buf_start_addr ,contr 
47e6 20600000 rtn 

ipc_rx_items_inquire:
47e7 6fe70304 fetch 3 ,ipc_to_bt_rptr_addr 
47e8 68470300 fetcht 3 ,ipc_to_bt_wptr_addr 

ipc_check_items:

isub_pdata_temp:
47e9 98467c00 isub temp ,null 
47ea 20600000 rtn 

ipc_tx_items_inquire:
47eb 6fe7030c fetch 3 ,ipc_to_m0_rptr_addr 
47ec 68470308 fetcht 3 ,ipc_to_m0_wptr_addr 
47ed 202047e9 branch ipc_check_items 

ipc_check_enter_lpm:
47ee 6fe24335 fetch 1 ,mem_ipc_enable 
47ef 207a0000 rtn blank 
47f0 44f8c01e bpatch patch1e_1 ,mem_patch1e 
47f1 204047e7 call ipc_rx_items_inquire 
47f2 2422f905 nbranch setarg1 ,zero 
47f3 204047eb call ipc_tx_items_inquire 
47f4 2422f905 nbranch setarg1 ,zero 
47f5 70433402 jam mcu_state_lpm ,mem_ipc_mcu_state 
47f6 2000001e nop 30 
47f7 20404800 call ipc_wait_m0_ack 
47f8 6fe24333 fetch 1 ,mem_ipc_mcu_phase 
47f9 c000c7fe beq mcu_phase1_nack ,ipc_check_noenter_lpm 
47fa 204047e7 call ipc_rx_items_inquire 
47fb 2422c7fe nbranch ipc_check_noenter_lpm ,zero 

ipc_check_enter_lpm_end:
47fc 70433304 jam mcu_phase2_ack ,mem_ipc_mcu_phase 
47fd 20207907 branch setarg0 

ipc_check_noenter_lpm:
47fe 70433300 jam mcu_phase_idle ,mem_ipc_mcu_phase 
47ff 20207905 branch setarg1 

ipc_wait_m0_ack:
4800 6fe24334 fetch 1 ,mem_ipc_mcu_state 
4801 243a4800 nbranch ipc_wait_m0_ack ,blank 
4802 20600000 rtn 

ipc_rx_block_clear:
4803 204047df call ipc_rx_byte_read 
4804 c20047d6 loop ipc_rx_block_read 
4805 202047db branch ipc_rx_block_read_end 

ipc_tx_wptr_loopback:
4806 58010500 setarg ipc_to_m0_buf_end_addr 
4807 98a67c00 isub contw ,null 
4808 24628000 nrtn zero 
4809 d8a10350 arg ipc_to_m0_buf_start_addr ,contw 
480a 20600000 rtn 

ipc_tx_byte_write:
480b 20404806 call ipc_tx_wptr_loopback 
480c e0420005 istoret 1 ,contw 
480d 20600000 rtn 

ipc_tx_block_write:
480e e8420006 ifetcht 1 ,contr 
480f 2040480b call ipc_tx_byte_write 
4810 c200480e loop ipc_tx_block_write 

ipc_tx_block_write_end:
4811 20404806 call ipc_tx_wptr_loopback 
4812 18a27e00 deposit contw 
4813 67e70308 store 3 ,ipc_to_m0_wptr_addr 
4814 20600000 rtn 

ipc_check_tx_buf_is_enough:
4815 44f9401e bpatch patch1e_2 ,mem_patch1e 
4816 78547c00 disable user 
4817 6fe70308 fetch 3 ,ipc_to_m0_wptr_addr 
4818 1fe20a00 icopy contw 
4819 6fe7030c fetch 3 ,ipc_to_m0_rptr_addr 
481a 1fe22200 icopy rega 

ipc_check_tx_buffer_ptr:
481b 18a08a01 increase 1 ,contw 
481c 20404806 call ipc_tx_wptr_loopback 
481d 1a227e00 copy rega ,pdata 
481e 98a67c00 isub contw ,null 
481f 2022c823 branch ipc_check_tx_buffer_not_enouth ,zero 
4820 c200481b loop ipc_check_tx_buffer_ptr 
4821 78347c00 enable user 
4822 20600000 rtn 

ipc_check_tx_buffer_not_enouth:
4823 6fe4433c fetch 2 ,mem_ipc_loss_packet 
4824 1fe0fe01 increase 1 ,pdata 
4825 67e4433c store 2 ,mem_ipc_loss_packet 
4826 20600000 rtn 

ipc_rx_process:
4827 44f9c01e bpatch patch1e_3 ,mem_patch1e 
4828 6fe24335 fetch 1 ,mem_ipc_enable 
4829 207a0000 rtn blank 
482a 204047e7 call ipc_rx_items_inquire 
482b 20628000 rtn zero 
482c 1fe20c00 icopy contr 
482d 204047df call ipc_rx_byte_read 
482e c000c831 beq ipc_type_cmd ,ipc_rx_cmd 
482f c002c838 beq ipc_type_ble ,ipc_rx_ble 
4830 20203b25 branch assert 

ipc_rx_cmd:
4831 44fa401e bpatch patch1e_4 ,mem_patch1e 
4832 204047df call ipc_rx_byte_read 
4833 204047df call ipc_rx_byte_read 
4834 67e20b08 store 1 ,mem_fifo_temp 
4835 204047db call ipc_rx_block_read_end 
4836 6fe20b08 fetch 1 ,mem_fifo_temp 
4837 202071f8 branch ui_ipc_send_cmd 

ipc_rx_ble:
4838 44fac01e bpatch patch1e_5 ,mem_patch1e 
4839 18c22200 copy contr ,rega 
483a 204052ae call le_fifo_check_full 
483b 247a0000 nrtn blank 
483c 6fe446c1 fetch 2 ,mem_ui_state_map 
483d 2fec0009 isolate0 ui_state_ble_connected ,pdata 
483e 2020c850 branch ipc_rx_ble_discard_packet ,true 
483f 1a220c00 copy rega ,contr 
4840 204047df call ipc_rx_byte_read 
4841 67e24336 store 1 ,mem_ipc_le_data_len 
4842 204047df call ipc_rx_byte_read 
4843 67e404e7 store 2 ,mem_le_att_handle 
4844 204047df call ipc_rx_byte_read 
4845 18c27e00 copy contr ,pdata 
4846 67e60b0d store 3 ,mem_temp 
4847 6a224336 fetchr rega ,1 ,mem_ipc_le_data_len 
4848 1a20a3fe increase -2 ,rega 
4849 684404e7 fetchr temp ,2 ,mem_le_att_handle 
484a 20404da2 call le_att_malloc_tx_notify 
484b 6f224336 fetchr loopcnt ,1 ,mem_ipc_le_data_len 
484c 1f20f3fe increase -2 ,loopcnt 
484d 6fe60b0d fetch 3 ,mem_temp 
484e 1fe20c00 icopy contr 
484f 202047d6 branch ipc_rx_block_read 

ipc_rx_ble_discard_packet:
4850 1a220c00 copy rega ,contr 
4851 204047df call ipc_rx_byte_read 
4852 1fe27200 icopy loopcnt 
4853 20204803 branch ipc_rx_block_clear 

ipc_tx_common:
4854 44fb401e bpatch patch1e_6 ,mem_patch1e 
4855 6f224339 fetchr loopcnt ,1 ,mem_ipc_tx_data_len 
4856 20404815 call ipc_check_tx_buf_is_enough 
4857 24740000 nrtn user 
4858 6f224339 fetchr loopcnt ,1 ,mem_ipc_tx_data_len 
4859 6fe70308 fetch 3 ,ipc_to_m0_wptr_addr 
485a 1fe20a00 icopy contw 
485b 6fe4433a fetch 2 ,mem_ipc_tx_data_ptr 
485c 1fe20c00 icopy contr 
485d 2020480e branch ipc_tx_block_write 

ipc_tx_bt_event:
485e 44fbc01e bpatch patch1e_7 ,mem_patch1e 
485f 6fe24335 fetch 1 ,mem_ipc_enable 
4860 207a0000 rtn blank 
4861 18007203 force 3 ,loopcnt 
4862 20404815 call ipc_check_tx_buf_is_enough 
4863 24740000 nrtn user 
4864 6fe70308 fetch 3 ,ipc_to_m0_wptr_addr 
4865 1fe20a00 icopy contw 
4866 d8400002 arg ipc_type_evt ,temp 
4867 2040480b call ipc_tx_byte_write 
4868 18000401 force 1 ,temp 
4869 2040480b call ipc_tx_byte_write 
486a 68420b08 fetchr temp ,1 ,mem_fifo_temp 
486b 2040480b call ipc_tx_byte_write 
486c 20204811 branch ipc_tx_block_write_end 

ipc_tx_bt_ble_test:
486d 7043390a jam 10 ,mem_ipc_tx_data_len 
486e 58004341 setarg mem_ipc_test_buff 

ipc_tx_buffer:
486f 67e4433a store 2 ,mem_ipc_tx_data_ptr 
4870 20204854 branch ipc_tx_common 

ipc_hfp_evt_received:
4871 70003f01 jam 1 ,pdata 
4872 da40000b arg ipc_type_hfp ,regb 
4873 da600b08 arg mem_fifo_temp ,regc 
4874 20204854 branch ipc_tx_common 

l2cap_init:
4875 2035c87a branch l2cap_init_wake ,wake 

l2cap_init_work:
4876 580043a7 setarg mem_l2cap_xmem_end 
4877 d8a0434b arg mem_l2cap_xmem_start ,contw 
4878 98a67200 isub contw ,loopcnt 
4879 2040776c call clear_mem 

l2cap_init_wake:
487a 44fc401f bpatch patch1f_0 ,mem_patch1f 
487b 580042ea setarg mem_avctp_xmem_end 
487c d8a042e6 arg mem_avctp_xmem_start ,contw 
487d 98a67200 isub contw ,loopcnt 
487e 2040776c call clear_mem 
487f 5800429b setarg mem_avdtp_xmem_end 
4880 d8a04292 arg mem_avdtp_xmem_start ,contw 
4881 98a67200 isub contw ,loopcnt 
4882 2040776c call clear_mem 
4883 580005c2 setarg mem_sdp_mem_end 
4884 d8a00582 arg mem_sdp_mem_start ,contw 
4885 98a67200 isub contw ,loopcnt 
4886 2040776c call clear_mem 
4887 580046e4 setarg mem_uppersm_xmem_end 
4888 d8a046dc arg mem_uppersm_xmem_start ,contw 
4889 98a67200 isub contw ,loopcnt 
488a 2040776c call clear_mem 
488b 580042f9 setarg mem_hid_xmem_end 
488c d8a042f9 arg mem_hid_xmem_end ,contw 
488d 98a67200 isub contw ,loopcnt 
488e 2040776c call clear_mem 
488f 58000365 setarg mem_l2cap_mem_end 
4890 d8a00309 arg mem_l2cap_mem_start ,contw 
4891 98a67200 isub contw ,loopcnt 
4892 2040776c call clear_mem 
4893 580045bb setarg mem_rfc_xmem_end 
4894 d8a045a6 arg mem_rfc_xmem_start ,contw 
4895 98a67200 isub contw ,loopcnt 
4896 2020776c branch clear_mem 

process_rx_l2cap_pkt:
4897 18c20400 copy contr ,temp 
4898 efe40006 ifetch 2 ,contr 
4899 67e40313 store 2 ,mem_l2cap_rx_pkt_length 
489a efe40006 ifetch 2 ,contr 
489b 67e40315 store 2 ,mem_l2cap_rx_cid 
489c 18c27e00 deposit contr 
489d 67e40311 store 2 ,mem_l2cap_payload_ptr 
489e 6fe40313 fetch 2 ,mem_l2cap_rx_pkt_length 
489f 203a48d4 branch l2cap_rx_reset_state ,blank 
48a0 6fe246ea fetch 1 ,mem_tws_state 
48a1 c30048a4 bbit0 tws_state_enable ,process_normal_rx_l2cap_pkt 
48a2 c30248a4 bbit0 tws_state_slave_listening ,process_normal_rx_l2cap_pkt 
48a3 c30348b9 bbit0 tws_state_master ,process_listen_tws_rx_l2cap_pkt 

process_normal_rx_l2cap_pkt:
48a4 6fe40315 fetch 2 ,mem_l2cap_rx_cid 
48a5 c000c8c1 beq l2cap_signal_channel ,l2cap_call_proc_signal 
48a6 1fe22200 copy pdata ,rega 
48a7 20404b24 call l2cap_get_channel_info_by_local_cid 
48a8 1a623000 copy regc ,regd 
48a9 44fcc01f bpatch patch1f_1 ,mem_patch1f 
48aa efe20013 ifetch 1 ,regc 
48ab c000c8c5 beq psm_sdp ,l2cap_call_proc_sdp 
48ac c001c8ce beq psm_rfcomm ,l2cap_call_proc_rfcomm 
48ad c008c43b beq psm_hid_control ,l2cap_call_proc_hid 
48ae c009c43b beq psm_hid_interrupt ,l2cap_call_proc_hid 
48af c00bc261 beq psm_avctp ,l2cap_call_proc_avctp 
48b0 c08cc8d4 bne psm_avdtp ,l2cap_rx_reset_state 
48b1 44fd401f bpatch patch1f_2 ,mem_patch1f 
48b2 6fe44292 fetch 2 ,mem_avdtpsignal_l2capch_ptr 
48b3 9a667c00 isub regc ,null 
48b4 2022c022 branch l2cap_call_proc_avdtp ,zero 
48b5 6fe44294 fetch 2 ,mem_avdtpmedia_l2capch_ptr 
48b6 9a667c00 isub regc ,null 
48b7 2022c034 branch l2cap_call_proc_avdtp_media ,zero 
48b8 20203b25 branch assert 

process_listen_tws_rx_l2cap_pkt:
48b9 6fe40315 fetch 2 ,mem_l2cap_rx_cid 
48ba 684442ad fetcht 2 ,mem_avdtp_signal 
48bb 98467c00 isub temp ,null 
48bc 2022c022 branch l2cap_call_proc_avdtp ,zero 
48bd 684442af fetcht 2 ,mem_avdtp_media 
48be 98467c00 isub temp ,null 
48bf 2022c034 branch l2cap_call_proc_avdtp_media ,zero 
48c0 202048d4 branch l2cap_rx_reset_state 

l2cap_call_proc_signal:
48c1 20404a5a call l2cap_malloc_is_fifo_full 
48c2 247a0000 nrtn blank 
48c3 204048d6 call l2cap_process_signal_pkt 
48c4 202048d4 branch l2cap_rx_reset_state 

l2cap_call_proc_sdp:
48c5 20404a61 call l2cap_malloc_is_fifo_empty 
48c6 247a0000 nrtn blank 
48c7 20404ab7 call l2cap_malloc_sdp_channel 
48c8 20406233 call sdp_process 
48c9 20404ac0 call l2cap_get_sdp_tx_buff 
48ca 6fe4031d fetch 2 ,mem_sdp_tx_pkt_length 
48cb 203a48d2 branch l2cap_call_proc_no_reply ,blank 
48cc e7e40005 istore 2 ,contw 
48cd 202048d4 branch l2cap_rx_reset_state 

l2cap_call_proc_rfcomm:
48ce 20404a5a call l2cap_malloc_is_fifo_full 
48cf 247a0000 nrtn blank 
48d0 20405ffc call l2cap_rfc_process 
48d1 202048d4 branch l2cap_rx_reset_state 

l2cap_call_proc_no_reply:
48d2 44fdc01f bpatch patch1f_3 ,mem_patch1f 
48d3 20404a50 call l2cap_malloc_discard 

l2cap_rx_reset_state:
48d4 70031701 jam l2cap_rx_done ,mem_l2cap_rx_done 
48d5 20600000 rtn 

l2cap_process_signal_pkt:
48d6 44fe401f bpatch patch1f_4 ,mem_patch1f 
48d7 18002400 force 0 ,regb 
48d8 6fe40313 fetch 2 ,mem_l2cap_rx_pkt_length 
48d9 1fe22600 copy pdata ,regc 
48da 6fe40311 fetch 2 ,mem_l2cap_payload_ptr 
48db 98000c00 iforce contr 
48dc efe20006 ifetch 1 ,contr 
48dd c00548e9 beq signal_info_req ,l2cap_proc_signal_info_req 
48de c005ca20 beq signal_info_rsp ,l2cap_proc_signal_info_rsp 
48df c000c908 beq signal_cmd_reject ,l2cap_proc_signal_cmd_reject 
48e0 c0014909 beq signal_connect_req ,l2cap_proc_signal_connect_req 
48e1 c001c97a beq signal_connect_rsp ,l2cap_proc_signal_connect_rsp 
48e2 c0024992 beq signal_config_req ,l2cap_proc_signal_config_req 
48e3 c002c9b2 beq signal_config_rsp ,l2cap_proc_signal_config_rsp 
48e4 c00349f4 beq signal_disconnect_req ,l2cap_proc_signal_disconnect_req 
48e5 c003ca13 beq signal_disconnect_rsp ,l2cap_proc_signal_disconnect_rsp 
48e6 c0044a1c beq signal_echo_req ,l2cap_proc_signal_echo_req 
48e7 c004ca1e beq signal_echo_rsp ,l2cap_proc_signal_echo_rsp 
48e8 20204a22 branch l2cap_reject_command 

l2cap_proc_signal_info_req:
48e9 efe20006 ifetch 1 ,contr 
48ea 67e20318 store 1 ,mem_l2cap_signal_ident 
48eb 18c08c02 increase 2 ,contr 
48ec efe40006 ifetch 2 ,contr 
48ed c00148f0 beq l2cap_sig_ext_featrue ,l2cap_send_signal_info_req_ext 
48ee c001c8fc beq l2cap_sig_fix_featrue ,l2cap_send_signal_info_req_fix 
48ef 20203b25 branch assert 

l2cap_send_signal_info_req_ext:
48f0 44fec01f bpatch patch1f_5 ,mem_patch1f 
48f1 da20000c arg 12 ,rega 
48f2 20404aa5 call l2cap_malloc_signal_channel 
48f3 5800000b setarg signal_info_rsp 
48f4 e7e20005 istore 1 ,contw 
48f5 6fe20318 fetch 1 ,mem_l2cap_signal_ident 
48f6 e7e20005 istore 1 ,contw 
48f7 58020008 setarg 0x020008 
48f8 e7ec0005 istore 6 ,contw 
48f9 58000280 setarg 0x0280 
48fa e7e80005 istore 4 ,contw 
48fb 20600000 rtn 

l2cap_send_signal_info_req_fix:
48fc 44ff401f bpatch patch1f_6 ,mem_patch1f 
48fd da200010 arg 16 ,rega 
48fe 20404aa5 call l2cap_malloc_signal_channel 
48ff 5800000b setarg signal_info_rsp 
4900 e7e20005 istore 1 ,contw 
4901 6fe20318 fetch 1 ,mem_l2cap_signal_ident 
4902 e7e20005 istore 1 ,contw 
4903 5803000c setarg 0x3000c 
4904 e7ec0005 istore 6 ,contw 
4905 58000006 setarg 0x0006 
4906 e7f00005 istore 8 ,contw 
4907 20600000 rtn 

l2cap_proc_signal_cmd_reject:
4908 20600000 rtn 

l2cap_proc_signal_connect_req:
4909 44ffc01f bpatch patch1f_7 ,mem_patch1f 
490a efe20006 ifetch 1 ,contr 
490b 67e20318 store 1 ,mem_l2cap_signal_ident 
490c 18c08c02 increase 2 ,contr 
490d efe40006 ifetch 2 ,contr 
490e 67e2035f store 1 ,mem_l2cap_temp_ch_psm 
490f e8440006 ifetcht 2 ,contr 
4910 60440363 storet 2 ,mem_l2cap_temp_remote_cid 
4911 20404914 call l2cap_check_psm 
4912 24343b25 nbranch assert ,user 
4913 2020491f branch l2cap_proc_signal_connect_req_allow_psm 

l2cap_check_psm:
4914 1fe22600 copy pdata ,regc 
4915 47004020 bpatchx patch20_0 ,mem_patch20 
4916 1a627e00 copy regc ,pdata 
4917 c000f903 beq psm_sdp ,enable_user 
4918 c001f903 beq psm_rfcomm ,enable_user 
4919 c008f903 beq psm_hid_control ,enable_user 
491a c009f903 beq psm_hid_interrupt ,enable_user 
491b c00bf903 beq psm_avctp ,enable_user 
491c c00cf903 beq psm_avdtp ,enable_user 
491d c00ff903 beq psm_att ,enable_user 
491e 202078ec branch disable_user 

l2cap_proc_signal_connect_req_allow_psm:
491f 4700c020 bpatchx patch20_1 ,mem_patch20 
4920 20404b48 call l2cap_get_random_local_cid 
4921 67e40361 store 2 ,mem_l2cap_temp_local_cid 
4922 58000000 setarg 0 
4923 79207e00 set1 l2cap_channel_state_conn_req ,pdata 
4924 67e20360 store 1 ,mem_l2cap_temp_ch_state 
4925 20404af0 call l2cap_create_empty_channel 
4926 6fec035f fetch 6 ,mem_l2cap_temp_ch_info 
4927 e7ec0013 istore 6 ,regc 
4928 20404b7a call l2cap_save_server_ptr 
4929 6fe2035f fetch 1 ,mem_l2cap_temp_ch_psm 
492a c000c95e beq psm_sdp ,l2cap_send_connect_res_pending 
492b 20204953 branch l2cap_send_connect_res_succ 

l2cap_prepare_send_connect_res_succ:
492c 47014020 bpatchx patch20_2 ,mem_patch20 
492d 6fe24362 fetch 1 ,mem_l2cap_pending_count 
492e 207a0000 rtn blank 
492f 20404a5a call l2cap_malloc_is_fifo_full 
4930 247a0000 nrtn blank 
4931 20404b58 call l2cap_get_active_pending_info 
4932 24740000 nrtn user 
4933 18c22200 copy contr ,rega 
4934 efe20006 ifetch 1 ,contr 
4935 67e20318 store 1 ,mem_l2cap_signal_ident 
4936 efe80006 ifetch 4 ,contr 
4937 ea640006 ifetchr regc ,2 ,contr 
4938 d8400050 arg 0x50 ,temp 
4939 98408400 iadd temp ,temp 
493a 1c427e00 copy clkn_bt ,pdata 
493b 98467c00 isub temp ,null 
493c 24610000 nrtn positive 
493d 58000000 setarg 0 
493e e7ee0011 istore 7 ,rega 
493f efe20013 ifetch 1 ,regc 
4940 c080bb25 bne psm_sdp ,assert 
4941 1a608c01 add regc ,offset_lc_state ,contr 
4942 e8420006 ifetcht 1 ,contr 
4943 da200000 arg 0 ,rega 
4944 79202200 set1 l2cap_channel_state_conn_req ,rega 
4945 da400000 arg 0 ,regb 
4946 79202401 set1 l2cap_channel_state_conn_res ,regb 
4947 1a227e00 copy rega ,pdata 
4948 9a41fe00 ior regb ,pdata 
4949 98417e00 iand temp ,pdata 
494a 9a267c00 isub rega ,null 
494b 2422bb25 nbranch assert ,zero 
494c 24628000 nrtn zero 
494d 6fe24362 fetch 1 ,mem_l2cap_pending_count 
494e 1fe0ffff increase -1 ,pdata 
494f 67e24362 store 1 ,mem_l2cap_pending_count 
4950 efec0013 ifetch 6 ,regc 
4951 67ec035f store 6 ,mem_l2cap_temp_ch_info 
4952 20204953 branch l2cap_send_connect_res_succ 

l2cap_send_connect_res_succ:
4953 4701c020 bpatchx patch20_3 ,mem_patch20 
4954 6fe24394 fetch 1 ,mem_l2cap_prepare_confreq_count 
4955 1fe0fe01 increase 1 ,pdata 
4956 67e24394 store 1 ,mem_l2cap_prepare_confreq_count 
4957 1a60a601 increase offset_lc_state ,regc 
4958 efe20013 ifetch 1 ,regc 
4959 79207e01 set1 l2cap_channel_state_conn_res ,pdata 
495a e7e20013 istore 1 ,regc 
495b db000000 arg l2cap_connect_successful ,regd 
495c dee00000 arg 0 ,rege 
495d 2020496a branch l2cap_send_connect_res 

l2cap_send_connect_res_pending:
495e 47024020 bpatchx patch20_4 ,mem_patch20 
495f 20404b4f call l2cap_get_empty_pending_info 
4960 6fe20318 fetch 1 ,mem_l2cap_signal_ident 
4961 e7e20005 istore 1 ,contw 
4962 1c427e00 copy clkn_bt ,pdata 
4963 e7e80005 istore 4 ,contw 
4964 e2640005 istorer regc ,2 ,contw 
4965 db000001 arg l2cap_connect_pending ,regd 
4966 dee00002 arg l2cap_authorization_pending ,rege 
4967 6fe24362 fetch 1 ,mem_l2cap_pending_count 
4968 1fe0fe01 increase 1 ,pdata 
4969 67e24362 store 1 ,mem_l2cap_pending_count 

l2cap_send_connect_res:
496a 4702c020 bpatchx patch20_5 ,mem_patch20 
496b da20000c arg 12 ,rega 
496c 20404aa5 call l2cap_malloc_signal_channel 
496d 58000003 setarg signal_connect_rsp 
496e e7e20005 istore 1 ,contw 
496f 6fe20318 fetch 1 ,mem_l2cap_signal_ident 
4970 e7e20005 istore 1 ,contw 
4971 58000008 setarg 8 
4972 e7e40005 istore 2 ,contw 
4973 6fe40361 fetch 2 ,mem_l2cap_temp_local_cid 
4974 e7e40005 istore 2 ,contw 
4975 6fe40363 fetch 2 ,mem_l2cap_temp_remote_cid 
4976 e7e40005 istore 2 ,contw 
4977 e3040005 istorer regd ,2 ,contw 
4978 e6e40005 istorer rege ,2 ,contw 
4979 20600000 rtn 

l2cap_proc_signal_connect_rsp:
497a 47034020 bpatchx patch20_6 ,mem_patch20 
497b efe20006 ifetch 1 ,contr 
497c 67e20318 store 1 ,mem_l2cap_signal_ident 
497d 18c08c02 increase 2 ,contr 
497e efe40006 ifetch 2 ,contr 
497f 67e40363 store 2 ,mem_l2cap_temp_remote_cid 
4980 e8440006 ifetcht 2 ,contr 
4981 60440361 storet 2 ,mem_l2cap_temp_local_cid 
4982 efe40006 ifetch 2 ,contr 
4983 c1800000 rtnne l2cap_connect_successful 
4984 6a240361 fetchr rega ,2 ,mem_l2cap_temp_local_cid 
4985 20404b24 call l2cap_get_channel_info_by_local_cid 
4986 24343b25 nbranch assert ,user 
4987 1a608a04 add regc ,offset_lc_remote_cid ,contw 
4988 6fe40363 fetch 2 ,mem_l2cap_temp_remote_cid 
4989 e7e40005 istore 2 ,contw 
498a 1a60a601 increase offset_lc_state ,regc 
498b efe20013 ifetch 1 ,regc 
498c 79207e01 set1 l2cap_channel_state_conn_res ,pdata 
498d e7e20013 istore 1 ,regc 
498e 6fe24394 fetch 1 ,mem_l2cap_prepare_confreq_count 
498f 1fe0fe01 increase 1 ,pdata 
4990 67e24394 store 1 ,mem_l2cap_prepare_confreq_count 
4991 20600000 rtn 

l2cap_proc_signal_config_req:
4992 4703c020 bpatchx patch20_7 ,mem_patch20 
4993 efe20006 ifetch 1 ,contr 
4994 67e20318 store 1 ,mem_l2cap_signal_ident 
4995 18c08c02 increase 2 ,contr 
4996 efe40006 ifetch 2 ,contr 
4997 67e40361 store 2 ,mem_l2cap_temp_local_cid 
4998 1fe22200 copy pdata ,rega 
4999 20404b24 call l2cap_get_channel_info_by_local_cid 
499a efec0013 ifetch 6 ,regc 
499b 67ec035f store 6 ,mem_l2cap_temp_ch_psm 
499c 24343b25 nbranch assert ,user 
499d 1a60a601 increase offset_lc_state ,regc 
499e efe20013 ifetch 1 ,regc 
499f 79207e04 set1 l2cap_channel_state_rcv_cfg_req ,pdata 
49a0 79207e03 set1 l2cap_channel_state_snd_cfg_res ,pdata 
49a1 e7e20013 istore 1 ,regc 

l2cap_proc_signal_config_res:
49a2 47044021 bpatchx patch21_0 ,mem_patch21 
49a3 da20000a arg 10 ,rega 
49a4 20404aa5 call l2cap_malloc_signal_channel 
49a5 58000005 setarg signal_config_rsp 
49a6 e7e20005 istore 1 ,contw 
49a7 6fe20318 fetch 1 ,mem_l2cap_signal_ident 
49a8 e7e20005 istore 1 ,contw 
49a9 58000006 setarg 6 
49aa e7e40005 istore 2 ,contw 
49ab 6fe40363 fetch 2 ,mem_l2cap_temp_remote_cid 
49ac e7e40005 istore 2 ,contw 
49ad 58000000 setarg 0 
49ae e7e40005 istore 2 ,contw 
49af 58000000 setarg l2cap_connect_successful 
49b0 e7e40005 istore 2 ,contw 
49b1 20600000 rtn 

l2cap_proc_signal_config_rsp:
49b2 4704c021 bpatchx patch21_1 ,mem_patch21 
49b3 efe20006 ifetch 1 ,contr 
49b4 67e20318 store 1 ,mem_l2cap_signal_ident 
49b5 18c08c02 increase 2 ,contr 
49b6 efe40006 ifetch 2 ,contr 
49b7 67e40361 store 2 ,mem_l2cap_temp_local_cid 
49b8 1fe22200 copy pdata ,rega 
49b9 20404b24 call l2cap_get_channel_info_by_local_cid 
49ba 1a60a601 increase offset_lc_state ,regc 
49bb efe20013 ifetch 1 ,regc 
49bc 79207e05 set1 l2cap_channel_state_rcv_cfg_res ,pdata 
49bd e7e20013 istore 1 ,regc 
49be 20600000 rtn 

l2cap_prepare_send_config_req:
49bf 47054021 bpatchx patch21_2 ,mem_patch21 
49c0 6fe24394 fetch 1 ,mem_l2cap_prepare_confreq_count 
49c1 207a0000 rtn blank 
49c2 20404a5a call l2cap_malloc_is_fifo_full 
49c3 247a0000 nrtn blank 
49c4 da200000 arg 0 ,rega 
49c5 79202200 set1 l2cap_channel_state_conn_req ,rega 
49c6 79202201 set1 l2cap_channel_state_conn_res ,rega 
49c7 da400000 arg 0 ,regb 
49c8 79202402 set1 l2cap_channel_state_snd_cfg_req ,regb 
49c9 20404b0f call l2cap_check_channel_state 
49ca 24740000 nrtn user 
49cb 18c08c01 increase 1 ,contr 
49cc 18c20a00 copy contr ,contw 
49cd efe20006 ifetch 1 ,contr 
49ce 79207e02 set1 l2cap_channel_state_snd_cfg_req ,pdata 
49cf e7e20005 istore 1 ,contw 
49d0 6fe24394 fetch 1 ,mem_l2cap_prepare_confreq_count 
49d1 1fe0ffff increase -1 ,pdata 
49d2 67e24394 store 1 ,mem_l2cap_prepare_confreq_count 
49d3 efec0013 ifetch 6 ,regc 
49d4 67ec035f store 6 ,mem_l2cap_temp_ch_info 
49d5 20404a24 call l2cap_get_req_id 
49d6 204049ea call l2cap_load_channel_param 

l2cap_send_config_req:
49d7 4705c021 bpatchx patch21_3 ,mem_patch21 
49d8 da20000c arg 12 ,rega 
49d9 20404aa5 call l2cap_malloc_signal_channel 
49da 58000004 setarg signal_config_req 
49db e7e20005 istore 1 ,contw 
49dc 6fe24397 fetch 1 ,mem_ml2cap_comm_id 
49dd e7e20005 istore 1 ,contw 
49de 58000008 setarg 8 
49df e7e40005 istore 2 ,contw 
49e0 6fe40363 fetch 2 ,mem_l2cap_temp_remote_cid 
49e1 e7e40005 istore 2 ,contw 
49e2 58000000 setarg 0 
49e3 e7e40005 istore 2 ,contw 
49e4 58000001 setarg 1 
49e5 e7e20005 istore 1 ,contw 
49e6 58000002 setarg 2 
49e7 e7e20005 istore 1 ,contw 
49e8 e6e40005 istorer rege ,2 ,contw 
49e9 20600000 rtn 

l2cap_load_channel_param:
49ea 47064021 bpatchx patch21_4 ,mem_patch21 
49eb 6fe2035f fetch 1 ,mem_l2cap_temp_ch_psm 
49ec dee003e3 arg l2cap_config_mtu_sdp ,rege 
49ed c1008000 rtneq psm_sdp 
49ee dee00100 arg l2cap_config_mtu_rfcomm ,rege 
49ef c1018000 rtneq psm_rfcomm 
49f0 dee002a0 arg l2cap_config_mtu_media ,rege 
49f1 c10c8000 rtneq psm_avdtp 
49f2 dee00080 arg l2cp_config_mtu_other ,rege 
49f3 20600000 rtn 

l2cap_proc_signal_disconnect_req:
49f4 4706c021 bpatchx patch21_5 ,mem_patch21 
49f5 efe20006 ifetch 1 ,contr 
49f6 67e20318 store 1 ,mem_l2cap_signal_ident 
49f7 18c08c02 increase 2 ,contr 
49f8 efe40006 ifetch 2 ,contr 
49f9 67e40361 store 2 ,mem_l2cap_temp_local_cid 
49fa 1fe22200 copy pdata ,rega 
49fb 20404b24 call l2cap_get_channel_info_by_local_cid 
49fc efec0013 ifetch 6 ,regc 
49fd 67ec035f store 6 ,mem_l2cap_temp_ch_psm 
49fe 1a623000 copy regc ,regd 
49ff 24347261 nbranch check_51cmd_disconnect ,user 
4a00 20404a05 call l2cap_send_signal_disconnect_res 
4a01 6a240361 fetchr rega ,2 ,mem_l2cap_temp_local_cid 
4a02 20404afd call l2cap_destory_channel 
4a03 1b022600 copy regd ,regc 
4a04 20204b61 branch l2cap_clear_server_ptr 

l2cap_send_signal_disconnect_res:
4a05 47074021 bpatchx patch21_6 ,mem_patch21 
4a06 da200008 arg 8 ,rega 
4a07 20404aa5 call l2cap_malloc_signal_channel 
4a08 58000007 setarg signal_disconnect_rsp 
4a09 e7e20005 istore 1 ,contw 
4a0a 6fe20318 fetch 1 ,mem_l2cap_signal_ident 
4a0b e7e20005 istore 1 ,contw 
4a0c 58000004 setarg 4 
4a0d e7e40005 istore 2 ,contw 
4a0e 6fe40361 fetch 2 ,mem_l2cap_temp_local_cid 
4a0f e7e40005 istore 2 ,contw 
4a10 6fe40363 fetch 2 ,mem_l2cap_temp_remote_cid 
4a11 e7e40005 istore 2 ,contw 
4a12 20600000 rtn 

l2cap_proc_signal_disconnect_rsp:
4a13 4707c021 bpatchx patch21_7 ,mem_patch21 
4a14 efe20006 ifetch 1 ,contr 
4a15 67e20318 store 1 ,mem_l2cap_signal_ident 
4a16 18c08c02 increase 2 ,contr 
4a17 efe40006 ifetch 2 ,contr 
4a18 67e40361 store 2 ,mem_l2cap_temp_local_cid 
4a19 efe40006 ifetch 2 ,contr 
4a1a 1fe22200 copy pdata ,rega 
4a1b 20204afd branch l2cap_destory_channel 

l2cap_proc_signal_echo_req:
4a1c 47084022 bpatchx patch22_0 ,mem_patch22 
4a1d 20203b25 branch assert 

l2cap_proc_signal_echo_rsp:
4a1e 4708c022 bpatchx patch22_1 ,mem_patch22 
4a1f 20600000 rtn 

l2cap_proc_signal_info_rsp:
4a20 47094022 bpatchx patch22_2 ,mem_patch22 
4a21 20600000 rtn 

l2cap_reject_command:
4a22 4709c022 bpatchx patch22_3 ,mem_patch22 
4a23 20203b25 branch assert 

l2cap_get_req_id:
4a24 470a4022 bpatchx patch22_4 ,mem_patch22 
4a25 6fe24397 fetch 1 ,mem_ml2cap_comm_id 
4a26 1fe0fe01 increase 1 ,pdata 
4a27 c0804a29 bne 0 ,l2cap_get_req_id_ok 
4a28 1fe0fe01 increase 1 ,pdata 

l2cap_get_req_id_ok:
4a29 67e24397 store 1 ,mem_ml2cap_comm_id 
4a2a 20600000 rtn 

l2cap_malloc:
4a2b 470ac022 bpatchx patch22_5 ,mem_patch22 
4a2c da400000 arg 0 ,regb 
4a2d 20404a5a call l2cap_malloc_is_fifo_full 
4a2e 243a3b25 nbranch assert ,blank 
4a2f 20404a6b call l2cap_malloc_get_full_map 
4a30 da401800 arg mem_tx_buff0 ,regb 
4a31 d8e00000 arg 0 ,queue 

l2cap_malloc_loop:
4a32 68424398 fetcht 1 ,mem_used_map 
4a33 a84fffff qisolate1 temp 
4a34 2020ca3a branch l2cap_malloc_next ,true 
4a35 20404a8d call l2cap_malloc_enough 
4a36 19667c00 sub timeup ,0 ,null 
4a37 20214a3a branch l2cap_malloc_next ,positive 
4a38 20404a75 call l2cap_malloc_into_fifo 
4a39 20204a40 branch l2cap_malloc_rtn 

l2cap_malloc_next:
4a3a 1a40a480 increase 128 ,regb 
4a3b 18e08e01 increase 1 ,queue 
4a3c 58000008 setarg 8 
4a3d 98e67c00 isub queue ,null 
4a3e 20214a32 branch l2cap_malloc_loop ,positive 
4a3f da400000 arg 0 ,regb 

l2cap_malloc_rtn:
4a40 20404a6b call l2cap_malloc_get_full_map 
4a41 1a427e00 copy regb ,pdata 
4a42 203a3b25 branch assert ,blank 
4a43 20600000 rtn 

l2cap_malloc_fifo_out:
4a44 470b4022 bpatchx patch22_6 ,mem_patch22 
4a45 20404a63 call l2cap_malloc_fifo_get_first_ptr 
4a46 18c08c01 increase 1 ,contr 
4a47 efe40006 ifetch 2 ,contr 
4a48 20600000 rtn 

l2cap_malloc_free:
4a49 470bc022 bpatchx patch22_7 ,mem_patch22 
4a4a 20404a63 call l2cap_malloc_fifo_get_first_ptr 
4a4b 18c20a00 copy contr ,contw 
4a4c 18c20400 copy contr ,temp 
4a4d 58000000 setarg 0 
4a4e e7e60005 istore 3 ,contw 
4a4f 20600000 rtn 

l2cap_malloc_discard:
4a50 470c4023 bpatchx patch23_0 ,mem_patch23 
4a51 20404a61 call l2cap_malloc_is_fifo_empty 
4a52 203a3b25 branch assert ,blank 
4a53 6fe6439f fetch 3 ,mem_tx_fifo2 
4a54 67e643a2 store 3 ,mem_tx_fifo3 
4a55 6fe6439c fetch 3 ,mem_tx_fifo1 
4a56 67e6439f store 3 ,mem_tx_fifo2 
4a57 6fe64399 fetch 3 ,mem_tx_fifo0 
4a58 67e6439c store 3 ,mem_tx_fifo1 
4a59 20600000 rtn 

l2cap_malloc_is_fifo_full:
4a5a 470cc023 bpatchx patch23_1 ,mem_patch23 
4a5b 6fe24398 fetch 1 ,mem_used_map 
4a5c c17f8000 rtneq 0xff 
4a5d 6fe64399 fetch 3 ,mem_tx_fifo0 
4a5e 20600000 rtn 

l2cap_malloc_is_fifo_nearly_full:
4a5f 6fe6439c fetch 3 ,mem_tx_fifo1 
4a60 20600000 rtn 

l2cap_malloc_is_fifo_empty:
4a61 6fe643a2 fetch 3 ,mem_tx_fifo3 
4a62 20600000 rtn 

l2cap_malloc_fifo_get_first_ptr:
4a63 470d4023 bpatchx patch23_2 ,mem_patch23 
4a64 20404a61 call l2cap_malloc_is_fifo_empty 
4a65 203a3b25 branch assert ,blank 
4a66 d8c04399 arg mem_tx_fifo0 ,contr 

l2cap_malloc_free_loop:
4a67 efe60006 ifetch 3 ,contr 
4a68 203a4a67 branch l2cap_malloc_free_loop ,blank 
4a69 18c08dfd increase -3 ,contr 
4a6a 20600000 rtn 

l2cap_malloc_get_full_map:
4a6b 470dc023 bpatchx patch23_3 ,mem_patch23 
4a6c df200004 arg 4 ,loopcnt 
4a6d d8c04399 arg mem_tx_fifo0_map ,contr 
4a6e d8400000 arg 0 ,temp 

l2cap_malloc_get_full_map_loop:
4a6f efe60006 ifetch 3 ,contr 
4a70 1fe17eff and pdata ,0xff ,pdata 
4a71 98418400 ior temp ,temp 
4a72 c2004a6f loop l2cap_malloc_get_full_map_loop 
4a73 60424398 storet 1 ,mem_used_map 
4a74 20600000 rtn 

l2cap_malloc_into_fifo:
4a75 470e4023 bpatchx patch23_4 ,mem_patch23 
4a76 20404a5a call l2cap_malloc_is_fifo_full 
4a77 243a3b25 nbranch assert ,blank 
4a78 20404a61 call l2cap_malloc_is_fifo_empty 
4a79 203a4a82 branch l2cap_malloc_into_fifo_no_push ,blank 
4a7a 6fe6439c fetch 3 ,mem_tx_fifo1 
4a7b 67e64399 store 3 ,mem_tx_fifo0 
4a7c efe60006 ifetch 3 ,contr 
4a7d e7e60005 istore 3 ,contw 
4a7e efe60006 ifetch 3 ,contr 
4a7f e7e60005 istore 3 ,contw 
4a80 58000000 setarg 0 
4a81 e7e60005 istore 3 ,contw 

l2cap_malloc_into_fifo_no_push:
4a82 d8400000 arg 0 ,temp 
4a83 19627e00 copy timeup ,pdata 
4a84 98e0fe00 iadd queue ,pdata 

l2cap_malloc_into_fifo_loop:
4a85 f9200400 qset1 temp 
4a86 18e08e01 increase 1 ,queue 
4a87 98e67c00 isub queue ,null 
4a88 2422ca85 nbranch l2cap_malloc_into_fifo_loop ,zero 
4a89 1a4d7e00 lshift8 regb ,pdata 
4a8a 9841fe00 ior temp ,pdata 
4a8b 67e643a2 store 3 ,mem_tx_fifo3 
4a8c 20600000 rtn 

l2cap_malloc_enough:
4a8d 470ec023 bpatchx patch23_5 ,mem_patch23 
4a8e 20404a6b call l2cap_malloc_get_full_map 
4a8f 18e22600 copy queue ,regc 
4a90 d8400000 arg 0 ,temp 
4a91 d9600000 arg 0 ,timeup 

l2cap_malloc_enough_loop:
4a92 18e27e00 copy queue ,pdata 
4a93 c0044a9d beq 8 ,l2cap_malloc_enough_end 
4a94 6fe24398 fetch 1 ,mem_used_map 
4a95 afefffff qisolate1 pdata 
4a96 2020ca9d branch l2cap_malloc_enough_end ,true 
4a97 18408480 increase 128 ,temp 
4a98 18e08e01 increase 1 ,queue 
4a99 1a227e00 copy rega ,pdata 
4a9a 98467c00 isub temp ,null 
4a9b 2022ca9d branch l2cap_malloc_enough_end ,zero 
4a9c 20214a92 branch l2cap_malloc_enough_loop ,positive 

l2cap_malloc_enough_end:
4a9d 18427e00 copy temp ,pdata 
4a9e 9a267c00 isub rega ,null 
4a9f 24214aa3 nbranch l2cap_malloc_enough_rtn ,positive 
4aa0 18e27e00 copy queue ,pdata 
4aa1 1a620400 copy regc ,temp 
4aa2 98461600 isub temp ,timeup 

l2cap_malloc_enough_rtn:
4aa3 1a620e00 copy regc ,queue 
4aa4 20600000 rtn 

l2cap_malloc_signal_channel:
4aa5 470f4023 bpatchx patch23_6 ,mem_patch23 
4aa6 20404a2b call l2cap_malloc 
4aa7 e224003f istorer rega ,2 ,pdata 
4aa8 58000001 setarg 1 
4aa9 e7e40005 istore 2 ,contw 
4aaa 20600000 rtn 

l2cap_malloc_server_channel:
4aab 470fc023 bpatchx patch23_7 ,mem_patch23 
4aac 20404a2b call l2cap_malloc 
4aad e224003f istorer rega ,2 ,pdata 
4aae 1b00a404 add regd ,offset_lc_remote_cid ,regb 
4aaf e8440012 ifetcht 2 ,regb 
4ab0 e0440005 istoret 2 ,contw 
4ab1 20600000 rtn 

l2cap_malloc_sdp_req:
4ab2 47104024 bpatchx patch24_0 ,mem_patch24 
4ab3 6fe4058f fetch 2 ,mem_sdp_transactionid_local 
4ab4 1fe0fe01 increase 1 ,pdata 
4ab5 67e4058f store 2 ,mem_sdp_transactionid_local 
4ab6 20204aab branch l2cap_malloc_server_channel 

l2cap_malloc_sdp_channel:
4ab7 4710c024 bpatchx patch24_1 ,mem_patch24 
4ab8 da2000fa arg sdp_malloc_size ,rega 
4ab9 20404aab call l2cap_malloc_server_channel 
4aba 67e40319 store 2 ,mem_sdp_tx_buff_ptr 
4abb 1fe0fe04 increase 4 ,pdata 
4abc 67e4031b store 2 ,mem_sdp_tx_payload_ptr 
4abd 58000000 setarg 0 
4abe 67e4031d store 2 ,mem_sdp_tx_pkt_length 
4abf 20600000 rtn 

l2cap_get_sdp_tx_buff:
4ac0 6fe40319 fetch 2 ,mem_sdp_tx_buff_ptr 
4ac1 20204ac4 branch l2cap_util_pdata_to_contw 

l2cap_get_sdp_tx_payload:
4ac2 6fe4031b fetch 2 ,mem_sdp_tx_payload_ptr 
4ac3 20204ac4 branch l2cap_util_pdata_to_contw 

l2cap_util_pdata_to_contw:
4ac4 203a3b25 branch assert ,blank 
4ac5 1fe20a00 copy pdata ,contw 
4ac6 20600000 rtn 

l2cap_send_server_conn:
4ac7 47114024 bpatchx patch24_2 ,mem_patch24 
4ac8 58000000 setarg 0 
4ac9 67ec035f store 6 ,mem_l2cap_temp_ch_info 
4aca 20404a24 call l2cap_get_req_id 
4acb da200008 arg 8 ,rega 
4acc 20404aa5 call l2cap_malloc_signal_channel 
4acd 58000002 setarg signal_connect_req 
4ace e7e20005 istore 1 ,contw 
4acf 6fe24397 fetch 1 ,mem_ml2cap_comm_id 
4ad0 e7e20005 istore 1 ,contw 
4ad1 58000004 setarg 0x0004 
4ad2 e7e40005 istore 2 ,contw 
4ad3 e3040005 istorer regd ,2 ,contw 
4ad4 20404b48 call l2cap_get_random_local_cid 
4ad5 e7e40005 istore 2 ,contw 
4ad6 67e40361 store 2 ,mem_l2cap_temp_local_cid 
4ad7 6fe20360 fetch 1 ,mem_l2cap_temp_ch_state 
4ad8 79207e00 set1 l2cap_channel_state_conn_req 
4ad9 67e20360 store 1 ,mem_l2cap_temp_ch_state 
4ada 6302035f storer regd ,1 ,mem_l2cap_temp_ch_psm 
4adb 20404af0 call l2cap_create_empty_channel 
4adc 6fec035f fetch 6 ,mem_l2cap_temp_ch_info 
4add e7ec0013 istore 6 ,regc 
4ade 20600000 rtn 

l2cap_send_server_disconnct:
4adf 4711c024 bpatchx patch24_3 ,mem_patch24 
4ae0 20404a24 call l2cap_get_req_id 
4ae1 da200008 arg 8 ,rega 
4ae2 20404aa5 call l2cap_malloc_signal_channel 
4ae3 58000006 setarg signal_disconnect_req 
4ae4 e7e20005 istore 1 ,contw 
4ae5 6fe24397 fetch 1 ,mem_ml2cap_comm_id 
4ae6 e7e20005 istore 1 ,contw 
4ae7 58000004 setarg 0x0004 
4ae8 e7e40005 istore 2 ,contw 
4ae9 1b008c04 add regd ,offset_lc_remote_cid ,contr 
4aea efe40006 ifetch 2 ,contr 
4aeb e7e40005 istore 2 ,contw 
4aec 1b008c02 add regd ,offset_lc_local_cid ,contr 
4aed efe40006 ifetch 2 ,contr 
4aee e7e40005 istore 2 ,contw 
4aef 20600000 rtn 

l2cap_create_empty_channel:
4af0 47124024 bpatchx patch24_4 ,mem_patch24 
4af1 d8400008 arg l2cap_channel_count ,temp 
4af2 d8c04364 arg mem_l2cap_ch_info ,contr 

l2cap_create_channel_loop:
4af3 efec0006 ifetch 6 ,contr 
4af4 203a4af8 branch l2cap_create_channel_rtn ,blank 
4af5 184085ff increase -1 ,temp 
4af6 2422caf3 nbranch l2cap_create_channel_loop ,zero 
4af7 20203b25 branch assert 

l2cap_create_channel_rtn:
4af8 18c0a7fa add contr ,-6 ,regc 
4af9 6fe24363 fetch 1 ,mem_l2cap_active_ch_count 
4afa 1fe0fe01 increase 1 ,pdata 
4afb 67e24363 store 1 ,mem_l2cap_active_ch_count 
4afc 20600000 rtn 

l2cap_destory_channel:
4afd 4712c024 bpatchx patch24_5 ,mem_patch24 
4afe d8400008 arg l2cap_channel_count ,temp 
4aff d8c04364 arg mem_l2cap_ch_info ,contr 

l2cap_destory_channel_loop:
4b00 efe40006 ifetch 2 ,contr 
4b01 efe40006 ifetch 2 ,contr 
4b02 18c08c02 increase 2 ,contr 
4b03 9a267c00 isub rega ,null 
4b04 2022cb08 branch l2cap_destory_channel_rtn ,zero 
4b05 184085ff increase -1 ,temp 
4b06 2422cb00 nbranch l2cap_destory_channel_loop ,zero 
4b07 20600000 rtn 

l2cap_destory_channel_rtn:
4b08 18c08bfa add contr ,-6 ,contw 
4b09 58000000 setarg 0 
4b0a e7ec0005 istore 6 ,contw 
4b0b 6fe24363 fetch 1 ,mem_l2cap_active_ch_count 
4b0c 1fe0ffff increase -1 ,pdata 
4b0d 67e24363 store 1 ,mem_l2cap_active_ch_count 
4b0e 20600000 rtn 

l2cap_check_channel_state:
4b0f 47134024 bpatchx patch24_6 ,mem_patch24 
4b10 d8400008 arg l2cap_channel_count ,temp 
4b11 d8c04364 arg mem_l2cap_ch_info ,contr 

l2cap_check_channel_loop:
4b12 18c08c01 increase 1 ,contr 
4b13 efe20006 ifetch 1 ,contr 
4b14 c0004b22 beq 0 ,l2cap_check_channel_loop_fast_loop 
4b15 1fe22600 copy pdata ,regc 
4b16 18c08c04 increase 4 ,contr 
4b17 1a227e00 copy rega ,pdata 
4b18 9a41fe00 ior regb ,pdata 
4b19 9a617e00 iand regc ,pdata 
4b1a 9a267c00 isub rega ,null 
4b1b 2022cb1f branch l2cap_check_channel_rtn ,zero 

l2cap_check_channel_next:
4b1c 184085ff increase -1 ,temp 
4b1d 2422cb12 nbranch l2cap_check_channel_loop ,zero 
4b1e 202078ec branch disable_user 

l2cap_check_channel_rtn:
4b1f 18c08dfa increase -6 ,contr 
4b20 18c22600 copy contr ,regc 
4b21 20207903 branch enable_user 

l2cap_check_channel_loop_fast_loop:
4b22 18c08c04 increase 4 ,contr 
4b23 20204b1c branch l2cap_check_channel_next 

l2cap_get_channel_info_by_local_cid:
4b24 4713c024 bpatchx patch24_7 ,mem_patch24 
4b25 d8400008 arg l2cap_channel_count ,temp 
4b26 d8c04364 arg mem_l2cap_ch_info ,contr 

l2cap_get_channel_info_local_loop:
4b27 18c08c02 increase 2 ,contr 
4b28 efe40006 ifetch 2 ,contr 
4b29 18c08c02 increase 2 ,contr 
4b2a 9a267c00 isub rega ,null 
4b2b 2022cb2f branch l2cap_get_channel_info_rtn ,zero 
4b2c 184085ff increase -1 ,temp 
4b2d 2422cb27 nbranch l2cap_get_channel_info_local_loop ,zero 
4b2e 202078ec branch disable_user 

l2cap_get_channel_info_rtn:
4b2f 18c08dfa increase -6 ,contr 
4b30 18c22600 copy contr ,regc 
4b31 20207903 branch enable_user 

l2cap_get_channel_info_by_remote_cid:
4b32 47144025 bpatchx patch25_0 ,mem_patch25 
4b33 d8400008 arg l2cap_channel_count ,temp 
4b34 d8c04364 arg mem_l2cap_ch_info ,contr 

l2cap_get_channel_info_remote_loop:
4b35 18c08c04 increase 4 ,contr 
4b36 efe40006 ifetch 2 ,contr 
4b37 9a267c00 isub rega ,null 
4b38 2022cb2f branch l2cap_get_channel_info_rtn ,zero 
4b39 184085ff increase -1 ,temp 
4b3a 2422cb35 nbranch l2cap_get_channel_info_remote_loop ,zero 
4b3b 202078ec branch disable_user 

l2cap_get_channel_info_by_psm:
4b3c d8400008 arg l2cap_channel_count ,temp 
4b3d d8c04364 arg mem_l2cap_ch_info ,contr 

l2cap_get_channel_info_by_psm_loop:
4b3e efe20006 ifetch 1 ,contr 
4b3f 18c08c05 increase 5 ,contr 
4b40 9a267c00 isub rega ,null 
4b41 2022cb2f branch l2cap_get_channel_info_rtn ,zero 
4b42 184085ff increase -1 ,temp 
4b43 2422cb3e nbranch l2cap_get_channel_info_by_psm_loop ,zero 
4b44 202078ec branch disable_user 

l2cap_check_empty_chenel_info:
4b45 6fe24363 fetch 1 ,mem_l2cap_active_ch_count 
4b46 c0007903 beq 0 ,enable_user 
4b47 202078ec branch disable_user 

l2cap_get_random_local_cid:
4b48 180a2200 random rega 
4b49 1a21221f and rega ,0x1f ,rega 
4b4a 1a22a240 xor rega ,0x40 ,rega 
4b4b 20404b24 call l2cap_get_channel_info_by_local_cid 
4b4c 20344b48 branch l2cap_get_random_local_cid ,user 
4b4d 1a227e00 copy rega ,pdata 
4b4e 20600000 rtn 

l2cap_get_empty_pending_info:
4b4f 6fee434d fetch 7 ,mem_l2cap_pending_info 
4b50 203a4b56 branch l2cap_get_empty_pending_info_rtn ,blank 
4b51 efee0006 ifetch 7 ,contr 
4b52 203a4b56 branch l2cap_get_empty_pending_info_rtn ,blank 
4b53 efee0006 ifetch 7 ,contr 
4b54 203a4b56 branch l2cap_get_empty_pending_info_rtn ,blank 
4b55 202078ec branch disable_user 

l2cap_get_empty_pending_info_rtn:
4b56 18c08bf9 add contr ,-7 ,contw 
4b57 20207903 branch enable_user 

l2cap_get_active_pending_info:
4b58 6fee434d fetch 7 ,mem_l2cap_pending_info 
4b59 243a4b5f nbranch l2cap_get_active_pending_info_rtn ,blank 
4b5a efee0006 ifetch 7 ,contr 
4b5b 243a4b5f nbranch l2cap_get_active_pending_info_rtn ,blank 
4b5c efee0006 ifetch 7 ,contr 
4b5d 243a4b5f nbranch l2cap_get_active_pending_info_rtn ,blank 
4b5e 202078ec branch disable_user 

l2cap_get_active_pending_info_rtn:
4b5f 18c08df9 increase -7 ,contr 
4b60 20207903 branch enable_user 

l2cap_clear_server_ptr:
4b61 4714c025 bpatchx patch25_1 ,mem_patch25 
4b62 6fe2035f fetch 1 ,mem_l2cap_temp_ch_psm 
4b63 c001cb67 beq psm_rfcomm ,l2cap_clear_rfcomm_ptr 
4b64 c00bcb6a beq psm_avctp ,l2cap_clear_avr_ptr 
4b65 c00ccb6d beq psm_avdtp ,l2cap_clear_a2dp_ptr 
4b66 20600000 rtn 

l2cap_clear_rfcomm_ptr:
4b67 58000000 setarg 0 
4b68 67e445b7 store 2 ,mem_rfc_l2capch_ptr 
4b69 20204478 branch hfp_hsp_reset 

l2cap_clear_avr_ptr:
4b6a 58000000 setarg 0 
4b6b 67e442e8 store 2 ,mem_avr_l2capch_ptr 
4b6c 20600000 rtn 

l2cap_clear_a2dp_ptr:
4b6d 6fe44292 fetch 2 ,mem_avdtpsignal_l2capch_ptr 
4b6e 9a667c00 isub regc ,null 
4b6f 2022cb74 branch l2cap_clear_a2dp_singal_ptr ,zero 
4b70 6fe44294 fetch 2 ,mem_avdtpmedia_l2capch_ptr 
4b71 9a667c00 isub regc ,null 
4b72 2022cb77 branch l2cap_clear_a2dp_media_ptr ,zero 
4b73 20203b25 branch assert 

l2cap_clear_a2dp_singal_ptr:
4b74 58000000 setarg 0 
4b75 67e44292 store 2 ,mem_avdtpsignal_l2capch_ptr 
4b76 20600000 rtn 

l2cap_clear_a2dp_media_ptr:
4b77 58000000 setarg 0 
4b78 67e44294 store 2 ,mem_avdtpmedia_l2capch_ptr 
4b79 20600000 rtn 

l2cap_save_server_ptr:
4b7a 47154025 bpatchx patch25_2 ,mem_patch25 
4b7b 6fe2035f fetch 1 ,mem_l2cap_temp_ch_psm 
4b7c c001cb80 beq psm_rfcomm ,l2cap_save_rfcomm_ptr 
4b7d c00bcb82 beq psm_avctp ,l2cap_save_avr_ptr 
4b7e c00ccb84 beq psm_avdtp ,l2cap_save_a2dp_ptr 
4b7f 20600000 rtn 

l2cap_save_rfcomm_ptr:
4b80 626445b7 storer regc ,2 ,mem_rfc_l2capch_ptr 
4b81 20600000 rtn 

l2cap_save_avr_ptr:
4b82 626442e8 storer regc ,2 ,mem_avr_l2capch_ptr 
4b83 20600000 rtn 

l2cap_save_a2dp_ptr:
4b84 70429a00 jam 0 ,mem_a2dp_reconnct_delay_timer 
4b85 6fe44292 fetch 2 ,mem_avdtpsignal_l2capch_ptr 
4b86 243a4b8b nbranch l2cap_save_a2dp_media_ptr ,blank 
4b87 62644292 storer regc ,2 ,mem_avdtpsignal_l2capch_ptr 
4b88 6fe20361 fetch 1 ,mem_l2cap_temp_local_cid 
4b89 67e442ad store 2 ,mem_avdtp_signal 
4b8a 20600000 rtn 

l2cap_save_a2dp_media_ptr:
4b8b 62644294 storer regc ,2 ,mem_avdtpmedia_l2capch_ptr 
4b8c 6fe20361 fetch 1 ,mem_l2cap_temp_local_cid 
4b8d 67e442af store 2 ,mem_avdtp_media 
4b8e 20600000 rtn 

l2cap_clear_nochannel_watchdog:
4b8f 70439500 jam 0 ,mem_l2cap_channel_disconnect_timer 
4b90 20600000 rtn 

l2cap_trigger_nochannel_waicthdog:
4b91 6fe24395 fetch 1 ,mem_l2cap_channel_disconnect_timer 
4b92 207a0000 rtn blank 
4b93 7043950f jam 15 ,mem_l2cap_channel_disconnect_timer 
4b94 20600000 rtn 

le_parse_att:
4b95 473ac02e bpatchx patch2e_5 ,mem_patch2e 
4b96 efe60006 ifetch 3 ,contr 
4b97 67e604e6 store 3 ,mem_le_att_opcode 
4b98 c0014ba5 beq attop_exchange_mtu_request ,le_parse_att_exchange_mtu_request 
4b99 c001cbad beq attop_exchange_mtu_response ,le_parse_att_exchange_mtu_response 
4b9a c0024bae beq attop_find_information_request ,le_parse_att_find_information_request 
4b9b c0034bd1 beq attop_find_by_type_value_request ,le_parse_att_find_by_type_value_request 
4b9c c0044c15 beq attop_read_by_type_request ,le_parse_att_read_by_type_request 
4b9d c0054c7b beq attop_read_request ,le_parse_att_read_request 
4b9e c0064c98 beq attop_read_blob_request ,le_parse_att_read_blob_request 
4b9f c0084cb0 beq attop_read_by_group_type_request ,le_parse_att_read_by_group_type_request 
4ba0 c0094cf0 beq attop_write_request ,le_parse_att_write_request 
4ba1 c00b4cfa beq attop_prepare_write_request ,le_parse_att_prepare_write_request 
4ba2 c00c4cfb beq attop_execute_write_request ,le_parse_att_execute_write_request 
4ba3 c0294cf2 beq attop_write_command ,le_parse_att_write_command 
4ba4 20600000 rtn 

le_parse_att_exchange_mtu_request:
4ba5 18002203 force 3 ,rega 
4ba6 18002404 force le_l2cap_cid_att ,regb 
4ba7 20405260 call le_fifo_malloc_tx_l2cap 
4ba8 58000003 setarg attop_exchange_mtu_response 
4ba9 e7e20005 istore 1 ,contw 
4baa 580000c4 setarg param_le_mtu 
4bab e7e40005 istore 2 ,contw 
4bac 20600000 rtn 

le_parse_att_exchange_mtu_response:
4bad 20600000 rtn 

le_parse_att_find_information_request:
4bae 1fecfe00 rshift8 pdata ,pdata 
4baf 67e444b1 store 2 ,mem_le_search_handle_start 
4bb0 efe40006 ifetch 2 ,contr 
4bb1 67e444b3 store 2 ,mem_le_search_handle_end 
4bb2 d9600002 arg 2 ,timeup 
4bb3 684444b1 fetcht 2 ,mem_le_search_handle_start 
4bb4 60440b0d storet 2 ,mem_temp 
4bb5 20404d2d call le_init_attlist_search 

le_send_att_find_information_res_loop:
4bb6 20404d55 call le_att_check_handle_end 
4bb7 24214bcf nbranch le_send_att_find_information_res_end ,positive 
4bb8 24344bc2 nbranch le_send_att_find_information_res_write_handle_info ,user 
4bb9 18002214 force 20 ,rega 
4bba 18002404 force le_l2cap_cid_att ,regb 
4bbb 20405260 call le_fifo_malloc_tx_l2cap 
4bbc 58000005 setarg attop_find_information_response 
4bbd e7e20005 istore 1 ,contw 
4bbe 58000001 setarg 1 
4bbf e7e20005 istore 1 ,contw 
4bc0 78547c00 disable user 
4bc1 20407778 call store_contw 

le_send_att_find_information_res_write_handle_info:
4bc2 68440b0d fetcht 2 ,mem_temp 
4bc3 20404d3f call le_att_get_handle_info 
4bc4 20407772 call get_contw 
4bc5 6fe40b0d fetch 2 ,mem_temp 
4bc6 e7e40005 istore 2 ,contw 
4bc7 6fe2453f fetch 1 ,mem_le_cur_uuid_lenth 
4bc8 1fe27200 copy pdata ,loopcnt 
4bc9 20407792 call memcpy_fast 
4bca 20407778 call store_contw 
4bcb 196097ff increase -1 ,timeup 
4bcc 2022cbcf branch le_send_att_find_information_res_end ,zero 

le_send_att_find_information_res_next:
4bcd 20404d72 call le_att_next_handle 
4bce 20204bb6 branch le_send_att_find_information_res_loop 

le_send_att_find_information_res_end:
4bcf 20344ce3 branch le_send_att_error_response_notfound ,user 
4bd0 20204d7a branch le_send_auto_len_by_mem 

le_parse_att_find_by_type_value_request:
4bd1 1fecfe00 rshift8 pdata ,pdata 
4bd2 67e444b1 store 2 ,mem_le_search_handle_start 
4bd3 efe40006 ifetch 2 ,contr 
4bd4 67e444b3 store 2 ,mem_le_search_handle_end 
4bd5 efe40006 ifetch 2 ,contr 
4bd6 67e444c9 store 2 ,mem_le_search_uuid 
4bd7 2040777b call store_contr 
4bd8 d8a044b5 arg mem_le_search_att_type_length ,contw 
4bd9 6fe4452b fetch 2 ,mem_le_l2cap_size 
4bda 1fe0fff9 increase -7 ,pdata 
4bdb 20404d9e call le_get_search_common2 

le_send_att_find_by_type_value_response:
4bdc 684444c9 fetcht 2 ,mem_le_search_uuid 
4bdd 58002800 setarg uuid_gatt_primary_service 
4bde 98467c00 isub temp ,null 
4bdf 2022cbe1 branch le_send_att_find_by_type_value_res_primary ,zero 
4be0 20204ce3 branch le_send_att_error_response_notfound 

le_send_att_find_by_type_value_res_primary:
4be1 d9600000 arg le_find_by_type_val_res_not_found ,timeup 
4be2 684444b1 fetcht 2 ,mem_le_search_handle_start 
4be3 60440b0d storet 2 ,mem_temp 
4be4 20404d3f call le_att_get_handle_info 
4be5 243a4ce3 nbranch le_send_att_error_response_notfound ,blank 

le_send_att_find_primary_search_loop:
4be6 68440b0d fetcht 2 ,mem_temp 
4be7 20404d3f call le_att_get_handle_info 
4be8 243a4bfa nbranch le_send_att_error_response_notfound2 ,blank 
4be9 18c22200 copy contr ,rega 
4bea 6fe24554 fetch 1 ,mem_le_curr_att_len 
4beb 1fe27200 copy pdata ,loopcnt 
4bec 684244b5 fetcht 1 ,mem_le_search_att_type_length 
4bed 98467c00 isub temp ,null 
4bee 2422cbf6 nbranch le_send_att_find_primary_search_loop1 ,zero 
4bef da4044b6 arg mem_le_search_att_type ,regb 
4bf0 20407856 call string_compare 
4bf1 2022cbfd branch le_send_att_find_primary_search_end_start_handle_found ,zero 
4bf2 6fe44540 fetch 2 ,mem_le_cur_uuid 
4bf3 684444c9 fetcht 2 ,mem_le_search_uuid 
4bf4 98467c00 isub temp ,null 
4bf5 2022cc05 branch le_send_att_find_primary_search_end_ending_handle_found ,zero 

le_send_att_find_primary_search_loop1:
4bf6 6fe40b0d fetch 2 ,mem_temp 
4bf7 1fe0fe01 increase 1 ,pdata 
4bf8 67e40b0d store 2 ,mem_temp 
4bf9 20204be6 branch le_send_att_find_primary_search_loop 

le_send_att_error_response_notfound2:
4bfa 19627e00 copy timeup ,pdata 
4bfb c000cc05 beq le_find_by_type_val_res_found_starting_handle ,le_send_att_find_primary_search_end_ending_handle_found 
4bfc 20204ce3 branch le_send_att_error_response_notfound 

le_send_att_find_primary_search_end_start_handle_found:
4bfd 6fe44540 fetch 2 ,mem_le_cur_uuid 
4bfe 684444c9 fetcht 2 ,mem_le_search_uuid 
4bff 98467c00 isub temp ,null 
4c00 2422cbf6 nbranch le_send_att_find_primary_search_loop1 ,zero 
4c01 d9600001 arg le_find_by_type_val_res_found_starting_handle ,timeup 
4c02 68440b0d fetcht 2 ,mem_temp 
4c03 6044453b storet 2 ,mem_le_cur_handle_start 
4c04 20204bf6 branch le_send_att_find_primary_search_loop1 

le_send_att_find_primary_search_end_ending_handle_found:
4c05 19627e00 copy timeup ,pdata 
4c06 c0004bf6 beq le_find_by_type_val_res_not_found ,le_send_att_find_primary_search_loop1 
4c07 d9600002 arg le_find_by_type_val_res_found_ending_handle ,timeup 
4c08 68440b0d fetcht 2 ,mem_temp 
4c09 184085ff increase -1 ,temp 
4c0a 6044453d storet 2 ,mem_le_cur_handle_end 

le_send_att_find_primary_search_end:
4c0b da200005 arg 5 ,rega 
4c0c 18002404 force le_l2cap_cid_att ,regb 
4c0d 20405260 call le_fifo_malloc_tx_l2cap 
4c0e 58000007 setarg attop_find_by_type_value_response 
4c0f e7e20005 istore 1 ,contw 
4c10 6fe4453b fetch 2 ,mem_le_cur_handle_start 
4c11 e7e40005 istore 2 ,contw 
4c12 6fe4453d fetch 2 ,mem_le_cur_handle_end 
4c13 e7e40005 istore 2 ,contw 
4c14 20600000 rtn 

le_parse_att_read_by_type_request:
4c15 1fecfe00 rshift8 pdata ,pdata 
4c16 67e444b1 store 2 ,mem_le_search_handle_start 
4c17 efe40006 ifetch 2 ,contr 
4c18 67e444b3 store 2 ,mem_le_search_handle_end 
4c19 20404d97 call le_get_search_att_uuid 

le_send_att_read_by_type_response:
4c1a 684444b1 fetcht 2 ,mem_le_search_handle_start 
4c1b 60440b0d storet 2 ,mem_temp 
4c1c 20404d2d call le_init_attlist_search 
4c1d 684444c9 fetcht 2 ,mem_le_search_uuid 
4c1e 58002803 setarg uuid_gatt_characteristic 
4c1f 98467c00 isub temp ,null 
4c20 2422cc4f nbranch le_send_att_read_by_type_res_not_characteristic ,zero 
4c21 d9600002 arg 2 ,timeup 

le_send_att_read_by_type_response_loop:
4c22 20404d55 call le_att_check_handle_end 
4c23 24214c3f nbranch le_send_att_read_by_type_response_end ,positive 
4c24 68440b0d fetcht 2 ,mem_temp 
4c25 20404d3f call le_att_get_handle_info 
4c26 c000cc3f beq 1 ,le_send_att_read_by_type_response_end 
4c27 20404d59 call le_att_same_uuid 
4c28 2422cc3d nbranch le_send_att_read_by_type_response_next_handle ,zero 
4c29 24344c41 nbranch le_send_att_read_by_type_res_found_next ,user 
4c2a 78547c00 disable user 
4c2b da200014 arg 20 ,rega 
4c2c 18002404 force le_l2cap_cid_att ,regb 
4c2d 20405260 call le_fifo_malloc_tx_l2cap 
4c2e 58000009 setarg attop_read_by_type_response 
4c2f e7e20005 istore 1 ,contw 
4c30 18a26000 copy contw ,alarm 
4c31 18a08a01 increase 1 ,contw 
4c32 20404c68 call le_send_att_read_by_type_write_properties 
4c33 20404d72 call le_att_next_handle 
4c34 20404d3f call le_att_get_handle_info 
4c35 20404c6f call le_send_att_read_by_type_write_uuid 
4c36 6fe2453f fetch 1 ,mem_le_cur_uuid_lenth 
4c37 1fe0fe05 increase 5 ,pdata 
4c38 e7e20030 istore 1 ,alarm 
4c39 6fe2453f fetch 1 ,mem_le_cur_uuid_lenth 
4c3a c0084c3f beq 16 ,le_send_att_read_by_type_response_end 
4c3b 196097ff increase -1 ,timeup 
4c3c 2022cc3f branch le_send_att_read_by_type_response_end ,zero 

le_send_att_read_by_type_response_next_handle:
4c3d 20404d72 call le_att_next_handle 
4c3e 20204c22 branch le_send_att_read_by_type_response_loop 

le_send_att_read_by_type_response_end:
4c3f 20344ce3 branch le_send_att_error_response_notfound ,user 
4c40 20204d7a branch le_send_auto_len_by_mem 

le_send_att_read_by_type_res_found_next:
4c41 20404d6d call le_store_att_record 
4c42 20404d72 call le_att_next_handle 
4c43 20404d3f call le_att_get_handle_info 
4c44 6fe2453f fetch 1 ,mem_le_cur_uuid_lenth 
4c45 c0084c3f beq 16 ,le_send_att_read_by_type_response_end 
4c46 20407772 call get_contw 
4c47 6fe40b0d fetch 2 ,mem_temp 
4c48 1fe0ffff increase -1 ,pdata 
4c49 e7e40005 istore 2 ,contw 
4c4a 20404d69 call le_write_att_record_common 
4c4b 20404c6f call le_send_att_read_by_type_write_uuid 
4c4c 196097ff increase -1 ,timeup 
4c4d 2022cc3f branch le_send_att_read_by_type_response_end ,zero 
4c4e 20204c3d branch le_send_att_read_by_type_response_next_handle 

le_send_att_read_by_type_res_not_characteristic:
4c4f 684444b1 fetcht 2 ,mem_le_search_handle_start 
4c50 60440b0d storet 2 ,mem_temp 

le_send_att_read_by_type_res_not_char_loop:
4c51 20404d55 call le_att_check_handle_end 
4c52 24214ce3 nbranch le_send_att_error_response_notfound ,positive 
4c53 20404d3f call le_att_get_handle_info 
4c54 c000cce3 beq 1 ,le_send_att_error_response_notfound 
4c55 20404d59 call le_att_same_uuid 
4c56 2422cc66 nbranch le_send_att_read_by_type_res_not_char_next ,zero 
4c57 da200014 arg 20 ,rega 
4c58 18002404 force le_l2cap_cid_att ,regb 
4c59 20405260 call le_fifo_malloc_tx_l2cap 
4c5a 58000009 setarg attop_read_by_type_response 
4c5b e7e20005 istore 1 ,contw 
4c5c 6fe24554 fetch 1 ,mem_le_curr_att_len 
4c5d 1fe27200 copy pdata ,loopcnt 
4c5e 1fe0fe02 increase 2 ,pdata 
4c5f e7e20005 istore 1 ,contw 
4c60 6fe40b0d fetch 2 ,mem_temp 
4c61 e7e40005 istore 2 ,contw 
4c62 20407775 call get_contr 
4c63 20407792 call memcpy_fast 
4c64 20407778 call store_contw 
4c65 20204d7a branch le_send_auto_len_by_mem 

le_send_att_read_by_type_res_not_char_next:
4c66 20404d72 call le_att_next_handle 
4c67 20204c51 branch le_send_att_read_by_type_res_not_char_loop 

le_send_att_read_by_type_write_properties:
4c68 6fe40b0d fetch 2 ,mem_temp 
4c69 e7e40005 istore 2 ,contw 
4c6a 6fe24554 fetch 1 ,mem_le_curr_att_len 
4c6b 1fe27200 copy pdata ,loopcnt 
4c6c 20407775 call get_contr 
4c6d 20407792 call memcpy_fast 
4c6e 20207778 branch store_contw 

le_send_att_read_by_type_write_uuid:
4c6f 20407772 call get_contw 
4c70 6fe40b0d fetch 2 ,mem_temp 
4c71 e7e40005 istore 2 ,contw 
4c72 20407778 call store_contw 
4c73 6fe2453f fetch 1 ,mem_le_cur_uuid_lenth 
4c74 1fe27200 copy pdata ,loopcnt 
4c75 20407772 call get_contw 
4c76 20407775 call get_contr 
4c77 9f260c00 isub loopcnt ,contr 
4c78 18c08dff increase -1 ,contr 
4c79 20407792 call memcpy_fast 
4c7a 20207778 branch store_contw 

le_parse_att_read_request:
4c7b 684404e7 fetcht 2 ,mem_le_att_handle 
4c7c 6fe444af fetch 2 ,mem_le_pairing_handle 
4c7d 243a4c8f nbranch le_parse_att_read_request_check_pairing ,blank 

le_send_att_read_response:
4c7e 604444b1 storet 2 ,mem_le_search_handle_start 
4c7f 20404d76 call le_att_get_handle_ptr 
4c80 203a4ce3 branch le_send_att_error_response_notfound ,blank 
4c81 efe20006 ifetch 1 ,contr 
4c82 1fe67c16 sub pdata ,22 ,null 
4c83 20214c85 branch le_send_att_read_response_less ,positive 
4c84 18007e16 force 22 ,pdata 

le_send_att_read_response_less:
4c85 1fe23000 copy pdata ,regd 
4c86 2040777b call store_contr 
4c87 1b00a201 add regd ,1 ,rega 
4c88 18002404 force le_l2cap_cid_att ,regb 
4c89 20405260 call le_fifo_malloc_tx_l2cap 
4c8a 5800000b setarg attop_read_response 
4c8b e7e20005 istore 1 ,contw 
4c8c 1b027200 copy regd ,loopcnt 
4c8d 20407775 call get_contr 
4c8e 2020779f branch memcpy 

le_parse_att_read_request_check_pairing:
4c8f 98467c00 isub temp ,null 
4c90 2022cc92 branch le_send_att_read_response_error_insufficient_auth ,zero 
4c91 20204c7e branch le_send_att_read_response 

le_send_att_read_response_error_insufficient_auth:
4c92 6fe24489 fetch 1 ,mem_le_pairing_mode 
4c93 c0004c7e beq le_pairing_mode_none ,le_send_att_read_response 
4c94 6fe204ad fetch 1 ,mem_le_state 
4c95 c2824c7e bbit1 lestate_encryption ,le_send_att_read_response 
4c96 7004e905 jam att_err_insufficient_authentication ,mem_le_err_code 
4c97 20204ce4 branch le_send_att_error_response 

le_parse_att_read_blob_request:
4c98 efe40006 ifetch 2 ,contr 
4c99 67e444b5 store 2 ,mem_le_att_offset 

le_send_att_read_blob_response:
4c9a da200014 arg 20 ,rega 
4c9b 18002404 force le_l2cap_cid_att ,regb 
4c9c 20405260 call le_fifo_malloc_tx_l2cap 
4c9d 5800000d setarg attop_read_blob_response 
4c9e e7e20005 istore 1 ,contw 
4c9f 6fe444b5 fetch 2 ,mem_le_att_offset 
4ca0 98002200 iforce rega 
4ca1 684404e7 fetcht 2 ,mem_le_att_handle 
4ca2 20404d76 call le_att_get_handle_ptr 
4ca3 203a4ce3 branch le_send_att_error_response_notfound ,blank 
4ca4 efe20006 ifetch 1 ,contr 
4ca5 9a267200 isub rega ,loopcnt 
4ca6 24214ce3 nbranch le_send_att_error_response_notfound ,positive 
4ca7 1f267c16 sub loopcnt ,22 ,null 
4ca8 20214caa branch le_send_att_read_blob_response_less ,positive 
4ca9 18007216 force 22 ,loopcnt 

le_send_att_read_blob_response_less:
4caa 1a227e00 deposit rega 
4cab 98c08c00 iadd contr ,contr 
4cac 20407792 call memcpy_fast 
4cad 20407778 call store_contw 
4cae 20204d7a branch le_send_auto_len_by_mem 

le_parse_att_read_multiple_request:
4caf 20600000 rtn 

le_parse_att_read_by_group_type_request:
4cb0 1fecfe00 rshift8 pdata ,pdata 
4cb1 67e444b1 store 2 ,mem_le_search_handle_start 
4cb2 efe40006 ifetch 2 ,contr 
4cb3 67e444b3 store 2 ,mem_le_search_handle_end 
4cb4 20404d9a call le_get_search_att_type 
4cb5 d9600002 arg 2 ,timeup 
4cb6 684444b1 fetcht 2 ,mem_le_search_handle_start 
4cb7 60440b0d storet 2 ,mem_temp 
4cb8 20404d2d call le_init_attlist_search 

le_send_att_read_by_group_type_response_loop:
4cb9 20404d55 call le_att_check_handle_end 
4cba 24214cda nbranch le_send_att_read_by_group_type_end0 ,positive 
4cbb 68440b0d fetcht 2 ,mem_temp 
4cbc 20404d3f call le_att_get_handle_info 
4cbd c000ccdd beq 1 ,le_send_att_read_by_group_type_end1 
4cbe 20404d5c call le_att_same_type 
4cbf 2422ccd8 nbranch le_send_att_read_by_group_type_next_handle ,zero 
4cc0 19627e00 copy timeup ,pdata 
4cc1 c0004cdd beq 0 ,le_send_att_read_by_group_type_end1 
4cc2 24344cce nbranch le_send_att_read_by_group_type_store_write_record ,user 
4cc3 78547c00 disable user 
4cc4 da200014 arg 20 ,rega 
4cc5 18002404 force le_l2cap_cid_att ,regb 
4cc6 20405260 call le_fifo_malloc_tx_l2cap 
4cc7 58000011 setarg attop_read_by_group_type_response 
4cc8 e7e20005 istore 1 ,contw 
4cc9 6fe24554 fetch 1 ,mem_le_curr_att_len 
4cca 1fe0fe04 increase 4 ,pdata 
4ccb e7e20005 istore 1 ,contw 
4ccc 20407778 call store_contw 
4ccd 20204cd4 branch le_send_att_read_by_group_type_store_record 

le_send_att_read_by_group_type_store_write_record:
4cce 6fe24554 fetch 1 ,mem_le_curr_att_len 
4ccf c0084cdd beq 16 ,le_send_att_read_by_group_type_end1 
4cd0 6fe40b0d fetch 2 ,mem_temp 
4cd1 1fe0ffff increase -1 ,pdata 
4cd2 67e4453d store 2 ,mem_le_cur_handle_end 
4cd3 20404d64 call le_write_att_record 

le_send_att_read_by_group_type_store_record:
4cd4 6fe40b0d fetch 2 ,mem_temp 
4cd5 67e4453b store 2 ,mem_le_cur_handle_start 
4cd6 20404d6d call le_store_att_record 
4cd7 196097ff increase -1 ,timeup 

le_send_att_read_by_group_type_next_handle:
4cd8 20404d72 call le_att_next_handle 
4cd9 20204cb9 branch le_send_att_read_by_group_type_response_loop 

le_send_att_read_by_group_type_end0:
4cda 6fe40b0d fetch 2 ,mem_temp 
4cdb 67e4453d store 2 ,mem_le_cur_handle_end 
4cdc 20204ce0 branch le_send_att_read_by_group_type_end_common 

le_send_att_read_by_group_type_end1:
4cdd 6fe40b0d fetch 2 ,mem_temp 
4cde 1fe0ffff increase -1 ,pdata 
4cdf 67e4453d store 2 ,mem_le_cur_handle_end 

le_send_att_read_by_group_type_end_common:
4ce0 20344ce3 branch le_send_att_error_response_notfound ,user 
4ce1 20404d64 call le_write_att_record 
4ce2 20204d7a branch le_send_auto_len_by_mem 

le_send_att_error_response_notfound:
4ce3 7004e90a jam att_err_attribute_not_found ,mem_le_err_code 

le_send_att_error_response:
4ce4 18002205 force 5 ,rega 
4ce5 18002404 force le_l2cap_cid_att ,regb 
4ce6 20405260 call le_fifo_malloc_tx_l2cap 
4ce7 58000001 setarg attop_error_response 
4ce8 e7e20005 istore 1 ,contw 
4ce9 6fe204e6 fetch 1 ,mem_le_att_opcode 
4cea e7e20005 istore 1 ,contw 
4ceb 6fe444b1 fetch 2 ,mem_le_search_handle_start 
4cec e7e40005 istore 2 ,contw 
4ced 6fe204e9 fetch 1 ,mem_le_err_code 
4cee e7e20005 istore 1 ,contw 
4cef 20600000 rtn 

le_parse_att_write_request:
4cf0 da604cf4 arg le_send_att_response ,regc 
4cf1 20204d0c branch le_att_parse_write 

le_parse_att_write_command:
4cf2 da600000 arg 0 ,regc 
4cf3 20204d0c branch le_att_parse_write 

le_send_att_response:
4cf4 18002201 force 1 ,rega 
4cf5 18002404 force le_l2cap_cid_att ,regb 
4cf6 20405260 call le_fifo_malloc_tx_l2cap 
4cf7 58000013 setarg attop_write_response 
4cf8 e7e20005 istore 1 ,contw 
4cf9 20600000 rtn 

le_parse_att_prepare_write_request:
4cfa 20600000 rtn 

le_parse_att_execute_write_request:
4cfb 20600000 rtn 

le_ipc_tx:
4cfc 6fe24335 fetch 1 ,mem_ipc_enable 
4cfd 207a0000 rtn blank 
4cfe 6fe40518 fetch 2 ,mem_le_payload_ptr 
4cff 1fe0fe03 increase 3 ,pdata 
4d00 67e4433a store 2 ,mem_ipc_tx_data_ptr 
4d01 1fe20a00 icopy contw 
4d02 58000005 setarg ipc_type_ble 
4d03 e7e20005 istore 1 ,contw 
4d04 6842452b fetcht 1 ,mem_le_l2cap_size 
4d05 184085ff increase -1 ,temp 
4d06 e0420005 istoret 1 ,contw 
4d07 6fe404e7 fetch 2 ,mem_le_att_handle 
4d08 e7e40005 istore 2 ,contw 
4d09 18408402 increase 2 ,temp 
4d0a 60424339 storet 1 ,mem_ipc_tx_data_len 
4d0b 20204854 branch ipc_tx_common 

le_att_parse_write:
4d0c 473b402e bpatchx patch2e_6 ,mem_patch2e 
4d0d 20404cfc call le_ipc_tx 
4d0e 6fe40518 fetch 2 ,mem_le_payload_ptr 
4d0f 1fe20c00 copy pdata ,contr 
4d10 18c0a407 add contr ,7 ,regb 
4d11 684404e7 fetcht 2 ,mem_le_att_handle 
4d12 20404d3f call le_att_get_handle_info 
4d13 203a4d15 branch le_att_deal_write_cont ,blank 
4d14 20204d29 branch le_att_deal_write_callback 

le_att_deal_write_cont:
4d15 6fe24554 fetch 1 ,mem_le_curr_att_len 
4d16 6844452b fetcht 2 ,mem_le_l2cap_size 
4d17 184085fd increase -3 ,temp 
4d18 204078db call not_greater_than 
4d19 1fe27200 copy pdata ,loopcnt 
4d1a 20407775 call get_contr 
4d1b 18c20a00 copy contr ,contw 
4d1c 1a420c00 copy regb ,contr 
4d1d 2040779f call memcpy 

le_att_deal_write_check_characteristic:
4d1e 6fe44540 fetch 2 ,mem_le_cur_uuid 
4d1f d8402902 arg client_charactertic_configuration ,temp 
4d20 98467c00 isub temp ,null 
4d21 2422cd29 nbranch le_att_deal_write_callback ,zero 
4d22 78547c00 disable user 
4d23 efe20012 ifetch 1 ,regb 
4d24 245a7903 ncall enable_user ,blank 
4d25 684404e7 fetcht 2 ,mem_le_att_handle 
4d26 184085ff increase -1 ,temp 
4d27 20544dbe call le_att_create_notify_switch ,user 
4d28 24544db3 ncall le_att_clear_notify_switch ,user 

le_att_deal_write_callback:
4d29 1a627e00 copy regc ,pdata 
4d2a 207a0000 rtn blank 
4d2b 1a627a00 copy regc ,pc 
4d2c 20600000 rtn 

le_init_attlist_search:
4d2d 6fe44537 fetch 2 ,mem_ui_le_uuid_table 
4d2e 98000c00 iforce contr 
4d2f 78347c00 enable user 
4d30 20600000 rtn 

le_att_get_handle_ptr2:
4d31 6fe44537 fetch 2 ,mem_ui_le_uuid_table 
4d32 98000c00 iforce contr 

le_att_get_handle_loop1:
4d33 efe40006 ifetch 2 ,contr 
4d34 207a0000 rtn blank 
4d35 98467c00 isub temp ,null 
4d36 20628000 rtn zero 
4d37 efe20006 ifetch 1 ,contr 
4d38 98c08c00 iadd contr ,contr 
4d39 efe20006 ifetch 1 ,contr 
4d3a 98c08c00 iadd contr ,contr 
4d3b 20204d33 branch le_att_get_handle_loop1 

le_att_get_handle_ptr_found:
4d3c efe20006 ifetch 1 ,contr 
4d3d 98c08c00 iadd contr ,contr 
4d3e 20600000 rtn 

le_att_get_handle_info:
4d3f 6fe44537 fetch 2 ,mem_ui_le_uuid_table 
4d40 98000c00 iforce contr 
4d41 18422200 copy temp ,rega 

le_att_get_handle_loop:
4d42 efe40006 ifetch 2 ,contr 
4d43 203a4d4b branch le_att_unfind_handle ,blank 
4d44 9a267c00 isub rega ,null 
4d45 2022cd4c branch le_att_finded_handle ,zero 
4d46 efe20006 ifetch 1 ,contr 
4d47 98c08c00 iadd contr ,contr 
4d48 efe20006 ifetch 1 ,contr 
4d49 98c08c00 iadd contr ,contr 
4d4a 20204d42 branch le_att_get_handle_loop 

le_att_unfind_handle:
4d4b 20207905 branch setarg1 

le_att_finded_handle:
4d4c efe20006 ifetch 1 ,contr 
4d4d 67e2453f store 1 ,mem_le_cur_uuid_lenth 
4d4e 1fe27200 copy pdata ,loopcnt 
4d4f d8a04540 arg mem_le_cur_uuid ,contw 
4d50 20407792 call memcpy_fast 
4d51 efe20006 ifetch 1 ,contr 
4d52 67e24554 store 1 ,mem_le_curr_att_len 
4d53 2040777b call store_contr 
4d54 20207907 branch setarg0 

le_att_check_handle_end:
4d55 68440b0d fetcht 2 ,mem_temp 
4d56 6fe444b3 fetch 2 ,mem_le_search_handle_end 
4d57 98467c00 isub temp ,null 
4d58 20600000 rtn 

le_att_same_uuid:
4d59 684244c8 fetcht 1 ,mem_le_search_uuid_length 
4d5a da2044c9 arg mem_le_search_uuid ,rega 
4d5b 20204d5e branch le_att_check_same_common 

le_att_same_type:
4d5c 684244b5 fetcht 1 ,mem_le_search_att_type_length 
4d5d da2044b6 arg mem_le_search_att_type ,rega 

le_att_check_same_common:
4d5e 6fe2453f fetch 1 ,mem_le_cur_uuid_lenth 
4d5f 1fe27200 copy pdata ,loopcnt 
4d60 98467c00 isub temp ,null 
4d61 24628000 nrtn zero 
4d62 da404540 arg mem_le_cur_uuid ,regb 
4d63 20207856 branch string_compare 

le_write_att_record:
4d64 20407772 call get_contw 
4d65 6fe4453b fetch 2 ,mem_le_cur_handle_start 
4d66 e7e40005 istore 2 ,contw 
4d67 6fe4453d fetch 2 ,mem_le_cur_handle_end 
4d68 e7e40005 istore 2 ,contw 

le_write_att_record_common:
4d69 6fe200c4 fetch 1 ,mem_tmp_buffer 
4d6a 1fe27200 copy pdata ,loopcnt 
4d6b 20407792 call memcpy_fast 
4d6c 20207778 branch store_contw 

le_store_att_record:
4d6d 6fe24554 fetch 1 ,mem_le_curr_att_len 
4d6e 67e200c4 store 1 ,mem_tmp_buffer 
4d6f 1fe27200 copy pdata ,loopcnt 
4d70 20407775 call get_contr 
4d71 20207792 branch memcpy_fast 

le_att_next_handle:
4d72 68440b0d fetcht 2 ,mem_temp 
4d73 18408401 increase 1 ,temp 
4d74 60440b0d storet 2 ,mem_temp 
4d75 20600000 rtn 

le_att_get_handle_ptr:
4d76 473bc02e bpatchx patch2e_7 ,mem_patch2e 
4d77 20404d31 call le_att_get_handle_ptr2 
4d78 2022cd3c branch le_att_get_handle_ptr_found ,zero 
4d79 20600000 rtn 

le_send_auto_len_by_mem:
4d7a 473c402f bpatchx patch2f_0 ,mem_patch2f 
4d7b 20407772 call get_contw 
4d7c 204052a6 call le_fifo_get_last_att_ptr 
4d7d 18a27e00 copy contw ,pdata 
4d7e 98c62200 isub contr ,rega 
4d7f 204052aa call le_fifo_get_last_l2cap_ptr 
4d80 e2240006 istorer rega ,2 ,contr 
4d81 1a20a204 increase 4 ,rega 
4d82 20405294 call le_fifo_get_last_tx_ptr 
4d83 e2220006 istorer rega ,1 ,contr 
4d84 20600000 rtn 

le_clean_att_list_handle_enable:
4d85 684444c6 fetcht 2 ,mem_le_notify_handle 
4d86 20404d8b call le_att_check_notification_enable 
4d87 1a220a00 copy rega ,contw 
4d88 58000000 setarg 0 
4d89 e7e20005 istore 1 ,contw 
4d8a 20600000 rtn 

le_att_check_notification_enable:
4d8b 473cc02f bpatchx patch2f_1 ,mem_patch2f 
4d8c 18408401 increase 1 ,temp 
4d8d 20404d76 call le_att_get_handle_ptr 
4d8e 18c08dfe increase -2 ,contr 
4d8f efe40006 ifetch 2 ,contr 
4d90 d8402902 arg client_charactertic_configuration ,temp 
4d91 98467c00 isub temp ,null 
4d92 24628000 nrtn zero 
4d93 18c08c01 increase 1 ,contr 
4d94 18c22200 copy contr ,rega 
4d95 efe20006 ifetch 1 ,contr 
4d96 20600000 rtn 

le_get_search_att_uuid:
4d97 2040777b call store_contr 
4d98 d8a044c8 arg mem_le_search_uuid_length ,contw 
4d99 20204d9c branch le_get_search_common 

le_get_search_att_type:
4d9a 2040777b call store_contr 
4d9b d8a044b5 arg mem_le_search_att_type_length ,contw 

le_get_search_common:
4d9c 6fe4452b fetch 2 ,mem_le_l2cap_size 
4d9d 1fe0fffb increase -5 ,pdata 

le_get_search_common2:
4d9e e7e20005 istore 1 ,contw 
4d9f 1fe27200 copy pdata ,loopcnt 
4da0 20407775 call get_contr 
4da1 20207792 branch memcpy_fast 

le_att_malloc_tx_notify:
4da2 18422600 copy temp ,regc 
4da3 da400004 arg le_l2cap_cid_att ,regb 
4da4 1a20a203 increase 3 ,rega 
4da5 20405260 call le_fifo_malloc_tx_l2cap 
4da6 1a20a3fd increase -3 ,rega 
4da7 5800001b setarg attop_handle_value_notification 
4da8 e7e20005 istore 1 ,contw 
4da9 1a620400 copy regc ,temp 
4daa e0440005 istoret 2 ,contw 
4dab 20600000 rtn 

le_att_check_notify_switch:
4dac d8c04550 arg mem_notify_handle_pool ,contr 
4dad df200004 arg 4 ,loopcnt 

le_att_check_notify_loop:
4dae efe20006 ifetch 1 ,contr 
4daf 98467c00 isub temp ,null 
4db0 2022f903 branch enable_user ,zero 
4db1 c2004dae loop le_att_check_notify_loop 
4db2 202078ec branch disable_user 

le_att_clear_notify_switch:
4db3 d8c04550 arg mem_notify_handle_pool ,contr 
4db4 df200004 arg 4 ,loopcnt 

le_att_clear_notify_loop:
4db5 efe20006 ifetch 1 ,contr 
4db6 98467c00 isub temp ,null 
4db7 2042cdba call le_att_clear_notify ,zero 
4db8 c2004db5 loop le_att_clear_notify_loop 
4db9 20600000 rtn 

le_att_clear_notify:
4dba 18c08bff add contr ,-1 ,contw 
4dbb 58000000 setarg 0 
4dbc e7e20005 istore 1 ,contw 
4dbd 20600000 rtn 

le_att_create_notify_switch:
4dbe d8c04550 arg mem_notify_handle_pool ,contr 
4dbf df200004 arg 4 ,loopcnt 

le_att_creat_notify_loop:
4dc0 efe20006 ifetch 1 ,contr 
4dc1 203a4dc4 branch le_att_create_notify ,blank 
4dc2 c2004dc0 loop le_att_creat_notify_loop 
4dc3 20600000 rtn 

le_att_create_notify:
4dc4 18c08bff add contr ,-1 ,contw 
4dc5 e0420005 istoret 1 ,contw 
4dc6 20600000 rtn 

le_att_destroy_notify_pool:
4dc7 58000000 setarg 0 
4dc8 67e84550 store 4 ,mem_notify_handle_pool 
4dc9 20600000 rtn 

le_send_update_att_mtu:
4dca 18002202 force 2 ,rega 
4dcb 18002404 force le_l2cap_cid_att ,regb 
4dcc 20405260 call le_fifo_malloc_tx_l2cap 
4dcd 58000002 setarg attop_exchange_mtu_request 
4dce e7e20005 istore 1 ,contw 
4dcf 580000c4 setarg param_le_mtu 
4dd0 e7e40005 istore 2 ,contw 
4dd1 20600000 rtn 

le_send_update_paramter:
4dd2 da60451b arg mem_le_connection_updata_param ,regc 
4dd3 202052ca branch le_l2cap_tx_update_req 

le_init_conn:
4dd4 4715c025 bpatchx patch25_3 ,mem_patch25 
4dd5 7855fc00 disable wake 
4dd6 204052d2 call le_pairing_mode_init 
4dd7 7042b101 jam 1 ,mem_app_state 
4dd8 7004c301 jam 1 ,mem_le_conn_handle 
4dd9 7004ad03 jam 3 ,mem_le_state 
4dda 7004c401 jam 1 ,mem_le_arq 
4ddb 5fffffff setarg -1 
4ddc 67e404c7 store 2 ,mem_le_event_count 
4ddd 18007e00 force 0 ,pdata 
4dde 67e204d0 store 1 ,mem_le_conn_sm 
4ddf 67e204c5 store 1 ,mem_le_ch 
4de0 67e204d1 store 1 ,mem_le_op 
4de1 67e64207 store 3 ,mem_sniff_rcv 
4de2 67e6420a store 3 ,mem_sniff_lost 
4de3 67ea4430 store 5 ,mem_le_pcnt_tx 
4de4 79207e27 set1 39 ,pdata 
4de5 67ea4435 store 5 ,mem_le_pcnt_rx 
4de6 70440901 jam 1 ,mem_le_txheader 
4de7 70440a00 jam 0 ,mem_le_txlen 
4de8 202051be branch le_supervision_flush 

le_init_master:
4de9 47164025 bpatchx patch25_4 ,mem_patch25 
4dea 7834fc00 enable master 
4deb 7004ae03 jam lemode_master ,mem_le_mode 
4dec 7004e701 jam 1 ,mem_le_att_handle 
4ded 7044b101 jam 1 ,mem_le_search_handle_start 
4dee 5800ffff setarg 0xffff 
4def 67e444b3 store 2 ,mem_le_search_handle_end 
4df0 18007e00 force 0 ,pdata 
4df1 67ea4435 store 5 ,mem_le_pcnt_rx 
4df2 79207e27 set1 39 ,pdata 
4df3 67ea4430 store 5 ,mem_le_pcnt_tx 
4df4 20204dd4 branch le_init_conn 

le_init_slave:
4df5 4716c025 bpatchx patch25_5 ,mem_patch25 
4df6 7854fc00 disable master 
4df7 7004ae01 jam lemode_slave ,mem_le_mode 
4df8 7043b100 jam 0 ,mem_le_adv_enable 
4df9 7000aa00 jam 0 ,mem_lpm_current_mult 
4dfa 20204dd4 branch le_init_conn 

le_dispatch:
4dfb 47174025 bpatchx patch25_6 ,mem_patch25 
4dfc 20404e5b call le_enable 
4dfd 20405050 call le_scan 
4dfe 204051c1 call le_adv 
4dff 20204e5f branch le_disable 

le_conn_dispatch:
4e00 4717c025 bpatchx patch25_7 ,mem_patch25 
4e01 20404e5b call le_enable 
4e02 2040414d call app_process_ble 
4e03 6fe204ae fetch 1 ,mem_le_mode 
4e04 c001ce06 beq lemode_master ,le_master_dispatch 
4e05 20204e1b branch le_slave_dispatch 

le_master_dispatch:
4e06 47184026 bpatchx patch26_0 ,mem_patch26 
4e07 7834fc00 enable master 
4e08 204051b5 call le_supervision_update 
4e09 20214e17 branch le_master_disconn ,positive 
4e0a 20403cf3 call check_ble_disabled 
4e0b 20404ea5 call le_setup 
4e0c 20405087 call le_prepare_tx 
4e0d 7856fc00 disable match 
4e0e 20404f2d call le_transmit_receive_sifs 
4e0f 24768000 nrtn match 
4e10 6fe20005 fetch 1 ,mem_le_conn_rcv 
4e11 1fe0fe01 increase 1 ,pdata 
4e12 67e20005 store 1 ,mem_le_conn_rcv 
4e13 20405010 call le_acknowledge 
4e14 20405224 call le_conn_sm_master 
4e15 7854fc00 disable master 
4e16 20600000 rtn 

le_master_disconn:
4e17 4718c026 bpatchx patch26_1 ,mem_patch26 
4e18 20404e43 call le_disconnect 
4e19 7854fc00 disable master 
4e1a 20600000 rtn 

le_slave_dispatch:
4e1b 47194026 bpatchx patch26_2 ,mem_patch26 
4e1c 20406f46 call sp_calc_sequence_256 
4e1d 204053ec call le_secure_connect_sm 
4e1e 78577c00 disable attempt 
4e1f 204051b5 call le_supervision_update 
4e20 20214e41 branch le_slave_disconn ,positive 
4e21 20403cf3 call check_ble_disabled 
4e22 20404ea5 call le_setup 
4e23 20404ef8 call le_receive_slave 
4e24 2436ce32 nbranch le_slave_unsync ,match 

le_slave_match:
4e25 4719c026 bpatchx patch26_3 ,mem_patch26 
4e26 20404e50 call le_got_first_packet 
4e27 20405010 call le_acknowledge 
4e28 20405087 call le_prepare_tx 
4e29 20404f35 call le_transmit_norx 
4e2a 204050d5 call le_parse 
4e2b 20404e38 call le_check_md 
4e2c 20344e3c branch le_slave_more_data ,user 

le_slave_cont:
4e2d 471a4026 bpatchx patch26_4 ,mem_patch26 
4e2e 204053cf call le_pairing_sm 
4e2f 20407206 call check_51cmd 
4e30 6fe204d1 fetch 1 ,mem_le_op 
4e31 c281ce41 bbit1 op_disconn ,le_slave_disconn 

le_slave_unsync:
4e32 471ac026 bpatchx patch26_5 ,mem_patch26 
4e33 20407875 call le_savelist 
4e34 2040522e call le_lpm_set_mult 
4e35 20405004 call le_update_channel_map 
4e36 20404fe0 call le_update_param 
4e37 202038cd branch calc_clke_offset 

le_check_md:
4e38 78547c00 disable user 
4e39 c513f903 bmark1 mark_ble_rx_md ,enable_user 
4e3a c5137903 bmark1 mark_ble_tx_md ,enable_user 
4e3b 20600000 rtn 

le_slave_more_data:
4e3c 471b4026 bpatchx patch26_6 ,mem_patch26 
4e3d 78377c00 enable attempt 
4e3e 20404f2f call le_transmit_receive_sifs_notx 
4e3f 2036ce25 branch le_slave_match ,match 
4e40 20204e2d branch le_slave_cont 

le_slave_disconn:
4e41 471bc026 bpatchx patch26_7 ,mem_patch26 
4e42 20404dc7 call le_att_destroy_notify_pool 

le_disconnect:
4e43 20404e48 call le_clear_connection_info 
4e44 204041fc call app_disconn_reason_collect_ble 
4e45 20406f0e call sp_initialize_256 
4e46 700b0815 jam bt_evt_le_disconnected ,mem_fifo_temp 
4e47 202071ee branch ui_ipc_send_event 

le_clear_connection_info:
4e48 471c4027 bpatchx patch27_0 ,mem_patch27 
4e49 7004c300 jam 0 ,mem_le_conn_handle 
4e4a 7004ae00 jam lemode_idle ,mem_le_mode 
4e4b 7004ad00 jam 0 ,mem_le_state 
4e4c 7042b100 jam 0 ,mem_app_state 
4e4d 70448700 jam flag_le_pairing_null ,mem_le_pairing_state 
4e4e 70448800 jam flag_le_enc_null ,mem_le_enc_state 
4e4f 20600000 rtn 

le_got_first_packet:
4e50 471cc027 bpatchx patch27_1 ,mem_patch27 
4e51 6fe20005 fetch 1 ,mem_le_conn_rcv 
4e52 1fe0fe01 increase 1 ,pdata 
4e53 67e20005 store 1 ,mem_le_conn_rcv 
4e54 6fe204ad fetch 1 ,mem_le_state 
4e55 c3818000 rtnbit1 lestate_got_first_packet 
4e56 79207e03 set1 lestate_got_first_packet 
4e57 67e204ad store 1 ,mem_le_state 
4e58 58000000 setarg 0 
4e59 67e84517 store 4 ,mem_le_transmit_window 
4e5a 20600000 rtn 

le_enable:
4e5b 471d4027 bpatchx patch27_2 ,mem_patch27 
4e5c 783b7c00 enable le 
4e5d 70891407 jam 7 ,rfen_ulp 
4e5e 20203cf3 branch check_ble_disabled 

le_disable:
4e5f 471dc027 bpatchx patch27_3 ,mem_patch27 
4e60 785b7c00 disable le 
4e61 70891403 jam 3 ,rfen_ulp 
4e62 db600000 arg 0 ,stop_watch 
4e63 20600000 rtn 

le_prep:
4e64 471e4027 bpatchx patch27_4 ,mem_patch27 
4e65 7844fc00 disable enable_crc 
4e66 7843fc00 disable enable_white 
4e67 6fe604d6 fetch 3 ,mem_le_crcinit 
4e68 98001e00 iforce crc24_init 
4e69 6fe243fa fetch 1 ,mem_le_ch_mapped 
4e6a 1fed8400 reverse pdata ,temp 
4e6b 79200401 set1 1 ,temp 
4e6c 18431c00 rshift temp ,white_init 
4e6d 20600000 rtn 

lerx_setfreq:
4e6e 471ec027 bpatchx patch27_5 ,mem_patch27 
4e6f 20404e78 call le_setfreq 
4e70 204039aa call set_freq_rx 
4e71 58000500 setarg param_pll_setup 
4e72 20403b27 call sleep 
4e73 202039ae branch rf_rx_enable 

letx_setfreq:
4e74 471f4027 bpatchx patch27_6 ,mem_patch27 
4e75 2036b9bd branch rf_tx_enable ,match 
4e76 20404e78 call le_setfreq 
4e77 202039b7 branch set_freq_tx 

le_setfreq:
4e78 471fc027 bpatchx patch27_7 ,mem_patch27 
4e79 204039a2 call set_sync_on 
4e7a 6fe204fb fetch 1 ,mem_le_testtype 
4e7b 243a4e8b nbranch le_ctf_test ,blank 
4e7c 6fe243fa fetch 1 ,mem_le_ch_mapped 
4e7d 1fe67c24 sub pdata ,36 ,null 
4e7e 20214e85 branch le_ctf_normal ,positive 
4e7f 18000400 force 0 ,temp 
4e80 c1128000 rtneq 37 
4e81 18000418 force 24 ,temp 
4e82 c1130000 rtneq 38 
4e83 1800044e force 78 ,temp 
4e84 20600000 rtn 

le_ctf_normal:
4e85 1fe67c0a sub pdata ,10 ,null 
4e86 20214e88 branch le_ctf_low ,positive 
4e87 1fe0fe01 increase 1 ,pdata 

le_ctf_low:
4e88 1fe3fe00 lshift pdata ,pdata 
4e89 1fe08402 add pdata ,2 ,temp 
4e8a 20600000 rtn 

le_ctf_test:
4e8b 6fe243fa fetch 1 ,mem_le_ch_mapped 
4e8c 1fe38400 lshift pdata ,temp 
4e8d 20600000 rtn 

le_sca_map:
4e8e d84001f4 arg 500 ,temp 
4e8f 207a0000 rtn blank 
4e90 d84000fa arg 250 ,temp 
4e91 c1008000 rtneq 1 
4e92 d8400096 arg 150 ,temp 
4e93 c1010000 rtneq 2 
4e94 d8400064 arg 100 ,temp 
4e95 c1018000 rtneq 3 
4e96 d840004b arg 75 ,temp 
4e97 c1020000 rtneq 4 
4e98 d8400032 arg 50 ,temp 
4e99 c1028000 rtneq 5 
4e9a d8400028 arg 40 ,temp 
4e9b c1030000 rtneq 6 
4e9c d8400014 arg 20 ,temp 
4e9d 20600000 rtn 

le_adv_access:
4e9e 588e89be setarg 0x8e89be 
4e9f 1fed7e00 lshift8 pdata ,pdata 
4ea0 1fe1fed6 or_into 0xd6 ,pdata 
4ea1 98001200 iforce access 
4ea2 58555555 setarg 0x555555 
4ea3 67e604d6 store 3 ,mem_le_crcinit 
4ea4 20600000 rtn 

le_setup:
4ea5 47204028 bpatchx patch28_0 ,mem_patch28 
4ea6 78287c00 enable swfine 
4ea7 6fe804d2 fetch 4 ,mem_le_access 
4ea8 98001200 iforce access 
4ea9 20404ed6 call le_map_channel 
4eaa 58000200 setarg 0x200 
4eab 2034ceae branch le_setup_master ,master 
4eac 6fe404bb fetch 2 ,mem_le_receive_window 
4ead 1fe37e00 rshift pdata ,pdata 

le_setup_master:
4eae d8400500 arg param_rx_ahead ,temp 
4eaf 9840fe00 iadd temp ,pdata 
4eb0 20403abd call ahead_window 
4eb1 1b427e00 deposit clke 
4eb2 20600000 rtn 

le_next_adv_channel:
4eb3 6fe243fa fetch 1 ,mem_le_ch_mapped 
4eb4 1fe0fe01 increase 1 ,pdata 
4eb5 67e243fa store 1 ,mem_le_ch_mapped 
4eb6 c1940000 rtnne 40 
4eb7 7043fa25 jam 37 ,mem_le_ch_mapped 
4eb8 20600000 rtn 

le_context_nexthop:
4eb9 4720c028 bpatchx patch28_1 ,mem_patch28 
4eba 1a208c01 add rega ,coffset_mode ,contr 
4ebb efe20006 ifetch 1 ,contr 
4ebc c4000000 rtnbit0 mode_le 
4ebd 1a208a1a add rega ,coffset_le_event_cnt ,contw 
4ebe efe40005 ifetch 2 ,contw 
4ebf 1fe0fe01 increase 1 ,pdata 
4ec0 e7e40005 istore 2 ,contw 
4ec1 1a208c19 add rega ,coffset_le_hop ,contr 
4ec2 efe20006 ifetch 1 ,contr 
4ec3 1a208a18 add rega ,coffset_le_ch ,contw 
4ec4 e8420005 ifetcht 1 ,contw 
4ec5 9840fe00 iadd temp ,pdata 
4ec6 1fe67c24 sub pdata ,36 ,null 
4ec7 20214ec9 branch le_nexthop_nowrap ,positive 
4ec8 1fe0ffdb increase -37 ,pdata 

le_nexthop_nowrap:
4ec9 e7e20005 istore 1 ,contw 
4eca 20600000 rtn 

le_calc_channel_map:
4ecb 47214028 bpatchx patch28_2 ,mem_patch28 
4ecc 6fea04de fetch 5 ,mem_le_channel_map 
4ecd 18000400 force 0 ,temp 
4ece 18007225 force 37 ,loopcnt 

le_count_channels_loop:
4ecf c3004ed1 bbit0 0 ,le_count_channels_notused 
4ed0 18408401 increase 1 ,temp 

le_count_channels_notused:
4ed1 1fe37e00 rshift pdata ,pdata 
4ed2 c2004ecf loop le_count_channels_loop 
4ed3 1840ffff add temp ,-1 ,pdata 
4ed4 67e204cf store 1 ,mem_le_channels 
4ed5 20600000 rtn 

le_map_channel:
4ed6 4721c028 bpatchx patch28_3 ,mem_patch28 
4ed7 6fe204c5 fetch 1 ,mem_le_ch 
4ed8 98000e00 iforce queue 
4ed9 684a04de fetcht 5 ,mem_le_channel_map 
4eda a84fffff qisolate1 temp 
4edb 2020ceeb branch le_map_channel_end ,true 

le_map_channel_next:
4edc 6fe204cf fetch 1 ,mem_le_channels 
4edd 98e67e00 isub queue ,pdata 
4ede 20214ee1 branch le_map_channel_cont ,positive 
4edf 1fe60fff sub pdata ,-1 ,queue 
4ee0 20204edc branch le_map_channel_next 

le_map_channel_cont:
4ee1 18e27200 copy queue ,loopcnt 
4ee2 18000e00 force 0 ,queue 

le_map_channel_loop:
4ee3 a84fffff qisolate1 temp 
4ee4 2020cee6 branch le_map_channel_skip ,true 
4ee5 1f20f201 increase 1 ,loopcnt 

le_map_channel_skip:
4ee6 1f227e00 deposit loopcnt 
4ee7 203a4eeb branch le_map_channel_end ,blank 
4ee8 18e08e01 increase 1 ,queue 
4ee9 1f20f3ff increase -1 ,loopcnt 
4eea 20204ee3 branch le_map_channel_loop 

le_map_channel_end:
4eeb 18e27e00 deposit queue 
4eec 67e243fa store 1 ,mem_le_ch_mapped 
4eed 20600000 rtn 

le_wait_tx:
4eee 2034cef1 branch le_wait_master ,master 
4eef 37c18200 until null ,timeout 
4ef0 20600000 rtn 

le_wait_master:
4ef1 d9600ea0 arg 0xea0 ,timeup 
4ef2 34730200 until clkn_rt ,meet 
4ef3 20600000 rtn 

le_receive_adv:
4ef4 47224028 bpatchx patch28_4 ,mem_patch28 
4ef5 78487c00 disable swfine 
4ef6 696443ae fetchr timeup ,2 ,mem_le_scan_window 
4ef7 20204efd branch le_receive_packet 

le_receive_slave:
4ef8 4722c028 bpatchx patch28_5 ,mem_patch28 
4ef9 78287c00 enable swfine 
4efa 6fe404bb fetch 2 ,mem_le_receive_window 
4efb 68484517 fetcht 4 ,mem_le_transmit_window 
4efc 98409600 iadd temp ,timeup 

le_receive_packet:
4efd 20404e6e call lerx_setfreq 

le_receive_rxon:
4efe 20404e64 call le_prep 
4eff 7856fc00 disable match 
4f00 7826fc00 enable decode_fec0 
4f01 7830fc00 enable is_rx 
4f02 78507c00 disable is_tx 
4f03 19623600 copy timeup ,stop_watch 
4f04 37c18400 correlate null ,timeout 
4f05 20374f08 branch le_receive_on_attempt ,attempt 
4f06 1b420400 copy clke ,temp 
4f07 604c00a4 storet 6 ,mem_sync_clke 

le_receive_on_attempt:
4f08 47234028 bpatchx patch28_6 ,mem_patch28 
4f09 242c36b6 nbranch end_of_packet ,sync 
4f0a 20374f10 branch le_receive_skip ,attempt 
4f0b dd2001e0 arg param_clke_cal_le ,clke_rt 
4f0c 1c225000 copy bt_clk ,clke_bt 
4f0d 6fe204ad fetch 1 ,mem_le_state 
4f0e c301cf10 bbit0 lestate_got_first_packet ,le_receive_skip 
4f0f 2055bba0 call lpm_adjust_clk ,wake 

le_receive_skip:
4f10 20403a37 call save_rssi 
4f11 7823fc00 enable enable_white 
4f12 7824fc00 enable enable_crc 
4f13 09800008 parse demod ,bucket ,8 
4f14 19897e00 rshift3 pwindow ,pdata 
4f15 67e20365 store 1 ,mem_le_rxbuf 
4f16 09800008 parse demod ,bucket ,8 
4f17 19897e00 rshift3 pwindow ,pdata 
4f18 e7e20005 istore 1 ,contw 
4f19 1fe1723f and pdata ,0x3f ,loopcnt 
4f1a 2022cf1f branch lerx_nopayload ,zero 

lerx_loop:
4f1b 09800008 parse demod ,bucket ,8 
4f1c 19897e00 rshift3 pwindow ,pdata 
4f1d e7e20005 istore 1 ,contw 
4f1e c2004f1b loop lerx_loop 

lerx_nopayload:
4f1f 4723c028 bpatchx patch28_7 ,mem_patch28 
4f20 09800018 parse demod ,bucket ,24 
4f21 78287c00 enable swfine 
4f22 db600664 arg param_sifs ,stop_watch 
4f23 1fef7e00 rshift32 pdata ,pdata 
4f24 1ff17e00 rshift16 pdata ,pdata 
4f25 e7e60005 istore 3 ,contw 
4f26 202336b6 branch end_of_packet ,crc_failed 
4f27 7836fc00 enable match 
4f28 6fe20017 fetch 1 ,mem_last_freq 
4f29 1fe0a200 add pdata ,0 ,rega 
4f2a 204039fd call rf_write_freq 
4f2b 7846fc00 disable decode_fec0 
4f2c 202039a2 branch set_sync_on 

le_transmit_receive_sifs:
4f2d 47244029 bpatchx patch29_0 ,mem_patch29 
4f2e 20404f37 call le_transmit 

le_transmit_receive_sifs_notx:
4f2f 68420017 fetcht 1 ,mem_last_freq 
4f30 204039aa call set_freq_rx 
4f31 204039ae call rf_rx_enable 
4f32 78287c00 enable swfine 
4f33 d9601388 arg 5000 ,timeup 
4f34 20204efe branch le_receive_rxon 

le_transmit_norx:
4f35 20404f37 call le_transmit 
4f36 202036b6 branch end_of_packet 

le_transmit:
4f37 4724c029 bpatchx patch29_1 ,mem_patch29 
4f38 20404e64 call le_prep 
4f39 20404e74 call letx_setfreq 
4f3a 79202a00 set1 txgfsk ,radio_ctrl 
4f3b 782efc00 enable encode_fec0 
4f3c 78307c00 enable is_tx 
4f3d 7850fc00 disable is_rx 
4f3e 20404eee call le_wait_tx 
4f3f 19317e00 rshift16 access ,pdata 
4f40 1fecfe00 rshift8 pdata ,pdata 
4f41 1ff1fe00 rshift4 pdata ,pdata 
4f42 08008628 inject mod ,40 
4f43 7823fc00 enable enable_white 
4f44 7824fc00 enable enable_crc 
4f45 6fe24409 fetch 1 ,mem_le_txheader 
4f46 08008608 inject mod ,8 
4f47 efe20006 ifetch 1 ,contr 
4f48 1fe1723f and pdata ,0x3f ,loopcnt 
4f49 08008608 inject mod ,8 
4f4a 2022cf4e branch letr_nopayload ,zero 

letr_loop:
4f4b efe20006 ifetch 1 ,contr 
4f4c 08008608 inject mod ,8 
4f4d c2004f4b loop letr_loop 

letr_nopayload:
4f4e 78247c00 enable enable_parity 
4f4f 08008618 inject mod ,24 
4f50 78447c00 disable enable_parity 
4f51 37d38200 until null ,tx_clear 
4f52 20000064 nop 100 
4f53 784efc00 disable encode_fec0 
4f54 20600000 rtn 

le_send_adv_ind:
4f55 47254029 bpatchx patch29_2 ,mem_patch29 
4f56 6fe244ee fetch 1 ,mem_le_adv_type 
4f57 c000cf65 beq adv_direct_ind ,le_send_adv_direct_ind 
4f58 6fe244ef fetch 1 ,mem_le_adv_own_addr_type 
4f59 1ff27e00 lshift4 pdata ,pdata 
4f5a 1febfe00 lshift2 pdata ,pdata 
4f5b 67e24409 store 1 ,mem_le_txheader 
4f5c 684243b2 fetcht 1 ,mem_le_adv_data_len 
4f5d 1840fe06 add temp ,6 ,pdata 
4f5e 67e2440a store 1 ,mem_le_txlen 
4f5f 6fec450c fetch 6 ,mem_le_lap 
4f60 67ec440b store 6 ,mem_le_txpayload 
4f61 18427200 copy temp ,loopcnt 
4f62 d8c043b3 arg mem_le_adv_data ,contr 
4f63 2040779f call memcpy 
4f64 20204f76 branch le_send_adv_transmit 

le_send_adv_direct_ind:
4f65 4725c029 bpatchx patch29_3 ,mem_patch29 
4f66 684444c6 fetcht 2 ,mem_le_notify_handle 
4f67 20404d8b call le_att_check_notification_enable 
4f68 1a220a00 copy rega ,contw 
4f69 58000001 setarg 1 
4f6a e7e20005 istore 1 ,contw 
4f6b 6fe244f0 fetch 1 ,mem_le_adv_direct_addr_type 
4f6c 1ff27e00 lshift4 pdata ,pdata 
4f6d 1febfe00 lshift2 pdata ,pdata 
4f6e 1fe0fe01 increase 1 ,pdata 
4f6f 67e24409 store 1 ,mem_le_txheader 
4f70 5800000c setarg 12 
4f71 67e2440a store 1 ,mem_le_txlen 
4f72 6fec450c fetch 6 ,mem_le_lap 
4f73 67ec440b store 6 ,mem_le_txpayload 
4f74 6fec4286 fetch 6 ,mem_hci_plap 
4f75 e7ec0005 istore 6 ,contw 

le_send_adv_transmit:
4f76 6fe20000 fetch 1 ,mem_le_adv_transmit 
4f77 1fe0fe01 increase 1 ,pdata 
4f78 67e20000 store 1 ,mem_le_adv_transmit 
4f79 db600708 arg 1800 ,stop_watch 
4f7a 7856fc00 disable match 
4f7b 20204f2d branch le_transmit_receive_sifs 

le_send_scan_request:
4f7c 47264029 bpatchx patch29_4 ,mem_patch29 
4f7d 6fe24509 fetch 1 ,mem_le_scan_type 
4f7e c1808000 rtnne le_scan_type_active ,pdata 
4f7f 6fe20000 fetch 1 ,mem_le_adv_transmit 
4f80 1fe0fe01 increase 1 ,pdata 
4f81 67e20000 store 1 ,mem_le_adv_transmit 
4f82 d8400c03 arg 0x0c03 ,temp 
4f83 6fe2450a fetch 1 ,mem_le_scan_own_addr_type 
4f84 7d3a0406 nsetflag blank ,le_sender_addr_bit ,temp 
4f85 1a227e00 copy rega ,pdata 
4f86 7d3a0407 nsetflag blank ,le_receiver_addr_bit ,temp 
4f87 60444409 storet 2 ,mem_le_txheader 
4f88 6fec450c fetch 6 ,mem_le_lap 
4f89 e7ec0005 istore 6 ,contw 
4f8a 6fec04bd fetch 6 ,mem_le_plap 
4f8b e7ec0005 istore 6 ,contw 
4f8c 20204f2d branch le_transmit_receive_sifs 

le_send_scan_response:
4f8d d8400004 arg scan_rsp ,temp 
4f8e 6fe244ef fetch 1 ,mem_le_adv_own_addr_type 
4f8f 7d3a0406 nsetflag blank ,le_sender_addr_bit ,temp 
4f90 60424409 storet 1 ,mem_le_txheader 
4f91 684243d2 fetcht 1 ,mem_le_scan_data_len 
4f92 1840fe06 add temp ,6 ,pdata 
4f93 67e2440a store 1 ,mem_le_txlen 
4f94 6fec450c fetch 6 ,mem_le_lap 
4f95 67ec440b store 6 ,mem_le_txpayload 
4f96 d8c043d3 arg mem_le_scan_data ,contr 
4f97 18427200 copy temp ,loopcnt 
4f98 2040779f call memcpy 
4f99 20204f35 branch le_transmit_norx 

le_connect_request:
4f9a 4726c029 bpatchx patch29_5 ,mem_patch29 
4f9b 18007fff force -1 ,pdata 
4f9c 38080001 setsect 2 ,1 
4f9d 67ea04de store 5 ,mem_le_channel_map 
4f9e 20404ecb call le_calc_channel_map 
4f9f 18007204 force 4 ,loopcnt 
4fa0 d8a004d2 arg mem_le_access ,contw 
4fa1 20405b66 call generate_random_loop 
4fa2 6fe44507 fetch 2 ,mem_le_conn_superto 
4fa3 67e404dc store 2 ,mem_le_superto 

le_con_req_hop_retry:
4fa4 180a7e00 random pdata 
4fa5 1fe17e0f and_into 0xf ,pdata 
4fa6 1fe67c04 sub pdata ,4 ,null 
4fa7 20214fa4 branch le_con_req_hop_retry ,positive 
4fa8 67e204c6 store 1 ,mem_le_hop 
4fa9 67e20757 store 1 ,mem_tmp1 
4faa 684443a9 fetcht 2 ,mem_le_conn_interval 
4fab 604404af storet 2 ,mem_le_tsniff 
4fac 18422600 copy temp ,regc 
4fad 1c40fe07 add clkn_bt ,7 ,pdata 
4fae 9a66fc00 idiv regc 
4faf 2040782e call wait_div_end 
4fb0 18072200 remainder rega 
4fb1 9a267e00 isub rega ,pdata 
4fb2 9a60fe00 iadd regc ,pdata 
4fb3 684443a7 fetcht 2 ,mem_le_dsniff 
4fb4 9840fe00 iadd temp ,pdata 
4fb5 67e804b1 store 4 ,mem_le_anchor 
4fb6 9c462200 isub clkn_bt ,rega 
4fb7 1a20a3fa increase -6 ,rega 
4fb8 da402205 arg 0x2205 ,regb 
4fb9 6fe24500 fetch 1 ,mem_le_conn_own_addr_type 
4fba 7d3a2406 nsetflag blank ,le_sender_addr_bit ,regb 
4fbb 6fe244f9 fetch 1 ,mem_le_conn_peer_addr_type 
4fbc 7d3a2407 nsetflag blank ,le_receiver_addr_bit ,regb 
4fbd 62444409 storer regb ,2 ,mem_le_txheader 
4fbe 6fec450c fetch 6 ,mem_le_lap 
4fbf e7ec0005 istore 6 ,contw 
4fc0 6fec04bd fetch 6 ,mem_le_plap 
4fc1 e7ec0005 istore 6 ,contw 
4fc2 6fe804d2 fetch 4 ,mem_le_access 
4fc3 e7e80005 istore 4 ,contw 
4fc4 180a7e00 random pdata 
4fc5 e7e40005 istore 2 ,contw 
4fc6 180a7e00 random pdata 
4fc7 e7e20005 istore 1 ,contw 
4fc8 18007e02 force 2 ,pdata 
4fc9 e7e20005 istore 1 ,contw 
4fca 1a2b7e00 rshift2 rega ,pdata 
4fcb e7e40005 istore 2 ,contw 
4fcc 1a6b7e00 rshift2 regc ,pdata 
4fcd e7e40005 istore 2 ,contw 
4fce 6fe44505 fetch 2 ,mem_le_conn_latency 
4fcf e7e40005 istore 2 ,contw 
4fd0 6fe44507 fetch 2 ,mem_le_conn_superto 
4fd1 e7e40005 istore 2 ,contw 
4fd2 6fea04de fetch 5 ,mem_le_channel_map 
4fd3 e7ea0005 istore 5 ,contw 
4fd4 6fe204c6 fetch 1 ,mem_le_hop 
4fd5 d84000a0 arg param_le_sca ,temp 
4fd6 9841fe00 ior temp ,pdata 
4fd7 e7e20005 istore 1 ,contw 
4fd8 20404f35 call le_transmit_norx 
4fd9 58004409 setarg mem_le_txheader 
4fda 1fe08c12 add pdata ,18 ,contr 
4fdb efe60006 ifetch 3 ,contr 
4fdc 67e604d6 store 3 ,mem_le_crcinit 
4fdd 20600000 rtn 

le_init_adv:
4fde 7854fc00 disable master 
4fdf 20204e9e branch le_adv_access 

le_update_param:
4fe0 47274029 bpatchx patch29_6 ,mem_patch29 
4fe1 6fe204ad fetch 1 ,mem_le_state 
4fe2 c4028000 rtnbit0 lestate_update_param 
4fe3 6fe404c7 fetch 2 ,mem_le_event_count 
4fe4 684404cd fetcht 2 ,mem_le_instant 
4fe5 98467e00 isub temp ,pdata 
4fe6 67e40122 store 2 ,mem_pdatatemp 
4fe7 24610000 nrtn positive 
4fe8 6fe204ad fetch 1 ,mem_le_state 
4fe9 793ffe05 set0 lestate_update_param ,pdata 
4fea 793ffe03 set0 lestate_got_first_packet ,pdata 
4feb 67e204ad store 1 ,mem_le_state 
4fec 6fe804b1 fetch 4 ,mem_le_anchor 
4fed 684404af fetcht 2 ,mem_le_tsniff 
4fee 60440b0d storet 2 ,mem_temp 
4fef 98462200 isub temp ,rega 
4ff0 6fe24400 fetch 1 ,mem_le_new_param 
4ff1 67e204d9 store 1 ,mem_le_window_size 
4ff2 e8440006 ifetcht 2 ,contr 
4ff3 efe40006 ifetch 2 ,contr 
4ff4 1febfe00 lshift2 pdata ,pdata 
4ff5 67e404af store 2 ,mem_le_tsniff 
4ff6 184b8400 lshift2 temp ,temp 
4ff7 9840fe00 iadd temp ,pdata 
4ff8 e8480006 ifetcht 4 ,contr 
4ff9 604804da storet 4 ,mem_le_slave_latency 
4ffa 9a20fe00 iadd rega ,pdata 
4ffb 1fe22800 copy pdata ,regab 
4ffc 6fe404af fetch 2 ,mem_le_tsniff 
4ffd 68440b0d fetcht 2 ,mem_temp 
4ffe 98467e00 isub temp ,pdata 
4fff 68440122 fetcht 2 ,mem_pdatatemp 
5000 984ffe00 imul32 temp ,pdata 
5001 9a80fe00 iadd regab ,pdata 
5002 67e804b1 store 4 ,mem_le_anchor 
5003 202051db branch le_receive_window_size 

le_update_channel_map:
5004 6fe204ad fetch 1 ,mem_le_state 
5005 c4030000 rtnbit0 lestate_update_map 
5006 6fe404c7 fetch 2 ,mem_le_event_count 
5007 684404cd fetcht 2 ,mem_le_instant 
5008 98467e00 isub temp ,pdata 
5009 24610000 nrtn positive 
500a 6fe204ad fetch 1 ,mem_le_state 
500b 793ffe06 set0 lestate_update_map ,pdata 
500c 67e204ad store 1 ,mem_le_state 
500d 6fea43fb fetch 5 ,mem_le_new_map 
500e 67ea04de store 5 ,mem_le_channel_map 
500f 20204ecb branch le_calc_channel_map 

le_acknowledge:
5010 4727c029 bpatchx patch29_7 ,mem_patch29 
5011 204051be call le_supervision_flush 
5012 20405029 call le_check_wak 
5013 6fe20365 fetch 1 ,mem_le_rxbuf 
5014 2feffe04 isolate1 md ,pdata 
5015 79208027 setflag true ,mark_ble_rx_md ,mark 
5016 1fe37e00 rshift pdata ,pdata 
5017 9842fe00 ixor temp ,pdata 
5018 2feffe02 isolate1 nesn ,pdata 
5019 7920800f setflag true ,mark_old_packet ,mark 
501a 6fe20366 fetch 1 ,mem_le_rxbuf + 1 
501b 203a5023 branch le_ack_unenc ,blank 
501c 6fe204ad fetch 1 ,mem_le_state 
501d c3025023 bbit0 lestate_encryption ,le_ack_unenc 
501e c6078000 rtnmark1 mark_old_packet 
501f 20406928 call load_sk 
5020 20406898 call le_decrypt 
5021 793a001a setflag blank ,mark_le_mic_ok ,mark 
5022 247a0000 nrtn blank 

le_ack_unenc:
5023 c6078000 rtnmark1 mark_old_packet 
5024 7920001a set1 mark_le_mic_ok ,mark 
5025 684204c4 fetcht 1 ,mem_le_arq 
5026 79400402 setflip nesn ,temp 
5027 604204c4 storet 1 ,mem_le_arq 
5028 20600000 rtn 

le_check_wak:
5029 4728402a bpatchx patch2a_0 ,mem_patch2a 
502a 684204c4 fetcht 1 ,mem_le_arq 
502b 284c0005 isolate0 wak ,temp 
502c 20608000 rtn true 
502d 6fe20365 fetch 1 ,mem_le_rxbuf 
502e 1fe3fe00 lshift pdata ,pdata 
502f 9842fe00 ixor temp ,pdata 
5030 c4018000 rtnbit0 sn 
5031 793f8405 set0 wak ,temp 
5032 79400403 setflip sn ,temp 
5033 604204c4 storet 1 ,mem_le_arq 
5034 28400603 compare 3 ,temp ,3 
5035 24608000 nrtn true 
5036 6fe2440b fetch 1 ,mem_le_txpayload 
5037 c002d03b beq ll_start_enc_req ,le_set_enc 
5038 6fe24488 fetch 1 ,mem_le_enc_state 
5039 c001503f beq flag_le_enc_pause ,le_clear_enc 
503a 20600000 rtn 

le_set_enc:
503b 6fe204ad fetch 1 ,mem_le_state 
503c 79207e04 set1 lestate_encryption ,pdata 
503d 67e204ad store 1 ,mem_le_state 
503e 20600000 rtn 

le_clear_enc:
503f 4728c02a bpatchx patch2a_1 ,mem_patch2a 
5040 70448800 jam flag_le_enc_null ,mem_le_enc_state 
5041 dfe00000 arg 0 ,pdata 
5042 67e8443a store 4 ,mem_le_last_mic 
5043 67ea4430 store 5 ,mem_le_pcnt_tx 
5044 79207e27 set1 39 ,pdata 
5045 67ea4435 store 5 ,mem_le_pcnt_rx 
5046 6fe204ad fetch 1 ,mem_le_state 
5047 793ffe04 set0 lestate_encryption ,pdata 
5048 67e204ad store 1 ,mem_le_state 
5049 20600000 rtn 

le_wait_adv:
504a 20404eb3 call le_next_adv_channel 
504b 20404ef4 call le_receive_adv 
504c 6fe20001 fetch 1 ,mem_le_adv_waitcnt 
504d 1fe0fe01 increase 1 ,pdata 
504e 67e20001 store 1 ,mem_le_adv_waitcnt 
504f 20600000 rtn 

le_scan:
5050 4729402a bpatchx patch2a_2 ,mem_patch2a 
5051 6fe243ab fetch 1 ,mem_le_scan_enable 
5052 c1808000 rtnne le_scan_enable 
5053 d8e00003 arg le_scan_interval_timer ,queue 
5054 204077ad call timer_check 
5055 247a0000 nrtn blank 
5056 6fe443ac fetch 2 ,mem_le_scan_interval 
5057 684443ae fetcht 2 ,mem_le_scan_window 
5058 98467e00 isub temp ,pdata 
5059 d8e00003 arg le_scan_interval_timer ,queue 
505a 204077a6 call timer_init 
505b 7854fc00 disable master 
505c 20404fde call le_init_adv 
505d 2040504a call le_wait_adv 
505e 24768000 nrtn match 
505f 4729c02a bpatchx patch2a_3 ,mem_patch2a 
5060 6fec0367 fetch 6 ,mem_le_rxbuf + 2 
5061 67ec04bd store 6 ,mem_le_plap 
5062 6fe20002 fetch 1 ,mem_le_adv_rcv 
5063 1fe0fe01 increase 1 ,pdata 
5064 67e20002 store 1 ,mem_le_adv_rcv 
5065 2040506f call le_create_conn 
5066 20748000 rtn master 
5067 20404f7c call le_send_scan_request 
5068 24768000 nrtn match 
5069 6fe20004 fetch 1 ,mem_le_scanrsp_rcv 
506a 1fe0fe01 increase 1 ,pdata 
506b 67e20004 store 1 ,mem_le_scanrsp_rcv 
506c 6ff2036d fetch 9 ,mem_le_rxbuf + 8 
506d 67f200c4 store 9 ,mem_tmp_buffer 
506e 20600000 rtn 

le_create_conn:
506f 472a402a bpatchx patch2a_4 ,mem_patch2a 
5070 6fe20501 fetch 1 ,mem_cmd_le_create_conn 
5071 c18d8000 rtnne hci_cmd_le_create_conn ,pdata 
5072 6fec04bd fetch 6 ,mem_le_plap 
5073 684c44fa fetcht 6 ,mem_le_conn_peer_addr 
5074 98467c00 isub temp ,null 
5075 24628000 nrtn zero 
5076 2040326a call context_new 
5077 24628000 nrtn zero 
5078 20404f9a call le_connect_request 
5079 20404de9 call le_init_master 
507a 70428400 jam 0 ,mem_hci_cmd 
507b 7004e500 jam 0 ,mem_le_peer_sca 
507c 6fe24132 fetch 1 ,mem_device_option 
507d c082507f bne dvc_op_dongle ,le_create_conn_ndongle 
507e 7004d021 jam conn_sm_send_write_req ,mem_le_conn_sm 

le_create_conn_ndongle:
507f 7043ab00 jam 0 ,mem_le_scan_enable 
5080 70050100 jam 0 ,mem_cmd_le_create_conn 
5081 2020324f branch context_save 

le_scan_check_sender_addr_type:
5082 da200001 arg 1 ,rega 
5083 6fe20365 fetch 1 ,mem_le_rxbuf 
5084 c3830000 rtnbit1 le_sender_addr_bit 
5085 da200000 arg 0 ,rega 
5086 20600000 rtn 

le_prepare_tx:
5087 472ac02a bpatchx patch2a_5 ,mem_patch2a 
5088 6fe204c4 fetch 1 ,mem_le_arq 
5089 c3828000 rtnbit1 wak 
508a 204050a8 call le_check_tx_md 
508b 2040528c call le_fifo_get_first_tx_ptr 
508c 203a50c1 branch le_send_empty ,blank 
508d efe20006 ifetch 1 ,contr 
508e ea220006 ifetchr rega ,1 ,contr 
508f 9a267e00 isub rega ,pdata 
5090 d840001b arg le_max_paket_len ,temp 
5091 204078db call not_greater_than 
5092 1fe20400 copy pdata ,temp 
5093 e8220006 ifetchr type ,1 ,contr 
5094 1a227e00 copy rega ,pdata 
5095 98c08c00 iadd contr ,contr 
5096 d8a0440b arg mem_le_txpayload ,contw 
5097 18427200 copy temp ,loopcnt 
5098 2040779f call memcpy 
5099 204050bd call le_update_tx_type 
509a 204050c3 call le_send_packet 
509b 2040528c call le_fifo_get_first_tx_ptr 
509c efe20006 ifetch 1 ,contr 
509d 1fe22200 copy pdata ,rega 
509e 18c23000 copy contr ,regd 
509f ea420006 ifetchr regb ,1 ,contr 
50a0 9a467e00 isub regb ,pdata 
50a1 d840001b arg le_max_paket_len ,temp 
50a2 204078db call not_greater_than 
50a3 9a40fe00 iadd regb ,pdata 
50a4 e7e20018 istore 1 ,regd 
50a5 9a267c00 isub rega ,null 
50a6 24628000 nrtn zero 
50a7 202052b2 branch le_fifo_release_first_node 

le_check_tx_md:
50a8 472b402a bpatchx patch2a_6 ,mem_patch2a 
50a9 6fe24556 fetch 1 ,mem_le_more_data 
50aa 203a50bb branch le_clear_md ,blank 
50ab 204050b1 call le_check_continue 
50ac c6130000 rtnmark1 mark_ble_tx_md 
50ad 20405290 call le_fifo_get_second_tx_ptr 
50ae 203a50bb branch le_clear_md ,blank 
50af 79200026 set1 mark_ble_tx_md ,mark 
50b0 20600000 rtn 

le_check_continue:
50b1 472bc02a bpatchx patch2a_7 ,mem_patch2a 
50b2 2040528c call le_fifo_get_first_tx_ptr 
50b3 203a50bb branch le_clear_md ,blank 
50b4 efe20006 ifetch 1 ,contr 
50b5 e8420006 ifetcht 1 ,contr 
50b6 98467e00 isub temp ,pdata 
50b7 1fe67c1b sub pdata ,le_max_paket_len ,null 
50b8 202150bb branch le_clear_md ,positive 
50b9 79200026 set1 mark_ble_tx_md ,mark 
50ba 20600000 rtn 

le_clear_md:
50bb 793f8026 set0 mark_ble_tx_md ,mark 
50bc 20600000 rtn 

le_update_tx_type:
50bd 1a227e00 copy rega ,pdata 
50be 207a0000 rtn blank 
50bf d8200001 arg llid_continue ,type 
50c0 20600000 rtn 

le_send_empty:
50c1 18000400 force 0 ,temp 
50c2 18000201 force 1 ,type 

le_send_packet:
50c3 472c402b bpatchx patch2b_0 ,mem_patch2b 
50c4 6042440a storet 1 ,mem_le_txlen 
50c5 684204c4 fetcht 1 ,mem_le_arq 
50c6 79200405 set1 wak ,temp 
50c7 18417efc and temp ,0xfc ,pdata 
50c8 9821fe00 ior type ,pdata 
50c9 67e204c4 store 1 ,mem_le_arq 
50ca 1fe17e1f and_into 0x1f ,pdata 
50cb 280ffe26 isolate1 mark_ble_tx_md ,mark 
50cc 7920fe04 setflag true ,md ,pdata 
50cd 67e24409 store 1 ,mem_le_txheader 
50ce 6fe2440a fetch 1 ,mem_le_txlen 
50cf 207a0000 rtn blank 
50d0 6fee440a fetch 7 ,mem_le_txheader + 1 
50d1 6fe204ad fetch 1 ,mem_le_state 
50d2 c4020000 rtnbit0 lestate_encryption 
50d3 20406928 call load_sk 
50d4 20206880 branch le_encrypt 

le_parse:
50d5 472cc02b bpatchx patch2b_1 ,mem_patch2b 
50d6 c6078000 rtnmark1 mark_old_packet 
50d7 c68d0000 rtnmark0 mark_le_mic_ok 
50d8 204052ae call le_fifo_check_full 
50d9 247a0000 nrtn blank 
50da 6fe20365 fetch 1 ,mem_le_rxbuf 
50db 1fe17e03 and pdata ,0x3 ,pdata 
50dc 67e20517 store 1 ,mem_le_packet_llid 
50dd efe20006 ifetch 1 ,contr 
50de 1fe17e1f and pdata ,0x1f ,pdata 
50df 67e20516 store 1 ,mem_le_packet_size 
50e0 207a0000 rtn blank 
50e1 60c40518 storer contr ,2 ,mem_le_payload_ptr 
50e2 6fe20517 fetch 1 ,mem_le_packet_llid 
50e3 c001d118 beq llid_le_ll ,le_parse_ll 

le_parse_l2cap:
50e4 472d402b bpatchx patch2b_2 ,mem_patch2b 
50e5 204050f0 call le_check_l2cap_complete 
50e6 24740000 nrtn user 
50e7 6fe40518 fetch 2 ,mem_le_payload_ptr 
50e8 1fe20c00 copy pdata ,contr 
50e9 efe40006 ifetch 2 ,contr 
50ea 67e4452b store 2 ,mem_le_l2cap_size 
50eb efe40006 ifetch 2 ,contr 
50ec c0024b95 beq le_l2cap_cid_att ,le_parse_att 
50ed c00352f2 beq le_l2cap_cid_smp ,le_parse_smp 
50ee c002d2c8 beq le_l2cap_cid_signal ,le_parse_signaling 
50ef 20600000 rtn 

le_check_l2cap_complete:
50f0 6fe20517 fetch 1 ,mem_le_packet_llid 
50f1 c00150f4 beq llid_start ,le_check_l2cap_llid_start 
50f2 c000d104 beq llid_continue ,le_check_l2cap_llid_continue 
50f3 20600000 rtn 

le_check_l2cap_llid_start:
50f4 472dc02b bpatchx patch2b_3 ,mem_patch2b 
50f5 6fe40518 fetch 2 ,mem_le_payload_ptr 
50f6 1fe20c00 copy pdata ,contr 
50f7 efe40006 ifetch 2 ,contr 
50f8 67e4452b store 2 ,mem_le_l2cap_size 
50f9 68420516 fetcht 1 ,mem_le_packet_size 
50fa 6042452d storet 1 ,mem_le_packet_len_recved 
50fb 1fe0fe04 increase 4 ,pdata 
50fc 98467c00 isub temp ,null 
50fd 2022f903 branch enable_user ,zero 
50fe 6f220516 fetchr loopcnt ,1 ,mem_le_packet_size 
50ff d8a0038d arg mem_le_l2capbuf ,contw 
5100 6fe40518 fetch 2 ,mem_le_payload_ptr 
5101 1fe20c00 copy pdata ,contr 
5102 2040779f call memcpy 
5103 202078ec branch disable_user 

le_check_l2cap_llid_continue:
5104 472e402b bpatchx patch2b_4 ,mem_patch2b 
5105 6fe2452d fetch 1 ,mem_le_packet_len_recved 
5106 d8a0038d arg mem_le_l2capbuf ,contw 
5107 98a0a200 iadd contw ,rega 
5108 68420516 fetcht 1 ,mem_le_packet_size 
5109 9840fe00 iadd temp ,pdata 
510a 67e2452d store 1 ,mem_le_packet_len_recved 
510b 6f220516 fetchr loopcnt ,1 ,mem_le_packet_size 
510c 1a220a00 copy rega ,contw 
510d 6fe40518 fetch 2 ,mem_le_payload_ptr 
510e 1fe20c00 copy pdata ,contr 
510f 2040779f call memcpy 
5110 5800038d setarg mem_le_l2capbuf 
5111 67e40518 store 2 ,mem_le_payload_ptr 
5112 6fe4452b fetch 2 ,mem_le_l2cap_size 
5113 1fe0fe04 increase 4 ,pdata 
5114 6842452d fetcht 1 ,mem_le_packet_len_recved 
5115 98467c00 isub temp ,null 
5116 2022f903 branch enable_user ,zero 
5117 202078ec branch disable_user 

le_parse_ll:
5118 472ec02b bpatchx patch2b_5 ,mem_patch2b 
5119 6fe20367 fetch 1 ,mem_le_rxbuf + 2 
511a c0005132 beq ll_connection_update_req ,le_parse_connection_update_req 
511b c000d13b beq ll_channel_map_req ,le_parse_channel_map_req 
511c c0015144 beq ll_terminate_ind ,le_parse_terminate_ind 
511d c001d152 beq ll_enc_req ,le_parse_enc_req 
511e c002518a beq ll_enc_rsp ,le_parse_enc_rsp 
511f c002d18f beq ll_start_enc_req ,le_parse_start_enc_req 
5120 c0035193 beq ll_start_enc_rsp ,le_parse_start_enc_rsp 
5121 c003d1b2 beq ll_unknown_rsp ,le_parse_unknown_rsp 
5122 c0045198 beq ll_feature_req ,le_parse_feature_req 
5123 c004d1b2 beq ll_feature_rsp ,le_parse_feature_rsp 
5124 c00551a0 beq ll_pause_enc_req ,le_parse_pause_enc_req 
5125 c005d1b2 beq ll_pause_enc_rsp ,le_parse_pause_enc_rsp 
5126 c00651a6 beq ll_version_ind ,le_parse_version_ind 
5127 c006d1b2 beq ll_reject_ind ,le_parse_reject_ind 
5128 c00951b3 beq ll_ping_req ,le_parse_ping_req 
5129 c009d1b2 beq ll_ping_rsp ,le_parse_ping_rsp 
512a da200002 arg 2 ,rega 
512b d8200003 arg llid_le_ll ,type 
512c 20405268 call le_fifo_malloc_tx 
512d 58000007 setarg ll_unknown_rsp 
512e e7e20005 istore 1 ,contw 
512f 6fe20367 fetch 1 ,mem_le_rxbuf + 2 
5130 e7e20005 istore 1 ,contw 
5131 20600000 rtn 

le_parse_connection_update_req:
5132 472f402b bpatchx patch2b_6 ,mem_patch2b 
5133 eff20006 ifetch 9 ,contr 
5134 67f24400 store 9 ,mem_le_new_param 
5135 efe40006 ifetch 2 ,contr 
5136 67e404cd store 2 ,mem_le_instant 
5137 6fe204ad fetch 1 ,mem_le_state 
5138 79207e05 set1 lestate_update_param ,pdata 
5139 67e204ad store 1 ,mem_le_state 
513a 20600000 rtn 

le_parse_channel_map_req:
513b 472fc02b bpatchx patch2b_7 ,mem_patch2b 
513c efea0006 ifetch 5 ,contr 
513d 67ea43fb store 5 ,mem_le_new_map 
513e efe40006 ifetch 2 ,contr 
513f 67e404cd store 2 ,mem_le_instant 
5140 6fe204ad fetch 1 ,mem_le_state 
5141 79207e06 set1 lestate_update_map ,pdata 
5142 67e204ad store 1 ,mem_le_state 
5143 20600000 rtn 

le_parse_terminate_ind:
5144 58000014 setarg 20 
5145 67e404dc store 2 ,mem_le_superto 
5146 20600000 rtn 

le_send_terminate_remote_user_ended_conn:
5147 700b0d13 jam hci_error_remote_user_ended_connection ,mem_temp 

le_send_terminate_ind:
5148 4730402c bpatchx patch2c_0 ,mem_patch2c 
5149 20405144 call le_parse_terminate_ind 
514a da200002 arg 2 ,rega 
514b d8200003 arg llid_le_ll ,type 
514c 20405268 call le_fifo_malloc_tx 
514d 58000002 setarg ll_terminate_ind 
514e e7e20005 istore 1 ,contw 
514f 6fe20b0d fetch 1 ,mem_temp 
5150 e7e20005 istore 1 ,contw 
5151 20600000 rtn 

le_parse_enc_req:
5152 4730c02c bpatchx patch2c_1 ,mem_patch2c 
5153 eff00006 ifetch 8 ,contr 
5154 67f04490 store 8 ,mem_le_rand 
5155 efe40006 ifetch 2 ,contr 
5156 67e4448e store 2 ,mem_le_ediv 
5157 eff00006 ifetch 8 ,contr 
5158 67f0046d store 8 ,mem_le_skdm 
5159 efe80006 ifetch 4 ,contr 
515a 67e8443e store 4 ,mem_le_ivm 
515b 6fe24487 fetch 1 ,mem_le_pairing_state 
515c c002515f beq flag_le_pairing_after_auth ,le_parse_enc_req_after_auth 
515d 6fe24456 fetch 1 ,mem_ltk_exists 
515e c0005163 beq 0 ,le_ltk_lost 

le_parse_enc_req_ltk_exist:

le_parse_enc_req_after_auth:
515f 70448801 jam flag_le_rcv_enc_start ,mem_le_enc_state 
5160 2040516e call le_send_enc_rsp 
5161 2040517f call le_send_start_enc_req 
5162 2020683f branch generate_sk 

le_ltk_lost:
5163 4731402c bpatchx patch2c_2 ,mem_patch2c 
5164 70448800 jam flag_le_enc_null ,mem_le_enc_state 
5165 20205166 branch le_send_reject_ind 

le_send_reject_ind:
5166 da200002 arg 2 ,rega 
5167 d8200003 arg llid_le_ll ,type 
5168 20405268 call le_fifo_malloc_tx 
5169 5800000d setarg ll_reject_ind 
516a e7e20005 istore 1 ,contw 
516b 58000006 setarg le_err_pin_or_key_missing 
516c e7e20005 istore 1 ,contw 
516d 20600000 rtn 

le_send_enc_rsp:
516e 4731c02c bpatchx patch2c_3 ,mem_patch2c 
516f d8a00475 arg mem_le_skds ,contw 
5170 18007208 force 8 ,loopcnt 
5171 20405b66 call generate_random_loop 
5172 d8a04442 arg mem_le_ivs ,contw 
5173 18007204 force 4 ,loopcnt 
5174 20405b66 call generate_random_loop 
5175 da20000d arg 13 ,rega 
5176 d8200003 arg llid_le_ll ,type 
5177 20405268 call le_fifo_malloc_tx 
5178 58000004 setarg ll_enc_rsp 
5179 e7e20005 istore 1 ,contw 
517a 6ff00475 fetch 8 ,mem_le_skds 
517b e7f00005 istore 8 ,contw 
517c 6fe84442 fetch 4 ,mem_le_ivs 
517d e7e80005 istore 4 ,contw 
517e 20600000 rtn 

le_send_start_enc_req:
517f da600005 arg ll_start_enc_req ,regc 
5180 20205183 branch le_send_ll_one_lenth 

le_send_start_enc_rsp:
5181 da600006 arg ll_start_enc_rsp ,regc 
5182 20205183 branch le_send_ll_one_lenth 

le_send_ll_one_lenth:
5183 4732402c bpatchx patch2c_4 ,mem_patch2c 
5184 da200001 arg 1 ,rega 
5185 d8200003 arg llid_le_ll ,type 
5186 20405268 call le_fifo_malloc_tx 
5187 1a627e00 copy regc ,pdata 
5188 e7e20005 istore 1 ,contw 
5189 20600000 rtn 

le_parse_enc_rsp:
518a eff00006 ifetch 8 ,contr 
518b 67f00475 store 8 ,mem_le_skds 
518c efe80006 ifetch 4 ,contr 
518d 67e84442 store 4 ,mem_le_ivs 
518e 2020683f branch generate_sk 

le_parse_start_enc_req:
518f 6fe204ad fetch 1 ,mem_le_state 
5190 79207e04 set1 lestate_encryption ,pdata 
5191 67e204ad store 1 ,mem_le_state 
5192 20600000 rtn 

le_parse_start_enc_rsp:
5193 20748000 rtn master 
5194 700b0832 jam bt_evt_le_start_enc ,mem_fifo_temp 
5195 204071ee call ui_ipc_send_event 
5196 70448804 jam flag_le_send_start_enc_rsp ,mem_le_enc_state 
5197 20205181 branch le_send_start_enc_rsp 

le_parse_feature_req:
5198 da200009 arg 9 ,rega 
5199 d8200003 arg llid_le_ll ,type 
519a 20405268 call le_fifo_malloc_tx 
519b 58000009 setarg ll_feature_rsp 
519c e7e20005 istore 1 ,contw 
519d 58000001 setarg param_le_features 
519e e7f00005 istore 8 ,contw 
519f 20600000 rtn 

le_parse_pause_enc_req:
51a0 70448802 jam flag_le_enc_pause ,mem_le_enc_state 
51a1 204051a4 call le_send_pause_enc_rsp 
51a2 700b0833 jam bt_evt_le_pause_enc ,mem_fifo_temp 
51a3 202071ee branch ui_ipc_send_event 

le_send_pause_enc_rsp:
51a4 da60000b arg ll_pause_enc_rsp ,regc 
51a5 20205183 branch le_send_ll_one_lenth 

le_parse_version_ind:
51a6 4732c02c bpatchx patch2c_5 ,mem_patch2c 
51a7 20748000 rtn master 
51a8 da200006 arg 6 ,rega 
51a9 d8200003 arg llid_le_ll ,type 
51aa 20405268 call le_fifo_malloc_tx 
51ab 5800000c setarg ll_version_ind 
51ac e7e20005 istore 1 ,contw 
51ad 58050e08 setarg param_le_version 
51ae e7e60005 istore 3 ,contw 
51af 58000005 setarg param_le_subversion 
51b0 e7e40005 istore 2 ,contw 
51b1 20600000 rtn 

le_parse_feature_rsp:

le_parse_unknown_rsp:

le_parse_pause_enc_rsp:

le_parse_reject_ind:

le_parse_ping_rsp:
51b2 20600000 rtn 

le_parse_ping_req:
51b3 da600013 arg ll_ping_rsp ,regc 
51b4 20205183 branch le_send_ll_one_lenth 

le_supervision_update:
51b5 684804c9 fetcht 4 ,mem_le_supervision_timer 
51b6 20403b14 call get_clkbt 
51b7 98461600 isub temp ,timeup 
51b8 19627e00 deposit timeup 
51b9 684404dc fetcht 2 ,mem_le_superto 
51ba 18520400 lshift4 temp ,temp 
51bb 18438400 lshift temp ,temp 
51bc 98467e00 isub temp ,pdata 
51bd 20600000 rtn 

le_supervision_flush:
51be 20403b14 call get_clkbt 
51bf 67e804c9 store 4 ,mem_le_supervision_timer 
51c0 20600000 rtn 

le_adv:
51c1 4733402c bpatchx patch2c_6 ,mem_patch2c 
51c2 6fe243b1 fetch 1 ,mem_le_adv_enable 
51c3 207a0000 rtn blank 
51c4 d8e00001 arg le_adv_interval_timer ,queue 
51c5 204077ad call timer_check 
51c6 247a0000 nrtn blank 
51c7 7854fc00 disable master 
51c8 78287c00 enable swfine 
51c9 20404fde call le_init_adv 
51ca 20404eb3 call le_next_adv_channel 
51cb 20404f55 call le_send_adv_ind 
51cc 2436d1d4 nbranch le_adv_not_match ,match 
51cd 6fe20003 fetch 1 ,mem_le_req_rcv 
51ce 1fe0fe01 increase 1 ,pdata 
51cf 67e20003 store 1 ,mem_le_req_rcv 
51d0 6fe20365 fetch 1 ,mem_le_rxbuf 
51d1 1fe17e0f and pdata ,0x0f ,pdata 
51d2 c001cf8d beq scan_req ,le_send_scan_response 
51d3 c002d1ee beq connect_req ,parse_connect_req 

le_adv_not_match:
51d4 20002710 nop 10000 
51d5 6fe243fa fetch 1 ,mem_le_ch_mapped 
51d6 c093d1c1 bne 39 ,le_adv 
51d7 2040522b call le_ledoff 
51d8 d8e00001 arg le_adv_interval_timer ,queue 
51d9 6fe444ec fetch 2 ,mem_le_adv_interval_max 
51da 202077a6 branch timer_init 

le_receive_window_size:
51db 4733c02c bpatchx patch2c_7 ,mem_patch2c 
51dc 6fe204e5 fetch 1 ,mem_le_peer_sca 
51dd 20404e8e call le_sca_map 
51de 6fe404af fetch 2 ,mem_le_tsniff 
51df 984ffe00 imul32 temp ,pdata 
51e0 d8400177 arg 375 ,temp 
51e1 984ffe00 imul32 temp ,pdata 
51e2 d84186a0 arg 100000 ,temp 
51e3 9846fc00 idiv temp 
51e4 6fe204d9 fetch 1 ,mem_le_window_size 
51e5 d8404e20 arg 20000 ,temp 
51e6 984ffe00 imul32 temp ,pdata 
51e7 67e84517 store 4 ,mem_le_transmit_window 
51e8 6fe44161 fetch 2 ,mem_rx_window_sniff 
51e9 2040782e call wait_div_end 
51ea 18078400 quotient temp 
51eb 9840fe00 iadd temp ,pdata 
51ec 67e404bb store 2 ,mem_le_receive_window 
51ed 20600000 rtn 

parse_connect_req:
51ee 4734402d bpatchx patch2d_0 ,mem_patch2d 
51ef 6fec036d fetch 6 ,mem_le_rxbuf + 8 
51f0 684c450c fetcht 6 ,mem_le_lap 
51f1 98467c00 isub temp ,null 
51f2 24628000 nrtn zero 
51f3 20405082 call le_scan_check_sender_addr_type 
51f4 1a227e00 copy rega ,pdata 
51f5 67e244f9 store 1 ,mem_le_conn_peer_addr_type 
51f6 6fee037a fetch 7 ,mem_le_rxbuf + 21 
51f7 67ee00c4 store 7 ,mem_tmp_buffer 
51f8 eff00006 ifetch 8 ,contr 
51f9 e7f00005 istore 8 ,contw 
51fa 6fec0367 fetch 6 ,mem_le_rxbuf + 2 
51fb 67ec04bd store 6 ,mem_le_plap 
51fc 18c08c06 increase 6 ,contr 
51fd eff00006 ifetch 8 ,contr 
51fe 67f004d2 store 8 ,mem_le_access 
51ff e8440006 ifetcht 2 ,contr 
5200 184b8400 lshift2 temp ,temp 
5201 efe40006 ifetch 2 ,contr 
5202 1febfe00 lshift2 pdata ,pdata 
5203 67e404af store 2 ,mem_le_tsniff 
5204 67e804b1 store 4 ,mem_le_anchor 
5205 98467e00 isub temp ,pdata 
5206 1fe0d1fe add pdata ,-2 ,clke_bt 
5207 eff20006 ifetch 9 ,contr 
5208 67f204da store 9 ,mem_le_slave_latency 
5209 efe20006 ifetch 1 ,contr 
520a 1ff18400 rshift4 pdata ,temp 
520b 18430400 rshift temp ,temp 
520c 604204e5 storet 1 ,mem_le_peer_sca 
520d 1fe17e1f and_into 0x1f ,pdata 
520e 67e204c6 store 1 ,mem_le_hop 
520f 204051db call le_receive_window_size 
5210 6fe84517 fetch 4 ,mem_le_transmit_window 
5211 d8403a98 arg 15000 ,temp 
5212 9840fe00 iadd temp ,pdata 
5213 67e84517 store 4 ,mem_le_transmit_window 
5214 20404ecb call le_calc_channel_map 
5215 20404df5 call le_init_slave 
5216 2040326a call context_new 
5217 24628000 nrtn zero 
5218 204038cd call calc_clke_offset 
5219 2040525e call le_l2cap_reset_signaling_identifier 
521a 700b0814 jam bt_evt_le_connected ,mem_fifo_temp 
521b 204071ee call ui_ipc_send_event 
521c 2020324f branch context_save 

le_data_send_write_req:
521d 7044d902 jam 0x2 ,mem_le_handle_data_len 
521e 58000001 setarg 0x0001 
521f 67e444da store 2 ,mem_le_handle_data 
5220 7004d025 jam conn_sm_wait_write_res ,mem_le_conn_sm 
5221 20600000 rtn 

le_data_wait_write_res:
5222 20600000 rtn 

le_data_wait_write_res1:
5223 20600000 rtn 

le_conn_sm_master:
5224 6fe24132 fetch 1 ,mem_device_option 
5225 c1820000 rtnne dvc_op_dongle 
5226 6fe204d0 fetch 1 ,mem_le_conn_sm 
5227 c010d21d beq conn_sm_send_write_req ,le_data_send_write_req 
5228 c012d222 beq conn_sm_wait_write_res ,le_data_wait_write_res 
5229 c0135223 beq conn_sm_wait_write_res1 ,le_data_wait_write_res1 
522a 20600000 rtn 

le_ledoff:
522b 684243b0 fetcht 1 ,mem_le_adv_led 
522c 79400407 setflip gpio_active_bit ,temp 
522d 20205e9d branch gpio_out 

le_lpm_set_mult:
522e 4734c02d bpatchx patch2d_1 ,mem_patch2d 
522f 7855fc00 disable wake 
5230 20375232 branch le_lpm_set_mult_attempt ,attempt 
5231 2436d23e nbranch le_lpm_lost ,match 

le_lpm_set_mult_attempt:
5232 20403c5d call lpm_match 
5233 6fe44161 fetch 2 ,mem_rx_window_sniff 
5234 67e404bb store 2 ,mem_le_receive_window 
5235 6fe20365 fetch 1 ,mem_le_rxbuf 
5236 2fe00601 compare 1 ,pdata ,3 
5237 2420bc70 nbranch lpm_mult_short ,true 
5238 6fe24409 fetch 1 ,mem_le_txheader 
5239 2fe00601 compare 1 ,pdata ,3 
523a 2420bc70 nbranch lpm_mult_short ,true 
523b 6fe204ad fetch 1 ,mem_le_state 
523c c282bc70 bbit1 lestate_update_param ,lpm_mult_short 
523d 20203c56 branch lpm_mult_wait_timeout 

le_lpm_lost:
523e 68444161 fetcht 2 ,mem_rx_window_sniff 
523f 18430400 rshift temp ,temp 
5240 6fe404bb fetch 2 ,mem_le_receive_window 
5241 9840fe00 iadd temp ,pdata 
5242 67e404bb store 2 ,mem_le_receive_window 
5243 20203c68 branch lpm_lost 

le_search_adtype:
5244 6fe20366 fetch 1 ,mem_le_rxbuf + 1 
5245 d8c0036d arg mem_le_rxbuf + 8 ,contr 
5246 98c0f200 iadd contr ,loopcnt 

le_search_adtype_loop:
5247 e8420006 ifetcht 1 ,contr 
5248 efe20006 ifetch 1 ,contr 
5249 9a267c00 isub rega ,null 
524a 20628000 rtn zero 
524b 1840ffff add temp ,-1 ,pdata 
524c 98c08c00 iadd contr ,contr 
524d 1f227e00 deposit loopcnt 
524e 98c67c00 isub contr ,null 
524f 20215247 branch le_search_adtype_loop ,positive 
5250 18007c01 force 1 ,null 
5251 20600000 rtn 

le_fifo_malloc_tx_l2cap_signaling:
5252 4735402d bpatchx patch2d_2 ,mem_patch2d 
5253 2040525a call le_l2cap_update_signaling_identifier 
5254 da400005 arg le_l2cap_cid_signal ,regb 
5255 20405260 call le_fifo_malloc_tx_l2cap 
5256 e3020005 istorer regd ,1 ,contw 
5257 6fe24555 fetch 1 ,mem_le_signaling_identifier 
5258 e7e20005 istore 1 ,contw 
5259 20600000 rtn 

le_l2cap_update_signaling_identifier:
525a 6fe24555 fetch 1 ,mem_le_signaling_identifier 
525b 1fe0fe01 pincrease 1 
525c 67e24555 store 1 ,mem_le_signaling_identifier 
525d c1800000 rtnne 0 

le_l2cap_reset_signaling_identifier:
525e 70455501 jam 1 ,mem_le_signaling_identifier 
525f 20600000 rtn 

le_fifo_malloc_tx_l2cap:
5260 4735c02d bpatchx patch2d_3 ,mem_patch2d 
5261 18000202 force llid_l2cap_start ,type 
5262 1a20a204 increase 4 ,rega 
5263 20405268 call le_fifo_malloc_tx 
5264 1a20a3fc increase -4 ,rega 
5265 e2240005 istorer rega ,2 ,contw 
5266 e2440005 istorer regb ,2 ,contw 
5267 20600000 rtn 

le_fifo_malloc_tx:
5268 4736402d bpatchx patch2d_4 ,mem_patch2d 
5269 1a267c76 sub rega ,118 ,null 
526a 24213b25 nbranch assert ,positive 
526b 6fe2452e fetch 1 ,mem_le_tx_buff_used 
526c d8400001 arg 1 ,temp 
526d df200004 arg le_tx_buff_count ,loopcnt 

le_fifo_malloc_tx_loop:
526e 98417c00 iand temp ,null 
526f 2022d273 branch le_fifo_malloc_tx_got_empty ,zero 
5270 18438400 lshift temp ,temp 
5271 c200526e loop le_fifo_malloc_tx_loop 
5272 20203b25 branch assert 

le_fifo_malloc_tx_got_empty:
5273 4736c02d bpatchx patch2d_5 ,mem_patch2d 
5274 9842fe00 ixor temp ,pdata 
5275 67e2452e store 1 ,mem_le_tx_buff_used 
5276 1f267e04 sub loopcnt ,le_tx_buff_count ,pdata 
5277 1fe9fe00 lshift3 pdata ,pdata 
5278 1ff27e00 lshift4 pdata ,pdata 
5279 d8401c00 arg mem_le_tx_buffer0 ,temp 
527a 98408400 iadd temp ,temp 

le_fifo_tx_find_empty_ptr:
527b df200000 arg 0 ,loopcnt 
527c d8c0452f arg mem_le_tx_ptr0 ,contr 

le_fifo_tx_find_empty_ptr_loop:
527d efe40006 ifetch 2 ,contr 
527e 203a5283 branch le_fifo_tx_found_empty_ptr ,blank 
527f 1f227e00 copy loopcnt ,pdata 
5280 1f20f201 increase 1 ,loopcnt 
5281 c082527d bne le_tx_buff_count ,le_fifo_tx_find_empty_ptr_loop 
5282 20203b25 branch assert 

le_fifo_tx_found_empty_ptr:
5283 4737402d bpatchx patch2d_6 ,mem_patch2d 
5284 18c08dfe increase -2 ,contr 
5285 e0440006 istoret 2 ,contr 
5286 18420a00 copy temp ,contw 
5287 e2220005 istorer rega ,1 ,contw 
5288 58000000 setarg 0 
5289 e7e20005 istore 1 ,contw 
528a e0220005 istorer type ,1 ,contw 
528b 20600000 rtn 

le_fifo_get_first_tx_ptr:
528c 4737c02d bpatchx patch2d_7 ,mem_patch2d 
528d 6fe4452f fetch 2 ,mem_le_tx_ptr0 
528e 1fe20c00 copy pdata ,contr 
528f 20600000 rtn 

le_fifo_get_second_tx_ptr:
5290 4738402e bpatchx patch2e_0 ,mem_patch2e 
5291 6fe44531 fetch 2 ,mem_le_tx_ptr1 
5292 1fe20c00 copy pdata ,contr 
5293 20600000 rtn 

le_fifo_get_last_tx_ptr:
5294 4738c02e bpatchx patch2e_1 ,mem_patch2e 
5295 20405298 call le_fifo_get_last_tx_ptr0 
5296 1fe20c00 copy pdata ,contr 
5297 20600000 rtn 

le_fifo_get_last_tx_ptr0:
5298 6fe44535 fetch 2 ,mem_le_tx_ptr3 
5299 247a0000 nrtn blank 
529a 6fe44533 fetch 2 ,mem_le_tx_ptr2 
529b 247a0000 nrtn blank 
529c 6fe44531 fetch 2 ,mem_le_tx_ptr1 
529d 247a0000 nrtn blank 
529e 6fe4452f fetch 2 ,mem_le_tx_ptr0 
529f 20600000 rtn 

le_fifo_get_first_l2cap_ptr:
52a0 2040528c call le_fifo_get_first_tx_ptr 
52a1 18c08c03 increase 3 ,contr 
52a2 20600000 rtn 

le_fifo_get_first_att_ptr:
52a3 2040528c call le_fifo_get_first_tx_ptr 
52a4 18c08c07 increase 7 ,contr 
52a5 20600000 rtn 

le_fifo_get_last_att_ptr:
52a6 4739402e bpatchx patch2e_2 ,mem_patch2e 
52a7 20405294 call le_fifo_get_last_tx_ptr 
52a8 18c08c07 increase 7 ,contr 
52a9 20600000 rtn 

le_fifo_get_last_l2cap_ptr:
52aa 4739c02e bpatchx patch2e_3 ,mem_patch2e 
52ab 20405294 call le_fifo_get_last_tx_ptr 
52ac 18c08c03 increase 3 ,contr 
52ad 20600000 rtn 

le_fifo_check_full:
52ae 6fe44535 fetch 2 ,mem_le_tx_ptr3 
52af 20600000 rtn 

le_fifo_check_empty:
52b0 6fe4452f fetch 2 ,mem_le_tx_ptr0 
52b1 20600000 rtn 

le_fifo_release_first_node:
52b2 473a402e bpatchx patch2e_4 ,mem_patch2e 
52b3 6fe4452f fetch 2 ,mem_le_tx_ptr0 
52b4 d8401c00 arg mem_le_tx_buffer0 ,temp 
52b5 98467e00 isub temp ,pdata 
52b6 1ff1fe00 rshift4 pdata ,pdata 
52b7 1fe90e00 rshift3 pdata ,queue 
52b8 6fe2452e fetch 1 ,mem_le_tx_buff_used 
52b9 f93ffe00 qset0 pdata 
52ba 67e2452e store 1 ,mem_le_tx_buff_used 
52bb df200000 arg 0 ,loopcnt 

le_fifo_release_first_node_loop:
52bc 1f23fe00 lshift loopcnt ,pdata 
52bd d8404531 arg mem_le_tx_ptr1 ,temp 
52be 98408400 iadd temp ,temp 
52bf efe40002 ifetch 2 ,temp 
52c0 184085fe increase -2 ,temp 
52c1 e7e40002 istore 2 ,temp 
52c2 1f227e00 copy loopcnt ,pdata 
52c3 1f20f201 increase 1 ,loopcnt 
52c4 c081d2bc bne le_tx_buff_update_loopcnt ,le_fifo_release_first_node_loop 
52c5 58000000 setarg 0 
52c6 e7e40002 istore 2 ,temp 
52c7 20600000 rtn 

le_parse_signaling:
52c8 efe20006 ifetch 1 ,contr 
52c9 20600000 rtn 

le_l2cap_tx_update_req:
52ca da20000c arg 0x0c ,rega 
52cb db000012 arg l2cap_connection_parameter_update_request ,regd 
52cc 20405252 call le_fifo_malloc_tx_l2cap_signaling 
52cd 58000008 setarg 0x08 
52ce e7e40005 istore 2 ,contw 
52cf eff00013 ifetch 8 ,regc 
52d0 e7f00005 istore 8 ,contw 
52d1 20600000 rtn 

le_pairing_mode_init:
52d2 473d402f bpatchx patch2f_2 ,mem_patch2f 
52d3 6fe24489 fetch 1 ,mem_le_pairing_mode 
52d4 c00052e2 beq le_pairing_mode_none ,le_set_no_pairing 
52d5 c000d2e5 beq le_pairing_mode_lagacy_justwork ,le_set_pairing_mode_lagacy_just_work 
52d6 c00152e7 beq le_pairing_mode_lagacy_passkey ,le_set_pairing_mode_lagacy_passkey 
52d7 c040d2db beq le_pairing_mode_secure_connect_justwork ,le_set_pairing_mode_secure_justwork 
52d8 c04152dd beq le_pairing_mode_secure_connect_numeric ,le_set_pairing_mode_secure_numeric 
52d9 c041d2e0 beq le_pairing_mode_secure_connect_passkey ,le_set_pairing_mode_secure_passkey 
52da 20600000 rtn 

le_set_pairing_mode_secure_justwork:
52db 7044830d jam flag_le_bonding_mitm_secure ,mem_le_pres_auth 
52dc 202052e3 branch le_set_noinputnooutput 

le_set_pairing_mode_secure_numeric:
52dd 7044830d jam flag_le_bonding_mitm_secure ,mem_le_pres_auth 
52de 70448101 jam flag_iocap_displayyesno ,mem_le_pres_iocap 
52df 20600000 rtn 

le_set_pairing_mode_secure_passkey:
52e0 7044830d jam flag_le_bonding_mitm_secure ,mem_le_pres_auth 
52e1 202052e8 branch le_set_displayonly 

le_set_no_pairing:
52e2 70448300 jam flag_le_no_bonding_no_mitm ,mem_le_pres_auth 

le_set_noinputnooutput:
52e3 70448103 jam flag_iocap_noinputnooutput ,mem_le_pres_iocap 
52e4 20600000 rtn 

le_set_pairing_mode_lagacy_just_work:
52e5 70448305 jam flag_le_bonding_mitm ,mem_le_pres_auth 
52e6 202052e3 branch le_set_noinputnooutput 

le_set_pairing_mode_lagacy_passkey:
52e7 70448305 jam flag_le_bonding_mitm ,mem_le_pres_auth 

le_set_displayonly:
52e8 70448100 jam flag_iocap_displayonly ,mem_le_pres_iocap 
52e9 20600000 rtn 

le_secure_connection_enable:
52ea 6fe24483 fetch 1 ,mem_le_pres_auth 
52eb 79207e03 set1 le_auth_secure_connection_pairing_bit ,pdata 
52ec 67e24483 store 1 ,mem_le_pres_auth 
52ed 20600000 rtn 

le_secure_connection_disable:
52ee 6fe24483 fetch 1 ,mem_le_pres_auth 
52ef 793ffe03 set0 le_auth_secure_connection_pairing_bit ,pdata 
52f0 67e24483 store 1 ,mem_le_pres_auth 
52f1 20600000 rtn 

le_parse_smp:
52f2 473dc02f bpatchx patch2f_3 ,mem_patch2f 
52f3 efe20006 ifetch 1 ,contr 
52f4 c000d309 beq smp_pairing_request ,le_parse_smp_pairing_request 
52f5 c001d33b beq smp_pairing_confirm ,le_parse_smp_pairing_confirm 
52f6 c002535a beq smp_pairing_random ,le_parse_smp_pairing_random 
52f7 c002d368 beq smp_pairing_failed ,le_parse_smp_pairing_failed 
52f8 c003538d beq smp_encryption_information ,le_parse_smp_encryption_information 
52f9 c003d3b6 beq smp_master_identification ,le_parse_smp_master_identification 
52fa c00453b6 beq smp_identity_information ,le_parse_smp_identity_information 
52fb c004d3b6 beq smp_identity_address_information ,le_parse_smp_identity_address_information 
52fc c00553b6 beq smp_signing_information ,le_parse_smp_signing_information 
52fd c005d3b6 beq smp_security_request ,le_parse_smp_security_request 
52fe c00653b7 beq smp_pairing_public_key ,le_parse_smp_public_key 
52ff c006d3bc beq smp_pairing_dhkey_check ,le_parse_smp_dhkey_check 
5300 20600000 rtn 

le_send_smp_security_request:
5301 18002202 force 2 ,rega 
5302 18002406 force le_l2cap_cid_smp ,regb 
5303 20405260 call le_fifo_malloc_tx_l2cap 
5304 5800000b setarg smp_security_request 
5305 e7e20005 istore 1 ,contw 
5306 6fe24483 fetch 1 ,mem_le_pres_auth 
5307 e7e20005 istore 1 ,contw 
5308 20600000 rtn 

le_parse_smp_pairing_request:
5309 67e24479 store 1 ,mem_le_preq 
530a efec0006 ifetch 6 ,contr 
530b e7ec0005 istore 6 ,contw 
530c 6fe24489 fetch 1 ,mem_le_pairing_mode 
530d c000536b beq le_pairing_mode_none ,le_smp_pairing_fail_reason_not_support_pairing 
530e 2040532b call le_send_smp_pairing_response 
530f 20405326 call le_check_master_support_secure_connect 
5310 70448703 jam flag_le_pairing_rcv_pairing_req ,mem_le_pairing_state 
5311 6fe2447a fetch 1 ,mem_le_preq_iocap 
5312 c0005318 beq flag_iocap_displayonly ,le_set_tk_0 
5313 c000d318 beq flag_iocap_displayyesno ,le_set_tk_0 
5314 c001d318 beq flag_iocap_noinputnooutput ,le_set_tk_0 
5315 6fe24489 fetch 1 ,mem_le_pairing_mode 
5316 c001531b beq le_pairing_mode_lagacy_passkey ,le_parse_smp_pairing_req_passkey 
5317 c1418000 rtneq le_pairing_mode_secure_connect_passkey 

le_set_tk_0:
5318 dfe00000 arg 0 ,pdata 
5319 67e8448a store 4 ,mem_le_tk 
531a 20600000 rtn 

le_parse_smp_pairing_req_passkey:
531b 6fe244a8 fetch 1 ,mem_le_fixed_passkey_flag 
531c 243a5324 nbranch le_parse_smp_pairing_req_fixed_passkey ,blank 

le_genernate_tk:
531d da20448a arg mem_le_tk ,rega 
531e 1a220a00 copy rega ,contw 
531f df200003 arg 3 ,loopcnt 
5320 20405b66 call generate_random_loop 
5321 6fe4448c fetch 2 ,mem_le_tk + 2 
5322 1fe17e07 and_into 0x7 ,pdata 
5323 67e4448c store 2 ,mem_le_tk + 2 

le_parse_smp_pairing_req_fixed_passkey:
5324 700b0834 jam bt_evt_le_tk_generate ,mem_fifo_temp 
5325 202071ee branch ui_ipc_send_event 

le_check_master_support_secure_connect:
5326 6fe2447c fetch 1 ,mem_le_preq_auth 
5327 c3818000 rtnbit1 le_auth_secure_connection_pairing_bit 
5328 6fe24489 fetch 1 ,mem_le_pairing_mode 
5329 c4038000 rtnbit0 le_pairing_mode_secure_connect_bit 
532a 20204246 branch app_ble_disconnect 

le_send_smp_pairing_response:
532b 68424485 fetcht 1 ,mem_le_pres_init_key_distribution 
532c 6fe2447e fetch 1 ,mem_le_preq_init_key_distribution 
532d 2feffe01 isolate1 le_initator_irk_bit ,pdata 
532e 79208401 setflag true ,le_initator_irk_bit ,temp 
532f 60424485 storet 1 ,mem_le_pres_init_key_distribution 
5330 68424486 fetcht 1 ,mem_le_pres_resp_key_distribution 
5331 79208401 setflag true ,le_initator_irk_bit ,temp 
5332 60424486 storet 1 ,mem_le_pres_resp_key_distribution 
5333 18002207 force 7 ,rega 
5334 18002406 force le_l2cap_cid_smp ,regb 
5335 20405260 call le_fifo_malloc_tx_l2cap 
5336 58000002 setarg smp_pairing_response 
5337 e7e20005 istore 1 ,contw 
5338 6fec4481 fetch 6 ,mem_le_pres_iocap 
5339 e7ec0005 istore 6 ,contw 
533a 20600000 rtn 

le_parse_smp_pairing_confirm:
533b 18c22200 copy contr ,rega 
533c 6fe24489 fetch 1 ,mem_le_pairing_mode 
533d c041d342 beq le_pairing_mode_secure_connect_passkey ,le_parse_smp_pairing_confirm_secure_passkey 
533e 1a220c00 copy rega ,contr 
533f d8a04457 arg mem_le_rconfirm ,contw 
5340 20407758 call memcpy16 
5341 20205348 branch le_send_smp_pairing_confirm 

le_parse_smp_pairing_confirm_secure_passkey:
5342 1a220c00 copy rega ,contr 
5343 d8a04457 arg mem_le_rconfirm ,contw 
5344 20407758 call memcpy16 
5345 7044aa02 jam le_sp_flag_commit_256 ,mem_le_secure_connect_flag 
5346 7044ac08 jam le_sc_stat_passkey_wait_confirm ,mem_le_secure_connect_state 
5347 20600000 rtn 

le_send_smp_pairing_confirm:
5348 6fe24489 fetch 1 ,mem_le_pairing_mode 
5349 c283d351 bbit1 le_pairing_mode_secure_connect_bit ,le_send_smp_pairing_confirm_sc 
534a 20406839 call generate_confirm 
534b 18002211 force 17 ,rega 
534c 18002406 force le_l2cap_cid_smp ,regb 
534d 20405260 call le_fifo_malloc_tx_l2cap 
534e 58000003 setarg smp_pairing_confirm 
534f e7e20005 istore 1 ,contw 
5350 20206932 branch store_aes_result 

le_send_smp_pairing_confirm_sc:
5351 d8a04467 arg mem_le_srand ,contw 
5352 20405b65 call generate_random 
5353 2040666e call function_f4_cb 
5354 18002211 force 17 ,rega 
5355 18002406 force le_l2cap_cid_smp ,regb 
5356 20405260 call le_fifo_malloc_tx_l2cap 
5357 58000003 setarg smp_pairing_confirm 
5358 e7e20005 istore 1 ,contw 
5359 202066a9 branch load_inverse_result 

le_parse_smp_pairing_random:
535a 18c22200 copy contr ,rega 
535b 6fe24489 fetch 1 ,mem_le_pairing_mode 
535c c283d36d bbit1 le_pairing_mode_secure_connect_bit ,le_parse_smp_pairing_random_sc 
535d 1a220c00 copy rega ,contr 
535e 20406831 call authenticate_rconfirm 
535f 2022d381 branch le_parse_smp_pairing_random_success ,zero 

le_send_pairing_confirm_value_failed:
5360 7004ea04 jam pairing_failed_confirm_value_failed ,mem_le_ll_pairing_fail_reason 

le_send_pairing_failed:
5361 18002202 force 2 ,rega 
5362 18002406 force le_l2cap_cid_smp ,regb 
5363 20405260 call le_fifo_malloc_tx_l2cap 
5364 58000005 setarg smp_pairing_failed 
5365 e7e20005 istore 1 ,contw 
5366 6fe204ea fetch 1 ,mem_le_ll_pairing_fail_reason 
5367 e7e20005 istore 1 ,contw 

le_parse_smp_pairing_failed:
5368 70448700 jam flag_le_pairing_null ,mem_le_pairing_state 
5369 700b0830 jam bt_evt_le_pairing_fail ,mem_fifo_temp 
536a 202071ee branch ui_ipc_send_event 

le_smp_pairing_fail_reason_not_support_pairing:
536b 7004ea05 jam pairing_failed_pairing_not_supported ,mem_le_ll_pairing_fail_reason 
536c 20205361 branch le_send_pairing_failed 

le_parse_smp_pairing_random_sc:
536d d8a0049d arg mem_le_mrand ,contw 
536e 1a220c00 copy rega ,contr 
536f 20407758 call memcpy16 
5370 6fe24489 fetch 1 ,mem_le_pairing_mode 
5371 c041d378 beq le_pairing_mode_secure_connect_passkey ,le_parse_smp_pairing_random_sc_passkey 
5372 204065f8 call function_g2 
5373 20405386 call le_send_smp_pairing_random 
5374 6fe24489 fetch 1 ,mem_le_pairing_mode 
5375 c1c10000 rtnne le_pairing_mode_secure_connect_numeric 
5376 700b083b jam bt_evt_le_gkey_generate ,mem_fifo_temp 
5377 202071ee branch ui_ipc_send_event 

le_parse_smp_pairing_random_sc_passkey:
5378 20406663 call function_f4_ca 
5379 d8a00b84 arg mem_aes_cmac_temp ,contw 
537a 204066a9 call load_inverse_result 
537b da200b84 arg mem_aes_cmac_temp ,rega 
537c da404457 arg mem_le_rconfirm ,regb 
537d df200010 arg 16 ,loopcnt 
537e 20407856 call string_compare 
537f 2422d360 nbranch le_send_pairing_confirm_value_failed ,zero 
5380 20205386 branch le_send_smp_pairing_random 

le_parse_smp_pairing_random_success:
5381 2040682e call generate_stk 
5382 700b0831 jam bt_evt_le_pairing_success ,mem_fifo_temp 
5383 204071ee call ui_ipc_send_event 
5384 70445601 jam 1 ,mem_ltk_exists 
5385 70448704 jam flag_le_pairing_after_auth ,mem_le_pairing_state 

le_send_smp_pairing_random:
5386 18002211 force 17 ,rega 
5387 18002406 force le_l2cap_cid_smp ,regb 
5388 20405260 call le_fifo_malloc_tx_l2cap 
5389 58000004 setarg smp_pairing_random 
538a e7e20005 istore 1 ,contw 
538b d8c04467 arg mem_le_srand ,contr 
538c 20207758 branch memcpy16 

le_parse_smp_encryption_information:
538d d8a0047d arg mem_le_peer_ltk ,contw 
538e 20207758 branch memcpy16 

le_send_smp_encryption_information:
538f 18002211 force 17 ,rega 
5390 18002406 force le_l2cap_cid_smp ,regb 
5391 20405260 call le_fifo_malloc_tx_l2cap 
5392 58000006 setarg smp_encryption_information 
5393 e7e20005 istore 1 ,contw 
5394 d8c04446 arg mem_le_ltk ,contr 
5395 20207758 branch memcpy16 

le_send_smp_master_identification:
5396 d8a0448e arg mem_le_ediv ,contw 
5397 1800720a force 10 ,loopcnt 
5398 20405b66 call generate_random_loop 
5399 1800220b force 11 ,rega 
539a 18002406 force le_l2cap_cid_smp ,regb 
539b 20405260 call le_fifo_malloc_tx_l2cap 
539c 58000007 setarg smp_master_identification 
539d e7e20005 istore 1 ,contw 
539e 6fe4448e fetch 2 ,mem_le_ediv 
539f e7e40005 istore 2 ,contw 
53a0 6ff04490 fetch 8 ,mem_le_rand 
53a1 e7f00005 istore 8 ,contw 
53a2 20600000 rtn 

le_send_smp_identity_information:
53a3 18002211 force 17 ,rega 
53a4 18002406 force le_l2cap_cid_smp ,regb 
53a5 20405260 call le_fifo_malloc_tx_l2cap 
53a6 58000008 setarg smp_identity_information 
53a7 e7e20005 istore 1 ,contw 
53a8 58000000 setarg 0 
53a9 e7f00005 istore 8 ,contw 
53aa e7f00005 istore 8 ,contw 
53ab 20600000 rtn 

le_send_smp_identity_address_information:
53ac 18002208 force 8 ,rega 
53ad 18002406 force le_l2cap_cid_smp ,regb 
53ae 20405260 call le_fifo_malloc_tx_l2cap 
53af 58000009 setarg smp_identity_address_information 
53b0 e7e20005 istore 1 ,contw 
53b1 6fe24500 fetch 1 ,mem_le_conn_own_addr_type 
53b2 e7e20005 istore 1 ,contw 
53b3 6fec450c fetch 6 ,mem_le_lap 
53b4 e7ec0005 istore 6 ,contw 
53b5 20600000 rtn 

le_parse_smp_master_identification:

le_parse_smp_identity_information:

le_parse_smp_identity_address_information:

le_parse_smp_signing_information:

le_parse_smp_security_request:
53b6 20600000 rtn 

le_parse_smp_public_key:
53b7 d8a00a2f arg mem_le_pubkey_remote_x_256 ,contw 
53b8 20407747 call memcpy64 
53b9 7044aa02 jam le_sp_flag_commit_256 ,mem_le_secure_connect_flag 
53ba 7044ac01 jam le_sc_stat_receive_public_key ,mem_le_secure_connect_state 
53bb 20600000 rtn 

le_parse_smp_dhkey_check:
53bc d8a00adf arg mem_sp_confirm_remote ,contw 
53bd 20407758 call memcpy16 
53be 7044ac06 jam le_sc_stat_receive_dhkey ,mem_le_secure_connect_state 
53bf 7044aa02 jam le_sp_flag_commit_256 ,mem_le_secure_connect_flag 
53c0 20600000 rtn 

le_send_smp_pairing_public_key:
53c1 18002241 force 65 ,rega 
53c2 18002406 force le_l2cap_cid_smp ,regb 
53c3 20405260 call le_fifo_malloc_tx_l2cap 
53c4 5800000c setarg smp_pairing_public_key 
53c5 e7e20005 istore 1 ,contw 
53c6 d8c04618 arg mem_le_pubkey_local_x_256 ,contr 
53c7 20207747 branch memcpy64 

le_send_smp_pairing_dhkey_check:
53c8 2040660f call function_f6_eb 
53c9 18002211 force 17 ,rega 
53ca 18002406 force le_l2cap_cid_smp ,regb 
53cb 20405260 call le_fifo_malloc_tx_l2cap 
53cc 5800000d setarg smp_pairing_dhkey_check 
53cd e7e20005 istore 1 ,contw 
53ce 202066a9 branch load_inverse_result 

le_pairing_sm:
53cf 473e402f bpatchx patch2f_4 ,mem_patch2f 
53d0 6fe24487 fetch 1 ,mem_le_pairing_state 
53d1 c000d3d7 beq flag_le_pairing_start ,le_pairing_sm_start 
53d2 c00253d9 beq flag_le_pairing_after_auth ,le_pairing_sm_after_auth 
53d3 c00353e0 beq flag_le_paring_send_enc_information ,le_pairng_sm_send_enc_information 
53d4 c003d3e2 beq flag_le_paring_send_master_identification ,le_pairng_sm_send_master_indentification 
53d5 c00453e7 beq flag_le_paring_send_indentity_information ,le_pairng_sm_send_indentity_information 
53d6 20600000 rtn 

le_pairing_sm_start:
53d7 70448702 jam flag_le_pairing_send_recurity_req ,mem_le_pairing_state 
53d8 20205301 branch le_send_smp_security_request 

le_pairing_sm_after_auth:
53d9 6fe24488 fetch 1 ,mem_le_enc_state 
53da c00253dc beq flag_le_send_start_enc_rsp ,le_pairing_sm_after_auth_start_enc 
53db 20600000 rtn 

le_pairing_sm_after_auth_start_enc:
53dc 70448706 jam flag_le_paring_send_enc_information ,mem_le_pairing_state 
53dd 700b0829 jam bt_evt_le_enc_info ,mem_fifo_temp 
53de 204071ee call ui_ipc_send_event 
53df 2020538f branch le_send_smp_encryption_information 

le_pairng_sm_send_enc_information:
53e0 70448707 jam flag_le_paring_send_master_identification ,mem_le_pairing_state 
53e1 20205396 branch le_send_smp_master_identification 

le_pairng_sm_send_master_indentification:
53e2 6fe2447e fetch 1 ,mem_le_preq_init_key_distribution 
53e3 2fec0001 isolate0 le_initator_irk_bit ,pdata 
53e4 2020d3e9 branch le_parse_start_enc_rsp_after_auth_end ,true 
53e5 70448708 jam flag_le_paring_send_indentity_information ,mem_le_pairing_state 
53e6 202053a3 branch le_send_smp_identity_information 

le_pairng_sm_send_indentity_information:
53e7 204053ac call le_send_smp_identity_address_information 
53e8 202053e9 branch le_parse_start_enc_rsp_after_auth_end 

le_parse_start_enc_rsp_after_auth_end:
53e9 704488ff jam flag_le_enc_end ,mem_le_enc_state 
53ea 704487ff jam flag_le_pairing_end ,mem_le_pairing_state 
53eb 20600000 rtn 

le_secure_connect_sm:
53ec 473ec02f bpatchx patch2f_5 ,mem_patch2f 
53ed 6fe24489 fetch 1 ,mem_le_pairing_mode 
53ee c4038000 rtnbit0 le_pairing_mode_secure_connect_bit 
53ef 6fe244aa fetch 1 ,mem_le_secure_connect_flag 
53f0 c1810000 rtnne le_sp_flag_commit_256 
53f1 7044aa00 jam sp_flag_standby ,mem_le_secure_connect_flag 
53f2 6fe244ac fetch 1 ,mem_le_secure_connect_state 
53f3 c000d42c beq le_sc_stat_receive_public_key ,le_sc_sm_receive_public_key 
53f4 c0015433 beq le_sc_stat_wait_send_public_key ,le_sc_sm_wait_send_public_key 
53f5 c001d426 beq le_sc_stat_send_public_key ,le_sc_sm_send_public_key 
53f6 c003540d beq le_sc_stat_receive_dhkey ,le_sc_sm_receive_dhkey 
53f7 c003d404 beq le_sc_stat_wait_confirm_gkey ,le_sc_sm_wait_confirm_gkey 
53f8 c00453fa beq le_sc_stat_passkey_wait_confirm ,le_sc_sm_passkey_wait_confirm 
53f9 20600000 rtn 

le_sc_sm_passkey_wait_confirm:
53fa 6fe246aa fetch 1 ,mem_authentication_passkey_times 
53fb 1fe20e00 copy pdata ,queue 
53fc 1fe0fe01 increase 1 ,pdata 
53fd 67e246aa store 1 ,mem_authentication_passkey_times 
53fe 6fe8448a fetch 4 ,mem_le_tk 
53ff afefffff qisolate1 pdata 
5400 58000080 setarg 0x80 
5401 7920fe00 setflag true ,0 ,pdata 
5402 67e246ab store 1 ,mem_passkey_1bit 
5403 20205429 branch le_sc_sm_ready_send_pairing_confirm 

le_sc_sm_wait_confirm_gkey:
5404 6fe244ad fetch 1 ,mem_le_sc_confirm_gkey_flag 
5405 7044ad00 jam flag_le_sc_confrim_null ,mem_le_sc_confirm_gkey_flag 
5406 c000d409 beq flag_le_sc_confrim_gkey_ok ,le_sc_confirm_gkey_ok 
5407 7044aa02 jam le_sp_flag_commit_256 ,mem_le_secure_connect_flag 
5408 20600000 rtn 

le_sc_confirm_gkey_ok:
5409 700b0831 jam bt_evt_le_pairing_success ,mem_fifo_temp 
540a 204071ee call ui_ipc_send_event 
540b 70448704 jam flag_le_pairing_after_auth ,mem_le_pairing_state 
540c 202053c8 branch le_send_smp_pairing_dhkey_check 

le_sc_sm_receive_dhkey:
540d 6fe20a2a fetch 1 ,mem_sp_dhkey_invalid 
540e c001d411 beq sp_key_valid_256 ,le_dhkey_ready 
540f 7044aa02 jam le_sp_flag_commit_256 ,mem_le_secure_connect_flag 
5410 20600000 rtn 

le_dhkey_ready:
5411 20406636 call function_f5 
5412 6fe24489 fetch 1 ,mem_le_pairing_mode 
5413 c041d415 beq le_pairing_mode_secure_connect_passkey ,le_dhkey_ready_common 
5414 20405318 call le_set_tk_0 

le_dhkey_ready_common:
5415 20406623 call function_f6_ea 
5416 da200b84 arg mem_aes_cmac_temp ,rega 
5417 da400adf arg mem_sp_confirm_remote ,regb 
5418 df200010 arg 16 ,loopcnt 
5419 20407856 call string_compare 
541a 2022d41d branch le_dhkey_check_ok ,zero 

le_dhkey_check_fail:
541b 7004ea0b jam pairing_failed_dhkey_check_failed ,mem_le_ll_pairing_fail_reason 
541c 20205361 branch le_send_pairing_failed 

le_dhkey_check_ok:
541d 20406a2f call sp_calc_check_publickey_256 
541e 2422d41b nbranch le_dhkey_check_fail ,zero 
541f 70445601 jam 1 ,mem_ltk_exists 
5420 6fe24489 fetch 1 ,mem_le_pairing_mode 
5421 c040d409 beq le_pairing_mode_secure_connect_justwork ,le_sc_confirm_gkey_ok 
5422 c041d409 beq le_pairing_mode_secure_connect_passkey ,le_sc_confirm_gkey_ok 
5423 7044aa02 jam le_sp_flag_commit_256 ,mem_le_secure_connect_flag 
5424 7044ac07 jam le_sc_stat_wait_confirm_gkey ,mem_le_secure_connect_state 
5425 20600000 rtn 

le_sc_sm_send_public_key:
5426 6fe24489 fetch 1 ,mem_le_pairing_mode 
5427 c041d42a beq le_pairing_mode_secure_connect_passkey ,le_sc_sm_send_public_key_passkey 
5428 7046ab00 jam 0 ,mem_passkey_1bit 

le_sc_sm_ready_send_pairing_confirm:
5429 20205348 branch le_send_smp_pairing_confirm 

le_sc_sm_send_public_key_passkey:
542a 7046aa00 jam 0 ,mem_authentication_passkey_times 
542b 2020531b branch le_parse_smp_pairing_req_passkey 

le_sc_sm_receive_public_key:
542c 7044aa02 jam le_sp_flag_commit_256 ,mem_le_secure_connect_flag 
542d 6fe244ae fetch 1 ,mem_le_sc_local_key_invalid 
542e c001d430 beq sp_key_valid_256 ,le_public_key_ready 
542f 20600000 rtn 

le_public_key_ready:
5430 7044ac02 jam le_sc_stat_wait_send_public_key ,mem_le_secure_connect_state 
5431 700a2a00 jam sp_key_invalid ,mem_sp_dhkey_invalid 
5432 20206f30 branch sp_dhkey_calc_256 

le_sc_sm_wait_send_public_key:
5433 7044aa02 jam le_sp_flag_commit_256 ,mem_le_secure_connect_flag 
5434 7044ac03 jam le_sc_stat_send_public_key ,mem_le_secure_connect_state 
5435 202053c1 branch le_send_smp_pairing_public_key 

init_lmp:
5436 20758000 rtn wake 

init_lmp_work:
5437 473f402f bpatchx patch2f_6 ,mem_patch2f 
5438 58000000 setarg 0 
5439 67e20048 store 1 ,mem_lmp_to_send 
543a 67e20055 store 1 ,mem_reconn_lmp_sm 
543b 67e20078 store 1 ,mem_lmo_opcode1 
543c 67e2007c store 1 ,mem_lmo_opcode2 
543d 67e20138 store 1 ,mem_connection_options 
543e 67e20a26 store 1 ,mem_pairing_auth 
543f 67e2430a store 1 ,mem_esco_amaddr 
5440 7045a200 jam switch_flag_init ,mem_switch_flag 
5441 70022500 jam 0 ,mem_switch_fail_master_count 
5442 70053b00 jam null_encryp ,mem_wait_encryption 

init_lmp_reinit:
5443 700a2600 jam 0 ,mem_pairing_auth 
5444 700a2500 jam 0 ,mem_sp_localsm 
5445 70053500 jam 0 ,mem_lmp_conn_state 
5446 6fe24132 fetch 1 ,mem_device_option 
5447 c1808000 rtnne dvc_op_hci ,pdata 
5448 70427000 jam 0 ,mem_link_key_exists 

parse_rx_done:
5449 20600000 rtn 

parse_lmp:
544a 473fc02f bpatchx patch2f_7 ,mem_patch2f 
544b 2054db58 call setlocalsm_master ,master 
544c 2454db5c ncall setlocalsm_slave ,master 
544d 6fe2007c fetch 1 ,mem_lmo_opcode2 
544e 245a5b1e ncall lmo_fifo_process ,blank 
544f 6fe2007c fetch 1 ,mem_lmo_opcode2 
5450 247a0000 nrtn blank 

parse_lmp_tws:
5451 6fe2004c fetch 1 ,mem_state_map 
5452 c4030000 rtnbit0 smap_rxlmp 
5453 793ffe06 set0 smap_rxlmp ,pdata 
5454 793f8001 set0 mark_rxbuf_inuse ,mark 
5455 67e2004c store 1 ,mem_state_map 
5456 6fe205c2 fetch 1 ,mem_rxbuf 
5457 6842004c fetcht 1 ,mem_state_map 
5458 2feffe00 isolate1 smap_lmptidinit ,pdata 
5459 79208401 setflag true ,smap_lmptid ,temp 
545a 6042004c storet 1 ,mem_state_map 
545b 18410402 and_into 0x2 ,temp 
545c 6042007f storet 1 ,mem_lmo_tid2 
545d 6842004c fetcht 1 ,mem_state_map 
545e 1fe37e00 rshift pdata ,pdata 
545f 67e2007d store 1 ,mem_lmi_opcode2 
5460 47404030 bpatchx patch30_0 ,mem_patch30 
5461 6fe2007d fetch 1 ,mem_lmi_opcode2 

parse_lmp0:
5462 c03fd4ff beq lmp_escape ,parse_lmp_escape 
5463 c001d553 beq lmp_accepted ,parse_lmp_accepted 
5464 c0025566 beq lmp_not_accepted ,parse_lmp_not_accepted 
5465 c01e54f2 beq lmp_set_afh ,parse_lmp_set_afh 
5466 c002d4ee beq lmp_clkoffset_req ,parse_lmp_clkoffset_req 
5467 c007d763 beq lmp_encryption_mode_req ,parse_lmp_encryption_mode_req 
5468 c00855e4 beq lmp_encryption_key_size_req ,parse_lmp_crypt_key 
5469 c011d600 beq lmp_auto_rate ,parse_lmp_auto_rate 
546a c01cd781 beq lmp_test_control ,parse_lmp_test_control 
546b c01c577c beq lmp_test_activate ,parse_lmp_test_activate 
546c c018d5e7 beq lmp_setup_complete ,parse_lmp_setup_complete 
546d c01bd66a beq lmp_supervision_timeout ,parse_lmp_supervision_timeout 
546e c013d666 beq lmp_features_req ,parse_lmp_features_req 
546f c019d663 beq lmp_host_connection_req ,parse_lmp_conn_req 
5470 c012d668 beq lmp_version_req ,parse_lmp_version_req 
5471 c01355fe beq lmp_version_res ,parse_lmp_version_res 
5472 c003d5f6 beq lmp_detach ,parse_lmp_detach 
5473 c016d5ed beq lmp_max_slot ,parse_lmp_max_slot 
5474 c01755ee beq lmp_max_slot_req ,parse_lmp_max_slot_req 
5475 c000d65f beq lmp_name_req ,parse_lmp_name_req 
5476 c001564a beq lmp_name_res ,parse_lmp_name_res 
5477 c014576e beq lmp_features_res ,parse_lmp_features_res 
5478 c004d640 beq lmp_comb_key ,parse_lmp_comb_key 
5479 c005d61a beq lmp_au_rand ,parse_lmp_au_rand 
547a c0045601 beq lmp_in_rand ,parse_lmp_in_rand 
547b c006562c beq lmp_sres ,parse_lmp_sres 
547c c00fd5fa beq lmp_incr_power_req ,parse_lmp_incr_power 
547d c01055fc beq lmp_decr_power_req ,parse_lmp_decr_power 
547e c010d685 beq lmp_max_power ,parse_lmp_max_power 
547f c0115686 beq lmp_min_power ,parse_lmp_min_power 
5480 c01ad687 beq lmp_page_mode_req ,parse_lmp_page_mode_req 
5481 c01b5688 beq lmp_page_scan_mode_req ,parse_lmp_page_scan_mode_req 
5482 c0125689 beq lmp_preferred_rate ,parse_lmp_preferred_rate 
5483 c01a568a beq lmp_slot_offset ,parse_lmp_slot_offset 
5484 c00bd68d beq lmp_sniff_req ,parse_lmp_sniff_req 
5485 c008d6a4 beq lmp_start_encryption_req ,parse_lmp_start_encryption_req 
5486 c00956a8 beq lmp_stop_encryption_req ,parse_lmp_stop_encryption_req 
5487 c009d6aa beq lmp_switch_req ,parse_lmp_switch_req 
5488 c006d6bf beq lmp_temp_rand ,parse_lmp_temp_rand 
5489 c00756c0 beq lmp_temp_key ,parse_lmp_temp_key 
548a c017d664 beq lmp_timing_accuracy_req ,parse_lmp_timing_accuracy_req 
548b c01856c1 beq lmp_timing_accuracy_res ,parse_lmp_timing_accuracy_res 
548c c00556c2 beq lmp_unit_key ,parse_lmp_unit_key 
548d c00c56c3 beq lmp_unsniff_req ,parse_lmp_unsniff_req 
548e c01956ca beq lmp_use_semi_permanent_key ,parse_lmp_use_semi_permanend_key 
548f c01ed6cb beq lmp_encapsulated_header ,parse_lmp_encapsulated_header 
5490 c01f570c beq lmp_encapsulated_payload ,parse_lmp_encapsulated_payload 
5491 c01fd706 beq lmp_simple_pairing_confirm ,parse_simple_pairing_confirm 
5492 c0205733 beq lmp_simple_pairing_number ,parse_lmp_simple_pairing_number 
5493 c020d745 beq lmp_dhkey_check ,parse_dhkey_check 
5494 c0035762 beq lmp_clkoffset_res ,parse_lmp_clkoffset_res 
5495 c01d54f0 beq lmp_enc_key_size_mask_req ,parse_enc_key_size_mask_req 
5496 c015d4c3 beq lmp_sco_link_req ,parse_lmp_sco_link_req 
5497 c01654e6 beq lmp_remove_sco_link_req ,parse_remove_sco_link 
5498 c01554ea beq lmp_quality_of_service_req ,parse_quality_of_server_req 
5499 c014d4ed beq lmp_quality_of_service ,parse_quality_of_server 

reject_unknown_packet:
549a 70007e19 jam unknown_lmp_pdu ,mem_lmo_reason2 

reject_lmp_packet:
549b 70007c04 jam lmp_not_accepted ,mem_lmo_opcode2 
549c 20600000 rtn 

parse_lmpext_remove_esco_req:
549d 204054d7 call lmp_exit_sco_sniff 
549e 70007c81 jam lmp_ext_accepted ,mem_lmo_opcode2 
549f 70007d8d jam lmp_ext_remove_esco_req ,mem_lmi_opcode2 
54a0 20600000 rtn 

parse_lmpext_esco_link_req_master:
54a1 70430801 jam 1 ,mem_neogotiation_state 
54a2 20204259 branch app_bt_esco_req 

parse_lmpext_esco_link_req:
54a3 2034d4a1 branch parse_lmpext_esco_link_req_master ,master 
54a4 6fe205c4 fetch 1 ,mem_rxbuf + 2 
54a5 67e242fa store 1 ,mem_sco_handle 
54a6 6fe205c5 fetch 1 ,mem_rxbuf + 3 
54a7 67e2430a store 1 ,mem_esco_amaddr 
54a8 6fe205c7 fetch 1 ,mem_rxbuf + 5 
54a9 1fe3fe00 lshift pdata ,pdata 
54aa 67e442fc store 2 ,mem_sco_dsniff 
54ab 6fe205c8 fetch 1 ,mem_rxbuf + 6 
54ac 1fe3fe00 lshift pdata ,pdata 
54ad 67e442fe store 2 ,mem_sco_tsniff 
54ae 6fe205c9 fetch 1 ,mem_rxbuf + 7 
54af 67e24300 store 1 ,mem_sco_wsniff 
54b0 6fe205ca fetch 1 ,mem_rxbuf + 8 
54b1 67e24301 store 1 ,mem_sco_tx_packet_type 
54b2 6fe205cb fetch 1 ,mem_rxbuf + 9 
54b3 67e24302 store 1 ,mem_sco_rx_packet_type 
54b4 6fe405cc fetch 2 ,mem_rxbuf + 10 
54b5 67e44305 store 2 ,mem_sco_tx_packet_len 
54b6 6fe405ce fetch 2 ,mem_rxbuf + 12 
54b7 67e44303 store 2 ,mem_sco_rx_packet_len 
54b8 6fe205d0 fetch 1 ,mem_rxbuf + 14 
54b9 67e24307 store 1 ,mem_air_mode 
54ba 6fe24302 fetch 1 ,mem_sco_rx_packet_type 
54bb c003d4c1 beq esco_type_ev3 ,lmpext_esco_accept_ev3 
54bc c01354c0 beq esco_type_2ev3 ,lmpext_esco_accept_2ev3 

lmpext_esco_reject:
54bd 70007c82 jam lmp_not_accepted_ext ,mem_lmo_opcode2 

lmpext_esco_link_req_end:
54be 70007d8c jam lmp_ext_esco_link_req ,mem_lmi_opcode2 
54bf 20600000 rtn 

lmpext_esco_accept_2ev3:
54c0 7920002a set1 mark_esco_edr_enable ,mark 

lmpext_esco_accept_ev3:
54c1 70007c81 jam lmp_ext_accepted ,mem_lmo_opcode2 
54c2 202054be branch lmpext_esco_link_req_end 

parse_lmp_sco_link_req:
54c3 2034c25d branch app_bt_sco_req ,master 
54c4 6fe205c3 fetch 1 ,mem_rxbuf + 1 
54c5 67e242fa store 1 ,mem_sco_handle 
54c6 6fe205c5 fetch 1 ,mem_rxbuf + 3 
54c7 1fe3fe00 lshift pdata ,pdata 
54c8 67e442fc store 2 ,mem_sco_dsniff 
54c9 6fe205c6 fetch 1 ,mem_rxbuf + 4 
54ca 1fe3fe00 lshift pdata ,pdata 
54cb 67e442fe store 2 ,mem_sco_tsniff 
54cc 6fe205c7 fetch 1 ,mem_rxbuf + 5 
54cd 67e24302 store 1 ,mem_sco_rx_packet_type 
54ce 67e24301 store 1 ,mem_sco_tx_packet_type 
54cf 6fe205c8 fetch 1 ,mem_rxbuf + 6 
54d0 67e24307 store 1 ,mem_air_mode 
54d1 5800001e setarg 30 
54d2 67e24303 store 1 ,mem_sco_rx_packet_len 
54d3 67e24305 store 1 ,mem_sco_tx_packet_len 
54d4 70007c03 jam lmp_accepted ,mem_lmo_opcode2 
54d5 70007d2b jam lmp_sco_link_req ,mem_lmi_opcode2 
54d6 20600000 rtn 

lmp_exit_sco_sniff:
54d7 20403d1d call load_context_to_acl 
54d8 793f802b set0 mark_sco_flag ,mark 
54d9 793f802a set0 mark_esco_edr_enable ,mark 
54da 793f8007 set0 mark_esco ,mark 
54db 793f802c set0 mark_enter_sco_sniff ,mark 
54dc 6fe20031 fetch 1 ,mem_mode 
54dd 793ffe07 set0 sco_in_sniff ,pdata 
54de 67e20031 store 1 ,mem_mode 
54df 20404473 call hfp_clear_sco_params 
54e0 70416f05 jam 5 ,mem_max_slot 
54e1 2040375a call sniff_exit 
54e2 204047af call hfp_voice_stop 
54e3 6fe20031 fetch 1 ,mem_mode 
54e4 c4030000 rtnbit0 acl_in_sniff 
54e5 20205882 branch lmp_enter_acl_sniff 

parse_remove_sco_link:
54e6 204054d7 call lmp_exit_sco_sniff 
54e7 70007d2c jam lmp_remove_sco_link_req ,mem_lmi_opcode2 
54e8 70007c03 jam lmp_accepted ,mem_lmo_opcode2 
54e9 20600000 rtn 

parse_quality_of_server_req:
54ea 70007d2a jam lmp_quality_of_service_req ,mem_lmi_opcode2 
54eb 70007c03 jam lmp_accepted ,mem_lmo_opcode2 
54ec 20600000 rtn 

parse_quality_of_server:
54ed 20600000 rtn 

parse_lmp_clkoffset_req:
54ee 70007c06 jam lmp_clkoffset_res ,mem_lmo_opcode2 
54ef 20600000 rtn 

parse_enc_key_size_mask_req:
54f0 70007c3b jam lmp_enc_key_size_mask_res ,mem_lmo_opcode2 
54f1 20600000 rtn 

parse_lmp_set_afh:
54f2 6fe805c3 fetch 4 ,mem_rxbuf + 1 
54f3 1fe3fe00 lshift pdata ,pdata 
54f4 67e84171 store 4 ,mem_afh_instant 
54f5 6fe205c7 fetch 1 ,mem_rxbuf + 5 
54f6 67e24178 store 1 ,mem_afh_new_mod 
54f7 6fea05c8 fetch 5 ,mem_rxbuf + 6 
54f8 67ea4186 store 5 ,mem_afh_map_new 
54f9 6fea05cd fetch 5 ,mem_rxbuf + 11 
54fa e7ea0005 istore 5 ,contw 
54fb 6fe20031 fetch 1 ,mem_mode 
54fc 79207e03 set1 afh_change ,pdata 
54fd 67e20031 store 1 ,mem_mode 
54fe 20600000 rtn 

parse_lmp_escape:
54ff 4740c030 bpatchx patch30_1 ,mem_patch30 
5500 6fe205c3 fetch 1 ,mem_rxbuf + 1 
5501 79207e07 set1 7 ,pdata 
5502 67e2007d store 1 ,mem_lmi_opcode2 
5503 c040d528 beq lmp_ext_accepted ,parse_lmpext_accepted 
5504 c0415530 beq lmp_not_accepted_ext ,parse_lmpext_not_accepted 
5505 c04ad66b beq lmp_sniff_subrating_req ,parse_lmp_sniff_subrating_req 
5506 c04b5684 beq lmp_sniff_subrating_res ,parse_lmp_sniff_subrating_res 
5507 c045d679 beq lmp_packet_type_table_req ,parse_lmpext_packet_type_table_req 
5508 c041d547 beq lmp_ext_features_req ,parse_lmpext_features_req 
5509 c0425549 beq lmp_ext_features_res ,parse_lmpext_features_res 
550a c0485515 beq lmp_ext_chn_classification_req ,parse_lmpext_chn_classification_req 
550b c04bd540 beq lmp_pause_encryption_req ,parse_lmpext_pause_encrypt 
550c c04c5545 beq lmp_resume_encryption_req ,parse_lmpext_resume_encrypt 
550d c04cd518 beq lmp_io_cap_req ,parse_lmpext_iocap_req 
550e c04d551d beq lmp_io_cap_res ,parse_lmpext_iocap_res 
550f c046d49d beq lmp_ext_remove_esco_req ,parse_lmpext_remove_esco_req 
5510 c04654a3 beq lmp_ext_esco_link_req ,parse_lmpext_esco_link_req 
5511 c1420000 rtneq lmp_ext_features_res 

reject_unknown_ext_packet:
5512 70007c82 jam lmp_not_accepted_ext ,mem_lmo_opcode2 
5513 70007e19 jam unknown_lmp_pdu ,mem_lmo_reason2 
5514 20600000 rtn 

parse_lmpext_chn_classification_req:
5515 70007c82 jam lmp_not_accepted_ext ,mem_lmo_opcode2 
5516 70007e2e jam not_support_chn_classification ,mem_lmo_reason2 
5517 20600000 rtn 

parse_lmpext_iocap_req:
5518 20405521 call iocap_lmpext_load 
5519 6fe24132 fetch 1 ,mem_device_option 
551a c000d525 beq dvc_op_hci ,iocap_lmpext_hci 
551b 70007c9a jam lmp_io_cap_res ,mem_lmo_opcode2 
551c 20600000 rtn 

parse_lmpext_iocap_res:
551d 20405521 call iocap_lmpext_load 
551e 6fe24132 fetch 1 ,mem_device_option 
551f c000d525 beq dvc_op_hci ,iocap_lmpext_hci 
5520 20205525 branch iocap_lmpext_common 

iocap_lmpext_load:
5521 d8a046a6 arg mem_sp_iocap_remote ,contw 
5522 6fe605c4 fetch 3 ,mem_rxbuf + 2 
5523 e7e60005 istore 3 ,contw 
5524 20600000 rtn 

iocap_lmpext_hci:

iocap_lmpext_common:
5525 20405b55 call check_localsm 
5526 2020eb6f branch master_set_mem_master_sp_flag ,true 
5527 20600000 rtn 

parse_lmpext_accepted:
5528 6fe205c5 fetch 1 ,mem_rxbuf + 3 
5529 79207e07 set1 7 ,pdata 
552a 67e2052d store 1 ,mem_lmi_accepted_opcode 
552b c045d536 beq lmp_packet_type_table_req ,parse_lmpext_accepted_ptt 
552c c0465576 beq lmp_ext_esco_link_req ,parse_lmpext_accepted_esco_link 
552d c046d52f beq lmp_ext_remove_esco_req ,parse_lmpext_remove_esco_link 
552e 20600000 rtn 

parse_lmp_accept_remove_sco_link:

parse_lmpext_remove_esco_link:
552f 202054d7 branch lmp_exit_sco_sniff 

parse_lmpext_not_accepted:
5530 6fe205c5 fetch 1 ,mem_rxbuf + 3 
5531 79207e07 set1 7 ,pdata 
5532 67e2052d store 1 ,mem_lmi_accepted_opcode 
5533 c045d53a beq lmp_packet_type_table_req ,parse_lmpext_not_accepted_ptt 
5534 c0464473 beq lmp_ext_esco_link_req ,hfp_clear_sco_params 
5535 20600000 rtn 

parse_lmpext_accepted_ptt:
5536 6fe241f8 fetch 1 ,mem_ptt 
5537 6842004c fetcht 1 ,mem_state_map 
5538 7d3a0405 nsetflag blank ,smap_edr ,temp 
5539 6042004c storet 1 ,mem_state_map 

parse_lmpext_not_accepted_ptt:
553a 6fe20030 fetch 1 ,mem_state 
553b c4028000 rtnbit0 state_init_seq 
553c 793ffe05 set0 state_init_seq ,pdata 
553d 67e20030 store 1 ,mem_state 
553e 70007c31 jam lmp_setup_complete ,mem_lmo_opcode2 
553f 20600000 rtn 

parse_lmpext_pause_encrypt:
5540 2434d543 nbranch parse_lmpext_pause_encrypt_slave ,master 
5541 70007c12 jam lmp_stop_encryption_req ,mem_lmo_opcode2 
5542 20205b44 branch tid_reply 

parse_lmpext_pause_encrypt_slave:
5543 70007c97 jam lmp_pause_encryption_req ,mem_lmo_opcode2 
5544 20600000 rtn 

parse_lmpext_resume_encrypt:
5545 20405b44 call tid_reply 
5546 202057e7 branch lmp_start_encryption 

parse_lmpext_features_req:
5547 70007c84 jam lmp_ext_features_res ,mem_lmo_opcode2 
5548 20600000 rtn 

parse_lmpext_features_res:
5549 684205c6 fetcht 1 ,mem_rxbuf + 4 
554a 18410401 and temp ,0x1 ,temp 
554b 60420534 storet 1 ,mem_remote_sppcap 
554c 6fe24284 fetch 1 ,mem_hci_cmd 
554d c0a8d54f bne hci_cmd_wait_remote_ext_feature ,parse_lmpext_features_res_not_hci 
554e 70428400 jam 0 ,mem_hci_cmd 

parse_lmpext_features_res_not_hci:
554f 6fe20055 fetch 1 ,mem_reconn_lmp_sm 
5550 c1820000 rtnne conn_sm_wait_features_ext 
5551 70005505 jam conn_sm_send_conn_req ,mem_reconn_lmp_sm 
5552 20205b74 branch process_conn_sm 

parse_lmp_accepted:
5553 47414030 bpatchx patch30_2 ,mem_patch30 
5554 6fe205c3 fetch 1 ,mem_rxbuf + 1 
5555 67e2052d store 1 ,mem_lmi_accepted_opcode 
5556 c019d598 beq lmp_host_connection_req ,parse_lmp_accepted_hostconn 
5557 c00455a7 beq lmp_in_rand ,parse_lmp_accepted_inrand 
5558 c007d5ae beq lmp_encryption_mode_req ,parse_lmp_accepted_enc_mode 
5559 c00855b4 beq lmp_encryption_key_size_req ,parse_lmp_accepted_enc_keysize 
555a c008d5b5 beq lmp_start_encryption_req ,parse_lmp_accepted_start_enc 
555b c00955bc beq lmp_stop_encryption_req ,parse_lmp_accepted_stop_enc 
555c c00c55e1 beq lmp_unsniff_req ,parse_lmp_accepted_unsniff_req 
555d c00bd5e2 beq lmp_sniff_req ,parse_lmp_accepted_sniff_req 
555e c009d595 beq lmp_switch_req ,parse_lmp_accepted_switch 
555f c015d57a beq lmp_sco_link_req ,parse_lmp_accepted_sco_link 
5560 c016552f beq lmp_remove_sco_link_req ,parse_lmp_accept_remove_sco_link 
5561 c01ed6d9 beq lmp_encapsulated_header ,parse_lmp_accepted_encapsulated_header 
5562 c01f5725 beq lmp_encapsulated_payload ,parse_lmp_accepted_encapsulated_payload 
5563 c02056db beq lmp_simple_pairing_number ,parse_lmp_accepted_simple_pairing_number 
5564 c020d6f8 beq lmp_dhkey_check ,parse_lmp_accepted_dhkey_check 
5565 20600000 rtn 

parse_lmp_not_accepted:
5566 4741c030 bpatchx patch30_3 ,mem_patch30 
5567 6fe205c3 fetch 1 ,mem_rxbuf + 1 
5568 67e2052d store 1 ,mem_lmi_accepted_opcode 
5569 c000d5d9 beq lmp_name_req ,parse_lmp_not_accepted_name_req 
556a c019d5a1 beq lmp_host_connection_req ,parse_lmp_not_accepted_hostconn 
556b c005d5bd beq lmp_au_rand ,parse_lmp_not_accepted_aurand 
556c c00455d0 beq lmp_in_rand ,parse_lmp_not_accepted_inrand 
556d c009d596 beq lmp_switch_req ,parse_lmp_not_accepted_switch 
556e c015d574 beq lmp_sco_link_req ,parse_lmp_not_accepted_sco_link_req 
556f c02055da beq lmp_simple_pairing_number ,parse_lmp_not_accepted_simple_pairing_number 
5570 c020d5dd beq lmp_dhkey_check ,parse_lmp_not_accepted_dhkey_check 
5571 c00c55e0 beq lmp_unsniff_req ,parse_lmp_not_accepted_unsniff_req 
5572 c00bd5e3 beq lmp_sniff_req ,parse_lmp_not_acdcept_sniff_req 
5573 20600000 rtn 

parse_lmp_not_accepted_sco_link_req:
5574 70007c2b jam lmp_sco_link_req ,mem_lmo_opcode2 
5575 20600000 rtn 

parse_lmpext_accepted_esco_link:
5576 6fe24302 fetch 1 ,mem_sco_rx_packet_type 
5577 c003d579 beq esco_type_ev3 ,send_lmpext_accept_esco_link 
5578 7920002a set1 mark_esco_edr_enable ,mark 

send_lmpext_accept_esco_link:
5579 79200007 set1 mark_esco ,mark 

send_lmp_accepted_sco_link:

parse_lmp_accepted_sco_link:
557a 70416f01 jam 1 ,mem_max_slot 

lmp_enter_sco_sniff:
557b 6fe20031 fetch 1 ,mem_mode 
557c 79207e07 set1 sco_in_sniff ,pdata 
557d 67e20031 store 1 ,mem_mode 
557e c3035580 bbit0 acl_in_sniff ,lmp_enter_sco_sniff0 
557f 2040375a call sniff_exit 

lmp_enter_sco_sniff0:
5580 7920002b set1 mark_sco_flag ,mark 
5581 6fe242fe fetch 1 ,mem_sco_tsniff 
5582 67e40032 store 2 ,mem_tsniff 
5583 6fe242fc fetch 1 ,mem_sco_dsniff 
5584 67e40075 store 2 ,mem_dsniff 
5585 6fe242fe fetch 1 ,mem_sco_tsniff 
5586 1feb7e00 rshift2 pdata ,pdata 
5587 c001d589 beq 3 ,lmp_enter_sco_sniff_end 
5588 1fe0ffff increase -1 ,pdata 

lmp_enter_sco_sniff_end:
5589 67e20073 store 1 ,mem_sniff_attempt 
558a 67e20092 store 1 ,mem_current_sniff_attempt 
558b 68424300 fetcht 1 ,mem_sco_wsniff 
558c 18430400 rshift temp ,temp 
558d 98460400 isub temp ,temp 
558e 60424310 storet 1 ,mem_esco_attempt 
558f 70007400 jam 0 ,mem_sniff_timeout 
5590 20403733 call sniff_init 
5591 70430b50 jam 0x50 ,mem_esco_arq 
5592 70430f06 jam param_sco_poll ,mem_sco_poll 
5593 2040479f call hfp_voice_start 
5594 20600000 rtn 

parse_lmp_accepted_switch:
5595 20203203 branch role_switch_prepare0 

parse_lmp_not_accepted_switch:
5596 7045a202 jam switch_flag_not_accept ,mem_switch_flag 
5597 20600000 rtn 

parse_lmp_accepted_hostconn:
5598 6fe20535 fetch 1 ,mem_lmp_conn_state 
5599 79207e00 set1 received_conn_req ,pdata 
559a 67e20535 store 1 ,mem_lmp_conn_state 
559b 700b0801 jam bt_evt_bb_connected ,mem_fifo_temp 
559c 204071ee call ui_ipc_send_event 
559d 700b0803 jam bt_evt_reconn_started ,mem_fifo_temp 
559e 204071ee call ui_ipc_send_event 
559f 70007c8b jam lmp_packet_type_table_req ,mem_lmo_opcode2 
55a0 20600000 rtn 

parse_lmp_not_accepted_hostconn:
55a1 70052e0b jam acl_connection_already_exists ,mem_disconn_reason_send 
55a2 70007c07 jam lmp_detach ,mem_lmo_opcode2 
55a3 18000410 force hci_error_host_timeout ,temp 
55a4 70005500 jam conn_sm_standby ,mem_reconn_lmp_sm 
55a5 2020d449 branch parse_rx_done ,true 
55a6 20600000 rtn 

parse_lmp_accepted_inrand:
55a7 6fe24270 fetch 1 ,mem_link_key_exists 
55a8 247a0000 nrtn blank 
55a9 20403499 call clear_linkkey 
55aa 204057e5 call lmp_generate_key 
55ab 20748000 rtn master 
55ac 79200021 set1 mark_slave_in_rand_accepted ,mark 
55ad 20600000 rtn 

parse_lmp_accepted_enc_mode:
55ae 24748000 nrtn master 
55af 70007c10 jam lmp_encryption_key_size_req ,mem_lmo_opcode2 
55b0 6fe2004c fetch 1 ,mem_state_map 
55b1 c4010000 rtnbit0 smap_encryption 
55b2 70007c12 jam lmp_stop_encryption_req ,mem_lmo_opcode2 
55b3 20600000 rtn 

parse_lmp_accepted_enc_keysize:
55b4 202057e7 branch lmp_start_encryption 

parse_lmp_accepted_start_enc:
55b5 6fe20030 fetch 1 ,mem_state 
55b6 c3820000 rtnbit1 state_conn_comp 
55b7 70007c31 jam lmp_setup_complete ,mem_lmo_opcode2 
55b8 6fe20055 fetch 1 ,mem_reconn_lmp_sm 
55b9 c1858000 rtnne conn_sm_encrypt_wait 
55ba 7000550c jam conn_sm_encrypt_wait_clear ,mem_reconn_lmp_sm 
55bb 20600000 rtn 

parse_lmp_accepted_stop_enc:
55bc 20600000 rtn 

parse_lmp_not_accepted_aurand:
55bd 6fe24132 fetch 1 ,mem_device_option 
55be c080d5cd bne dvc_op_hci ,parse_lmp_not_accepted_aurand_send_detach 
55bf 6fe24270 fetch 1 ,mem_link_key_exists 
55c0 207a0000 rtn blank 
55c1 68420055 fetcht 1 ,mem_reconn_lmp_sm 
55c2 70005500 jam 0 ,mem_reconn_lmp_sm 
55c3 70427000 jam 0 ,mem_link_key_exists 
55c4 6fe205c4 fetch 1 ,mem_rxbuf + 2 
55c5 c1830000 rtnne key_missing 
55c6 60420055 storet 1 ,mem_reconn_lmp_sm 
55c7 700a2501 jam local_statemachine ,mem_sp_localsm 
55c8 6fe40532 fetch 2 ,mem_lmpext_ssp_enable 
55c9 68420534 fetcht 1 ,mem_remote_sppcap 
55ca 98417e00 iand temp ,pdata 
55cb 203a4382 branch cmd_pair ,blank 
55cc 2020437f branch cmd_ssp 

parse_lmp_not_accepted_aurand_send_detach:
55cd 70007c07 jam lmp_detach ,mem_lmo_opcode2 
55ce 70052e13 jam other_end_terminated ,mem_disconn_reason_send 
55cf 20600000 rtn 

parse_lmp_not_accepted_inrand:
55d0 6fe205c4 fetch 1 ,mem_rxbuf + 2 
55d1 c00355d6 beq key_missing ,parse_lmp_inrand_key_missing 
55d2 c18c0000 rtnne pairing_not_allowed 
55d3 70052e18 jam pairing_not_allowed ,mem_disconn_reason_send 
55d4 70007c07 jam lmp_detach ,mem_lmo_opcode2 
55d5 20600000 rtn 

parse_lmp_inrand_key_missing:
55d6 70052e06 jam key_missing ,mem_disconn_reason_send 
55d7 70007c07 jam lmp_detach ,mem_lmo_opcode2 
55d8 20600000 rtn 

parse_lmp_not_accepted_name_req:
55d9 20600000 rtn 

parse_lmp_not_accepted_simple_pairing_number:
55da 700a1f00 jam sp_stat_null ,mem_sp_state 
55db 70007c07 jam lmp_detach ,mem_lmo_opcode2 
55dc 20205449 branch parse_rx_done 

parse_lmp_not_accepted_dhkey_check:
55dd 700a1f00 jam sp_stat_null ,mem_sp_state 
55de 70007c07 jam lmp_detach ,mem_lmo_opcode2 
55df 20205449 branch parse_rx_done 

parse_lmp_not_accepted_unsniff_req:
55e0 20600000 rtn 

parse_lmp_accepted_unsniff_req:
55e1 202056c5 branch lmp_exit_acl_sniff 

parse_lmp_accepted_sniff_req:
55e2 20205882 branch lmp_enter_acl_sniff 

parse_lmp_not_acdcept_sniff_req:
55e3 20600000 rtn 

parse_lmp_crypt_key:
55e4 684205c3 fetcht 1 ,mem_rxbuf + 1 
55e5 60420054 storet 1 ,mem_key_size 
55e6 202055f8 branch accept_lmp_msg 

parse_lmp_setup_complete:
55e7 6fe20535 fetch 1 ,mem_lmp_conn_state 
55e8 79207e02 set1 received_setup_complete ,pdata 
55e9 67e20535 store 1 ,mem_lmp_conn_state 
55ea c3818000 rtnbit1 sent_setup_complete 
55eb 70007c31 jam lmp_setup_complete ,mem_lmo_opcode2 
55ec 20205449 branch parse_rx_done 

parse_lmp_max_slot:
55ed 20600000 rtn 

parse_lmp_max_slot_req:
55ee 6fe2416f fetch 1 ,mem_max_slot 
55ef 684205c3 fetcht 1 ,mem_rxbuf + 1 
55f0 98467c00 isub temp ,null 
55f1 202155f8 branch accept_lmp_msg ,positive 
55f2 70007c04 jam lmp_not_accepted ,mem_lmo_opcode2 
55f3 70007e1f jam unspecified_error ,mem_lmo_reason2 
55f4 70007d2e jam lmp_max_slot_req ,mem_lmi_opcode2 
55f5 20600000 rtn 

parse_lmp_detach:
55f6 204059a2 call prepare_disconnect 
55f7 202055f8 branch accept_lmp_msg 

accept_lmp_msg:
55f8 70007c03 jam lmp_accepted ,mem_lmo_opcode2 
55f9 20600000 rtn 

parse_lmp_incr_power:
55fa 70007c21 jam lmp_max_power ,mem_lmo_opcode2 
55fb 20600000 rtn 

parse_lmp_decr_power:
55fc 70007c22 jam lmp_min_power ,mem_lmo_opcode2 
55fd 20600000 rtn 

parse_lmp_version_res:
55fe 70005501 jam conn_sm_send_features ,mem_reconn_lmp_sm 
55ff 20600000 rtn 

parse_lmp_auto_rate:
5600 20600000 rtn 

parse_lmp_in_rand:
5601 204057e2 call lmp_copy_rand 
5602 70053801 jam pincode_state_wait_pincode ,mem_pincode_state 
5603 6fe24132 fetch 1 ,mem_device_option 
5604 c000d607 beq dvc_op_hci ,parse_lmp_in_rand_hci 
5605 700b080a jam bt_evt_pincode_req ,mem_fifo_temp 
5606 204071ee call ui_ipc_send_event 

parse_lmp_in_rand_hci:
5607 20405b4c call tid_check 
5608 2420d7ea nbranch lmp_accept_inrand ,true 
5609 2434d60e nbranch parse_lmp_inrand_res ,master 
560a 70007c04 jam lmp_not_accepted ,mem_lmo_opcode2 
560b 70007d08 jam lmp_in_rand ,mem_lmi_opcode2 
560c 70007e23 jam transaction_collision ,mem_lmo_reason2 
560d 20600000 rtn 

parse_lmp_inrand_res:
560e 6fe2004b fetch 1 ,mem_op 
560f 79207e02 set1 op_inrand_req ,pdata 
5610 67e2004b store 1 ,mem_op 
5611 20600000 rtn 

pop_tid_follow:
5612 6842004c fetcht 1 ,mem_state_map 
5613 7d3a0401 nsetflag blank ,smap_lmptid ,temp 
5614 6042004c storet 1 ,mem_state_map 
5615 20600000 rtn 

push_tid_follow:
5616 6fe2007f fetch 1 ,mem_lmo_tid2 
5617 1fe37e00 rshift pdata ,pdata 
5618 1fe17e01 and_into 1 ,pdata 
5619 20600000 rtn 

parse_lmp_au_rand:
561a 6fe20a26 fetch 1 ,mem_pairing_auth 
561b 205a796b call nv_load_device_list ,blank 
561c 20405616 call push_tid_follow 
561d 67e20539 store 1 ,mem_sres_tid 
561e 204057e2 call lmp_copy_rand 
561f 70007c0c jam lmp_sres ,mem_lmo_opcode2 
5620 6fe24270 fetch 1 ,mem_link_key_exists 
5621 247a0000 nrtn blank 
5622 6fe20030 fetch 1 ,mem_state 
5623 c3830000 rtnbit1 state_combkey 
5624 70007e06 jam key_missing ,mem_lmo_reason2 
5625 6fe24132 fetch 1 ,mem_device_option 
5626 c080d49b bne dvc_op_hci ,reject_lmp_packet 
5627 70007c00 jam 0 ,mem_lmo_opcode2 

parse_lmp_inrand_sres:
5628 6fe2004b fetch 1 ,mem_op 
5629 79207e00 set1 op_send_sres ,pdata 
562a 67e2004b store 1 ,mem_op 
562b 20600000 rtn 

parse_lmp_sres:
562c da200040 arg mem_plap ,rega 
562d 2040672f call function_e1 
562e 6fe805c3 fetch 4 ,mem_rxbuf + 1 
562f 68480603 fetcht 4 ,mem_input_store 
5630 98467c00 isub temp ,null 
5631 2022d635 branch authentication_ok ,zero 
5632 70007c07 jam lmp_detach ,mem_lmo_opcode2 
5633 70052e05 jam authentication_failure_error ,mem_disconn_reason_send 
5634 20600000 rtn 

authentication_ok:
5635 20405639 call authentication_ok_common 
5636 6fe246a0 fetch 1 ,mem_ssp_enable 
5637 203a56f9 branch pairing_success ,blank 
5638 20600000 rtn 

authentication_ok_common:
5639 20406824 call copy_aco 
563a 204031da call linkkey_ready 
563b 6fe2004b fetch 1 ,mem_op 
563c 2feffe01 isolate1 op_auth_req ,pdata 
563d 793ffe01 set0 op_auth_req ,pdata 
563e 67e2004b store 1 ,mem_op 
563f 20600000 rtn 

parse_lmp_comb_key:
5640 da2005c3 arg mem_rxbuf + 1 ,rega 
5641 da4005f3 arg mem_kinit ,regb 
5642 d8a005d3 arg mem_random_number ,contw 
5643 204067f0 call xor16 
5644 da200040 arg mem_plap ,rega 
5645 20405b6a call generate_linkkey 
5646 70007c0b jam lmp_au_rand ,mem_lmo_opcode2 
5647 6fe20030 fetch 1 ,mem_state 
5648 c30357e5 bbit0 state_combkey ,lmp_generate_key 
5649 20600000 rtn 

parse_lmp_name_res:
564a 6fe4012a fetch 2 ,mem_len 
564b 1fe0f3fd add pdata ,-3 ,loopcnt 
564c 684205c3 fetcht 1 ,mem_rxbuf + 1 
564d 580000c4 setarg mem_tmp_buffer 
564e 98408a00 iadd temp ,contw 
564f d8c005c5 arg mem_rxbuf + 3 ,contr 
5650 2040779f call memcpy 
5651 68420053 fetcht 1 ,mem_name_offset 
5652 6fe205c4 fetch 1 ,mem_rxbuf + 2 
5653 98467e00 isub temp ,pdata 
5654 1fe67c0e sub pdata ,14 ,null 
5655 2021565a branch parse_lmp_name_res_end ,positive 
5656 1840fe0e add temp ,14 ,pdata 
5657 67e20053 store 1 ,mem_name_offset 
5658 70007c01 jam lmp_name_req ,mem_lmo_opcode2 
5659 20600000 rtn 

parse_lmp_name_res_end:
565a 6fe2004c fetch 1 ,mem_state_map 
565b 79207e03 set1 smap_name_res ,pdata 
565c 67e2004c store 1 ,mem_state_map 
565d c28257ef bbit1 smap_name_req ,lmp_disconnect 
565e 20600000 rtn 

parse_lmp_name_req:
565f 6fe205c3 fetch 1 ,mem_rxbuf + 1 
5660 67e2007d store 1 ,mem_lmi_opcode2 
5661 70007c02 jam lmp_name_res ,mem_lmo_opcode2 
5662 20600000 rtn 

parse_lmp_conn_req:
5663 202055f8 branch accept_lmp_msg 

parse_lmp_timing_accuracy_req:
5664 70007c30 jam lmp_timing_accuracy_res ,mem_lmo_opcode2 
5665 20600000 rtn 

parse_lmp_features_req:
5666 70007c28 jam lmp_features_res ,mem_lmo_opcode2 
5667 20600000 rtn 

parse_lmp_version_req:
5668 70007c26 jam lmp_version_res ,mem_lmo_opcode2 
5669 20600000 rtn 

parse_lmp_supervision_timeout:
566a 20600000 rtn 

parse_lmp_sniff_subrating_req:
566b 6fe40032 fetch 2 ,mem_tsniff 
566c 98000400 iforce temp 
566d 6fe205c4 fetch 1 ,mem_rxbuf + 2 
566e 67e2009f store 1 ,mem_subsniff_rate 
566f 984f8400 imul32 temp ,temp 
5670 6fe405c5 fetch 2 ,mem_rxbuf + 3 
5671 1fe3fe00 lshift pdata ,pdata 
5672 67e400a0 store 2 ,mem_subsniff_tcmax 
5673 6fe805c7 fetch 4 ,mem_rxbuf + 5 
5674 1fe3fe00 lshift pdata ,pdata 
5675 67e8009b store 4 ,mem_subsniff_instant 
5676 18427e00 deposit temp 
5677 67e400a2 store 2 ,mem_subsniff_tsniff 
5678 20600000 rtn 

parse_lmpext_packet_type_table_req:
5679 684241f8 fetcht 1 ,mem_ptt 
567a 6fe205c4 fetch 1 ,mem_rxbuf + 2 
567b 9842fc00 ixor temp ,null 
567c 2422d512 nbranch reject_unknown_ext_packet ,zero 
567d 2feffe00 isolate1 0 ,pdata 
567e 6fe2004c fetch 1 ,mem_state_map 
567f 7920fe05 setflag true ,smap_edr ,pdata 
5680 67e2004c store 1 ,mem_state_map 
5681 70007c81 jam lmp_ext_accepted ,mem_lmo_opcode2 
5682 70007d8b jam lmp_packet_type_table_req ,mem_lmi_opcode2 
5683 20600000 rtn 

parse_lmp_sniff_subrating_res:
5684 20600000 rtn 

parse_lmp_max_power:
5685 20600000 rtn 

parse_lmp_min_power:
5686 20600000 rtn 

parse_lmp_page_mode_req:
5687 202055f8 branch accept_lmp_msg 

parse_lmp_page_scan_mode_req:
5688 202055f8 branch accept_lmp_msg 

parse_lmp_preferred_rate:
5689 20600000 rtn 

parse_lmp_slot_offset:
568a 6fe405c3 fetch 2 ,mem_rxbuf + 1 
568b 67e4013c store 2 ,mem_slot_offset 
568c 20600000 rtn 

parse_lmp_sniff_req:
568d 6fe20031 fetch 1 ,mem_mode 
568e c28356a2 bbit1 acl_in_sniff ,lmp_reject_sniff 
568f c595d691 bmark0 mark_sco_flag ,parse_lmp_sniff_request 
5690 202056a2 branch lmp_reject_sniff 

parse_lmp_sniff_request:
5691 6fe405c4 fetch 2 ,mem_rxbuf + 2 
5692 1fe3fe00 lshift pdata ,pdata 
5693 67e401e3 store 2 ,mem_acl_dsniff 
5694 6fe405c6 fetch 2 ,mem_rxbuf + 4 
5695 1fe3fe00 lshift pdata ,pdata 
5696 67e401e5 store 2 ,mem_acl_tsniff 
5697 6fe405c8 fetch 2 ,mem_rxbuf + 6 
5698 67e201e7 store 1 ,mem_acl_attempt 
5699 98000400 iforce temp 
569a 6fe405ca fetch 2 ,mem_rxbuf + 8 
569b 67e201e8 store 1 ,mem_acl_timeout 
569c 98467c00 isub temp ,null 
569d 2421569f nbranch set_big_value_to_attempt ,positive 
569e 67e201e7 store 1 ,mem_acl_attempt 

set_big_value_to_attempt:
569f 70007c03 jam lmp_accepted ,mem_lmo_opcode2 
56a0 70007d17 jam lmp_sniff_req ,mem_lmi_opcode2 
56a1 20600000 rtn 

lmp_reject_sniff:
56a2 70007e24 jam pdu_not_allowed ,mem_lmo_reason2 
56a3 2020549b branch reject_lmp_packet 

parse_lmp_start_encryption_req:
56a4 204055f8 call accept_lmp_msg 
56a5 204057e2 call lmp_copy_rand 
56a6 20406732 call function_e3 
56a7 20203725 branch start_encryption 

parse_lmp_stop_encryption_req:
56a8 204055f8 call accept_lmp_msg 
56a9 2020372d branch stop_encryption 

parse_lmp_switch_req:
56aa 202056b2 branch parse_lmp_switch_req_not_accept 
56ab 6fe245a3 fetch 1 ,mem_role_switch_flag 
56ac 243a56b2 nbranch parse_lmp_switch_req_not_accept ,blank 
56ad 6fe805c3 fetch 4 ,mem_rxbuf + 1 
56ae 1fe3fe00 lshift pdata ,pdata 
56af 2034d6b9 branch parse_lmp_switch_accept ,master 
56b0 68424270 fetcht 1 ,mem_link_key_exists 
56b1 243a56b6 nbranch parse_lmp_switch_req_clear_mark ,blank 

parse_lmp_switch_req_not_accept:
56b2 70007c04 jam lmp_not_accepted ,mem_lmo_opcode2 
56b3 70007d13 jam lmp_switch_req ,mem_lmi_opcode2 
56b4 70007e24 jam pdu_not_allowed ,mem_lmo_reason2 
56b5 20600000 rtn 

parse_lmp_switch_req_clear_mark:
56b6 70007c34 jam lmp_slot_offset ,mem_lmo_opcode2 
56b7 70005500 jam 0 ,mem_reconn_lmp_sm 
56b8 20203200 branch role_switch_prepare 

parse_lmp_switch_accept:
56b9 20403200 call role_switch_prepare 
56ba 79200022 set1 mark_reconn_recieve_switch ,mark 
56bb 6fe20138 fetch 1 ,mem_connection_options 
56bc 793ffe02 set0 connection_switch ,pdata 
56bd 67e20138 store 1 ,mem_connection_options 
56be 202055f8 branch accept_lmp_msg 

parse_lmp_temp_rand:
56bf 20600000 rtn 

parse_lmp_temp_key:
56c0 20600000 rtn 

parse_lmp_timing_accuracy_res:
56c1 20600000 rtn 

parse_lmp_unit_key:
56c2 20600000 rtn 

parse_lmp_unsniff_req:
56c3 70007c03 jam lmp_accepted ,mem_lmo_opcode2 
56c4 70007d18 jam lmp_unsniff_req ,mem_lmi_opcode2 

lmp_exit_acl_sniff:
56c5 6fe20031 fetch 1 ,mem_mode 
56c6 793ffe06 set0 acl_in_sniff ,pdata 
56c7 67e20031 store 1 ,mem_mode 
56c8 c6158000 rtnmark1 mark_sco_flag 
56c9 2020375a branch sniff_exit 

parse_lmp_use_semi_permanend_key:
56ca 20600000 rtn 

parse_lmp_encapsulated_header:
56cb 6fe205c3 fetch 1 ,mem_rxbuf + 1 
56cc c080d6d7 bne encapsulated_major_type_p192 ,parse_lmp_encapsulated_header_reject 
56cd 6fe205c4 fetch 1 ,mem_rxbuf + 2 
56ce c080d6d7 bne encapsulated_minor_type_p192 ,parse_lmp_encapsulated_header_reject 
56cf 6fe205c5 fetch 1 ,mem_rxbuf + 3 
56d0 c09856d7 bne encapsulated_len_p192 ,parse_lmp_encapsulated_header_reject 
56d1 20405b55 call check_localsm 
56d2 2020d6d4 branch parse_lmp_encapsulated_header_master ,true 
56d3 700a1f01 jam sp_stat_key_recv ,mem_sp_state 

parse_lmp_encapsulated_header_master:
56d4 70007c03 jam lmp_accepted ,mem_lmo_opcode2 
56d5 70007d3d jam lmp_encapsulated_header ,mem_lmi_opcode2 
56d6 20205449 branch parse_rx_done 

parse_lmp_encapsulated_header_reject:
56d7 70007e24 jam pdu_not_allowed ,mem_lmo_reason2 
56d8 2020549b branch reject_lmp_packet 

parse_lmp_accepted_encapsulated_header:
56d9 70007c3e jam lmp_encapsulated_payload ,mem_lmo_opcode2 
56da 20600000 rtn 

parse_lmp_accepted_simple_pairing_number:
56db 6fe246a4 fetch 1 ,mem_ssp_mode_flag 
56dc c000d6e2 beq ssp_mode_ssp_pin_flag ,parse_lmp_accepted_simple_pairing_number_ssp_pin 
56dd c00156e6 beq ssp_mode_passkey_entry_flag ,parse_lmp_accepted_simple_pairing_number_passkey 

parse_lmp_accepted_simple_pairing_number_common:
56de 20405b55 call check_localsm 
56df 20608000 rtn true 
56e0 700a1f08 jam sp_stat_confirm_recv ,mem_sp_state 
56e1 20600000 rtn 

parse_lmp_accepted_simple_pairing_number_ssp_pin:
56e2 20406df9 call g_noninit_number_confirm 
56e3 700b0835 jam bt_evt_bt_gkey_generate ,mem_fifo_temp 
56e4 204071ee call ui_ipc_send_event 
56e5 202056de branch parse_lmp_accepted_simple_pairing_number_common 

parse_lmp_accepted_simple_pairing_number_passkey:
56e6 20405b55 call check_localsm 
56e7 20608000 rtn true 
56e8 6fe246aa fetch 1 ,mem_authentication_passkey_times 
56e9 c009d6f6 beq 19 ,authentication_passkey_end 
56ea 1fe0fe01 increase 1 ,pdata 
56eb 67e246aa store 1 ,mem_authentication_passkey_times 

authentication_passkey:
56ec 700a2101 jam sp_flag_commit ,mem_sp_flag 
56ed 700a1f04 jam sp_stat_commit_calc ,mem_sp_state 
56ee 6fe246aa fetch 1 ,mem_authentication_passkey_times 
56ef 1fe20e00 copy pdata ,queue 
56f0 6fec46cc fetch 6 ,mem_pin 
56f1 afefffff qisolate1 pdata 
56f2 58000080 setarg 0x80 
56f3 7920fe00 setflag true ,0 ,pdata 
56f4 67e246ab store 1 ,mem_passkey_1bit 
56f5 20600000 rtn 

authentication_passkey_end:
56f6 700a1f08 jam sp_stat_confirm_recv ,mem_sp_state 
56f7 20600000 rtn 

parse_lmp_accepted_dhkey_check:
56f8 204056fe call parse_lmp_accepted_dhkey_check_common 

pairing_success:
56f9 6fe246ac fetch 1 ,mem_flag_pairing_state 
56fa 207a0000 rtn blank 
56fb 7046ac00 jam flag_pairing_state_not_pairing ,mem_flag_pairing_state 
56fc 700b0838 jam bt_evt_bt_pairing_success ,mem_fifo_temp 
56fd 202071ee branch ui_ipc_send_event 

parse_lmp_accepted_dhkey_check_common:
56fe 20405b55 call check_localsm 
56ff 2440edfc ncall g_noninit ,true 
5700 2040ee0c call g_init ,true 
5701 20405b55 call check_localsm 
5702 20608000 rtn true 
5703 700a1f0c jam sp_stat_link_key_calc ,mem_sp_state 
5704 700a2101 jam sp_flag_commit ,mem_sp_flag 
5705 20600000 rtn 

parse_simple_pairing_confirm:
5706 d8a00adf arg mem_sp_confirm_remote ,contw 
5707 d8c005c3 arg mem_rxbuf + 1 ,contr 
5708 20407758 call memcpy16 
5709 6fe246a4 fetch 1 ,mem_ssp_mode_flag 
570a c1010000 rtneq ssp_mode_passkey_entry_flag 
570b 20206b6f branch master_set_mem_master_sp_flag 

parse_lmp_encapsulated_payload:
570c 6fe20a20 fetch 1 ,mem_master_sp_state 
570d c003d710 beq sp_stat_random_send ,parse_encapsulated_payload_master 
570e 6fe20a1f fetch 1 ,mem_sp_state 
570f c080d723 bne sp_stat_key_recv ,parse_lmp_encapsulated_payload_reject 

parse_encapsulated_payload_master:
5710 6fe20a28 fetch 1 ,mem_sp_remote_key_recv_count 
5711 1fe60a20 sub pdata ,0x20 ,contw 
5712 24215723 nbranch parse_lmp_encapsulated_payload_reject ,positive 
5713 d8a00a37 arg mem_sp_pubkey_remote ,contw 
5714 98a08a00 iadd contw ,contw 
5715 6ff005c3 fetch 8 ,mem_rxbuf + 1 
5716 e7f00005 istore 8 ,contw 
5717 6ff005cb fetch 8 ,mem_rxbuf + 9 
5718 e7f00005 istore 8 ,contw 
5719 6fe20a28 fetch 1 ,mem_sp_remote_key_recv_count 
571a 1fe0fe10 increase 16 ,pdata 
571b 67e20a28 store 1 ,mem_sp_remote_key_recv_count 
571c c09855f8 bne encapsulated_len_p192 ,accept_lmp_msg 

parse_lmp_encapsulated_payload_completed:
571d 20405b55 call check_localsm 
571e 2020d5f8 branch accept_lmp_msg ,true 
571f 700a2901 jam sp_key_valid ,mem_sp_remote_key_invalid 
5720 700a1f02 jam sp_stat_key_generate ,mem_sp_state 
5721 700a2101 jam sp_flag_commit ,mem_sp_flag 
5722 202055f8 branch accept_lmp_msg 

parse_lmp_encapsulated_payload_reject:
5723 70007e24 jam pdu_not_allowed ,mem_lmo_reason2 
5724 2020549b branch reject_lmp_packet 

parse_lmp_accepted_encapsulated_payload:
5725 6fe20a27 fetch 1 ,mem_sp_local_key_send_count 
5726 c0185729 beq encapsulated_len_p192 ,parse_lmp_encapsulated_payload_all_accepted 
5727 70007c3e jam lmp_encapsulated_payload ,mem_lmo_opcode2 
5728 20205449 branch parse_rx_done 

parse_lmp_encapsulated_payload_all_accepted:
5729 20405b55 call check_localsm 
572a 2020d732 branch parse_lmp_encapsulated_payload_all_accepted_master ,true 
572b 6fe246a4 fetch 1 ,mem_ssp_mode_flag 
572c c0015730 beq ssp_mode_passkey_entry_flag ,parse_lmp_encapsulated_payload_all_accepted_get_passkey 
572d 700a2101 jam sp_flag_commit ,mem_sp_flag 
572e 700a1f04 jam sp_stat_commit_calc ,mem_sp_state 
572f 20205449 branch parse_rx_done 

parse_lmp_encapsulated_payload_all_accepted_get_passkey:
5730 700b0836 jam bt_evt_bt_get_passkey ,mem_fifo_temp 
5731 202071ee branch ui_ipc_send_event 

parse_lmp_encapsulated_payload_all_accepted_master:
5732 20205449 branch parse_rx_done 

parse_lmp_simple_pairing_number:
5733 6fe20a20 fetch 1 ,mem_master_sp_state 
5734 c003d737 beq sp_stat_random_send ,parse_lmp_simple_pairing_number_master 
5735 6fe20a1f fetch 1 ,mem_sp_state 
5736 c0835743 bne sp_stat_random_recv ,parse_lmp_simple_pairing_number_reject 

parse_lmp_simple_pairing_number_master:
5737 d8a00a9f arg mem_sp_random_remote ,contw 
5738 6ff005c3 fetch 8 ,mem_rxbuf + 1 
5739 e7f00005 istore 8 ,contw 
573a 6ff005cb fetch 8 ,mem_rxbuf + 9 
573b e7f00005 istore 8 ,contw 
573c 20405b55 call check_localsm 
573d 2020d741 branch parse_lmp_simple_pairing_number_master0 ,true 
573e 700a1f07 jam sp_stat_random_send ,mem_sp_state 
573f 700a2101 jam sp_flag_commit ,mem_sp_flag 
5740 202055f8 branch accept_lmp_msg 

parse_lmp_simple_pairing_number_master0:
5741 700a2004 jam sp_stat_commit_calc ,mem_master_sp_state 
5742 20206b6f branch master_set_mem_master_sp_flag 

parse_lmp_simple_pairing_number_reject:
5743 70007e24 jam pdu_not_allowed ,mem_lmo_reason2 
5744 2020549b branch reject_lmp_packet 

parse_dhkey_check:
5745 6fe20a20 fetch 1 ,mem_master_sp_state 
5746 c005d749 beq sp_stat_confirm_send ,parse_dhkey_check_master 
5747 6fe20a1f fetch 1 ,mem_sp_state 
5748 c0845758 bne sp_stat_confirm_recv ,parse_lmp_dhkey_check_reject 

parse_dhkey_check_master:
5749 d8a00acf arg mem_sp_check_result ,contw 
574a d8c005c3 arg mem_rxbuf + 1 ,contr 
574b 20407758 call memcpy16 
574c 20405b55 call check_localsm 
574d 2020d755 branch parse_dhkey_check_master0 ,true 
574e 6fe246a4 fetch 1 ,mem_ssp_mode_flag 
574f c000d75a beq ssp_mode_ssp_pin_flag ,number_comparison_mode 

number_comparison_successed:
5750 7046a900 jam 0 ,mem_flag_mode_ssp_pin 
5751 700a1f09 jam sp_stat_confirm_check ,mem_sp_state 
5752 700a2101 jam sp_flag_commit ,mem_sp_flag 
5753 70007d41 jam lmp_dhkey_check ,mem_lmi_opcode2 
5754 20205449 branch parse_rx_done 

parse_dhkey_check_master0:
5755 700a2009 jam sp_stat_confirm_check ,mem_master_sp_state 
5756 700a2201 jam sp_flag_commit ,mem_master_sp_flag 
5757 20205449 branch parse_rx_done 

parse_lmp_dhkey_check_reject:
5758 70007e24 jam pdu_not_allowed ,mem_lmo_reason2 
5759 2020549b branch reject_lmp_packet 

number_comparison_mode:
575a 6fe246a9 fetch 1 ,mem_flag_mode_ssp_pin 
575b c283d75f bbit1 flag_mode_ssp_pin_reviceve_comparison_bit ,comparison_result 
575c 79207e06 set1 flag_mode_ssp_pin_recieve_dhkey_bit ,pdata 
575d 67e246a9 store 1 ,mem_flag_mode_ssp_pin 
575e 20600000 rtn 

comparison_result:
575f c2805750 bbit1 flag_mode_ssp_pin_comparison_result_bit ,number_comparison_successed 
5760 7046a900 jam 0 ,mem_flag_mode_ssp_pin 
5761 20205758 branch parse_lmp_dhkey_check_reject 

parse_lmp_clkoffset_res:
5762 20205449 branch parse_rx_done 

parse_lmp_encryption_mode_req:
5763 6fe20138 fetch 1 ,mem_connection_options 
5764 793ffe01 set0 connection_encrypt ,pdata 
5765 67e20138 store 1 ,mem_connection_options 
5766 204055f8 call accept_lmp_msg 
5767 24748000 nrtn master 
5768 6fe205c3 fetch 1 ,mem_rxbuf + 1 
5769 6842004b fetcht 1 ,mem_op 
576a 793a0404 setflag blank ,op_stop_enc ,temp 
576b 7d3a0405 nsetflag blank ,op_start_enc ,temp 
576c 6042004b storet 1 ,mem_op 
576d 20600000 rtn 

parse_lmp_features_res:
576e 685005c3 fetcht 8 ,mem_rxbuf + 1 
576f 6fe24284 fetch 1 ,mem_hci_cmd 
5770 c0a85772 bne hci_cmd_wait_remote_feature ,parse_lmp_features_res_not_hci 
5771 70428400 jam 0 ,mem_hci_cmd 

parse_lmp_features_res_not_hci:
5772 6fe20055 fetch 1 ,mem_reconn_lmp_sm 
5773 c1810000 rtnne conn_sm_wait_features_res 
5774 6fe24132 fetch 1 ,mem_device_option 
5775 c000d778 beq dvc_op_hci ,parse_lmp_feature_ext_sm 
5776 6fe20138 fetch 1 ,mem_connection_options 
5777 c302577a bbit0 connection_feature_ext ,parse_lmp_send_conn 

parse_lmp_feature_ext_sm:
5778 70005503 jam conn_sm_send_features_ext ,mem_reconn_lmp_sm 
5779 20600000 rtn 

parse_lmp_send_conn:
577a 70005505 jam conn_sm_send_conn_req ,mem_reconn_lmp_sm 
577b 20600000 rtn 

parse_lmp_test_activate:
577c 6fe2014a fetch 1 ,mem_debug_config 
577d 67e2011e store 1 ,mem_test_mode_old_debug_config 
577e 70007c03 jam lmp_accepted ,mem_lmo_opcode2 
577f 70007d38 jam lmp_test_activate ,mem_lmi_opcode2 
5780 20600000 rtn 

parse_lmp_test_control:
5781 70007c03 jam lmp_accepted ,mem_lmo_opcode2 
5782 70007d39 jam lmp_test_control ,mem_lmi_opcode2 
5783 18007209 force 9 ,loopcnt 
5784 d8c005c3 arg mem_rxbuf + 1 ,contr 
5785 d8a00115 arg mem_temp_payload ,contw 

parse_lmp_test_xor:
5786 efe20006 ifetch 1 ,contr 
5787 1fe2fe55 xor_into 0x55 ,pdata 
5788 e7e20005 istore 1 ,contw 
5789 c2005786 loop parse_lmp_test_xor 
578a 6fe20115 fetch 1 ,test_mode_scenario 
578b 68420114 fetcht 1 ,mem_tester_emulate 
578c 793f8407 set0 tester_no_whitening ,temp 
578d 793f8404 set0 tester_pattern_test ,temp 
578e c07fd79a beq exit_test_mode ,parse_lmp_test_control_exit 
578f c00057b3 beq pause_test_mode ,parse_lmp_test_control_pause 
5790 c002d7a7 beq closed_loop_back_acl ,parse_lmp_test_control_loopback 
5791 c003d7a6 beq acl_without_whitening ,parse_lmp_test_control_loopback_nowhite 
5792 c00357a7 beq closed_loop_back_sco ,parse_lmp_test_control_loopback 
5793 c00457a6 beq sco_without_whitening ,parse_lmp_test_control_loopback_nowhite 
5794 c000d79f beq zero_pattern ,parse_lmp_test_control_pattern 
5795 c001579f beq one_pattern ,parse_lmp_test_control_pattern 
5796 c001d79f beq alt_pattern ,parse_lmp_test_control_pattern 
5797 c004d79f beq alt2_pattern ,parse_lmp_test_control_pattern 
5798 c002579f beq pseudorandom ,parse_lmp_test_control_pattern 
5799 20600000 rtn 

parse_lmp_test_control_exit:
579a 6fe20114 fetch 1 ,mem_tester_emulate 
579b 79207e03 set1 tester_exit ,pdata 
579c 79207e02 set1 tester_change ,pdata 
579d 67e20114 store 1 ,mem_tester_emulate 
579e 20600000 rtn 

parse_lmp_test_control_pattern:
579f 79200404 set1 tester_pattern_test ,temp 
57a0 70014b05 jam 5 ,mem_lch_code 
57a1 6fe4011c fetch 2 ,test_mode_data_length 
57a2 98007200 iforce loopcnt 
57a3 67e4012a store 2 ,mem_len 
57a4 d8a005c2 arg mem_rxbuf ,contw 
57a5 20407809 call pn9 

parse_lmp_test_control_loopback_nowhite:
57a6 79200407 set1 tester_no_whitening ,temp 

parse_lmp_test_control_loopback:
57a7 79200402 set1 tester_change ,temp 
57a8 18007e00 force 0 ,pdata 
57a9 67e2000b store 1 ,mem_slave_rcvcnt 
57aa 67e400bd store 2 ,mem_tst_pktcnt_crc 
57ab 67e400bf store 2 ,mem_tst_pktcnt_dmh 
57ac 67e400bb store 2 ,mem_tst_pktcnt_hec 
57ad 67e400b9 store 2 ,mem_tst_pktcnt_sync 
57ae 6fe20116 fetch 1 ,test_mode_hopping_mode 
57af 2fe1fe00 compare fixed_freq ,pdata ,0xff 
57b0 79208406 setflag true ,tester_fixed_freq ,temp 
57b1 60420114 storet 1 ,mem_tester_emulate 
57b2 20600000 rtn 

parse_lmp_test_control_pause:
57b3 793f8011 set0 mark_testmode ,mark 
57b4 70011400 jam 0 ,mem_tester_emulate 
57b5 6fe2014a fetch 1 ,mem_debug_config 
57b6 793ffe06 set0 debug_tx_pattern ,pdata 
57b7 67e2014a store 1 ,mem_debug_config 
57b8 20600000 rtn 

check_test_cond:
57b9 6fe20114 fetch 1 ,mem_tester_emulate 
57ba c4010000 rtnbit0 tester_change 
57bb 6fe2011f fetch 1 ,mem_tester_cnt 
57bc 1fe0fe01 increase 1 ,pdata 
57bd 67e2011f store 1 ,mem_tester_cnt 
57be c1828000 rtnne 5 
57bf 70011f00 jam 0 ,mem_tester_cnt 
57c0 6fe20114 fetch 1 ,mem_tester_emulate 
57c1 793ffe02 set0 tester_change ,pdata 
57c2 67e20114 store 1 ,mem_tester_emulate 
57c3 c281d7da bbit1 tester_exit ,check_test_exit 
57c4 2feffe07 isolate1 tester_no_whitening ,pdata 
57c5 2040f8b5 call test_no_white ,true 
57c6 2440f8b9 ncall test_enable_white ,true 
57c7 6fe2011b fetch 1 ,test_mode_packet_type 
57c8 2fe06020 compare 0x20 ,pdata ,0x30 
57c9 6fe2004c fetch 1 ,mem_state_map 
57ca 7920fe05 setflag true ,smap_edr ,pdata 
57cb 67e2004c store 1 ,mem_state_map 
57cc 6fe20114 fetch 1 ,mem_tester_emulate 
57cd 6842014a fetcht 1 ,mem_debug_config 
57ce 2feffe04 isolate1 tester_pattern_test ,pdata 
57cf 79208406 setflag true ,debug_tx_pattern ,temp 
57d0 2feffe06 isolate1 tester_fixed_freq ,pdata 
57d1 79208404 setflag true ,debug_tx_fixed_freq ,temp 
57d2 79208405 setflag true ,debug_rx_fixed_freq ,temp 
57d3 6042014a storet 1 ,mem_debug_config 
57d4 6fe20117 fetch 1 ,test_mode_tx_freq 
57d5 67e2052f store 1 ,mem_tx_fixed_freq 
57d6 6fe20118 fetch 1 ,test_mode_rx_freq 
57d7 67e20530 store 1 ,mem_rx_fixed_freq 
57d8 79200011 set1 mark_testmode ,mark 
57d9 20600000 rtn 

check_test_exit:
57da 793f8011 set0 mark_testmode ,mark 
57db 70011400 jam 0 ,mem_tester_emulate 
57dc 6fe2011e fetch 1 ,mem_test_mode_old_debug_config 
57dd 67e2014a store 1 ,mem_debug_config 
57de 6fe28043 fetch 1 ,core_config 
57df 1fe17efb and_into 0xfb ,pdata 
57e0 67e28043 store 1 ,core_config 
57e1 20600000 rtn 

lmp_copy_rand:
57e2 d8c005c3 arg mem_rxbuf + 1 ,contr 
57e3 d8a005d3 arg mem_random_number ,contw 
57e4 20207758 branch memcpy16 

lmp_generate_key:
57e5 70007c09 jam lmp_comb_key ,mem_lmo_opcode2 
57e6 20600000 rtn 

lmp_start_encryption:
57e7 24748000 nrtn master 
57e8 70007c11 jam lmp_start_encryption_req ,mem_lmo_opcode2 
57e9 20600000 rtn 

lmp_accept_inrand:
57ea da204140 arg mem_lap ,rega 
57eb 204066fc call generate_kinit 
57ec 70007c03 jam lmp_accepted ,mem_lmo_opcode2 
57ed 70007d08 jam lmp_in_rand ,mem_lmi_opcode2 
57ee 20600000 rtn 

lmp_disconnect:
57ef 7000720a jam 10 ,mem_conn_timer 
57f0 70007c07 jam lmp_detach ,mem_lmo_opcode2 
57f1 70052e16 jam local_host ,mem_disconn_reason_send 
57f2 20600000 rtn 

send_lmp:
57f3 47424030 bpatchx patch30_4 ,mem_patch30 
57f4 78547c00 disable user 
57f5 20405b1e call lmo_fifo_process 
57f6 6fe20048 fetch 1 ,mem_lmp_to_send 
57f7 207a0000 rtn blank 
57f8 c283d829 bbit1 7 ,send_lmp_escape 
57f9 c000d9de beq lmp_name_req ,send_lmp_name_req 
57fa c001590b beq lmp_name_res ,send_lmp_name_res 
57fb c001d871 beq lmp_accepted ,send_lmp_accepted 
57fc c002588f beq lmp_not_accepted ,send_lmp_not_accepted 
57fd c013da40 beq lmp_features_req ,send_lmp_features_req 
57fe c014592f beq lmp_features_res ,send_lmp_features_res 
57ff c018591b beq lmp_timing_accuracy_res ,send_lmp_timing_accuracy_res 
5800 c012da3b beq lmp_version_req ,send_lmp_version_req 
5801 c013592a beq lmp_version_res ,send_lmp_version_res 
5802 c018da2b beq lmp_setup_complete ,send_lmp_setup_complete 
5803 c01bd9d9 beq lmp_supervision_timeout ,send_lmp_superto 
5804 c019d9a7 beq lmp_host_connection_req ,send_lmp_no_payload 
5805 c0045ac1 beq lmp_in_rand ,send_lmp_inrand 
5806 c004dab7 beq lmp_comb_key ,send_lmp_comb_key 
5807 c005dac9 beq lmp_au_rand ,send_lmp_aurand 
5808 c0065ad2 beq lmp_sres ,send_lmp_sres 
5809 c007d9d1 beq lmp_encryption_mode_req ,send_lmp_encryption_mode_req 
580a c0085af5 beq lmp_encryption_key_size_req ,send_lmp_encryption_key_size_req 
580b c008daeb beq lmp_start_encryption_req ,send_lmp_start_encryption 
580c c003d99d beq lmp_detach ,send_lmp_detach 
580d c01559ed beq lmp_quality_of_service_req ,send_lmp_quality_of_service_req 
580e c00559ee beq lmp_unit_key ,send_lmp_unit_key 
580f c015d9ad beq lmp_sco_link_req ,send_lmp_sco_link_req 
5810 c01659ca beq lmp_remove_sco_link_req ,send_lmp_remove_sco_link_req 
5811 c0035920 beq lmp_clkoffset_res ,send_lmp_clkoffset_res 
5812 c010d9aa beq lmp_max_power ,send_lmp_nopayload_reply 
5813 c016da21 beq lmp_max_slot ,send_lmp_max_slot 
5814 c0175a26 beq lmp_max_slot_req ,send_lmp_max_slot_req 
5815 c01159aa beq lmp_min_power ,send_lmp_nopayload_reply 
5816 c01a59ef beq lmp_slot_offset ,send_lmp_slot_offset 
5817 c009da04 beq lmp_switch_req ,send_lmp_switch_req 
5818 c00bda13 beq lmp_sniff_req ,send_lmp_sniff_req 
5819 c0095af2 beq lmp_stop_encryption_req ,send_lmp_stop_encryption_req 
581a c017da19 beq lmp_timing_accuracy_req ,send_lmp_timing_accuracy_req 
581b c00c5a1e beq lmp_unsniff_req ,send_lmp_unsniff_req 
581c c01eda66 beq lmp_encapsulated_header ,send_lmp_encapsulated_header 
581d c01f5a72 beq lmp_encapsulated_payload ,send_lmp_encapsulated_payload 
581e c01fda84 beq lmp_simple_pairing_confirm ,send_lmp_simple_pairing_comfirm 
581f c0205a8f beq lmp_simple_pairing_number ,send_lmp_simple_pairing_number 
5820 c020daa4 beq lmp_dhkey_check ,send_lmp_dhkey_check 
5821 c011dab3 beq lmp_auto_rate ,send_lmp_auto_rate 
5822 c01ddaae beq lmp_enc_key_size_mask_res ,send_lmp_enc_key_size_mask_res 
5823 c002dab4 beq lmp_clkoffset_req ,send_lmp_clkoffset_req 
5824 c014dab5 beq lmp_quality_of_service ,send_lmp_quality_of_service 
5825 c01c5ab6 beq lmp_test_activate ,send_lmp_test_activate 
5826 c01cd9e4 beq lmp_test_control ,send_lmp_test_control 

send_lmp_error:
5827 20203b25 branch assert 
5828 20600000 rtn 

send_lmp_escape:
5829 c040d89d beq lmp_ext_accepted ,send_lmpext_accepted 
582a c04258cc beq lmp_ext_features_res ,send_lmpext_features_res 
582b c04158aa beq lmp_not_accepted_ext ,send_lmpext_not_accepted 
582c c041d934 beq lmp_ext_features_req ,send_lmpext_features_req 
582d c045d93f beq lmp_packet_type_table_req ,send_lmpext_packet_type_table_req 
582e c04bd999 beq lmp_pause_encryption_req ,send_lmpext_pause_encryption_req 
582f c04cd8fc beq lmp_io_cap_req ,send_lmp_io_cap_req 
5830 c04d58d7 beq lmp_io_cap_res ,send_lmpext_io_cap_res 
5831 c04ad901 beq lmp_sniff_subrating_req ,send_lmpext_sniff_subrating_req 
5832 c04b5902 beq lmp_sniff_subrating_res ,send_lmpext_sniff_subrating_res 
5833 c0465836 beq lmp_ext_esco_link_req ,send_lmpext_esco_req 
5834 c046d868 beq lmp_ext_remove_esco_req ,send_lmpext_remove_esco 
5835 20203b25 branch assert 

send_lmpext_esco_req:
5836 70430702 jam codec_air_mode ,mem_air_mode 
5837 2034d83a branch send_lmpext_esco_req_master ,master 
5838 7042fa00 jam 0x00 ,mem_sco_handle 
5839 2020583b branch send_lmpext_esco_req_slave 

send_lmpext_esco_req_master:
583a 70430a07 jam 0x07 ,mem_esco_amaddr 

send_lmpext_esco_req_slave:
583b 7042fc00 jam 0 ,mem_sco_dsniff 
583c 6fe2413d fetch 1 ,mem_features + 5 
583d c302d845 bbit0 5 ,send_lmpext_esco_req_ev3 

send_lmpext_esco_req_2ev3:
583e 70430002 jam 2 ,mem_sco_wsniff 
583f 7042fe18 jam 24 ,mem_sco_tsniff 
5840 70430126 jam esco_type_2ev3 ,mem_sco_tx_packet_type 
5841 70430226 jam esco_type_2ev3 ,mem_sco_rx_packet_type 
5842 7043033c jam 60 ,mem_sco_rx_packet_len 
5843 7043053c jam 60 ,mem_sco_tx_packet_len 
5844 2020584b branch send_lmpext_esco_req_end 

send_lmpext_esco_req_ev3:
5845 70430002 jam 2 ,mem_sco_wsniff 
5846 7042fe0c jam 12 ,mem_sco_tsniff 
5847 70430107 jam esco_type_ev3 ,mem_sco_tx_packet_type 
5848 70430207 jam esco_type_ev3 ,mem_sco_rx_packet_type 
5849 7043031e jam 30 ,mem_sco_rx_packet_len 
584a 7043051e jam 30 ,mem_sco_tx_packet_len 

send_lmpext_esco_req_end:
584b 18007e8c force lmp_ext_esco_link_req ,pdata 
584c 18000e10 force 16 ,queue 
584d 20405b03 call send_lmpext 
584e 6fe242fa fetch 1 ,mem_sco_handle 
584f e7e20005 istore 1 ,contw 
5850 6fe2430a fetch 1 ,mem_esco_amaddr 
5851 e7e20005 istore 1 ,contw 
5852 58000000 setarg 0 
5853 e7e20005 istore 1 ,contw 
5854 6fe242fc fetch 1 ,mem_sco_dsniff 
5855 e7e20005 istore 1 ,contw 
5856 6fe242fe fetch 1 ,mem_sco_tsniff 
5857 1fe37e00 rshift pdata ,pdata 
5858 e7e20005 istore 1 ,contw 
5859 6fe24300 fetch 1 ,mem_sco_wsniff 
585a e7e20005 istore 1 ,contw 
585b 6fe24301 fetch 1 ,mem_sco_tx_packet_type 
585c e7e20005 istore 1 ,contw 
585d e7e20005 istore 1 ,contw 
585e 6fe44303 fetch 2 ,mem_sco_rx_packet_len 
585f e7e40005 istore 2 ,contw 
5860 e7e40005 istore 2 ,contw 
5861 6fe24307 fetch 1 ,mem_air_mode 
5862 e7e20005 istore 1 ,contw 
5863 6fe24308 fetch 1 ,mem_neogotiation_state 
5864 e7e20005 istore 1 ,contw 
5865 243a5b12 nbranch send_lmp_reply ,blank 
5866 2034db12 branch send_lmp_reply ,master 
5867 20205b14 branch send_lmp_request 

send_lmpext_remove_esco:
5868 18000e04 force 4 ,queue 
5869 20405b03 call send_lmpext 
586a 6fe242fa fetch 1 ,mem_sco_handle 
586b e7e20005 istore 1 ,contw 
586c 6fe2052e fetch 1 ,mem_disconn_reason_send 
586d e7e20005 istore 1 ,contw 
586e 6fe2430b fetch 1 ,mem_esco_arq 
586f 67e20047 store 1 ,mem_cur_arq 
5870 20205b14 branch send_lmp_request 

send_lmp_accepted:
5871 4742c030 bpatchx patch30_5 ,mem_patch30 
5872 18007e02 force 2 ,pdata 
5873 20405afb call msg_send_lmp 
5874 6fe20049 fetch 1 ,mem_lmi_opcode 
5875 e7e20005 istore 1 ,contw 
5876 20405b09 call send_lmp_follow 
5877 6fe20049 fetch 1 ,mem_lmi_opcode 
5878 c015d57a beq lmp_sco_link_req ,send_lmp_accepted_sco_link 
5879 c0165881 beq lmp_remove_sco_link_req ,send_lmp_accept_remove_sco_link_req 
587a c00458b4 beq lmp_in_rand ,send_lmp_accepted_inrand 
587b c007d8b8 beq lmp_encryption_mode_req ,send_lmp_accepted_enc_mode 
587c c00858c3 beq lmp_encryption_key_size_req ,send_lmp_accepted_enc_key 
587d c00bd882 beq lmp_sniff_req ,send_lmp_accept_sniff_req 
587e c019d8c6 beq lmp_host_connection_req ,send_lmp_accepted_connection 
587f c020d8cb beq lmp_dhkey_check ,send_lmp_accept_dhkey_check 
5880 20600000 rtn 

send_lmp_accept_remove_sco_link_req:
5881 20600000 rtn 

send_lmp_accept_sniff_req:

lmp_enter_acl_sniff:
5882 6fe20031 fetch 1 ,mem_mode 
5883 79207e06 set1 acl_in_sniff ,pdata 
5884 67e20031 store 1 ,mem_mode 
5885 c6158000 rtnmark1 mark_sco_flag 
5886 6fe401e3 fetch 2 ,mem_acl_dsniff 
5887 67e40075 store 2 ,mem_dsniff 
5888 6fe401e5 fetch 2 ,mem_acl_tsniff 
5889 67e40032 store 2 ,mem_tsniff 
588a 6fe201e7 fetch 1 ,mem_acl_attempt 
588b 67e20073 store 1 ,mem_sniff_attempt 
588c 6fe201e8 fetch 1 ,mem_acl_timeout 
588d 67e20074 store 1 ,mem_sniff_timeout 
588e 20203733 branch sniff_init 

send_lmp_not_accepted:
588f 18007e03 force 3 ,pdata 
5890 20405afb call msg_send_lmp 
5891 6fe20049 fetch 1 ,mem_lmi_opcode 
5892 c005d897 beq lmp_au_rand ,send_not_accept_aurand 
5893 e7e20005 istore 1 ,contw 
5894 6fe2004a fetch 1 ,mem_lmo_reason 
5895 e7e20005 istore 1 ,contw 
5896 20205b09 branch send_lmp_follow 

send_not_accept_aurand:
5897 e7e20005 istore 1 ,contw 
5898 6fe2004a fetch 1 ,mem_lmo_reason 
5899 e7e20005 istore 1 ,contw 
589a d8400539 arg mem_sres_tid ,temp 
589b 20205b3e branch special_tid_store 

send_remove_esco_link:
589c 20600000 rtn 

send_lmpext_accepted:
589d 18000e04 force 4 ,queue 
589e 20405b03 call send_lmpext 
589f 5800007f setarg lmp_escape 
58a0 e7e20005 istore 1 ,contw 
58a1 6fe20049 fetch 1 ,mem_lmi_opcode 
58a2 1fe22200 icopy rega 
58a3 793ffe07 set0 7 ,pdata 
58a4 e7e20005 istore 1 ,contw 
58a5 20405b09 call send_lmp_follow 
58a6 1a227e00 copy rega ,pdata 
58a7 c0465579 beq lmp_ext_esco_link_req ,send_lmpext_accept_esco_link 
58a8 c046d89c beq lmp_ext_remove_esco_req ,send_remove_esco_link 
58a9 20600000 rtn 

send_lmpext_not_accepted:
58aa 18000e05 force 5 ,queue 
58ab 20405b03 call send_lmpext 
58ac 5800007f setarg lmp_escape 
58ad e7e20005 istore 1 ,contw 
58ae 6fe20049 fetch 1 ,mem_lmi_opcode 
58af 793ffe07 set0 7 ,pdata 
58b0 e7e20005 istore 1 ,contw 
58b1 6fe2004a fetch 1 ,mem_lmo_reason 
58b2 e7e20005 istore 1 ,contw 
58b3 20205b09 branch send_lmp_follow 

send_lmp_accepted_inrand:
58b4 20403499 call clear_linkkey 
58b5 20405b4c call tid_check 
58b6 20608000 rtn true 
58b7 202057e5 branch lmp_generate_key 

send_lmp_accepted_enc_mode:
58b8 6fe2004b fetch 1 ,mem_op 
58b9 c282d8bf bbit1 op_start_enc ,send_lmp_accepted_enc_start 
58ba c4020000 rtnbit0 op_stop_enc 
58bb 70007c12 jam lmp_stop_encryption_req ,mem_lmo_opcode2 
58bc 793ffe04 set0 op_stop_enc ,pdata 
58bd 20405b44 call tid_reply 
58be 202058c1 branch send_lmp_accepted_enc_exit 

send_lmp_accepted_enc_start:
58bf 70007c10 jam lmp_encryption_key_size_req ,mem_lmo_opcode2 
58c0 793ffe05 set0 op_start_enc ,pdata 

send_lmp_accepted_enc_exit:
58c1 67e2004b store 1 ,mem_op 
58c2 20600000 rtn 

send_lmp_accepted_enc_key:
58c3 20405b55 call check_localsm 
58c4 2020d7e7 branch lmp_start_encryption ,true 
58c5 20600000 rtn 

send_lmp_accepted_connection:
58c6 6fe20535 fetch 1 ,mem_lmp_conn_state 
58c7 79207e00 set1 received_conn_req ,pdata 
58c8 67e20535 store 1 ,mem_lmp_conn_state 
58c9 700b0801 jam bt_evt_bb_connected ,mem_fifo_temp 
58ca 202071ee branch ui_ipc_send_event 

send_lmp_accept_dhkey_check:
58cb 20600000 rtn 

send_lmpext_features_res:
58cc 18000e0c force 12 ,queue 
58cd 20405b03 call send_lmpext 
58ce 58000001 setarg 0x01 
58cf e7e20005 istore 1 ,contw 
58d0 6fe40532 fetch 2 ,mem_lmpext_ssp_enable 
58d1 e7e40005 istore 2 ,contw 
58d2 58000000 setarg 0 
58d3 e7e60005 istore 3 ,contw 
58d4 58000000 setarg 0x00 
58d5 e7e80005 istore 4 ,contw 
58d6 20205b12 branch send_lmp_reply 

send_lmpext_io_cap_res:
58d7 18000e05 force 5 ,queue 
58d8 20405b03 call send_lmpext 
58d9 6fe646a1 fetch 3 ,mem_sp_iocap_local 
58da e7e60005 istore 3 ,contw 
58db 20405b12 call send_lmp_reply 
58dc 7046ac01 jam flag_pairing_state_pairing ,mem_flag_pairing_state 
58dd 6fe246a1 fetch 1 ,mem_sp_iocap_local 
58de c000d8e8 beq display_yesno ,responder_iocap_display_yesno 
58df c00158e2 beq keyboard_only ,responder_iocap_keyboard_only 
58e0 c001d8ee beq no_input_no_output ,responder_iocap_no_input_no_output 
58e1 20600000 rtn 

responder_iocap_keyboard_only:
58e2 6fe246a6 fetch 1 ,mem_sp_iocap_remote 
58e3 c00058fa beq display_only ,responder_iocap_keyboard_only_initiator_iocap_display_only 
58e4 c000d8fa beq display_yesno ,responder_iocap_keyboard_only_initiator_iocap_display_yesno 
58e5 c00158fa beq keyboard_only ,responder_iocap_keyboard_only_initiator_iocap_keyboard_only 
58e6 c001d8f4 beq no_input_no_output ,responder_iocap_keyboard_only_initiator_iocap_no_input_no_output 
58e7 20600000 rtn 

responder_iocap_display_yesno:
58e8 6fe246a6 fetch 1 ,mem_sp_iocap_remote 
58e9 c00058f4 beq display_only ,responder_iocap_display_yesno_initiator_iocap_display_only 
58ea c000d8f8 beq display_yesno ,responder_iocap_display_yesno_initiator_iocap_display_yesno 
58eb c00158fa beq keyboard_only ,responder_iocap_display_yesno_initiator_iocap_keyboard_only 
58ec c001d8f4 beq no_input_no_output ,responder_iocap_display_yesno_initiator_iocap_no_input_no_output 
58ed 20600000 rtn 

responder_iocap_no_input_no_output:
58ee 6fe246a6 fetch 1 ,mem_sp_iocap_remote 
58ef c00058f4 beq display_only ,responder_iocap_no_input_no_output_initiator_iocap_display_only 
58f0 c000d8f4 beq display_yesno ,responder_iocap_no_input_no_output_initiator_iocap_display_yesno 
58f1 c00158f4 beq keyboard_only ,responder_iocap_no_input_no_output_initiator_iocap_keyboard_only 
58f2 c001d8f4 beq no_input_no_output ,responder_iocap_no_input_no_output_initiator_iocap_no_input_no_output 
58f3 20600000 rtn 

responder_iocap_keyboard_only_initiator_iocap_no_input_no_output:

responder_iocap_display_yesno_initiator_iocap_no_input_no_output:

responder_iocap_display_yesno_initiator_iocap_display_only:

responder_iocap_no_input_no_output_initiator_iocap_display_only:

responder_iocap_no_input_no_output_initiator_iocap_display_yesno:

responder_iocap_no_input_no_output_initiator_iocap_keyboard_only:

responder_iocap_no_input_no_output_initiator_iocap_no_input_no_output:

set_ssp_mode_justwork:
58f4 7046a403 jam ssp_mode_just_work_flag ,mem_ssp_mode_flag 
58f5 6fe246a5 fetch 1 ,mem_spp_reject_justwork_flag 
58f6 c000c231 beq reject_justwork ,app_bt_disconnect 
58f7 20600000 rtn 

responder_iocap_display_yesno_initiator_iocap_display_yesno:

set_ssp_mode_numeric_comparison:
58f8 7046a401 jam ssp_mode_ssp_pin_flag ,mem_ssp_mode_flag 
58f9 20600000 rtn 

responder_iocap_keyboard_only_initiator_iocap_display_yesno:

responder_iocap_keyboard_only_initiator_iocap_keyboard_only:

responder_iocap_keyboard_only_initiator_iocap_display_only:

responder_iocap_display_yesno_initiator_iocap_keyboard_only:

set_ssp_mode_passkey:
58fa 7046a402 jam ssp_mode_passkey_entry_flag ,mem_ssp_mode_flag 
58fb 20600000 rtn 

send_lmp_io_cap_req:
58fc 18000e05 force 5 ,queue 
58fd 20405b03 call send_lmpext 
58fe 6fe646a1 fetch 3 ,mem_sp_iocap_local 
58ff e7e60005 istore 3 ,contw 
5900 20205b14 branch send_lmp_request 

send_lmpext_sniff_subrating_req:
5901 20600000 rtn 

send_lmpext_sniff_subrating_res:
5902 18000e09 force 9 ,queue 
5903 20405b03 call send_lmpext 
5904 6fe2009f fetch 1 ,mem_subsniff_rate 
5905 e7e20005 istore 1 ,contw 
5906 6fe400a0 fetch 2 ,mem_subsniff_tcmax 
5907 e7e40005 istore 2 ,contw 
5908 6fe8009b fetch 4 ,mem_subsniff_instant 
5909 e7e80005 istore 4 ,contw 
590a 20205b12 branch send_lmp_reply 

send_lmp_name_res:
590b 18007e11 force 17 ,pdata 
590c 20405afb call msg_send_lmp 
590d 6fe20049 fetch 1 ,mem_lmi_opcode 
590e 1fe20400 copy pdata ,temp 
590f c0005913 beq 0x00 ,send_lmp_name_res_offset_ok 
5910 c0075913 beq 0x0e ,send_lmp_name_res_offset_ok 
5911 c00e5913 beq 0x1c ,send_lmp_name_res_offset_ok 
5912 20600000 rtn 

send_lmp_name_res_offset_ok:
5913 e7e20005 istore 1 ,contw 
5914 6fe2455c fetch 1 ,mem_local_name_length 
5915 e7e20005 istore 1 ,contw 
5916 1fe27200 copy pdata ,loopcnt 
5917 5800455d setarg mem_local_name 
5918 98408c00 iadd temp ,contr 
5919 2040779f call memcpy 
591a 20205b12 branch send_lmp_reply 

send_lmp_timing_accuracy_res:
591b 18007e03 force 3 ,pdata 
591c 20405afb call msg_send_lmp 
591d 58000114 setarg 0x0114 
591e e7e40005 istore 2 ,contw 
591f 20205b12 branch send_lmp_reply 

send_lmp_clkoffset_res:
5920 18007e03 force 3 ,pdata 
5921 20405afb call msg_send_lmp 
5922 6fe80130 fetch 4 ,mem_clke_bt 
5923 9c467e00 isub clkn_bt ,pdata 
5924 2034d926 branch send_lmp_clkoffset_res_master ,master 
5925 1fe67e00 sub pdata ,0 ,pdata 

send_lmp_clkoffset_res_master:
5926 1feb7e00 rshift2 pdata ,pdata 
5927 793ffe0f set0 15 ,pdata 
5928 e7e40005 istore 2 ,contw 
5929 20205b12 branch send_lmp_reply 

send_lmp_version_res:
592a 18007e06 force 6 ,pdata 
592b 20405afb call msg_send_lmp 
592c 6fea4557 fetch 5 ,mem_lmp_version 
592d e7ea0005 istore 5 ,contw 
592e 20205b12 branch send_lmp_reply 

send_lmp_features_res:
592f 18007e09 force 9 ,pdata 
5930 20405afb call msg_send_lmp 
5931 6ff04138 fetch 8 ,mem_features 
5932 e7f00005 istore 8 ,contw 
5933 20205b12 branch send_lmp_reply 

send_lmpext_features_req:
5934 18000e0c force 12 ,queue 
5935 20405b03 call send_lmpext 
5936 58000001 setarg 0x01 
5937 e7e20005 istore 1 ,contw 
5938 6fe40532 fetch 2 ,mem_lmpext_ssp_enable 
5939 e7e40005 istore 2 ,contw 
593a 58000000 setarg 0 
593b e7e60005 istore 3 ,contw 
593c 58000000 setarg 0x00 
593d e7e80005 istore 4 ,contw 
593e 20205b14 branch send_lmp_request 

send_lmpext_packet_type_table_req:
593f 18000e03 force 3 ,queue 
5940 20405b03 call send_lmpext 
5941 6fe241f8 fetch 1 ,mem_ptt 
5942 e7e20005 istore 1 ,contw 
5943 78547c00 disable user 
5944 20405b14 call send_lmp_request 
5945 24740000 nrtn user 
5946 24748000 nrtn master 
5947 6fe24177 fetch 1 ,mem_afh_cfg 
5948 c4000000 rtnbit0 afh_cfg_on 
5949 20405957 call afh_init 
594a 20205961 branch afh_open_all_channels 

ssp_enable:
594b 6fe2413e fetch 1 ,mem_features + 6 
594c 79207e03 set1 param_featrue_ssp ,pdata 
594d 67e2413e store 1 ,mem_features + 6 
594e 58000101 setarg param_lmpext_ssp_enable 
594f 67e40532 store 2 ,mem_lmpext_ssp_enable 
5950 20600000 rtn 

ssp_disable:
5951 6fe2413e fetch 1 ,mem_features + 6 
5952 793ffe03 set0 param_featrue_ssp ,pdata 
5953 67e2413e store 1 ,mem_features + 6 
5954 58000000 setarg 0 
5955 67e40532 store 2 ,mem_lmpext_ssp_enable 
5956 20600000 rtn 

afh_init:
5957 70417703 jam 0x3 ,mem_afh_cfg 
5958 58000000 setarg 0 
5959 67e841e1 store 4 ,mem_afh_timer 
595a d8a04179 arg mem_afh_map_lo ,contw 
595b 2040596b call afh_reset_map 
595c d8a04186 arg mem_afh_map_new ,contw 
595d 2040596b call afh_reset_map 
595e d8a041e5 arg mem_afh_classify_channel_map ,contw 
595f 2040596b call afh_reset_map 
5960 20205972 branch afh_clear_error_counter 

afh_open_all_channels:
5961 d8a04186 arg mem_afh_map_new ,contw 
5962 2040596b call afh_reset_map 
5963 20405972 call afh_clear_error_counter 
5964 20205975 branch afh_set_send_flag 

afh_open_classify_map:
5965 6fea41e5 fetch 5 ,mem_afh_classify_channel_map 
5966 67ea4186 store 5 ,mem_afh_map_new 
5967 efea0006 ifetch 5 ,contr 
5968 e7ea0005 istore 5 ,contw 
5969 20405972 call afh_clear_error_counter 
596a 20205975 branch afh_set_send_flag 

afh_reset_map:
596b 58ffffff setarg 0xffffff 
596c e7e60005 istore 3 ,contw 
596d e7e60005 istore 3 ,contw 
596e e7e60005 istore 3 ,contw 
596f 5800007f setarg 0x7f 
5970 e7e20005 istore 1 ,contw 
5971 20600000 rtn 

afh_clear_error_counter:
5972 58000000 setarg 0 
5973 67e44175 store 2 ,mem_afh_error_total 
5974 20600000 rtn 

afh_set_send_flag:
5975 6fe24177 fetch 1 ,mem_afh_cfg 
5976 79207e02 set1 send_lmp_set_afh ,pdata 
5977 67e24177 store 1 ,mem_afh_cfg 
5978 20600000 rtn 

send_set_afh:
5979 24748000 nrtn master 
597a 18007e10 force 16 ,pdata 
597b 20405afb call msg_send_lmp 
597c 1c427e00 deposit clkn_bt 
597d d84001dc arg 476 ,temp 
597e 9840fe00 iadd temp ,pdata 
597f 1fe37e00 rshift pdata ,pdata 
5980 1fe0fe01 increase 1 ,pdata 
5981 793ffe00 set0 0 ,pdata 
5982 e7e80005 istore 4 ,contw 
5983 1fe20400 copy pdata ,temp 
5984 58000001 setarg 1 
5985 e7e20005 istore 1 ,contw 
5986 6fea4186 fetch 5 ,mem_afh_map_new 
5987 e7ea0005 istore 5 ,contw 
5988 efea0006 ifetch 5 ,contr 
5989 e7ea0005 istore 5 ,contw 
598a 18438400 lshift temp ,temp 
598b 60484171 storet 4 ,mem_afh_instant 
598c 20405b14 call send_lmp_request 
598d 6fe20031 fetch 1 ,mem_mode 
598e 79207e03 set1 afh_change ,pdata 
598f 67e20031 store 1 ,mem_mode 
5990 70417801 jam 1 ,mem_afh_new_mod 
5991 6fe84171 fetch 4 ,mem_afh_instant 
5992 d842ee00 arg timer_one_minute ,temp 
5993 9840fe00 iadd temp ,pdata 
5994 67e841e1 store 4 ,mem_afh_timer 
5995 6fe24177 fetch 1 ,mem_afh_cfg 
5996 c3820000 rtnbit1 afh_cfg_master_sent_req 
5997 70007c90 jam lmp_ext_chn_classification_req ,mem_lmo_opcode2 
5998 20600000 rtn 

send_lmpext_pause_encryption_req:
5999 18000e02 force 2 ,queue 
599a 20405b03 call send_lmpext 
599b 2434db12 nbranch send_lmp_reply ,master 
599c 20205b14 branch send_lmp_request 

send_lmp_detach:
599d 18007e02 force 2 ,pdata 
599e 20405afb call msg_send_lmp 
599f 6fe2052e fetch 1 ,mem_disconn_reason_send 
59a0 e7e20005 istore 1 ,contw 
59a1 20405b14 call send_lmp_request 

prepare_disconnect:
59a2 6fe2004b fetch 1 ,mem_op 
59a3 79207e03 set1 op_disconn ,pdata 
59a4 67e2004b store 1 ,mem_op 
59a5 70007232 jam 50 ,mem_conn_timer 
59a6 20600000 rtn 

send_lmp_no_payload:
59a7 18007e01 force 1 ,pdata 
59a8 20405afb call msg_send_lmp 
59a9 20205b14 branch send_lmp_request 

send_lmp_nopayload_reply:
59aa 18007e01 force 1 ,pdata 
59ab 20405afb call msg_send_lmp 
59ac 20205b12 branch send_lmp_reply 

send_lmp_sco_link_req:
59ad 2034d9b2 branch send_lmp_sco_link_master ,master 
59ae 7042fa00 jam 0x00 ,mem_sco_handle 
59af 6fe20031 fetch 1 ,mem_mode 
59b0 79207e04 set1 sco_req_by_slave ,pdata 
59b1 67e20031 store 1 ,mem_mode 

send_lmp_sco_link_master:
59b2 70430102 jam sco_type_hv3 ,mem_sco_tx_packet_type 
59b3 70430202 jam sco_type_hv3 ,mem_sco_rx_packet_type 
59b4 7043031e jam 30 ,mem_sco_rx_packet_len 
59b5 7043051e jam 30 ,mem_sco_tx_packet_len 
59b6 7042fe0c jam 12 ,mem_sco_tsniff 
59b7 7042fc00 jam 0 ,mem_sco_dsniff 
59b8 18007e07 force 7 ,pdata 
59b9 20405afb call msg_send_lmp 
59ba 6fe242fa fetch 1 ,mem_sco_handle 
59bb e7e20005 istore 1 ,contw 
59bc 58000000 setarg 0x00 
59bd e7e20005 istore 1 ,contw 
59be 1fe37e00 rshift pdata ,pdata 
59bf 6fe242fc fetch 1 ,mem_sco_dsniff 
59c0 e7e20005 istore 1 ,contw 
59c1 6fe242fe fetch 1 ,mem_sco_tsniff 
59c2 1fe37e00 rshift pdata ,pdata 
59c3 e7e20005 istore 1 ,contw 
59c4 58000002 setarg sco_type_hv3 
59c5 e7e20005 istore 1 ,contw 
59c6 18007e02 force codec_air_mode ,pdata 
59c7 e7e20005 istore 1 ,contw 
59c8 2034db12 branch send_lmp_reply ,master 
59c9 20205b0f branch send_lmp_tid 

send_lmp_remove_sco_link_req:
59ca 18007e03 force 3 ,pdata 
59cb 20405afb call msg_send_lmp 
59cc 6fe242fa fetch 1 ,mem_sco_handle 
59cd e7e20005 istore 1 ,contw 
59ce 18007e13 force other_end_terminated ,pdata 
59cf e7e20005 istore 1 ,contw 
59d0 20205b14 branch send_lmp_request 

send_lmp_encryption_mode_req:
59d1 18007e02 force 2 ,pdata 
59d2 20405afb call msg_send_lmp 
59d3 6fe2004c fetch 1 ,mem_state_map 
59d4 2fec0002 isolate0 smap_encryption ,pdata 
59d5 7920fe00 setflag true ,0 ,pdata 
59d6 1fe17e01 and_into 1 ,pdata 
59d7 e7e20005 istore 1 ,contw 
59d8 20205b14 branch send_lmp_request 

send_lmp_superto:
59d9 18007e03 force 3 ,pdata 
59da 20405afb call msg_send_lmp 
59db 6fe40051 fetch 2 ,mem_supervision_to 
59dc e7e40005 istore 2 ,contw 
59dd 20205b14 branch send_lmp_request 

send_lmp_name_req:
59de 700072fa jam 250 ,mem_conn_timer 
59df 18007e02 force 2 ,pdata 
59e0 20405afb call msg_send_lmp 
59e1 6fe20053 fetch 1 ,mem_name_offset 
59e2 e7e20005 istore 1 ,contw 
59e3 20205b14 branch send_lmp_request 

send_lmp_test_control:
59e4 18007e0a force 10 ,pdata 
59e5 20405afb call msg_send_lmp 
59e6 d8c00115 arg mem_temp_payload ,contr 
59e7 18007209 force 9 ,loopcnt 

send_lmp_test_control_loop:
59e8 efe20006 ifetch 1 ,contr 
59e9 1fe2fe55 xor_into 0x55 ,pdata 
59ea e7e20005 istore 1 ,contw 
59eb c20059e8 loop send_lmp_test_control_loop 
59ec 20205b14 branch send_lmp_request 

send_lmp_quality_of_service_req:
59ed 20205b14 branch send_lmp_request 

send_lmp_unit_key:
59ee 20205b14 branch send_lmp_request 

send_lmp_slot_offset:
59ef 20748000 rtn master 
59f0 204038b9 call calc_slot_offset 
59f1 18007e09 force 9 ,pdata 
59f2 20405afb call msg_send_lmp 
59f3 6fe4013c fetch 2 ,mem_slot_offset 
59f4 e7e40005 istore 2 ,contw 
59f5 6fe64140 fetch 3 ,mem_lap 
59f6 e7e60005 istore 3 ,contw 
59f7 6fe24143 fetch 1 ,mem_uap 
59f8 e7e20005 istore 1 ,contw 
59f9 6fe44144 fetch 2 ,mem_nap 
59fa e7e40005 istore 2 ,contw 
59fb c581da00 bmark0 mark_switch_initiated ,send_lmp_slot_offset_reply 
59fc 793f8003 set0 mark_switch_initiated ,mark 
59fd 20405b14 call send_lmp_request 
59fe 70007c13 jam lmp_switch_req ,mem_lmo_opcode2 
59ff 20600000 rtn 

send_lmp_slot_offset_reply:
5a00 20405b12 call send_lmp_reply 
5a01 70007c03 jam lmp_accepted ,mem_lmo_opcode2 
5a02 70007d13 jam lmp_switch_req ,mem_lmi_opcode2 
5a03 20600000 rtn 

send_lmp_switch_req:
5a04 d8400200 arg 0x200 ,temp 
5a05 2034da08 branch switch_on_native ,master 
5a06 1d027e00 deposit clke_bt 
5a07 20205a09 branch switch_slack 

switch_on_native:
5a08 1c427e00 deposit clkn_bt 

switch_slack:
5a09 1c227e00 deposit bt_clk 
5a0a 9840fe00 iadd temp ,pdata 
5a0b 1fe17ffc and_into 0x1fc ,pdata 
5a0c 67e80034 store 4 ,mem_sniff_anchor 
5a0d 18007e05 force 5 ,pdata 
5a0e 20405afb call msg_send_lmp 
5a0f 6fe80034 fetch 4 ,mem_sniff_anchor 
5a10 1fe37e00 rshift pdata ,pdata 
5a11 e7e80005 istore 4 ,contw 
5a12 20205b14 branch send_lmp_request 

send_lmp_sniff_req:
5a13 18007e0a force 10 ,pdata 
5a14 20405afb call msg_send_lmp 
5a15 d8c0053c arg mem_sniff_payload ,contr 
5a16 eff20006 ifetch 9 ,contr 
5a17 e7f20005 istore 9 ,contw 
5a18 20205b14 branch send_lmp_request 

send_lmp_timing_accuracy_req:
5a19 18007e03 force 3 ,pdata 
5a1a 20405afb call msg_send_lmp 
5a1b 58000114 setarg 0x0114 
5a1c e7e40005 istore 2 ,contw 
5a1d 20205b14 branch send_lmp_request 

send_lmp_unsniff_req:
5a1e 18007e01 force 1 ,pdata 
5a1f 20405afb call msg_send_lmp 
5a20 20205b14 branch send_lmp_request 

send_lmp_max_slot:
5a21 18007e02 force 2 ,pdata 
5a22 20405afb call msg_send_lmp 
5a23 6fe2416f fetch 1 ,mem_max_slot 
5a24 e7e20005 istore 1 ,contw 
5a25 20205b14 branch send_lmp_request 

send_lmp_max_slot_req:
5a26 18007e02 force 2 ,pdata 
5a27 20405afb call msg_send_lmp 
5a28 58000005 setarg 0x05 
5a29 e7e20005 istore 1 ,contw 
5a2a 20205b14 branch send_lmp_request 

send_lmp_setup_complete:
5a2b 6fe20030 fetch 1 ,mem_state 
5a2c 79207e04 set1 state_conn_comp ,pdata 
5a2d 67e20030 store 1 ,mem_state 
5a2e 1c427e00 copy clkn_bt ,pdata 
5a2f 67e8054c store 4 ,mem_aurand_send_delay_time 
5a30 6fe20535 fetch 1 ,mem_lmp_conn_state 
5a31 c281da39 bbit1 sent_setup_complete ,send_lmp_setup_complete_has_sent 
5a32 79207e03 set1 sent_setup_complete ,pdata 
5a33 67e20535 store 1 ,mem_lmp_conn_state 
5a34 700b0805 jam bt_evt_setup_complete ,mem_fifo_temp 
5a35 204071ee call ui_ipc_send_event 
5a36 18007e01 force 1 ,pdata 
5a37 20405afb call msg_send_lmp 
5a38 20205b14 branch send_lmp_request 

send_lmp_setup_complete_has_sent:
5a39 70004800 jam 0 ,mem_lmp_to_send 
5a3a 20600000 rtn 

send_lmp_version_req:
5a3b 18007e06 force 6 ,pdata 
5a3c 20405afb call msg_send_lmp 
5a3d 6fea4557 fetch 5 ,mem_lmp_version 
5a3e e7ea0005 istore 5 ,contw 
5a3f 20205b14 branch send_lmp_request 

send_lmp_features_req:
5a40 18007e09 force 9 ,pdata 
5a41 20405afb call msg_send_lmp 
5a42 6ff04138 fetch 8 ,mem_features 
5a43 e7f00005 istore 8 ,contw 
5a44 20205b14 branch send_lmp_request 

sp_master_send_io_cap_get:
5a45 6fe24132 fetch 1 ,mem_device_option 
5a46 c000da4a beq dvc_op_hci ,sp_master_send_io_cap_get_hci 
5a47 700a2201 jam sp_flag_commit ,mem_master_sp_flag 
5a48 6fe245f7 fetch 1 ,mem_sp_local_key_invalid 
5a49 c1808000 rtnne sp_key_valid 

sp_master_send_io_cap_get_hci:
5a4a 700a2013 jam sp_master_stat_start_done ,mem_master_sp_state 
5a4b 20600000 rtn 

sp_master_send_io_cap_send:
5a4c 20405b48 call tid_initiate 
5a4d 70007c99 jam lmp_io_cap_req ,mem_lmo_opcode2 
5a4e 700a2003 jam sp_stat_key_send ,mem_master_sp_state 
5a4f 20600000 rtn 

sp_master_send_lmp_encapsulated_header:
5a50 20405b48 call tid_initiate 
5a51 70007c3d jam lmp_encapsulated_header ,mem_lmo_opcode2 
5a52 700a2007 jam sp_stat_random_send ,mem_master_sp_state 
5a53 20600000 rtn 

sp_master_commitment_compare:
5a54 da200abf arg mem_sp_calc_result_high ,rega 
5a55 da400adf arg mem_sp_confirm_remote ,regb 
5a56 df200010 arg 16 ,loopcnt 
5a57 20407856 call string_compare 
5a58 2022da5e branch sp_master_commitment_compare_success ,zero 
5a59 700a2000 jam sp_stat_null ,mem_master_sp_state 
5a5a 20406b71 call master_clear_mem_master_sp_flag 
5a5b 70007e24 jam pdu_not_allowed ,mem_lmo_reason2 
5a5c 70007d40 jam lmp_simple_pairing_number ,mem_lmi_opcode2 
5a5d 2020549b branch reject_lmp_packet 

sp_master_commitment_compare_success:
5a5e 700a200a jam sp_stat_confirm_calc ,mem_master_sp_state 
5a5f 20406b6f call master_set_mem_master_sp_flag 
5a60 70007d40 jam lmp_simple_pairing_number ,mem_lmi_opcode2 
5a61 202055f8 branch accept_lmp_msg 

sp_master_send_lmp_simple_pairing_number:
5a62 70007c40 jam lmp_simple_pairing_number ,mem_lmo_opcode2 
5a63 20600000 rtn 

sp_send_lmp_encapsulated_header:
5a64 70007c3d jam lmp_encapsulated_header ,mem_lmo_opcode2 
5a65 20600000 rtn 

send_lmp_encapsulated_header:
5a66 700a2700 jam 0 ,mem_sp_local_key_send_count 
5a67 18007e04 force 4 ,pdata 
5a68 20405afb call msg_send_lmp 
5a69 18007e01 force encapsulated_major_type_p192 ,pdata 
5a6a e7e20005 istore 1 ,contw 
5a6b 18007e01 force encapsulated_minor_type_p192 ,pdata 
5a6c e7e20005 istore 1 ,contw 
5a6d 18007e30 force encapsulated_len_p192 ,pdata 
5a6e e7e20005 istore 1 ,contw 
5a6f 20405b55 call check_localsm 
5a70 2020db14 branch send_lmp_request ,true 
5a71 20205b12 branch send_lmp_reply 

send_lmp_encapsulated_payload:
5a72 18007e11 force 17 ,pdata 
5a73 20405afb call msg_send_lmp 
5a74 6fe20a27 fetch 1 ,mem_sp_local_key_send_count 
5a75 d8c04670 arg mem_sp_pubkey_local ,contr 
5a76 98c08c00 iadd contr ,contr 
5a77 eff00006 ifetch 8 ,contr 
5a78 e7f00005 istore 8 ,contw 
5a79 eff00006 ifetch 8 ,contr 
5a7a e7f00005 istore 8 ,contw 
5a7b 6fe20a27 fetch 1 ,mem_sp_local_key_send_count 
5a7c 1fe0fe10 increase 16 ,pdata 
5a7d 67e20a27 store 1 ,mem_sp_local_key_send_count 
5a7e 20405b55 call check_localsm 
5a7f 2020db14 branch send_lmp_request ,true 
5a80 20205b12 branch send_lmp_reply 

sp_send_lmp_simple_pairing_comfirm:
5a81 700a1f06 jam sp_stat_random_recv ,mem_sp_state 
5a82 70007c3f jam lmp_simple_pairing_confirm ,mem_lmo_opcode2 
5a83 20600000 rtn 

send_lmp_simple_pairing_comfirm:
5a84 18007e11 force 17 ,pdata 
5a85 20405afb call msg_send_lmp 
5a86 d8c00abf arg mem_sp_calc_result_high ,contr 
5a87 eff00006 ifetch 8 ,contr 
5a88 e7f00005 istore 8 ,contw 
5a89 eff00006 ifetch 8 ,contr 
5a8a e7f00005 istore 8 ,contw 
5a8b 20205b12 branch send_lmp_reply 

sp_send_lmp_simple_pairing_number:
5a8c 20405b1e call lmo_fifo_process 
5a8d 70007c40 jam lmp_simple_pairing_number ,mem_lmo_opcode2 
5a8e 20600000 rtn 

send_lmp_simple_pairing_number:
5a8f 20405b55 call check_localsm 
5a90 2040eaac call sp_local_random_key_generator ,true 
5a91 18007e11 force 17 ,pdata 
5a92 20405afb call msg_send_lmp 
5a93 d8c00a8f arg mem_sp_random_local ,contr 
5a94 eff00006 ifetch 8 ,contr 
5a95 e7f00005 istore 8 ,contw 
5a96 eff00006 ifetch 8 ,contr 
5a97 e7f00005 istore 8 ,contw 
5a98 20405b55 call check_localsm 
5a99 2420db12 nbranch send_lmp_reply ,true 
5a9a 2020db14 branch send_lmp_request ,true 

master_sp_sm_end:
5a9b 700a200f jam sp_stat_done ,mem_master_sp_state 

sp_aurand_send:
5a9c 20405b48 call tid_initiate 
5a9d 70007c0b jam lmp_au_rand ,mem_lmo_opcode2 
5a9e 20405b60 call check_localsm_master 
5a9f 2020eae9 branch sp_master_key_prarm_push ,true 
5aa0 20206af3 branch sp_link_key_prarm_push 

master_sp_send_lmp_dhkey_check:
5aa1 20405b44 call tid_reply 

sp_send_lmp_dhkey_check:
5aa2 70007c41 jam lmp_dhkey_check ,mem_lmo_opcode2 
5aa3 20600000 rtn 

send_lmp_dhkey_check:
5aa4 18007e11 force 17 ,pdata 
5aa5 20405afb call msg_send_lmp 
5aa6 d8c00abf arg mem_sp_calc_result_high ,contr 
5aa7 eff00006 ifetch 8 ,contr 
5aa8 e7f00005 istore 8 ,contw 
5aa9 eff00006 ifetch 8 ,contr 
5aaa e7f00005 istore 8 ,contw 
5aab 20405b55 call check_localsm 
5aac 2420db12 nbranch send_lmp_reply ,true 
5aad 2020db14 branch send_lmp_request ,true 

send_lmp_enc_key_size_mask_res:
5aae 18007e03 force 3 ,pdata 
5aaf 20405afb call msg_send_lmp 
5ab0 5800fffe setarg 0xfffe 
5ab1 e7e40005 istore 2 ,contw 
5ab2 20205b12 branch send_lmp_reply 

send_lmp_auto_rate:
5ab3 20205b14 branch send_lmp_request 

send_lmp_clkoffset_req:
5ab4 20205b14 branch send_lmp_request 

send_lmp_quality_of_service:
5ab5 20205b14 branch send_lmp_request 

send_lmp_test_activate:
5ab6 20205b14 branch send_lmp_request 

send_lmp_comb_key:
5ab7 20405b64 call generate_random_number 
5ab8 da204140 arg mem_lap ,rega 
5ab9 20405b6a call generate_linkkey 
5aba 18007e11 force 17 ,pdata 
5abb 20405afb call msg_send_lmp 
5abc da2005f3 arg mem_kinit ,rega 
5abd da4005d3 arg mem_random_number ,regb 
5abe 204067f0 call xor16 
5abf 2434db09 nbranch send_lmp_follow ,master 
5ac0 20205b0f branch send_lmp_tid 

send_lmp_inrand:
5ac1 20405b64 call generate_random_number 
5ac2 da200040 arg mem_plap ,rega 
5ac3 204066fc call generate_kinit 

send_lmp_rand:
5ac4 18007e11 force 17 ,pdata 
5ac5 20405afb call msg_send_lmp 
5ac6 d8c005d3 arg mem_random_number ,contr 
5ac7 20407758 call memcpy16 
5ac8 20205b0f branch send_lmp_tid 

send_lmp_aurand:
5ac9 6fe20a26 fetch 1 ,mem_pairing_auth 
5aca 203a5acf branch send_lmp_aurand_notpairing ,blank 
5acb 20405b55 call check_localsm 
5acc 2040db48 call tid_initiate ,true 
5acd 2440db44 ncall tid_reply ,true 
5ace 20205ad0 branch send_lmp_aurand_common 

send_lmp_aurand_notpairing:
5acf 20405b48 call tid_initiate 

send_lmp_aurand_common:
5ad0 20405b64 call generate_random_number 
5ad1 20205ac4 branch send_lmp_rand 

send_lmp_sres:
5ad2 da204140 arg mem_lap ,rega 
5ad3 2040672f call function_e1 
5ad4 18007e05 force 5 ,pdata 
5ad5 20405afb call msg_send_lmp 
5ad6 6fe80603 fetch 4 ,mem_input_store 
5ad7 e7e80005 istore 4 ,contw 
5ad8 d8400539 arg mem_sres_tid ,temp 
5ad9 20405b3e call special_tid_store 
5ada 20406824 call copy_aco 
5adb 20405b55 call check_localsm 
5adc 2020dae1 branch send_lmp_sres_master ,true 
5add 70053b01 jam done_encryp ,mem_wait_encryption 
5ade 6fe20a26 fetch 1 ,mem_pairing_auth 
5adf 207a0000 rtn blank 
5ae0 70007c0b jam lmp_au_rand ,mem_lmo_opcode2 

send_lmp_sres_master:
5ae1 6fe24270 fetch 1 ,mem_link_key_exists 
5ae2 207a0000 rtn blank 

send_lmp_sres_startenc:
5ae3 20405b55 call check_localsm 
5ae4 2420dae7 nbranch send_lmp_sres_startenc_slave ,true 
5ae5 70007c0f jam lmp_encryption_mode_req ,mem_lmo_opcode2 
5ae6 20600000 rtn 

send_lmp_sres_startenc_slave:
5ae7 c6908000 rtnmark0 mark_slave_in_rand_accepted 
5ae8 793f8021 set0 mark_slave_in_rand_accepted ,mark 
5ae9 70007c0f jam lmp_encryption_mode_req ,mem_lmo_opcode2 
5aea 20600000 rtn 

send_lmp_start_encryption:
5aeb 20405b64 call generate_random_number 
5aec 20406732 call function_e3 
5aed 18007e11 force 17 ,pdata 
5aee 20405afb call msg_send_lmp 
5aef d8c005d3 arg mem_random_number ,contr 
5af0 20407758 call memcpy16 
5af1 20205b0f branch send_lmp_tid 

send_lmp_stop_encryption_req:
5af2 18007e01 force 1 ,pdata 
5af3 20405afb call msg_send_lmp 
5af4 20205b0f branch send_lmp_tid 

send_lmp_encryption_key_size_req:
5af5 18007e02 force 2 ,pdata 
5af6 20405afb call msg_send_lmp 
5af7 18007e10 force 16 ,pdata 
5af8 e7e20005 istore 1 ,contw 
5af9 67e20054 store 1 ,mem_key_size 
5afa 20205b0f branch send_lmp_tid 

msg_send_lmp:
5afb 1fe9fe00 lshift3 pdata ,pdata 
5afc 1fe1fe07 or_into 0x07 ,pdata 
5afd 67e2051a store 1 ,mem_lmo_header_length 
5afe df200011 arg 17 ,loopcnt 
5aff d8a0051c arg mem_lmo_payload ,contw 
5b00 2040776c call clear_mem 
5b01 d8a0051c arg mem_lmo_payload ,contw 
5b02 20600000 rtn 

send_lmpext:
5b03 1fe1227f and pdata ,0x7f ,rega 
5b04 7000487f jam lmp_escape ,mem_lmp_to_send 
5b05 18e27e00 deposit queue 
5b06 20405afb call msg_send_lmp 
5b07 e2220005 istorer rega ,1 ,contw 
5b08 20600000 rtn 

send_lmp_follow:
5b09 6fe20048 fetch 1 ,mem_lmp_to_send 
5b0a 1fe3fe00 lshift pdata ,pdata 
5b0b 6842004c fetcht 1 ,mem_state_map 
5b0c 284ffe01 isolate1 smap_lmptid ,temp 
5b0d 7920fe00 setflag true ,0 ,pdata 
5b0e 20205b19 branch send_lmp_exit 

send_lmp_tid:
5b0f 6842004c fetcht 1 ,mem_state_map 
5b10 18410401 and_into 1 ,temp 
5b11 20205b15 branch send_lmp_end 

send_lmp_reply:
5b12 18000400 force 0 ,temp 
5b13 20205b15 branch send_lmp_end 

send_lmp_request:
5b14 18000401 force 1 ,temp 

send_lmp_end:
5b15 6fe20048 fetch 1 ,mem_lmp_to_send 
5b16 1fe3fe00 lshift pdata ,pdata 
5b17 7934fe00 setflag master ,0 ,pdata 
5b18 9842fe00 ixor temp ,pdata 

send_lmp_exit:
5b19 67e2051b store 1 ,mem_lmo_header_opcode 
5b1a 70004800 jam 0 ,mem_lmp_to_send 
5b1b 20405b23 call lmo_fifo_process_lmo0empty 
5b1c 78347c00 enable user 
5b1d 20600000 rtn 

lmo_fifo_process:
5b1e 6fe20048 fetch 1 ,mem_lmp_to_send 
5b1f 203a5b23 branch lmo_fifo_process_lmo0empty ,blank 
5b20 6fe20078 fetch 1 ,mem_lmo_opcode1 
5b21 247a0000 nrtn blank 
5b22 20205b2d branch lmo_fifo_process_lmo2to1 

lmo_fifo_process_lmo0empty:
5b23 6fe20078 fetch 1 ,mem_lmo_opcode1 
5b24 203a5b33 branch lmo_fifo_process_lmo1_empty ,blank 
5b25 6fe60078 fetch 3 ,mem_lmo_opcode1 
5b26 67e60048 store 3 ,mem_lmp_to_send 
5b27 6842007b fetcht 1 ,mem_lmo_tid1 
5b28 6fe2004c fetch 1 ,mem_state_map 
5b29 793ffe01 set0 smap_lmptid ,pdata 
5b2a 9841fe00 ior temp ,pdata 
5b2b 67e2004c store 1 ,mem_state_map 
5b2c 70007800 jam 0 ,mem_lmo_opcode1 

lmo_fifo_process_lmo2to1:
5b2d 6fe2007c fetch 1 ,mem_lmo_opcode2 
5b2e 207a0000 rtn blank 
5b2f 6fe8007c fetch 4 ,mem_lmo_opcode2 
5b30 67e80078 store 4 ,mem_lmo_opcode1 
5b31 70007c00 jam 0 ,mem_lmo_opcode2 
5b32 20600000 rtn 

lmo_fifo_process_lmo1_empty:
5b33 6fe2007c fetch 1 ,mem_lmo_opcode2 
5b34 207a0000 rtn blank 
5b35 6fe6007c fetch 3 ,mem_lmo_opcode2 
5b36 67e60048 store 3 ,mem_lmp_to_send 
5b37 6842007f fetcht 1 ,mem_lmo_tid2 
5b38 6fe2004c fetch 1 ,mem_state_map 
5b39 793ffe01 set0 smap_lmptid ,pdata 
5b3a 9841fe00 ior temp ,pdata 
5b3b 67e2004c store 1 ,mem_state_map 
5b3c 70007c00 jam 0 ,mem_lmo_opcode2 
5b3d 20600000 rtn 

special_tid_store:
5b3e 6a62004c fetchr regc ,1 ,mem_state_map 
5b3f efe20002 ifetch 1 ,temp 
5b40 20405612 call pop_tid_follow 
5b41 20405b09 call send_lmp_follow 
5b42 6262004c storer regc ,1 ,mem_state_map 
5b43 20600000 rtn 

tid_reply:
5b44 6842004c fetcht 1 ,mem_state_map 
5b45 793f8400 set0 smap_lmptidinit ,temp 
5b46 6042004c storet 1 ,mem_state_map 
5b47 20600000 rtn 

tid_initiate:
5b48 6842004c fetcht 1 ,mem_state_map 
5b49 79200400 set1 smap_lmptidinit ,temp 
5b4a 6042004c storet 1 ,mem_state_map 
5b4b 20600000 rtn 

tid_check:
5b4c 7d34fe01 nsetflag master ,smap_lmptid ,pdata 
5b4d 6842004c fetcht 1 ,mem_state_map 
5b4e 9842fe00 ixor temp ,pdata 
5b4f 2feffe01 isolate1 smap_lmptid ,pdata 
5b50 20600000 rtn 

tid_set_reply:
5b51 6fe2004c fetch 1 ,mem_state_map 
5b52 7934fe01 setflag master ,smap_lmptid ,pdata 
5b53 67e2004c store 1 ,mem_state_map 
5b54 20600000 rtn 

check_localsm:
5b55 6fe20a25 fetch 1 ,mem_sp_localsm 
5b56 2fe0fe01 compare local_statemachine ,pdata ,0x7f 
5b57 20600000 rtn 

setlocalsm_master:
5b58 6fe20a25 fetch 1 ,mem_sp_localsm 
5b59 79207e07 set1 7 ,pdata 
5b5a 67e20a25 store 1 ,mem_sp_localsm 
5b5b 20600000 rtn 

setlocalsm_slave:
5b5c 6fe20a25 fetch 1 ,mem_sp_localsm 
5b5d 793ffe07 set0 7 ,pdata 
5b5e 67e20a25 store 1 ,mem_sp_localsm 
5b5f 20600000 rtn 

check_localsm_master:
5b60 6fe20a25 fetch 1 ,mem_sp_localsm 
5b61 2feffe07 isolate1 7 ,pdata 
5b62 67e20a25 store 1 ,mem_sp_localsm 
5b63 20600000 rtn 

generate_random_number:
5b64 d8a005d3 arg mem_random_number ,contw 

generate_random:
5b65 18007210 force 16 ,loopcnt 

generate_random_another:

generate_random_loop:
5b66 180a7e00 random pdata 
5b67 e7e20005 istore 1 ,contw 
5b68 c2005b66 loop generate_random_another 
5b69 20600000 rtn 

generate_linkkey:
5b6a 20406700 call function_e21 
5b6b da204274 arg mem_link_key ,rega 
5b6c da400603 arg mem_input_store ,regb 
5b6d eff00011 ifetch 8 ,rega 
5b6e 68420030 fetcht 1 ,mem_state 
5b6f 7d3a0406 nsetflag blank ,state_combkey ,temp 
5b70 60420030 storet 1 ,mem_state 
5b71 1a220a00 copy rega ,contw 
5b72 204067f0 call xor16 
5b73 202031eb branch generate_linkkey_continue 

process_conn_sm:
5b74 6fe2007c fetch 1 ,mem_lmo_opcode2 
5b75 203a5b79 branch process_conn_sm_continue ,blank 
5b76 20405b1e call lmo_fifo_process 
5b77 6fe2007c fetch 1 ,mem_lmo_opcode2 
5b78 247a0000 nrtn blank 

process_conn_sm_continue:
5b79 47434030 bpatchx patch30_6 ,mem_patch30 
5b7a 6fe20055 fetch 1 ,mem_reconn_lmp_sm 
5b7b 207a0000 rtn blank 
5b7c c000db9a beq conn_sm_send_features ,host_create_conn_send_features 
5b7d c0015ba6 beq conn_sm_wait_features_res ,host_create_conn_waiting 
5b7e c001db90 beq conn_sm_send_features_ext ,host_creat_conn_send_feat_ext 
5b7f c0025ba6 beq conn_sm_wait_features_ext ,host_create_conn_waiting 
5b80 c002db9d beq conn_sm_send_conn_req ,host_create_conn_send_conn_req 
5b81 c0035ba1 beq conn_sm_wait_conn_accept ,host_create_conn_wait_accept 
5b82 c003dba7 beq conn_sm_send_switch ,host_create_conn_switch 
5b83 c0045b93 beq conn_sm_wait_switch_after_host_connection ,host_creat_conn_wait_switch 
5b84 c004db95 beq conn_sm_send_aurand ,host_auth_remote_dev 
5b85 c0055bb7 beq conn_sm_encrypt ,host_create_conn_encrypt 
5b86 c005dbbf beq conn_sm_encrypt_wait ,host_create_conn_encrypt_wait 
5b87 c0065bc3 beq conn_sm_encrypt_wait_clear ,host_create_conn_encrypt_wait_clear 
5b88 c006dbb0 beq conn_sm_send_setup_complete ,host_create_conn_send_setup_complete 
5b89 c0075bb3 beq conn_sm_wait_setup_complete ,host_create_conn_wait_setup_complete 
5b8a 20203b25 branch assert 
5b8b 20600000 rtn 

host_conn_judge_encrypt:
5b8c 6fe20138 fetch 1 ,mem_connection_options 
5b8d c4008000 rtnbit0 connection_encrypt 
5b8e 7000550b jam conn_sm_encrypt_wait ,mem_reconn_lmp_sm 
5b8f 20600000 rtn 

host_creat_conn_send_feat_ext:
5b90 70005504 jam conn_sm_wait_features_ext ,mem_reconn_lmp_sm 
5b91 70007c83 jam lmp_ext_features_req ,mem_lmo_opcode2 
5b92 20600000 rtn 

host_creat_conn_wait_switch:
5b93 70005509 jam conn_sm_send_aurand ,mem_reconn_lmp_sm 
5b94 20600000 rtn 

host_auth_remote_dev:
5b95 6fe20138 fetch 1 ,mem_connection_options 
5b96 c3005b98 bbit0 connection_auth ,host_sm_done 
5b97 70007c0b jam lmp_au_rand ,mem_lmo_opcode2 

host_sm_done:
5b98 70005500 jam conn_sm_standby ,mem_reconn_lmp_sm 
5b99 20600000 rtn 

host_create_conn_send_features:
5b9a 70005502 jam conn_sm_wait_features_res ,mem_reconn_lmp_sm 
5b9b 70007c27 jam lmp_features_req ,mem_lmo_opcode2 
5b9c 20600000 rtn 

host_create_conn_send_conn_req:
5b9d 70005506 jam conn_sm_wait_conn_accept ,mem_reconn_lmp_sm 
5b9e 793f8022 set0 mark_reconn_recieve_switch ,mark 
5b9f 70007c33 jam lmp_host_connection_req ,mem_lmo_opcode2 
5ba0 20205443 branch init_lmp_reinit 

host_create_conn_wait_accept:
5ba1 2434db98 nbranch host_sm_done ,master 
5ba2 6fe20138 fetch 1 ,mem_connection_options 
5ba3 c3015b93 bbit0 connection_switch ,host_creat_conn_wait_switch 
5ba4 70005507 jam conn_sm_send_switch ,mem_reconn_lmp_sm 
5ba5 20600000 rtn 

host_create_conn_waiting:
5ba6 20600000 rtn 

host_create_conn_switch:
5ba7 6fe20535 fetch 1 ,mem_lmp_conn_state 
5ba8 c4018000 rtnbit0 sent_setup_complete 
5ba9 c4010000 rtnbit0 received_setup_complete 
5baa 6fe20138 fetch 1 ,mem_connection_options 
5bab 793ffe02 set0 connection_switch ,pdata 
5bac 67e20138 store 1 ,mem_connection_options 
5bad 70007c13 jam lmp_switch_req ,mem_lmo_opcode2 
5bae 70005508 jam conn_sm_wait_switch_after_host_connection ,mem_reconn_lmp_sm 
5baf 20600000 rtn 

host_create_conn_send_setup_complete:
5bb0 7000550e jam conn_sm_wait_setup_complete ,mem_reconn_lmp_sm 
5bb1 70007c31 jam lmp_setup_complete ,mem_lmo_opcode2 
5bb2 20600000 rtn 

host_create_conn_wait_setup_complete:
5bb3 6fe20535 fetch 1 ,mem_lmp_conn_state 
5bb4 c4010000 rtnbit0 received_setup_complete 
5bb5 70005500 jam conn_sm_standby ,mem_reconn_lmp_sm 
5bb6 20600000 rtn 

host_create_conn_encrypt:
5bb7 6fe20138 fetch 1 ,mem_connection_options 
5bb8 c280dbba bbit1 connection_encrypt ,host_create_conn_encrypt_start 
5bb9 20600000 rtn 

host_create_conn_encrypt_start:
5bba 6fe20138 fetch 1 ,mem_connection_options 
5bbb 793ffe01 set0 connection_encrypt ,pdata 
5bbc 67e20138 store 1 ,mem_connection_options 
5bbd 70007c0f jam lmp_encryption_mode_req ,mem_lmo_opcode2 
5bbe 20600000 rtn 

host_create_conn_encrypt_wait:
5bbf 6fe2053b fetch 1 ,mem_wait_encryption 
5bc0 207a0000 rtn blank 
5bc1 70005500 jam conn_sm_standby ,mem_reconn_lmp_sm 
5bc2 20205bba branch host_create_conn_encrypt_start 

host_create_conn_encrypt_wait_clear:
5bc3 7000550d jam conn_sm_send_setup_complete ,mem_reconn_lmp_sm 
5bc4 20600000 rtn 

host_auth:
5bc5 6fe2004b fetch 1 ,mem_op 
5bc6 c2815bca bbit1 op_inrand_req ,remote_auth 
5bc7 20405b48 call tid_initiate 
5bc8 70007c08 jam lmp_in_rand ,mem_lmo_opcode2 
5bc9 20204364 branch cmd_exit 

remote_auth:
5bca 6fe2004b fetch 1 ,mem_op 
5bcb 793ffe02 set0 op_inrand_req ,pdata 
5bcc 67e2004b store 1 ,mem_op 
5bcd 204057ea call lmp_accept_inrand 
5bce 20405b51 call tid_set_reply 
5bcf 20204364 branch cmd_exit 

pincode_reinit:
5bd0 58000004 setarg 4 
5bd1 67e246cb store 1 ,mem_pin_length 
5bd2 58003030 setarg 0x3030 
5bd3 e7e40005 istore 2 ,contw 
5bd4 e7e40005 istore 2 ,contw 
5bd5 20600000 rtn 

twspi_reset:
5bd6 20600000 rtn 

twspi_write:
5bd7 20205c9e branch spid_write_reg 

twspi_read:
5bd8 20205ca5 branch spid_read_reg 

read_enc:
5bd9 24345bdc nbranch read_unenc ,user 
5bda 18006c00 force 0 ,aes_ctrl 
5bdb 20205bdd branch read_function 

read_unenc:
5bdc 18006c80 force aes_zero ,aes_ctrl 

read_function:
5bdd 18427c00 copy temp ,null 
5bde 2022dbe0 branch read_fuction_zero ,zero 
5bdf 1a627a00 copy regc ,pc 

read_fuction_zero:
5be0 2fcc0000 isolate0 0 ,null 
5be1 20205c61 branch set_ucode_status 

get_block_header:
5be2 18000404 force 4 ,temp 

get_block_header0:
5be3 da2001f7 arg mem_ucode_buf ,rega 
5be4 20405bdc call read_unenc 
5be5 da2055aa arg 0x55aa ,rega 
5be6 6fe401f7 fetch 2 ,mem_ucode_buf 
5be7 e8440006 ifetcht 2 ,contr 
5be8 9a267c00 isub rega ,null 
5be9 20600000 rtn 

read_first_eep_block:
5bea d8400002 arg 2 ,temp 
5beb da2001f7 arg mem_ucode_buf ,rega 
5bec 20405bdc call read_unenc 
5bed 6fe401f7 fetch 2 ,mem_ucode_buf 
5bee 67e401f0 store 2 ,mem_eep_addr_hi 
5bef 20545bf8 call get_iv ,user 
5bf0 20600000 rtn 

read_first_flash_block:
5bf1 d8400003 arg 3 ,temp 
5bf2 da2001f3 arg mem_spid_rbuf ,rega 
5bf3 20405bdc call read_unenc 
5bf4 6fe601f3 fetch 3 ,mem_spid_rbuf 
5bf5 67e601ef store 3 ,mem_addr_hi 
5bf6 20545bf8 call get_iv ,user 
5bf7 20600000 rtn 

get_iv:
5bf8 d8400010 arg 16 ,temp 
5bf9 da200200 arg mem_ucode_keybuf ,rega 
5bfa 20405bdc call read_unenc 
5bfb d8c00200 arg mem_ucode_keybuf ,contr 
5bfc df200010 arg 16 ,loopcnt 
5bfd 20406910 call aes_load_data 
5bfe 204068bf call do_aes_ecb 
5bff 2020692c branch aes_clear_data 

load_storage:
5c00 7856fc00 disable match 
5c01 20405be2 call get_block_header 
5c02 24628000 nrtn zero 
5c03 7836fc00 enable match 
5c04 70802380 jam 0x80 ,core_ucode_ctrl 
5c05 70802200 jam 0 ,core_ucode_hi 
5c06 70802400 jam 0 ,core_ucode_low 
5c07 da208025 arg core_ucode_data ,rega 
5c08 20405bd9 call read_enc 
5c09 70802300 jam 0x0 ,core_ucode_ctrl 

load_storage_loop:
5c0a d8400006 arg 6 ,temp 
5c0b 20405be3 call get_block_header0 
5c0c 24628000 nrtn zero 
5c0d ea240006 ifetchr rega ,2 ,contr 
5c0e 20405bdc call read_unenc 
5c0f 20205c0a branch load_storage_loop 

reload_eeprom:
5c10 20407867 call clean_mem 
5c11 58001000 setarg 0x1000 
5c12 67e401f0 store 2 ,mem_eep_addr_hi 
5c13 da605d38 arg iicd_read_eep ,regc 
5c14 df200002 arg 2 ,loopcnt 

reload_eeprom_loop:
5c15 20405be2 call get_block_header 
5c16 24628000 nrtn zero 
5c17 6fe401f0 fetch 2 ,mem_eep_addr_hi 
5c18 1ff0fe00 byteswap pdata ,pdata 
5c19 9840fe00 iadd temp ,pdata 
5c1a 1ff0fe00 byteswap pdata ,pdata 
5c1b 67e401f0 store 2 ,mem_eep_addr_hi 
5c1c c2005c15 loop reload_eeprom_loop 
5c1d 20205c0a branch load_storage_loop 

loadcode:
5c1e 70805025 jam 0x25 ,core_clkoff 
5c1f 20407867 call clean_mem 
5c20 20405cb1 call qspi_init_flash 

loadcode_lpm:
5c21 78547c00 disable user 
5c22 20405db8 call otp_enable_chgpump 
5c23 58000000 setarg otp_ucode_flag 
5c24 da2001ec arg mem_otp_ucode_flag ,rega 
5c25 d8400002 arg 2 ,temp 
5c26 20405e01 call otpd_read_data 
5c27 6fe401ec fetch 2 ,mem_otp_ucode_flag 
5c28 c303dc31 bbit0 otp_uflag_aes ,loadcode_otp 
5c29 580007f0 setarg otp_ucode_aeskey 
5c2a da200200 arg mem_ucode_keybuf ,rega 
5c2b d8400010 arg 16 ,temp 
5c2c 20405e01 call otpd_read_data 
5c2d 70800608 jam lock_otp ,core_misc_ctrl 
5c2e d8c00200 arg mem_ucode_keybuf ,contr 
5c2f 2040691e call load_key128 
5c30 78347c00 enable user 

loadcode_otp:
5c31 6fe401ec fetch 2 ,mem_otp_ucode_flag 
5c32 1ff0fe00 byteswap pdata ,pdata 
5c33 d84007ff arg 0x7ff ,temp 
5c34 98417e00 iand temp ,pdata 
5c35 2022dc3a branch loadcode_spi ,zero 
5c36 20405dbd call otp_set_addr 
5c37 da605e06 arg otpd_read_code ,regc 
5c38 20545bf8 call get_iv ,user 
5c39 20405c00 call load_storage 

loadcode_spi:
5c3a 20405dbb call otp_disable_chgpump 
5c3b 6fe201ec fetch 1 ,mem_otp_ucode_flag 
5c3c c282dc43 bbit1 otp_uflag_skip_flash ,loadcode_iic 
5c3d da605cd9 arg qspi_read_flash ,regc 
5c3e 20405bf1 call read_first_flash_block 
5c3f 20405c00 call load_storage 
5c40 2436dc43 nbranch loadcode_iic ,match 
5c41 6fe201eb fetch 1 ,mem_ucode_status 
5c42 c3005c3a bbit0 0 ,loadcode_spi 

loadcode_iic:
5c43 24345c46 nbranch loadcode_noenc ,user 
5c44 18006c00 force 0 ,aes_ctrl 
5c45 70800604 jam set_tea_key ,core_misc_ctrl 

loadcode_noenc:
5c46 6fe201ec fetch 1 ,mem_otp_ucode_flag 
5c47 c2835c54 bbit1 otp_uflag_skip_eep ,loadcode_hci 
5c48 20405d0f call iicd_init_pin 
5c49 20405d23 call clear_eeprom_size_2k 
5c4a 20405c5b call loadcode_iic_by_eeprom 
5c4b 2436dc4f nbranch loadcode_iic_eeprom_2k ,match 
5c4c 6fe201eb fetch 1 ,mem_ucode_status 
5c4d c3005c43 bbit0 0 ,loadcode_iic 
5c4e 20205c54 branch loadcode_hci 

loadcode_iic_eeprom_2k:
5c4f 20405d20 call set_eeprom_size_2k 
5c50 20405c5b call loadcode_iic_by_eeprom 
5c51 2436dc54 nbranch loadcode_hci ,match 
5c52 6fe201eb fetch 1 ,mem_ucode_status 
5c53 c3005c43 bbit0 0 ,loadcode_iic 

loadcode_hci:
5c54 70805021 jam 0x21 ,core_clkoff 
5c55 18007004 force regidx_key ,regext_index 
5c56 2040692d call aes_clear 
5c57 6fe201ec fetch 1 ,mem_otp_ucode_flag 
5c58 c4020000 rtnbit0 otp_uflag_hci 
5c59 20404341 call hci_init 

loadcode_hci_loop:
5c5a 20205c5a branch loadcode_hci_loop 

loadcode_iic_by_eeprom:
5c5b 58000000 setarg 0x0 
5c5c 67e401f0 store 2 ,mem_addr_mi 
5c5d da605d38 arg iicd_read_eep ,regc 
5c5e 20405d01 call iicd_init_20clk 
5c5f 20405bea call read_first_eep_block 
5c60 20205c00 branch load_storage 

set_ucode_status:
5c61 6fe201eb fetch 1 ,mem_ucode_status 
5c62 1fe3fe00 lshift pdata ,pdata 
5c63 7920fe00 setflag true ,0 ,pdata 
5c64 2a2c000f isolate0 15 ,rega 
5c65 20608000 rtn true 
5c66 67e201eb store 1 ,mem_ucode_status 
5c67 20600000 rtn 

decrypt_code:
5c68 2ecffe07 isolate1 7 ,aes_ctrl 
5c69 20608000 rtn true 

decrypt_code_loop:
5c6a 6fe28330 fetch 1 ,core_dma_status 
5c6b afefffff qisolate1 pdata 
5c6c 20608000 rtn true 
5c6d 6fe28308 fetch 1 ,core_misc_status 
5c6e c300dc6a bbit0 1 ,decrypt_code_loop 
5c6f 204068c2 call do_aes_cbc 
5c70 20205c6a branch decrypt_code_loop 

save_ucode:
5c71 1f220400 copy loopcnt ,temp 
5c72 6044424e storet 2 ,mem_patch_len 
5c73 70802380 jam 0x80 ,core_ucode_ctrl 
5c74 70802200 jam 0 ,core_ucode_hi 
5c75 70802400 jam 0 ,core_ucode_low 
5c76 67e4424c store 2 ,mem_patch_ptr 
5c77 98000a00 iforce contw 
5c78 1f2bf200 lshift2 loopcnt ,loopcnt 

save_ucode_loop:
5c79 6fe28025 fetch 1 ,core_ucode_data 
5c7a e7e20005 istore 1 ,contw 
5c7b c2005c79 loop save_ucode_loop 
5c7c 70802300 jam 0x0 ,core_ucode_ctrl 
5c7d 20600000 rtn 

load_ucode:
5c7e 6fe4424c fetch 2 ,mem_patch_ptr 
5c7f 207a0000 rtn blank 
5c80 70802380 jam 0x80 ,core_ucode_ctrl 
5c81 70802200 jam 0 ,core_ucode_hi 
5c82 70802400 jam 0 ,core_ucode_low 
5c83 6844424e fetcht 2 ,mem_patch_len 
5c84 184bf200 lshift2 temp ,loopcnt 
5c85 98000c00 iforce contr 

load_ucode_loop:
5c86 efe20006 ifetch 1 ,contr 
5c87 67e28025 store 1 ,core_ucode_data 
5c88 c2005c86 loop load_ucode_loop 
5c89 70802300 jam 0x0 ,core_ucode_ctrl 
5c8a 20600000 rtn 

spid_init:
5c8b 47454031 bpatchx patch31_2 ,mem_patch31 
5c8c 7080ba75 jam 0x75 ,core_spid_ctrl 
5c8d 7080bb0a jam 10 ,core_spid_delay 
5c8e 58000222 setarg mem_spid_tbuf 
5c8f 67e480be store 2 ,core_spid_txaddr 
5c90 580001f3 setarg mem_spid_rbuf 
5c91 67e480c0 store 2 ,core_spid_rxaddr 
5c92 6fe242d0 fetch 1 ,mem_spid_sclkpin 
5c93 d8400021 arg gpcfg_spid_sck ,temp 
5c94 20405ebd call gpio_config_function 
5c95 6fe242d1 fetch 1 ,mem_spid_sdiopin 
5c96 d8400023 arg gpcfg_spid_sdio ,temp 
5c97 20205ebd branch gpio_config_function 

spid_reset:
5c98 6fe280ba fetch 1 ,core_spid_ctrl 
5c99 79207e07 set1 7 ,pdata 
5c9a 67e280ba store 1 ,core_spid_ctrl 
5c9b 793ffe07 set0 7 ,pdata 
5c9c 67e280ba store 1 ,core_spid_ctrl 
5c9d 20600000 rtn 

spid_write_reg:
5c9e 79207e07 set1 7 ,pdata 
5c9f 67e40222 store 2 ,mem_spid_tbuf 
5ca0 4745c031 bpatchx patch31_3 ,mem_patch31 
5ca1 7080bc02 jam 2 ,core_spid_txlen 
5ca2 7080c200 jam 0 ,core_spid_rxlen 
5ca3 70800a02 jam spid_start ,core_dma_start 
5ca4 20205cae branch wait_spid_done 

spid_read_reg:
5ca5 18000401 force 1 ,temp 

spid_read_regs:
5ca6 67e20222 store 1 ,mem_spid_tbuf 
5ca7 47464031 bpatchx patch31_4 ,mem_patch31 
5ca8 7080bc01 jam 1 ,core_spid_txlen 
5ca9 604480c2 storet 2 ,core_spid_rxlen 
5caa 70800a02 jam spid_start ,core_dma_start 
5cab 20405cae call wait_spid_done 
5cac 6fe201f3 fetch 1 ,mem_spid_rbuf 
5cad 20600000 rtn 

wait_spid_done:
5cae 6fe28330 fetch 1 ,core_dma_status 
5caf c3035cae bbit0 spid_done ,wait_spid_done 
5cb0 20600000 rtn 

qspi_init_flash:
5cb1 58000000 setarg 0x0 
5cb2 67e601ef store 3 ,mem_addr_hi 
5cb3 7080a108 jam 8 ,core_qspi_delay 
5cb4 7080a001 jam 1 ,core_qspi_ctrl 
5cb5 58001706 setarg qspi_io2_pin | gpcfg_qspi_io2 
5cb6 20405eba call gpio_config_param 
5cb7 58001805 setarg qspi_io1_pin | gpcfg_qspi_io1 
5cb8 20405eba call gpio_config_param 
5cb9 58001902 setarg qspi_ncs_pin | gpcfg_qspi_ncs 
5cba 20405eba call gpio_config_param 
5cbb 58001a07 setarg qspi_io3_pin | gpcfg_qspi_io3 
5cbc 20405eba call gpio_config_param 
5cbd 58001b03 setarg qspi_sck_pin | gpcfg_qspi_sck 
5cbe 20405eba call gpio_config_param 
5cbf 58001c04 setarg qspi_io0_pin | gpcfg_qspi_io0 
5cc0 20205eba branch gpio_config_param 

qspi_unlock_flash:
5cc1 58000000 setarg 0 
5cc2 67e480a8 store 2 ,core_qspi_rxlen 
5cc3 58000001 setarg 1 
5cc4 67e480a2 store 2 ,core_qspi_txlen 
5cc5 580001ee setarg mem_qspi_tbuf 
5cc6 67e480a4 store 2 ,core_qspi_txaddr 
5cc7 7001ee06 jam 6 ,mem_qspi_tbuf 
5cc8 70800a08 jam qspi_start ,core_dma_start 
5cc9 20205cfe branch wait_qspi_done 

qspi_write_flash:
5cca 18408404 increase 4 ,temp 
5ccb 604480a2 storet 2 ,core_qspi_txlen 
5ccc 1a20a3fc increase -4 ,rega 
5ccd d8400002 arg 2 ,temp 
5cce e0420011 istoret 1 ,rega 
5ccf 1ff10400 rshift16 pdata ,temp 
5cd0 e0420005 istoret 1 ,contw 
5cd1 1fec8400 rshift8 pdata ,temp 
5cd2 e0420005 istoret 1 ,contw 
5cd3 e7e20005 istore 1 ,contw 
5cd4 622480a4 storer rega ,2 ,core_qspi_txaddr 
5cd5 58000000 setarg 0 
5cd6 67e480a8 store 2 ,core_qspi_rxlen 
5cd7 70800a08 jam qspi_start ,core_dma_start 
5cd8 20205cfe branch wait_qspi_done 

qspi_read_flash:
5cd9 7001ee3b jam 0x3b ,mem_qspi_tbuf 
5cda 58000004 setarg 4 
5cdb 67e480a2 store 2 ,core_qspi_txlen 

qspi_read_flash_raw:
5cdc 604480a8 storet 2 ,core_qspi_rxlen 
5cdd 580001ee setarg mem_qspi_tbuf 
5cde 67e480a4 store 2 ,core_qspi_txaddr 
5cdf 622480a6 storer rega ,2 ,core_qspi_rxaddr 
5ce0 6fe280a0 fetch 1 ,core_qspi_ctrl 
5ce1 2a2c000f isolate0 15 ,rega 
5ce2 7920fe02 setflag true ,2 ,pdata 
5ce3 67e280a0 store 1 ,core_qspi_ctrl 
5ce4 70800a08 jam qspi_start ,core_dma_start 
5ce5 2ecffe07 isolate1 7 ,aes_ctrl 
5ce6 2020dcef branch qspi_no_decryption ,true 

qspi_read_flash_wait:
5ce7 6fe28330 fetch 1 ,core_dma_status 
5ce8 c283dce7 bbit1 qspi_rw ,qspi_read_flash_wait 
5ce9 d8e00003 arg qspi_done ,queue 
5cea 1851f200 rshift4 temp ,loopcnt 

qspi_decryption_loop:
5ceb 18006c41 force aes_cbc | aes_load ,aes_ctrl 
5cec 18006c01 force aes_cbc ,aes_ctrl 
5ced 204068b7 call wait_aes 
5cee c2005ceb loop qspi_decryption_loop 

qspi_no_decryption:
5cef 20405cfe call wait_qspi_done 
5cf0 2feffe02 isolate1 qspi_crcok ,pdata 
5cf1 20405c61 call set_ucode_status 
5cf2 6fe201ef fetch 1 ,mem_addr_hi 
5cf3 1ff02400 lshift16 pdata ,regb 
5cf4 6fe401f0 fetch 2 ,mem_addr_mi 
5cf5 1ff0fe00 byteswap pdata ,pdata 
5cf6 9a41fe00 ior regb ,pdata 
5cf7 9840fe00 iadd temp ,pdata 
5cf8 67e201f1 store 1 ,mem_addr_lo 
5cf9 1fecfe00 rshift8 pdata ,pdata 
5cfa 67e201f0 store 1 ,mem_addr_mi 
5cfb 1fecfe00 rshift8 pdata ,pdata 
5cfc 67e201ef store 1 ,mem_addr_hi 
5cfd 20600000 rtn 

wait_qspi_done:
5cfe 6fe28330 fetch 1 ,core_dma_status 
5cff c301dcfe bbit0 qspi_done ,wait_qspi_done 
5d00 20600000 rtn 

iicd_init_20clk:
5d01 7080ab05 jam 5 ,core_iicd_scl_low 
5d02 7080ac07 jam 7 ,core_iicd_scl_high 
5d03 7080ad07 jam 7 ,core_iicd_start_setup 
5d04 7080ae07 jam 7 ,core_iicd_start_hold 
5d05 7080af07 jam 7 ,core_iicd_stop_setup 
5d06 7080b005 jam 5 ,core_iicd_data_setup 
5d07 20600000 rtn 

iicd_init_30clk:
5d08 7080ab0a jam 10 ,core_iicd_scl_low 
5d09 7080ac0c jam 12 ,core_iicd_scl_high 
5d0a 7080ad0c jam 12 ,core_iicd_start_setup 
5d0b 7080ae0c jam 12 ,core_iicd_start_hold 
5d0c 7080af0c jam 12 ,core_iicd_stop_setup 
5d0d 7080b00a jam 10 ,core_iicd_data_setup 
5d0e 20600000 rtn 

iicd_init_pin:
5d0f 58001d2d setarg iic_sda_pin | gpcfg_iic_sda 
5d10 20405eba call gpio_config_param 
5d11 58001e2c setarg iic_scl_pin | gpcfg_iic_scl 
5d12 20205eba branch gpio_config_param 

wait_iicd_done:
5d13 6fe28330 fetch 1 ,core_dma_status 
5d14 c302dd13 bbit0 iicd_done ,wait_iicd_done 
5d15 20600000 rtn 

iicd_read_data:
5d16 67e201ef store 1 ,mem_iicd_tbuf 
5d17 580001ef setarg mem_iicd_tbuf 
5d18 67e480b4 store 2 ,core_iicd_txaddr 
5d19 58000001 setarg 1 
5d1a 67e480b2 store 2 ,core_iicd_txlen 
5d1b 604480b8 storet 2 ,core_iicd_rxlen 
5d1c 622480b6 storer rega ,2 ,core_iicd_rxaddr 
5d1d 7080aa01 jam 1 ,core_iicd_ctrl 
5d1e 70800a04 jam iicd_start ,core_dma_start 
5d1f 20205d13 branch wait_iicd_done 

set_eeprom_size_2k:
5d20 79200028 set1 mark_eeprom_size ,mark 
5d21 7042d508 jam 0x08 ,mem_eeprom_block_size 
5d22 20600000 rtn 

clear_eeprom_size_2k:
5d23 793f8028 set0 mark_eeprom_size ,mark 
5d24 7042d520 jam 0x20 ,mem_eeprom_block_size 
5d25 20600000 rtn 

iicd_read_eep_data_size_2k:
5d26 6fe242d2 fetch 1 ,mem_ef_base 
5d27 9a40fe00 iadd regb ,pdata 
5d28 67e201f0 store 1 ,mem_addr_mi 
5d29 20205d2d branch iicd_read_eep_size_2k 

iicd_read_eep_size_2k_loadcode:
5d2a 6fe401f0 fetch 2 ,mem_addr_mi 
5d2b 1ff0fe00 byteswap pdata ,pdata 
5d2c 67e201f0 store 1 ,mem_addr_mi 

iicd_read_eep_size_2k:
5d2d 58000003 setarg 3 
5d2e 67e480b2 store 2 ,core_iicd_txlen 
5d2f 7001efa0 jam 0xa0 ,mem_iicd_tbuf 
5d30 7001f1a1 jam 0xa1 ,mem_iicd_tbuf + 2 
5d31 20205d3e branch iicd_read_eep_common 

iicd_read_eep_data:
5d32 4746c031 bpatchx patch31_5 ,mem_patch31 
5d33 c5145d26 bmark1 mark_eeprom_size ,iicd_read_eep_data_size_2k 
5d34 6fe442d2 fetch 2 ,mem_ef_base 
5d35 9a40fe00 iadd regb ,pdata 
5d36 1ff0fe00 byteswap pdata ,pdata 
5d37 67e401f0 store 2 ,mem_eep_addr_hi 

iicd_read_eep:
5d38 47474031 bpatchx patch31_6 ,mem_patch31 
5d39 c5145d2a bmark1 mark_eeprom_size ,iicd_read_eep_size_2k_loadcode 
5d3a 58000004 setarg 4 
5d3b 67e480b2 store 2 ,core_iicd_txlen 
5d3c 7001efa0 jam 0xa0 ,mem_iicd_tbuf 
5d3d 7001f2a1 jam 0xa1 ,mem_iicd_tbuf + 3 

iicd_read_eep_common:
5d3e 580001ef setarg mem_iicd_tbuf 
5d3f 67e480b4 store 2 ,core_iicd_txaddr 
5d40 604480b8 storet 2 ,core_iicd_rxlen 
5d41 622480b6 storer rega ,2 ,core_iicd_rxaddr 
5d42 58000002 setarg 2 
5d43 2a2c000f isolate0 15 ,rega 
5d44 7920fe00 setflag true ,0 ,pdata 
5d45 67e280aa store 1 ,core_iicd_ctrl 
5d46 70800a04 jam iicd_start ,core_dma_start 
5d47 d8e00005 arg iicd_done ,queue 
5d48 20405c68 call decrypt_code 
5d49 20405d13 call wait_iicd_done 
5d4a 2feffe04 isolate1 iicd_crcok ,pdata 
5d4b 20405c61 call set_ucode_status 
5d4c c5145d53 bmark1 mark_eeprom_size ,iicd_read_eep_load_code_size_2k 
5d4d 6fe401f0 fetch 2 ,mem_eep_addr_hi 
5d4e 1ff0fe00 byteswap pdata ,pdata 
5d4f 9840fe00 iadd temp ,pdata 
5d50 1ff0fe00 byteswap pdata ,pdata 
5d51 67e401f0 store 2 ,mem_eep_addr_hi 
5d52 20600000 rtn 

iicd_read_eep_load_code_size_2k:
5d53 6fe201f0 fetch 1 ,mem_addr_mi 
5d54 9840fe00 iadd temp ,pdata 
5d55 1ff0fe00 byteswap pdata ,pdata 
5d56 67e401f0 store 2 ,mem_addr_mi 
5d57 20600000 rtn 

iicd_write_eep_data:
5d58 4747c031 bpatchx patch31_7 ,mem_patch31 
5d59 6fe442d2 fetch 2 ,mem_ef_base 
5d5a 9a40fe00 iadd regb ,pdata 

iicd_write_ota_data:
5d5b 67e40122 store 2 ,mem_pdatatemp 
5d5c 47484032 bpatchx patch32_0 ,mem_patch32 
5d5d 60440b0d storet 2 ,mem_temp 
5d5e 62240b25 storer rega ,2 ,mem_contr 

iicd_write_eep_loop:
5d5f 20405d6e call iicd_eep_transparency 
5d60 68440b1d fetcht 2 ,mem_regb 
5d61 6a240b25 fetchr rega ,2 ,mem_contr 
5d62 6fe40122 fetch 2 ,mem_pdatatemp 
5d63 20405d8e call iicd_write_eep 
5d64 6fe40b1d fetch 2 ,mem_regb 
5d65 68440b25 fetcht 2 ,mem_contr 
5d66 98408400 iadd temp ,temp 
5d67 60440b25 storet 2 ,mem_contr 
5d68 68440122 fetcht 2 ,mem_pdatatemp 
5d69 98408400 iadd temp ,temp 
5d6a 60440122 storet 2 ,mem_pdatatemp 
5d6b 6fe40b0d fetch 2 ,mem_temp 
5d6c 243a5d5f nbranch iicd_write_eep_loop ,blank 
5d6d 20600000 rtn 

iicd_eep_transparency:
5d6e 4748c032 bpatchx patch32_1 ,mem_patch32 
5d6f 6fe442d5 fetch 2 ,mem_eeprom_block_size 
5d70 1fe0ffff increase -1 ,pdata 
5d71 68440122 fetcht 2 ,mem_pdatatemp 
5d72 9841fe00 ior temp ,pdata 
5d73 1fe0fe01 increase 1 ,pdata 
5d74 67e60b21 store 3 ,mem_regc 
5d75 6fe40b0d fetch 2 ,mem_temp 
5d76 9840fe00 iadd temp ,pdata 
5d77 68460b21 fetcht 3 ,mem_regc 
5d78 98467e00 isub temp ,pdata 
5d79 24215d80 nbranch iicd_eep_deal_short_packet ,positive 
5d7a 67e40b0d store 2 ,mem_temp 
5d7b 6fe60b21 fetch 3 ,mem_regc 
5d7c 68440122 fetcht 2 ,mem_pdatatemp 
5d7d 98467e00 isub temp ,pdata 
5d7e 67e40b1d store 2 ,mem_regb 
5d7f 20600000 rtn 

iicd_eep_deal_short_packet:
5d80 6fe40b0d fetch 2 ,mem_temp 
5d81 67e40b1d store 2 ,mem_regb 
5d82 58000000 setarg 0 
5d83 67e40b0d store 2 ,mem_temp 
5d84 20600000 rtn 

iicd_write_eep_size_2k:
5d85 18408402 increase 2 ,temp 
5d86 604480b2 storet 2 ,core_iicd_txlen 
5d87 1a20a3fe increase -2 ,rega 
5d88 e8460011 ifetcht 3 ,rega 
5d89 18422400 copy temp ,regb 
5d8a d84000a0 arg 0xa0 ,temp 
5d8b e0420011 istoret 1 ,rega 
5d8c e7e20005 istore 1 ,contw 
5d8d 20205d9b branch iicd_write_eep_common 

iicd_write_eep:
5d8e 1fe22400 copy pdata ,regb 
5d8f 47494032 bpatchx patch32_2 ,mem_patch32 
5d90 c5145d85 bmark1 mark_eeprom_size ,iicd_write_eep_size_2k 
5d91 1a427e00 copy regb ,pdata 
5d92 18408403 increase 3 ,temp 
5d93 604480b2 storet 2 ,core_iicd_txlen 
5d94 1a20a3fd increase -3 ,rega 
5d95 e8460011 ifetcht 3 ,rega 
5d96 18422400 copy temp ,regb 
5d97 d84000a0 arg 0xa0 ,temp 
5d98 e0420011 istoret 1 ,rega 
5d99 1ff0fe00 byteswap pdata ,pdata 
5d9a e7e40005 istore 2 ,contw 

iicd_write_eep_common:
5d9b 622480b4 storer rega ,2 ,core_iicd_txaddr 
5d9c 58000000 setarg 0 
5d9d 67e480b8 store 2 ,core_iicd_rxlen 
5d9e 7080aa01 jam 1 ,core_iicd_ctrl 
5d9f 70800a04 jam iicd_start ,core_dma_start 
5da0 20405d13 call wait_iicd_done 
5da1 e2460011 istorer regb ,3 ,rega 

iic_check_eeprom_standby:
5da2 7001f200 jam 0 ,mem_iicd_tbuf + 3 

iic_check_eeprom_standby_wait:
5da3 58000001 setarg 1 
5da4 67e480b2 store 2 ,core_iicd_txlen 
5da5 7001efa0 jam 0xa0 ,mem_iicd_tbuf 
5da6 580001ef setarg mem_iicd_tbuf 
5da7 67e480b4 store 2 ,core_iicd_txaddr 
5da8 58000000 setarg 0 
5da9 67e480b8 store 2 ,core_iicd_rxlen 
5daa 67e480b6 store 2 ,core_iicd_rxaddr 
5dab 58000003 setarg 3 
5dac 67e280aa store 1 ,core_iicd_ctrl 
5dad 70800a04 jam iicd_start ,core_dma_start 
5dae 20405d13 call wait_iicd_done 
5daf 6fe28331 fetch 1 ,core_perf_status 
5db0 c4018000 rtnbit0 iicd_ack 
5db1 200005dc nop 1500 
5db2 6fe201f2 fetch 1 ,mem_iicd_tbuf + 3 
5db3 1fe0fe01 increase 1 ,pdata 
5db4 67e201f2 store 1 ,mem_iicd_tbuf + 3 
5db5 1fe67c28 sub pdata ,40 ,null 
5db6 24610000 nrtn positive 
5db7 20205da3 branch iic_check_eeprom_standby_wait 

otp_enable_chgpump:
5db8 70897370 jam 0x70 ,rfen_chgpump 
5db9 20000bb8 nop param_chgpump_delay 
5dba 20600000 rtn 

otp_disable_chgpump:
5dbb 70897330 jam 0x30 ,rfen_chgpump 
5dbc 20600000 rtn 

otp_set_addr:
5dbd 1fe9fe00 lshift3 pdata ,pdata 
5dbe 67e48044 store 2 ,core_otp_addr 
5dbf 70804600 jam 0 ,core_otp_din 
5dc0 20600000 rtn 

otp_write:
5dc1 20405dbd call otp_set_addr 
5dc2 20405dee call otp_ce 

otp_program:
5dc3 e8420011 ifetcht 1 ,rega 
5dc4 1a20a201 increase 1 ,rega 
5dc5 18000e00 force 0 ,queue 

otp_program_bit:
5dc6 a84c0000 qisolate0 temp 
5dc7 2020dde5 branch otp_skip_0 ,true 
5dc8 6fe28046 fetch 1 ,core_otp_din 
5dc9 79207e06 set1 6 ,pdata 
5dca 79207e07 set1 7 ,pdata 
5dcb 67e28046 store 1 ,core_otp_din 
5dcc 70804702 jam 0x02 ,core_otp_ctrl 
5dcd 70804782 jam 0x82 ,core_otp_ctrl 
5dce 793ffe07 set0 7 ,pdata 
5dcf 67e28046 store 1 ,core_otp_din 
5dd0 7080478a jam 0x8a ,core_otp_ctrl 
5dd1 2000000b nop 11 
5dd2 708047ca jam 0xca ,core_otp_ctrl 
5dd3 20000021 nop 33 
5dd4 7080474a jam 0x4a ,core_otp_ctrl 
5dd5 2000002c nop 44 
5dd6 708047ca jam 0xca ,core_otp_ctrl 
5dd7 20000016 nop 22 
5dd8 7080478a jam 0x8a ,core_otp_ctrl 
5dd9 20000021 nop 33 
5dda 70804782 jam 0x82 ,core_otp_ctrl 
5ddb 20000001 nop 1 
5ddc 70804792 jam 0x92 ,core_otp_ctrl 
5ddd 2000000a nop 10 
5dde 708047b2 jam 0xb2 ,core_otp_ctrl 
5ddf 6fe28007 fetch 1 ,core_otp_rdata 
5de0 70804792 jam 0x92 ,core_otp_ctrl 
5de1 20000001 nop 1 
5de2 70804782 jam 0x82 ,core_otp_ctrl 
5de3 afec0000 qisolate0 pdata 
5de4 2020ddc6 branch otp_program_bit ,true 

otp_skip_0:
5de5 6fe48044 fetch 2 ,core_otp_addr 
5de6 1fe0fe01 increase 1 ,pdata 
5de7 67e48044 store 2 ,core_otp_addr 
5de8 18e08e01 increase 1 ,queue 
5de9 28e01e08 compare 8 ,queue ,0xf 
5dea 2420ddc6 nbranch otp_program_bit ,true 
5deb c2005dc3 loop otp_program 
5dec 70804783 jam 0x83 ,core_otp_ctrl 
5ded 20600000 rtn 

otp_ce:
5dee 70804782 jam 0x82 ,core_otp_ctrl 
5def 2000000c nop 12 
5df0 70804780 jam 0x80 ,core_otp_ctrl 
5df1 70804782 jam 0x82 ,core_otp_ctrl 
5df2 20000096 nop 150 
5df3 20600000 rtn 

otpd_read_init:
5df4 20405dee call otp_ce 
5df5 708047a2 jam 0xa2 ,core_otp_ctrl 
5df6 62248048 storer rega ,2 ,core_otpd_rxaddr 
5df7 6044804a storet 2 ,core_otpd_rxlen 
5df8 d8400001 arg 1 ,temp 
5df9 2a2c000f isolate0 15 ,rega 
5dfa 79208404 setflag true ,4 ,temp 
5dfb 60428046 storet 1 ,core_otp_din 
5dfc 70800a01 jam otpd_start ,core_dma_start 
5dfd 20600000 rtn 

otpd_wait_end:
5dfe 6fe28330 fetch 1 ,core_dma_status 
5dff c300ddfe bbit0 otpd_done ,otpd_wait_end 
5e00 20600000 rtn 

otpd_read_data:
5e01 20405dbd call otp_set_addr 
5e02 20405df4 call otpd_read_init 
5e03 20405dfe call otpd_wait_end 
5e04 70804783 jam 0x83 ,core_otp_ctrl 
5e05 20600000 rtn 

otpd_read_code:
5e06 6fe4832e fetch 2 ,core_current_otp_addr 
5e07 67e48044 store 2 ,core_otp_addr 
5e08 20405df4 call otpd_read_init 
5e09 d8e00001 arg otpd_done ,queue 
5e0a 20405c68 call decrypt_code 
5e0b 20405dfe call otpd_wait_end 
5e0c 2feffe00 isolate1 otpd_crcok ,pdata 
5e0d 20405c61 call set_ucode_status 
5e0e 70804783 jam 0x83 ,core_otp_ctrl 
5e0f 20600000 rtn 

uartd_rx_cnt_got_first_byte:
5e10 70428c01 jam 1 ,mem_uartd_rxitems_got_data 
5e11 18000e0e force uart_rx_timer ,queue 
5e12 6fe4428e fetch 2 ,mem_uartd_rx_timeout 
5e13 202077a6 branch timer_init 

uartd_rx_cnt_with_threshold:
5e14 6fe48312 fetch 2 ,core_uart_rx_items 
5e15 207a0000 rtn blank 
5e16 6842428d fetcht 1 ,mem_uartd_rxitems_threshold 
5e17 98467c00 isub temp ,null 
5e18 20215e20 branch uartd_rx_cnt_rtn_value ,positive 
5e19 6fe2428c fetch 1 ,mem_uartd_rxitems_got_data 
5e1a 203a5e10 branch uartd_rx_cnt_got_first_byte ,blank 
5e1b d8e0000e arg uart_rx_timer ,queue 
5e1c 204077ad call timer_check 
5e1d 203a5e20 branch uartd_rx_cnt_rtn_value ,blank 
5e1e 58000000 setarg 0 
5e1f 20600000 rtn 

uartd_rx_cnt_rtn_value:
5e20 18000e0e force uart_rx_timer ,queue 
5e21 204077a5 call timer_stop 
5e22 70428c00 jam 0 ,mem_uartd_rxitems_got_data 
5e23 6fe48312 fetch 2 ,core_uart_rx_items 
5e24 20600000 rtn 

uartd_prepare_tx:
5e25 6944805e fetchr contwu ,2 ,core_uart_tx_wptr 
5e26 20600000 rtn 

uartd_send:
5e27 6144805e storer contwu ,2 ,core_uart_tx_wptr 
5e28 20600000 rtn 

uartd_prepare_rx:
5e29 6fe48312 fetch 2 ,core_uart_rx_items 
5e2a 207a0000 rtn blank 
5e2b 98007200 iforce loopcnt 
5e2c 68648058 fetchr contru ,2 ,core_uart_rx_rptr 
5e2d 20600000 rtn 

uartd_rxdone_by_len:
5e2e 6fe48058 fetch 2 ,core_uart_rx_rptr 
5e2f 9840fe00 iadd temp ,pdata 
5e30 1fe20600 copy pdata ,contru 

uartd_rxdone:
5e31 60648058 storer contru ,2 ,core_uart_rx_rptr 
5e32 20600000 rtn 

uart_set_baud_by_mem:
5e33 6fe442f2 fetch uart_baud_len ,mem_baud 
5e34 67e48052 store uart_baud_len ,core_uart_baud 
5e35 20600000 rtn 

init_filter_ram:
5e36 d8a08800 arg 0x8800 ,contw 
5e37 df200020 arg 0x20 ,loopcnt 
5e38 2040775e call memset0 
5e39 580004f9 setarg 0x4f9 
5e3a 67e48848 store 2 ,0x8848 
5e3b 67e4884a store 2 ,0x884a 
5e3c 67e4884c store 2 ,0x884c 
5e3d 67e4886c store 2 ,0x886c 
5e3e 67e4888c store 2 ,0x888c 
5e3f 67e488ac store 2 ,0x88ac 
5e40 58000204 setarg 0x204 
5e41 67e488ae store 2 ,0x88ae 
5e42 58000506 setarg 0x0506 
5e43 67e488b0 store 2 ,0x88b0 
5e44 58000504 setarg 0x0504 
5e45 67e488b2 store 2 ,0x88b2 
5e46 58000200 setarg 0x0200 
5e47 67e488b4 store 2 ,0x88b4 
5e48 5800fefb setarg 0xFEFB 
5e49 67e488b6 store 2 ,0x88b6 
5e4a 5800faf9 setarg 0xFAF9 
5e4b 67e488b8 store 2 ,0x88b8 
5e4c 5800fafb setarg 0xFAFB 
5e4d 67e488ba store 2 ,0x88ba 
5e4e 5800fd00 setarg 0xFD00 
5e4f 67e488bc store 2 ,0x88bc 
5e50 58000408 setarg 0x0408 
5e51 67e488be store 2 ,0x88be 
5e52 58000a0c setarg 0x0A0C 
5e53 67e488c0 store 2 ,0x88c0 
5e54 58000b09 setarg 0x0B09 
5e55 67e488c2 store 2 ,0x88c2 
5e56 58000500 setarg 0x0500 
5e57 67e488c4 store 2 ,0x88c4 
5e58 5800f8f1 setarg 0xF8F1 
5e59 67e488c6 store 2 ,0x88c6 
5e5a 5800ece8 setarg 0xECE8 
5e5b 67e488c8 store 2 ,0x88c8 
5e5c 5800e9eb setarg 0xE9EB 
5e5d 67e488ca store 2 ,0x88ca 
5e5e 5800f500 setarg 0xF500 
5e5f 67e488cc store 2 ,0x88cc 
5e60 58001223 setarg 0x1223 
5e61 67e488ce store 2 ,0x88ce 
5e62 5800374b setarg 0x374B 
5e63 67e488d0 store 2 ,0x88d0 
5e64 58005e71 setarg 0x5E71 
5e65 67e488d2 store 2 ,0x88d2 
5e66 5800787f setarg 0x787F 
5e67 67e488d4 store 2 ,0x88d4 
5e68 20600000 rtn 

gpio_set_wake_by_current_state:
5e69 79200407 set1 gpio_active_bit ,temp 
5e6a 20405e8b call gpio_get_bit 
5e6b 7d208407 nsetflag true ,gpio_active_bit ,temp 

gpio_set_wake:
5e6c 284ffe05 isolate1 5 ,temp 
5e6d 20608000 rtn true 
5e6e 284c0007 isolate0 gpio_active_bit ,temp 
5e6f 18410e1f and temp ,0x1f ,queue 
5e70 6fe800ab fetch 4 ,mem_gpio_wakeup_low 
5e71 f920fe00 qsetflag true ,pdata 
5e72 67e800ab store 4 ,mem_gpio_wakeup_low 
5e73 6fe800af fetch 4 ,mem_gpio_wakeup_high 
5e74 fd20fe00 nqsetflag true ,pdata 
5e75 67e800af store 4 ,mem_gpio_wakeup_high 
5e76 20600000 rtn 

gpio_clr_wake:
5e77 284ffe05 isolate1 5 ,temp 
5e78 20608000 rtn true 
5e79 284c0007 isolate0 gpio_active_bit ,temp 
5e7a 18410e1f and temp ,0x1f ,queue 
5e7b 6fe800ab fetch 4 ,mem_gpio_wakeup_low 
5e7c f93ffe00 qset0 pdata 
5e7d 67e800ab store 4 ,mem_gpio_wakeup_low 
5e7e 6fe800af fetch 4 ,mem_gpio_wakeup_high 
5e7f f93ffe00 qset0 pdata 
5e80 67e800af store 4 ,mem_gpio_wakeup_high 
5e81 20600000 rtn 

gpio_config_input_nowake:
5e82 20405e77 call gpio_clr_wake 
5e83 20205e85 branch gpio_config_input_without_wake 

gpio_config_input:
5e84 2455de6c ncall gpio_set_wake ,wake 

gpio_config_input_without_wake:
5e85 20405eb6 call gpio_addr 
5e86 58000000 setarg 0 
5e87 284ffe07 isolate1 gpio_active_bit ,temp 
5e88 7d20fe06 nsetflag true ,6 ,pdata 
5e89 7920fe07 setflag true ,7 ,pdata 
5e8a 20205eab branch gpio_write 

gpio_get_bit:
5e8b d8a0831c arg core_gpio_in ,contw 
5e8c 18410e07 and temp ,0x07 ,queue 
5e8d 18497e00 rshift3 temp ,pdata 
5e8e 1fe17e07 and_into 7 ,pdata 
5e8f 98a08a00 iadd contw ,contw 
5e90 efe20005 ifetch 1 ,contw 
5e91 284ffe07 isolate1 gpio_active_bit ,temp 
5e92 2020de95 branch gpio_get_bit_reverse ,true 
5e93 afec0000 qisolate0 pdata 
5e94 20600000 rtn 

gpio_get_bit_reverse:
5e95 afefffff qisolate1 pdata 
5e96 20600000 rtn 

gpio_out_inactive:
5e97 2fcffe07 isolate1 7 ,null 
5e98 20205e9a branch gpio_out_flag 

gpio_out_active:
5e99 2fcc0007 isolate0 7 ,null 

gpio_out_flag:
5e9a 58000000 setarg 0 
5e9b 7d20fe07 nsetflag true ,gpio_active_bit ,pdata 
5e9c 98428400 ixor temp ,temp 

gpio_out:
5e9d 20405eb6 call gpio_addr 
5e9e 5800003f setarg 0x3f 
5e9f 284ffe07 isolate1 gpio_active_bit ,temp 
5ea0 7920fe00 setflag true ,0 ,pdata 
5ea1 20205eab branch gpio_write 

gpio_check_active:
5ea2 20405eb6 call gpio_addr 
5ea3 efe20005 ifetch 1 ,contw 
5ea4 c2805ea7 bbit1 0 ,gpio_check_active_high 
5ea5 284c0007 isolate0 gpio_active_bit ,temp 
5ea6 20600000 rtn 

gpio_check_active_high:
5ea7 284c0007 isolate0 gpio_active_bit ,temp 
5ea8 20600000 rtn 

gpio_set_analog:
5ea9 20405eb6 call gpio_addr 
5eaa 580000c0 setarg gpcfg_no_ie 

gpio_write:
5eab e7e20005 istore 1 ,contw 
5eac 20600000 rtn 

gpio_pd_idle:
5ead d8c08080 arg core_gpio_conf ,contr 
5eae df200028 arg 40 ,loopcnt 

gpio_pd_idle_loop:
5eaf efe20006 ifetch 1 ,contr 
5eb0 243a5eb4 nbranch gpio_pd_idle_configured ,blank 
5eb1 58000080 setarg 0x80 
5eb2 18c08bff add contr ,-1 ,contw 
5eb3 e7e20005 istore 1 ,contw 

gpio_pd_idle_configured:
5eb4 c2005eaf loop gpio_pd_idle_loop 
5eb5 20600000 rtn 

gpio_addr:
5eb6 18417e3f and temp ,0x3f ,pdata 
5eb7 d8a08080 arg core_gpio_conf ,contw 
5eb8 98a08a00 iadd contw ,contw 
5eb9 20600000 rtn 

gpio_config_param:
5eba 1fe104ff and pdata ,0xff ,temp 
5ebb 1fecfe00 rshift8 pdata ,pdata 
5ebc 20205ebe branch gpio_config_function_int 

gpio_config_function:
5ebd c4038000 rtnbit0 gpio_active_bit 

gpio_config_function_int:
5ebe 1fe17e3f and_into 0x3f ,pdata 
5ebf d8a08080 arg core_gpio_conf ,contw 
5ec0 98a08a00 iadd contw ,contw 
5ec1 e0420005 istoret 1 ,contw 
5ec2 20600000 rtn 

gpio_get_config:
5ec3 1841043f and_into 0x3f ,temp 
5ec4 58008080 setarg core_gpio_conf 
5ec5 98408c00 iadd temp ,contr 
5ec6 efe20006 ifetch 1 ,contr 
5ec7 20600000 rtn 

gpio_config_uart:
5ec8 6fe242c8 fetch 1 ,mem_uart_txpin 
5ec9 d8400008 arg gpcfg_uart_txd ,temp 
5eca 20405ebd call gpio_config_function 
5ecb 6fe242c9 fetch 1 ,mem_uart_rxpin 
5ecc d8400009 arg gpcfg_uart_rxd ,temp 
5ecd 20405ebd call gpio_config_function 
5ece 6fe242ca fetch 1 ,mem_uart_rtspin 
5ecf d840000a arg gpcfg_uart_rts ,temp 
5ed0 20405ebd call gpio_config_function 
5ed1 6fe242cb fetch 1 ,mem_uart_ctspin 
5ed2 d840000b arg gpcfg_uart_cts ,temp 
5ed3 20205ebd branch gpio_config_function 

gpio_config_uartb:
5ed4 6fe242cc fetch 1 ,mem_uartb_txpin 
5ed5 d840000c arg gpcfg_uartb_txd ,temp 
5ed6 20405ebd call gpio_config_function 
5ed7 6fe242cd fetch 1 ,mem_uartb_rxpin 
5ed8 d840000d arg gpcfg_uartb_rxd ,temp 
5ed9 20405ebd call gpio_config_function 
5eda 6fe242ce fetch 1 ,mem_uartb_rtspin 
5edb d840000e arg gpcfg_uartb_rts ,temp 
5edc 20405ebd call gpio_config_function 
5edd 6fe242cf fetch 1 ,mem_uartb_ctspin 
5ede d840000f arg gpcfg_uartb_cts ,temp 
5edf 20205ebd branch gpio_config_function 

set_pwm_blink:
5ee0 1fed7e00 lshift8 pdata ,pdata 
5ee1 1ff27e00 lshift4 pdata ,pdata 
5ee2 67e480cf store 2 ,core_pwm0_ncnt 
5ee3 67e480cd store 2 ,core_pwm0_pcnt 
5ee4 20600000 rtn 

set_pwm_steadyon:
5ee5 58000000 setarg 0 
5ee6 67e480cf store 2 ,core_pwm0_ncnt 
5ee7 58000001 setarg 1 
5ee8 67e480cd store 2 ,core_pwm0_pcnt 
5ee9 20600000 rtn 

set_pwm_off:
5eea 58000000 setarg 0 
5eeb 67e480cf store 2 ,core_pwm0_ncnt 
5eec 67e480cd store 2 ,core_pwm0_pcnt 
5eed 20600000 rtn 

enable_xip:
5eee 6fe642dc fetch 3 ,mem_xip_flash_offset 
5eef 207a0000 rtn blank 
5ef0 67e6802c store 3 ,core_flash_offset 
5ef1 58000002 setarg 2 
5ef2 7d35fe00 nsetflag wake ,0 ,pdata 

enable_xip_patch:
5ef3 67e28006 store 1 ,core_misc_ctrl 
5ef4 6fe242e1 fetch 1 ,mem_xip_flash_read_cmd 
5ef5 67e2802f store 1 ,core_flash_read_cmd 
5ef6 6fe201ec fetch 1 ,mem_otp_ucode_flag 
5ef7 c303defa bbit0 7 ,enable_xip_cont 
5ef8 37d98200 until null ,lpo_edge 
5ef9 37d98200 until null ,lpo_edge 

enable_xip_cont:
5efa 6fe442df fetch 2 ,mem_xip_option 
5efb 67e480a0 store 2 ,core_qspi_ctrl 
5efc 20600000 rtn 

qspi_mmode:
5efd 6fe280a0 fetch 1 ,core_qspi_ctrl 
5efe 79207e06 set1 6 ,pdata 
5eff 67e280a0 store 1 ,core_qspi_ctrl 
5f00 20600000 rtn 

qspi_nmode:
5f01 6fe280a0 fetch 1 ,core_qspi_ctrl 
5f02 793ffe06 set0 6 ,pdata 
5f03 67e280a0 store 1 ,core_qspi_ctrl 
5f04 20600000 rtn 

mqspi_read:
5f05 4749c032 bpatchx patch32_3 ,mem_patch32 
5f06 6fe280a0 fetch 1 ,core_qspi_ctrl 
5f07 1fe22400 copy pdata ,regb 
5f08 6fe280a1 fetch 1 ,core_qspi_delay 
5f09 1fe22600 copy pdata ,regc 
5f0a 58000005 setarg 0x05 
5f0b 9a41fe00 ior regb ,pdata 
5f0c 67e280a0 store 1 ,core_qspi_ctrl 
5f0d 7080a108 jam 0x08 ,core_qspi_delay 
5f0e 6fe40b50 fetch 2 ,mem_flash_data_address 
5f0f 67e480a6 store 2 ,core_qspi_rxaddr 
5f10 6fe40b52 fetch 2 ,mem_flash_trans_length 
5f11 67e480a8 store 2 ,core_qspi_rxlen 
5f12 58000004 setarg 4 
5f13 67e480a2 store 2 ,core_qspi_txlen 
5f14 58010000 setarg mmem_qspi_tbuf 
5f15 67e480a4 store 2 ,core_qspi_txaddr 
5f16 5800003b setarg 0x3b 
5f17 67e30000 store 1 ,mmem_qspi_tbuf 
5f18 6fe60b4d fetch 3 ,mem_flash_address 
5f19 1ff10400 rshift16 pdata ,temp 
5f1a e0420005 istoret 1 ,contw 
5f1b 1fec8400 rshift8 pdata ,temp 
5f1c e0420005 istoret 1 ,contw 
5f1d e7e20005 istore 1 ,contw 
5f1e 70800a08 jam qspi_start ,core_dma_start 
5f1f 20405cfe call wait_qspi_done 
5f20 1a427e00 copy regb ,pdata 
5f21 67e280a0 store 1 ,core_qspi_ctrl 
5f22 1a627e00 copy regc ,pdata 
5f23 67e280a1 store 1 ,core_qspi_delay 
5f24 20600000 rtn 

qspi_read:
5f25 474a4032 bpatchx patch32_4 ,mem_patch32 
5f26 6fe280a0 fetch 1 ,core_qspi_ctrl 
5f27 1fe22400 copy pdata ,regb 
5f28 6fe280a1 fetch 1 ,core_qspi_delay 
5f29 1fe22600 copy pdata ,regc 
5f2a 58000005 setarg 0x05 
5f2b 9a41fe00 ior regb ,pdata 
5f2c 67e280a0 store 1 ,core_qspi_ctrl 
5f2d 7080a108 jam 0x08 ,core_qspi_delay 
5f2e 6fe40b50 fetch 2 ,mem_flash_data_address 
5f2f 67e480a6 store 2 ,core_qspi_rxaddr 
5f30 6fe40b52 fetch 2 ,mem_flash_trans_length 
5f31 67e480a8 store 2 ,core_qspi_rxlen 
5f32 58000004 setarg 4 
5f33 67e480a2 store 2 ,core_qspi_txlen 
5f34 580001ee setarg mem_qspi_tbuf 
5f35 67e480a4 store 2 ,core_qspi_txaddr 
5f36 5800003b setarg 0x3b 
5f37 67e201ee store 1 ,mem_qspi_tbuf 
5f38 6fe60b4d fetch 3 ,mem_flash_address 
5f39 1ff10400 rshift16 pdata ,temp 
5f3a e0420005 istoret 1 ,contw 
5f3b 1fec8400 rshift8 pdata ,temp 
5f3c e0420005 istoret 1 ,contw 
5f3d e7e20005 istore 1 ,contw 
5f3e 70800a08 jam qspi_start ,core_dma_start 
5f3f 20405cfe call wait_qspi_done 
5f40 1a427e00 copy regb ,pdata 
5f41 67e280a0 store 1 ,core_qspi_ctrl 
5f42 1a627e00 copy regc ,pdata 
5f43 67e280a1 store 1 ,core_qspi_delay 
5f44 20600000 rtn 

qspi_write:
5f45 474ac032 bpatchx patch32_5 ,mem_patch32 
5f46 6fe280a0 fetch 1 ,core_qspi_ctrl 
5f47 1fe22400 copy pdata ,regb 
5f48 6fe280a1 fetch 1 ,core_qspi_delay 
5f49 1fe22600 copy pdata ,regc 
5f4a 7080a004 jam 0x04 ,core_qspi_ctrl 
5f4b 7080a100 jam 0 ,core_qspi_delay 
5f4c 20405cc1 call qspi_unlock_flash 
5f4d 6fe60b4d fetch 3 ,mem_flash_address 
5f4e 1fe22200 copy pdata ,rega 
5f4f 20405f5d call qspi_sector_earse_flash 
5f50 20405f6e call qspi_wait_write_flash 
5f51 20405cc1 call qspi_unlock_flash 
5f52 6fe40b50 fetch 2 ,mem_flash_data_address 
5f53 1fe22200 copy pdata ,rega 
5f54 68420b52 fetcht 1 ,mem_flash_trans_length 
5f55 6fe60b4d fetch 3 ,mem_flash_address 
5f56 20405cca call qspi_write_flash 
5f57 20405f6e call qspi_wait_write_flash 
5f58 1a427e00 copy regb ,pdata 
5f59 67e280a0 store 1 ,core_qspi_ctrl 
5f5a 1a627e00 copy regc ,pdata 
5f5b 67e280a1 store 1 ,core_qspi_delay 
5f5c 20600000 rtn 

qspi_sector_earse_flash:
5f5d 474b4032 bpatchx patch32_6 ,mem_patch32 
5f5e 58000000 setarg 0 
5f5f 67e480a8 store 2 ,core_qspi_rxlen 
5f60 58000004 setarg 4 
5f61 67e480a2 store 2 ,core_qspi_txlen 
5f62 580001ee setarg mem_qspi_tbuf 
5f63 67e480a4 store 2 ,core_qspi_txaddr 
5f64 58000020 setarg 0x20 
5f65 67e201ee store 1 ,mem_qspi_tbuf 
5f66 1a310400 rshift16 rega ,temp 
5f67 e0420005 istoret 1 ,contw 
5f68 1a2c8400 rshift8 rega ,temp 
5f69 e0420005 istoret 1 ,contw 
5f6a 1a227e00 copy rega ,pdata 
5f6b e7e20005 istore 1 ,contw 
5f6c 70800a08 jam qspi_start ,core_dma_start 
5f6d 20205cfe branch wait_qspi_done 

qspi_wait_write_flash:
5f6e 474bc032 bpatchx patch32_7 ,mem_patch32 
5f6f 700b0d00 jam 0 ,mem_temp 
5f70 dfe00b0d arg mem_temp ,pdata 
5f71 67e480a6 store 2 ,core_qspi_rxaddr 
5f72 58000001 setarg 1 
5f73 67e480a8 store 2 ,core_qspi_rxlen 
5f74 58000001 setarg 1 
5f75 67e480a2 store 2 ,core_qspi_txlen 
5f76 580001ee setarg mem_qspi_tbuf 
5f77 67e480a4 store 2 ,core_qspi_txaddr 
5f78 7001ee05 jam 0x05 ,mem_qspi_tbuf 
5f79 70800a08 jam qspi_start ,core_dma_start 
5f7a 20405cfe call wait_qspi_done 
5f7b 6fe20b0d fetch 1 ,mem_temp 
5f7c c2805f6e bbit1 0 ,qspi_wait_write_flash 
5f7d 20600000 rtn 

update_dac_wptr:
5f7e 474c4033 bpatchx patch33_0 ,mem_patch33 
5f7f 68448100 fetcht 2 ,core_dac_saddr 
5f80 6fe48102 fetch 2 ,core_dac_len 
5f81 9840fe00 iadd temp ,pdata 
5f82 1fe0fe01 increase 1 ,pdata 
5f83 9a267c00 isub rega ,null 
5f84 2422df86 nbranch write_dac_ptr ,zero 
5f85 6fe48100 fetch 2 ,core_dac_saddr 

write_dac_ptr:
5f86 67e48104 store 2 ,core_dac_wptr 
5f87 20600000 rtn 

sbc_hw_check_err:
5f88 474cc033 bpatchx patch33_1 ,mem_patch33 
5f89 6fe48319 fetch 2 ,core_sbc_status 
5f8a 1fe17ec0 and pdata ,0xc0 ,pdata 
5f8b c1000000 rtneq 0 
5f8c 70800b20 jam 0x20 ,core_sbc_clr 
5f8d 20000005 nop 5 
5f8e 70800b00 jam 0x0 ,core_sbc_clr 
5f8f 70806408 jam 0x8 ,core_sbc_ctrl 
5f90 6fe20002 fetch 1 ,mem_sbc_error 
5f91 1fe0fe01 increase 1 ,pdata 
5f92 67e20002 store 1 ,mem_sbc_error 
5f93 20600000 rtn 

sbc_update_dac_wptr:
5f94 474d4033 bpatchx patch33_2 ,mem_patch33 
5f95 6fe4836e fetch 2 ,core_sbc_dwp 
5f96 1fe22200 copy pdata ,rega 
5f97 1fe17e03 and pdata ,0x3 ,pdata 
5f98 c0803b25 bne 0 ,assert 
5f99 1a227e00 copy rega ,pdata 
5f9a 6844810c fetcht 2 ,core_sbc_daddr 
5f9b 9840fe00 iadd temp ,pdata 
5f9c 67e48104 store 2 ,core_dac_wptr 

audio_voice_adjust:
5f9d 6fe28108 fetch 1 ,core_dac_lvol 
5f9e 684242ac fetcht 1 ,mem_audio_vol 

audio_voice_adjust_common:
5f9f 98467c00 isub temp ,null 
5fa0 20628000 rtn zero 
5fa1 20215fa7 branch audio_voice_down ,positive 
5fa2 6fe28108 fetch 1 ,core_dac_lvol 
5fa3 1fe0fe01 increase 0x1 ,pdata 
5fa4 67e28108 store 1 ,core_dac_lvol 
5fa5 67e28109 store 1 ,core_dac_rvol 
5fa6 20600000 rtn 

audio_voice_down:
5fa7 6fe28108 fetch 1 ,core_dac_lvol 
5fa8 1fe0ffff increase -1 ,pdata 
5fa9 67e28108 store 1 ,core_dac_lvol 
5faa 67e28109 store 1 ,core_dac_rvol 
5fab 20600000 rtn 

audio_voice_slow_down:
5fac 6f228108 fetchr loopcnt ,1 ,core_dac_lvol 
5fad 207a0000 rtn blank 
5fae 1f237200 rshift loopcnt ,loopcnt 

audio_voice_slow_down_loop:
5faf 20002ee0 nop 12000 
5fb0 20002ee0 nop 12000 
5fb1 20002ee0 nop 12000 
5fb2 6fe28108 fetch 1 ,core_dac_lvol 
5fb3 1fe0fffe increase -2 ,pdata 
5fb4 67e28108 store 1 ,core_dac_lvol 
5fb5 67e28109 store 1 ,core_dac_rvol 
5fb6 c2005faf loop audio_voice_slow_down_loop 
5fb7 20600000 rtn 

sbc_hw_wait:
5fb8 6fe28064 fetch 1 ,core_sbc_ctrl 
5fb9 c4000000 rtnbit0 0 
5fba 6fe48112 fetch 2 ,core_sbc_swp 
5fbb 6844836c fetcht 2 ,core_sbc_srp 
5fbc 98467c00 isub temp ,null 
5fbd 2422dfb8 nbranch sbc_hw_wait ,zero 
5fbe 20600000 rtn 

sbc_hw_check_busy:
5fbf 6fe48112 fetch 2 ,core_sbc_swp 
5fc0 6844836c fetcht 2 ,core_sbc_srp 
5fc1 98467c00 isub temp ,null 
5fc2 20600000 rtn 

dac_hw_get_count:
5fc3 474dc033 bpatchx patch33_3 ,mem_patch33 
5fc4 6fe48104 fetch 2 ,core_dac_wptr 
5fc5 6844836a fetcht 2 ,core_dac_rptr 
5fc6 98467e00 isub temp ,pdata 
5fc7 20610000 rtn positive 
5fc8 6fe4836a fetch 2 ,core_dac_rptr 
5fc9 68448104 fetcht 2 ,core_dac_wptr 
5fca 98460400 isub temp ,temp 
5fcb 6fe48102 fetch 2 ,core_dac_len 
5fcc 98467e00 isub temp ,pdata 
5fcd 20600000 rtn 

xip_status:
5fce 20000320 nop 800 
5fcf 6fe20008 fetch 1 ,8 
5fd0 20600000 rtn 

reset_xip1:
5fd1 df20000a arg 10 ,loopcnt 
5fd2 20405fce call xip_status 
5fd3 c1118000 rtneq 0x23 
5fd4 70800602 jam 2 ,core_misc_ctrl 
5fd5 c2005fd2 loop reset_xip1 + 1 
5fd6 20600000 rtn 

reset_xip2:
5fd7 df20000a arg 10 ,loopcnt 
5fd8 20405fce call xip_status 
5fd9 c1118000 rtneq 0x23 
5fda 70801002 jam 2 ,core_reset 
5fdb 70800602 jam 2 ,core_misc_ctrl 
5fdc c2005fd2 loop reset_xip1 + 1 
5fdd 20600000 rtn 

read_scs:
5fde 5800edf2 setarg 0xedf2 
5fdf 67e4802a store 2 ,core_scs_addr 
5fe0 20000002 nop 2 
5fe1 6fe28308 fetch 1 ,core_misc_status 
5fe2 20600000 rtn 

load_le_ltk:
5fe3 2040798e call nv_ng_load_nvram 
5fe4 204079a4 call nv_get_last_record_ptr 
5fe5 efec0013 ifetch 6 ,regc 
5fe6 67ec04bd store 6 ,mem_le_plap 
5fe7 67ec4286 store 6 ,mem_hci_plap 
5fe8 207a0000 rtn blank 
5fe9 df200010 arg 16 ,loopcnt 
5fea d8a04446 arg mem_le_ltk ,contw 
5feb 2040779f call memcpy 
5fec 70445601 jam 1 ,mem_ltk_exists 
5fed 20600000 rtn 

uart_copy_tx_bytes:
5fee 1f227e00 deposit loopcnt 
5fef 207a0000 rtn blank 

uart_copy_tx_bytes_loop:
5ff0 efe20006 ifetch 1 ,contr 
5ff1 e7e2000a istore 1 ,contwu 
5ff2 c2005ff0 loop uart_copy_tx_bytes_loop 
5ff3 20600000 rtn 

rfc_init:
5ff4 20758000 rtn wake 

rfc_reinit:
5ff5 474e4033 bpatchx patch33_4 ,mem_patch33 
5ff6 58000000 setarg 0 
5ff7 67e445b9 store 2 ,mem_rfc_server_state 
5ff8 67e245ad store 1 ,mem_remote_spp_channel 
5ff9 67e245a6 store 1 ,mem_pn_dlci 
5ffa 7045b250 jam 0x50 ,mem_credit_given 
5ffb 20600000 rtn 

l2cap_rfc_process:
5ffc 474ec033 bpatchx patch33_5 ,mem_patch33 
5ffd 6fe40311 fetch 2 ,mem_l2cap_payload_ptr 
5ffe 1fe20c00 copy pdata ,contr 
5fff efe20006 ifetch 1 ,contr 
6000 67e2056d store 1 ,mem_rfc_adss 
6001 1fe97e00 rshift3 pdata ,pdata 
6002 67e2056e store 1 ,mem_rfc_current_channel 
6003 efe20006 ifetch 1 ,contr 
6004 67e2056f store 1 ,mem_rfc_frame_type 
6005 20406057 call rfc_get_frame_len 
6006 60440571 storet 2 ,mem_rfc_paylead_length 
6007 18c27e00 copy contr ,pdata 
6008 67e40573 store 2 ,mem_rfc_paylead_ptr 
6009 6fe2056e fetch 1 ,mem_rfc_current_channel 
600a c0006019 beq 0 ,rfc_parse_signal_packet 
600b 2020606c branch rfc_parse_server_packet 

rfc_parse_signal_sabm:
600c 6842056e fetcht 1 ,mem_rfc_current_channel 
600d 700570d7 jam 0xd7 ,mem_current_fcs 
600e 204060d3 call rfc_send_ua 
600f 6fe445b9 fetch 2 ,mem_rfc_server_state 
6010 79207e08 set1 rfc_signal_sabm ,pdata 
6011 79207e09 set1 rfc_signal_ua ,pdata 
6012 67e445b9 store 2 ,mem_rfc_server_state 
6013 7045ac00 jam 0 ,mem_rfcomm_initiator 
6014 202060b1 branch rfcomm_rx_process_end 

rfc_parse_signal_ua:
6015 6fe445b9 fetch 2 ,mem_rfc_server_state 
6016 79207e09 set1 rfc_signal_ua ,pdata 
6017 67e445b9 store 2 ,mem_rfc_server_state 
6018 202060b1 branch rfcomm_rx_process_end 

rfc_parse_signal_packet:
6019 474f4033 bpatchx patch33_6 ,mem_patch33 
601a 6fe2056f fetch 1 ,mem_rfc_frame_type 
601b c01fe00c beq rfcomm_frame_type_sabm ,rfc_parse_signal_sabm 
601c c039e015 beq rfcomm_frame_type_ua ,rfc_parse_signal_ua 
601d c077e020 beq rfcomm_frame_type_uih ,rfc_parse_signal_uih 
601e c1298000 rtneq rfcomm_frame_type_disconn 
601f 20203b25 branch assert 

rfc_parse_signal_uih:
6020 6fe40573 fetch 2 ,mem_rfc_paylead_ptr 
6021 1fe20c00 copy pdata ,contr 
6022 2040604f call rfc_get_uih_head_struct 
6023 474fc033 bpatchx patch33_7 ,mem_patch33 
6024 6fe20575 fetch 1 ,mem_uih_cmd_type 
6025 c020e02a beq uih_param_neg_cmd ,rfc_parse_signal_cmd_pn 
6026 c0206031 beq uih_param_neg_res ,rfc_parse_signal_res_pn 
6027 c038e060 beq uih_modem_status_cmd ,rfc_parse_signal_cmd_ms 
6028 c0386067 beq uih_modem_status_res ,rfc_parse_signal_res_ms 
6029 202060b1 branch rfcomm_rx_process_end 

rfc_parse_signal_cmd_pn:
602a 20406036 call rfc_get_sigal_pn_param 
602b 6fe445b9 fetch 2 ,mem_rfc_server_state 
602c 79207e00 set1 rfc_signal_pn_cmd ,pdata 
602d 79207e01 set1 rfc_signal_pn_res ,pdata 
602e 67e445b9 store 2 ,mem_rfc_server_state 
602f 204060dc call rfc_send_signal_res_pn 
6030 202060b1 branch rfcomm_rx_process_end 

rfc_parse_signal_res_pn:
6031 6fe445b9 fetch 2 ,mem_rfc_server_state 
6032 79207e01 set1 rfc_signal_pn_res ,pdata 
6033 67e445b9 store 2 ,mem_rfc_server_state 
6034 20406036 call rfc_get_sigal_pn_param 
6035 202060b1 branch rfcomm_rx_process_end 

rfc_get_sigal_pn_param:
6036 6fe40578 fetch 2 ,mem_rfc_payload_ptr 
6037 1fe20c00 copy pdata ,contr 
6038 efe20006 ifetch 1 ,contr 
6039 67e245a6 store 1 ,mem_pn_dlci 
603a efe20006 ifetch 1 ,contr 
603b 67e2057b store 1 ,mem_pn_credit_flow_type_info 
603c efe20006 ifetch 1 ,contr 
603d 67e2057c store 1 ,mem_pn_priority 
603e efe20006 ifetch 1 ,contr 
603f 67e2057d store 1 ,mem_pn_acknowledg_timer 
6040 efe40006 ifetch 2 ,contr 
6041 67e445a7 store 2 ,mem_pn_max_frame_size 
6042 efe20006 ifetch 1 ,contr 
6043 67e2057e store 1 ,mem_pn_max_retrans 
6044 efe20006 ifetch 1 ,contr 
6045 67e445b0 store 2 ,mem_remote_credits 
6046 20600000 rtn 

rfc_get_signal_ms_param:
6047 6fe40578 fetch 2 ,mem_rfc_payload_ptr 
6048 1fe20c00 copy pdata ,contr 
6049 efe20006 ifetch 1 ,contr 
604a 1fe97e00 rshift3 pdata ,pdata 
604b 67e245b3 store 1 ,mem_ms_channel 
604c efe20006 ifetch 1 ,contr 
604d 67e2057a store 1 ,mem_ms_param 
604e 20600000 rtn 

rfc_get_uih_head_struct:
604f efe20006 ifetch 1 ,contr 
6050 1fe37e00 rshift pdata ,pdata 
6051 67e20575 store 1 ,mem_uih_cmd_type 
6052 20406057 call rfc_get_frame_len 
6053 60440576 storet 2 ,mem_uih_length 
6054 18c27e00 copy contr ,pdata 
6055 67e40578 store 2 ,mem_rfc_payload_ptr 
6056 20600000 rtn 

rfc_get_frame_len:
6057 efe20006 ifetch 1 ,contr 
6058 1fe20400 copy pdata ,temp 
6059 18430400 rshift temp ,temp 
605a c3800000 rtnbit1 0 
605b efe20006 ifetch 1 ,contr 
605c 1fe9fe00 lshift3 pdata ,pdata 
605d 1ff27e00 lshift4 pdata ,pdata 
605e 98408400 iadd temp ,temp 
605f 20600000 rtn 

rfc_parse_signal_cmd_ms:
6060 20406047 call rfc_get_signal_ms_param 
6061 6fe445b9 fetch 2 ,mem_rfc_server_state 
6062 79207e05 set1 rfc_signal_recv_ms_cmd ,pdata 
6063 79207e06 set1 rfc_signal_send_ms_res ,pdata 
6064 67e445b9 store 2 ,mem_rfc_server_state 
6065 204060f3 call rfc_send_modem_status_res 
6066 202060b1 branch rfcomm_rx_process_end 

rfc_parse_signal_res_ms:
6067 20406047 call rfc_get_signal_ms_param 
6068 6fe445b9 fetch 2 ,mem_rfc_server_state 
6069 79207e07 set1 rfc_signal_recv_ms_res ,pdata 
606a 67e445b9 store 2 ,mem_rfc_server_state 
606b 202060b1 branch rfcomm_rx_process_end 

rfc_parse_server_packet:
606c 47504034 bpatchx patch34_0 ,mem_patch34 
606d 6fe2056f fetch 1 ,mem_rfc_frame_type 
606e c039e074 beq rfcomm_frame_type_ua ,rfc_parse_server_ua 
606f c01fe07f beq rfcomm_frame_type_sabm ,rfc_parse_server_sabm 
6070 c029e0ab beq rfcomm_frame_type_disconn ,rfc_parse_sverver_disconnect 

rfc_parse_sever_uih:
6071 c077e09b beq rfcomm_frame_type_uih ,rfc_parse_server_uih 
6072 c07fe093 beq rfcomm_frame_type_uih_credits ,rfc_parse_server_uih_credits 
6073 20203b25 branch assert 

rfc_parse_server_ua:
6074 6fe246dc fetch 1 ,mem_major_uppersm 
6075 c001e07c beq up_major_sm_disconnect_server ,rfc_parse_server_ua_disc 
6076 6fe2056e fetch 1 ,mem_rfc_current_channel 
6077 67e245b6 store 1 ,mem_profile_channel 
6078 6fe445b9 fetch 2 ,mem_rfc_server_state 
6079 79207e03 set1 rfc_server_ua ,pdata 
607a 67e445b9 store 2 ,mem_rfc_server_state 
607b 202060b1 branch rfcomm_rx_process_end 

rfc_parse_server_ua_disc:
607c 58000000 setarg 0 
607d 67e445b9 store 2 ,mem_rfc_server_state 
607e 202060b1 branch rfcomm_rx_process_end 

rfc_parse_server_sabm:
607f 6fe2056e fetch 1 ,mem_rfc_current_channel 
6080 67e245b6 store 1 ,mem_profile_channel 
6081 6fe445b9 fetch 2 ,mem_rfc_server_state 
6082 79207e03 set1 rfc_server_ua ,pdata 
6083 79207e02 set1 rfc_server_sabm ,pdata 
6084 67e445b9 store 2 ,mem_rfc_server_state 
6085 6fe2056d fetch 1 ,mem_rfc_adss 
6086 2040618d call rfcomm_calculate_fcs_ua 
6087 67e20570 store 1 ,mem_current_fcs 
6088 204060d3 call rfc_send_ua 
6089 6fe2056d fetch 1 ,mem_rfc_adss 
608a 1feb7e00 rshift2 pdata ,pdata 
608b 67e245a6 store 1 ,mem_pn_dlci 
608c 1febfe00 lshift2 pdata ,pdata 
608d 793ffe01 set0 rfcomm_address_cr ,pdata 
608e 79207e00 set1 rfcomm_address_ext_len ,pdata 
608f d84045ae arg mem_hiufcs_spp ,temp 
6090 6044056b storet 2 ,mem_contw_temp 
6091 2040619c call rfcomm_save_fcs_uih 
6092 202060b1 branch rfcomm_rx_process_end 

rfc_parse_server_uih_credits:
6093 6fe40573 fetch 2 ,mem_rfc_paylead_ptr 
6094 1fe20c00 copy pdata ,contr 
6095 1fe0fe01 increase 1 ,pdata 
6096 67e40573 store 2 ,mem_rfc_paylead_ptr 
6097 efe20006 ifetch 1 ,contr 
6098 684445b0 fetcht 2 ,mem_remote_credits 
6099 9840fe00 iadd temp ,pdata 
609a 67e445b0 store 2 ,mem_remote_credits 

rfc_parse_server_uih:
609b 20406116 call rfcomm_increase_credit_given 
609c 6fe246c3 fetch 1 ,mem_ui_profile_supported 
609d c301e0a3 bbit0 support_hf_hs ,parse_uih_spp_uih_cont0 
609e 204060a6 call rfc_send_uih_credit 
609f 6fe40573 fetch 2 ,mem_rfc_paylead_ptr 
60a0 67e44328 store 2 ,mem_at_payload_ptr 
60a1 68e20571 fetchr queue ,1 ,mem_rfc_paylead_length 
60a2 202045b4 branch hfp_process_rfcomm_packet 

parse_uih_spp_uih_cont0:
60a3 204061d9 call rfc_get_rfcomm_snd_adss 
60a4 20406106 call rfc_send_uih_without_payload 
60a5 202060b1 branch rfcomm_rx_process_end 

rfc_send_uih_credit:
60a6 6fe245b2 fetch 1 ,mem_credit_given 
60a7 1fe67c28 sub pdata ,40 ,null 
60a8 20610000 rtn positive 
60a9 204061d9 call rfc_get_rfcomm_snd_adss 
60aa 20206106 branch rfc_send_uih_without_payload 

rfc_parse_sverver_disconnect:
60ab 20405ff5 call rfc_reinit 
60ac 6fe2056d fetch 1 ,mem_rfc_adss 
60ad 2040618d call rfcomm_calculate_fcs_ua 
60ae 67e20570 store 1 ,mem_current_fcs 
60af 204060d3 call rfc_send_ua 
60b0 202060b1 branch rfcomm_rx_process_end 

rfcomm_rx_process_end:
60b1 20600000 rtn 

rfc_prepare_send_signal_ms:
60b2 4750c034 bpatchx patch34_1 ,mem_patch34 
60b3 6fe445b9 fetch 2 ,mem_rfc_server_state 
60b4 c3820000 rtnbit1 rfc_signal_send_ms_cmd 
60b5 c4000000 rtnbit0 rfc_signal_pn_cmd 
60b6 c4008000 rtnbit0 rfc_signal_pn_res 
60b7 c4010000 rtnbit0 rfc_server_sabm 
60b8 c4018000 rtnbit0 rfc_server_ua 
60b9 c4040000 rtnbit0 rfc_signal_sabm 
60ba c4048000 rtnbit0 rfc_signal_ua 
60bb 79207e04 set1 rfc_signal_send_ms_cmd ,pdata 
60bc 67e445b9 store 2 ,mem_rfc_server_state 

rfc_send_signal_ms_cmd:
60bd 6b0445b7 fetchr regd ,2 ,mem_rfc_l2capch_ptr 
60be da200008 arg 8 ,rega 
60bf 20404aab call l2cap_malloc_server_channel 
60c0 684245b6 fetcht 1 ,mem_profile_channel 
60c1 18498400 lshift3 temp ,temp 
60c2 18418403 or_into 0x03 ,temp 
60c3 da2000aa arg 0xaa ,rega 

rfc_org_signal_ms:
60c4 6fe245ac fetch 1 ,mem_rfcomm_initiator 
60c5 1fe3fe00 lshift pdata ,pdata 
60c6 79207e00 set1 0 ,pdata 
60c7 e7e20005 istore 1 ,contw 
60c8 580009ef setarg 0x09ef 
60c9 e7e40005 istore 2 ,contw 
60ca 580005e3 setarg 0x05e3 
60cb e7e40005 istore 2 ,contw 
60cc 18427e00 copy temp ,pdata 
60cd e7e20005 istore 1 ,contw 
60ce 5800008d setarg 0x8d 
60cf e7e20005 istore 1 ,contw 
60d0 20406196 call rfcomm_calculate_fcs_dlci0 
60d1 e7e20005 istore 1 ,contw 
60d2 20600000 rtn 

rfc_send_ua:
60d3 da200004 arg 4 ,rega 
60d4 20404aab call l2cap_malloc_server_channel 
60d5 6fe2056d fetch 1 ,mem_rfc_adss 
60d6 e7e20005 istore 1 ,contw 
60d7 58000173 setarg 0x0173 
60d8 e7e40005 istore 2 ,contw 
60d9 6fe20570 fetch 1 ,mem_current_fcs 
60da e7e20005 istore 1 ,contw 
60db 20600000 rtn 

rfc_send_signal_res_pn:
60dc da20000e arg 0xe ,rega 
60dd 20404aab call l2cap_malloc_server_channel 
60de 6fe245ac fetch 1 ,mem_rfcomm_initiator 
60df 1fe3fe00 lshift pdata ,pdata 
60e0 79207e00 set1 0 ,pdata 
60e1 e7e20005 istore 1 ,contw 
60e2 580015ef setarg 0x15ef 
60e3 e7e40005 istore 2 ,contw 
60e4 58001181 setarg 0x1181 
60e5 e7e40005 istore 2 ,contw 
60e6 6fe245a6 fetch 1 ,mem_pn_dlci 
60e7 e7e20005 istore 1 ,contw 
60e8 580000e0 setarg 0x0000e0 
60e9 e7e60005 istore 3 ,contw 
60ea 580000c8 setarg rfcomm_max_frame_size 
60eb e7e40005 istore 2 ,contw 
60ec 58000000 setarg 0x00 
60ed e7e20005 istore 1 ,contw 
60ee 58000007 setarg 0x07 
60ef e7e20005 istore 1 ,contw 
60f0 20406196 call rfcomm_calculate_fcs_dlci0 
60f1 e7e20005 istore 1 ,contw 
60f2 20600000 rtn 

rfc_send_modem_status_res:
60f3 da200008 arg 8 ,rega 
60f4 20404aab call l2cap_malloc_server_channel 
60f5 6fe245ac fetch 1 ,mem_rfcomm_initiator 
60f6 1fe3fe00 lshift pdata ,pdata 
60f7 79207e00 set1 0 ,pdata 
60f8 e7e20005 istore 1 ,contw 
60f9 580009ef setarg 0x09ef 
60fa e7e40005 istore 2 ,contw 
60fb 580005e1 setarg 0x05e1 
60fc e7e40005 istore 2 ,contw 
60fd 684245a6 fetcht 1 ,mem_pn_dlci 
60fe 184b8400 lshift2 temp ,temp 
60ff 18418403 or_into 3 ,temp 
6100 e0420005 istoret 1 ,contw 
6101 5800008d setarg 0x8d 
6102 e7e20005 istore 1 ,contw 
6103 20406196 call rfcomm_calculate_fcs_dlci0 
6104 e7e20005 istore 1 ,contw 
6105 20600000 rtn 

rfc_send_uih_without_payload:
6106 6fe245b2 fetch 1 ,mem_credit_given 
6107 207a0000 rtn blank 
6108 20404a5a call l2cap_malloc_is_fifo_full 
6109 247a0000 nrtn blank 
610a da200005 arg 0x5 ,rega 
610b 20404aab call l2cap_malloc_server_channel 
610c 6fe2057f fetch 1 ,mem_rfcomm_send_adss 
610d e7e20005 istore 1 ,contw 
610e 580001ff setarg 0x01ff 
610f e7e40005 istore 2 ,contw 
6110 6fe245b2 fetch 1 ,mem_credit_given 
6111 e7e20005 istore 1 ,contw 
6112 6fe245af fetch 1 ,mem_hiufcs_spp_wcredits 
6113 e7e20005 istore 1 ,contw 
6114 7045b200 jam 0 ,mem_credit_given 
6115 20600000 rtn 

rfcomm_increase_credit_given:
6116 6fe40571 fetch 2 ,mem_rfc_paylead_length 
6117 207a0000 rtn blank 
6118 6fe245b2 fetch 1 ,mem_credit_given 
6119 1fe0fe01 increase 1 ,pdata 
611a 67e245b2 store 1 ,mem_credit_given 
611b 20600000 rtn 

rfc_tx_write_length:
611c 6fe445b4 fetch 2 ,mem_current_packet_length 
611d 1fe67c7f sub pdata ,0x7f ,null 
611e 24216123 nbranch rfc_tx_write_long_packet ,positive 
611f 1fe3fe00 lshift pdata ,pdata 
6120 79207e00 set1 0 ,pdata 
6121 e7e20005 istore 1 ,contw 
6122 20600000 rtn 

rfc_tx_write_long_packet:
6123 6fe445b4 fetch 2 ,mem_current_packet_length 
6124 1fe97e00 rshift3 pdata ,pdata 
6125 1ff18400 rshift4 pdata ,temp 
6126 1fe17e7f and_into 0x7f ,pdata 
6127 1fe3fe00 lshift pdata ,pdata 
6128 793ffe00 set0 0 ,pdata 
6129 e7e20005 istore 1 ,contw 
612a e0420005 istoret 1 ,contw 
612b 20600000 rtn 

rfc_tx_write_given_credit:
612c 6fe245b2 fetch 1 ,mem_credit_given 
612d 207a0000 rtn blank 
612e e7e20005 istore 1 ,contw 
612f 20600000 rtn 

rfc_send_signal_cmd_pn:
6130 47514034 bpatchx patch34_2 ,mem_patch34 
6131 684245b6 fetcht 1 ,mem_profile_channel 
6132 204061e5 call channel_to_dlci 
6133 604245a6 storet 1 ,mem_pn_dlci 
6134 da20000e arg 14 ,rega 
6135 20404aab call l2cap_malloc_server_channel 
6136 6fe245ac fetch 1 ,mem_rfcomm_initiator 
6137 1fe3fe00 lshift pdata ,pdata 
6138 79207e00 set1 0 ,pdata 
6139 e7e20005 istore 1 ,contw 
613a 580015ef setarg 0x15ef 
613b e7e40005 istore 2 ,contw 
613c 58001183 setarg 0x1183 
613d e7e40005 istore 2 ,contw 
613e 6fe245a6 fetch 1 ,mem_pn_dlci 
613f e7e20005 istore 1 ,contw 
6140 580000f0 setarg 0x0000f0 
6141 e7e60005 istore 3 ,contw 
6142 580000c8 setarg rfcomm_max_frame_size 
6143 e7e40005 istore 2 ,contw 
6144 58000000 setarg 0 
6145 e7e20005 istore 1 ,contw 
6146 58000007 setarg 0x07 
6147 e7e20005 istore 1 ,contw 
6148 20406196 call rfcomm_calculate_fcs_dlci0 
6149 e7e20005 istore 1 ,contw 
614a 7045b210 jam 0x10 ,mem_credit_given 
614b 20600000 rtn 

rfc_send_signal_sabm:
614c 70056d03 jam 3 ,mem_rfc_adss 
614d 7005701c jam 0x1c ,mem_current_fcs 
614e 20406158 call rfc_send_sabm 
614f 7045ac01 jam 1 ,mem_rfcomm_initiator 
6150 20600000 rtn 

rfc_send_server_sabm:
6151 684245a6 fetcht 1 ,mem_pn_dlci 
6152 204061da call rfc_dlci_to_address_cmd 
6153 20406181 call rfcomm_calculate_fcs_sabm 
6154 67e20570 store 1 ,mem_current_fcs 
6155 684245a6 fetcht 1 ,mem_pn_dlci 
6156 204061da call rfc_dlci_to_address_cmd 
6157 6042056d storet 1 ,mem_rfc_adss 

rfc_send_sabm:
6158 da200004 arg 4 ,rega 
6159 20404aab call l2cap_malloc_server_channel 
615a 6fe2056d fetch 1 ,mem_rfc_adss 
615b e7e20005 istore 1 ,contw 
615c 5800013f setarg 0x013f 
615d e7e40005 istore 2 ,contw 
615e 6fe20570 fetch 1 ,mem_current_fcs 
615f e7e20005 istore 1 ,contw 
6160 20600000 rtn 

rfc_send_server_disc:
6161 684245a6 fetcht 1 ,mem_pn_dlci 
6162 204061da call rfc_dlci_to_address_cmd 
6163 20406175 call rfcomm_calculate_fcs_disc 
6164 67e20570 store 1 ,mem_current_fcs 
6165 684245a6 fetcht 1 ,mem_pn_dlci 
6166 204061da call rfc_dlci_to_address_cmd 
6167 6042056d storet 1 ,mem_rfc_adss 
6168 2020616c branch rfc_send_disc 

rfc_send_signal_disc:
6169 70056d03 jam 3 ,mem_rfc_adss 
616a 700570fd jam 0xfd ,mem_current_fcs 
616b 7045ac00 jam 0 ,mem_rfcomm_initiator 

rfc_send_disc:
616c da200004 arg 4 ,rega 
616d 20404aab call l2cap_malloc_server_channel 
616e 6fe2056d fetch 1 ,mem_rfc_adss 
616f e7e20005 istore 1 ,contw 
6170 58000153 setarg 0x0153 
6171 e7e40005 istore 2 ,contw 
6172 6fe20570 fetch 1 ,mem_current_fcs 
6173 e7e20005 istore 1 ,contw 
6174 20600000 rtn 

rfcomm_calculate_fcs_disc:
6175 18427e00 copy temp ,pdata 
6176 1fedfe00 reverse pdata ,pdata 
6177 67e245ab store 1 ,memfcstemp3 
6178 18007e53 force ini_tx_disc ,pdata 
6179 1fedfe00 reverse pdata ,pdata 
617a 67e245aa store 1 ,memfcstemp2 
617b 18007e01 force 0x01 ,pdata 
617c 1fedfe00 reverse pdata ,pdata 
617d 67e245a9 store 1 ,memfcstemp1 
617e 204061b7 call caculate_fcs 
617f 18427e00 copy temp ,pdata 
6180 20600000 rtn 

rfcomm_calculate_fcs_sabm:
6181 18427e00 copy temp ,pdata 
6182 1fedfe00 reverse pdata ,pdata 
6183 67e245ab store 1 ,memfcstemp3 
6184 18007e3f force ini_tx_sabm ,pdata 
6185 1fedfe00 reverse pdata ,pdata 
6186 67e245aa store 1 ,memfcstemp2 
6187 18007e01 force 0x01 ,pdata 
6188 1fedfe00 reverse pdata ,pdata 
6189 67e245a9 store 1 ,memfcstemp1 
618a 204061b7 call caculate_fcs 
618b 18427e00 copy temp ,pdata 
618c 20600000 rtn 

rfcomm_calculate_fcs_ua:
618d 1fedfe00 reverse pdata ,pdata 
618e 67e245ab store 1 ,memfcstemp3 
618f 18007e73 force rsp_tx_ua ,pdata 
6190 1fedfe00 reverse pdata ,pdata 
6191 67e245aa store 1 ,memfcstemp2 
6192 18007e01 force 0x01 ,pdata 
6193 1fedfe00 reverse pdata ,pdata 
6194 67e245a9 store 1 ,memfcstemp1 
6195 202061b7 branch caculate_fcs 

rfcomm_calculate_fcs_dlci0:
6196 6fe245ac fetch 1 ,mem_rfcomm_initiator 
6197 203a619a branch rfcomm_calculate_fcs_dlci0_res ,blank 
6198 58000070 setarg 0x70 
6199 20600000 rtn 

rfcomm_calculate_fcs_dlci0_res:
619a 580000aa setarg 0xaa 
619b 20600000 rtn 

rfcomm_save_fcs_uih:
619c 1fedfe00 reverse pdata ,pdata 
619d 67e245ab store 1 ,memfcstemp3 
619e 18007eef force rsp_rx_uih ,pdata 
619f 204061ab call caculate_uihdata_fcs 
61a0 6844056b fetcht 2 ,mem_contw_temp 
61a1 18420a00 copy temp ,contw 
61a2 e7e20005 istore 1 ,contw 
61a3 18a20400 copy contw ,temp 
61a4 6044056b storet 2 ,mem_contw_temp 
61a5 18007eff force rsp_rx_uih_wdata ,pdata 
61a6 204061ab call caculate_uihdata_fcs 
61a7 6844056b fetcht 2 ,mem_contw_temp 
61a8 18420a00 copy temp ,contw 
61a9 e7e20005 istore 1 ,contw 
61aa 20600000 rtn 

caculate_uihdata_fcs:
61ab 1fedfe00 reverse pdata ,pdata 
61ac 67e245aa store 1 ,memfcstemp2 
61ad 6fe445aa fetch 2 ,memfcstemp2 
61ae 1fed7e00 lshift8 pdata ,pdata 
61af 67e60568 store 3 ,mem_mod2div_temp 
61b0 da200107 arg 0x107 ,rega 
61b1 da40000f arg 0xf ,regb 
61b2 204061c4 call mod2div 
61b3 1fe2fed7 xor_into 0xd7 ,pdata 
61b4 1fe47e00 invert pdata ,pdata 
61b5 1fedfe00 reverse pdata ,pdata 
61b6 20600000 rtn 

caculate_fcs:
61b7 6fe645a9 fetch 3 ,memfcstemp1 
61b8 67e60568 store 3 ,mem_mod2div_temp 
61b9 da200107 arg 0x107 ,rega 
61ba da40000f arg 0xf ,regb 
61bb 204061c4 call mod2div 
61bc 1fed7e00 lshift8 pdata ,pdata 
61bd da400007 arg 0x7 ,regb 
61be 204061c4 call mod2div 
61bf 1fe2fe2b xor_into 0x2b ,pdata 
61c0 1fe47e00 invert pdata ,pdata 
61c1 1fedfe00 reverse pdata ,pdata 
61c2 1fe20400 copy pdata ,temp 
61c3 20600000 rtn 

mod2div:
61c4 da600000 arg 0 ,regc 
61c5 1a427200 copy regb ,loopcnt 
61c6 20407717 call right_shift_n 
61c7 1fe20400 icopy temp 

mod2div_loop:
61c8 18427e00 copy temp ,pdata 
61c9 1a63a600 lshift regc ,regc 
61ca c30461cd bbit0 8 ,mod2div_not_enough_reduction 
61cb 9a228400 ixor rega ,temp 
61cc 1a60a601 increase 1 ,regc 

mod2div_not_enough_reduction:
61cd 18438400 lshift temp ,temp 
61ce 6fe60568 fetch 3 ,mem_mod2div_temp 
61cf 1a40a5ff increase -1 ,regb 
61d0 2a41feff compare 0xff ,regb ,0xff 
61d1 2020e1d7 branch mod2div_end ,true 
61d2 1a427200 copy regb ,loopcnt 
61d3 20407717 call right_shift_n 
61d4 2feffe00 isolate1 0 ,pdata 
61d5 79208400 setflag true ,0 ,temp 
61d6 202061c8 branch mod2div_loop 

mod2div_end:
61d7 18437e00 rshift temp ,pdata 
61d8 20600000 rtn 

rfc_get_rfcomm_snd_adss:
61d9 684245a6 fetcht 1 ,mem_pn_dlci 

rfc_dlci_to_address_cmd:
61da 184b8400 lshift2 temp ,temp 
61db 79200400 set1 rfcomm_address_ext_len ,temp 
61dc 6fe245ac fetch 1 ,mem_rfcomm_initiator 
61dd 245a61e9 ncall set_cr_bit ,blank 
61de 6042057f storet 1 ,mem_rfcomm_send_adss 
61df 20600000 rtn 

dlci_to_address_res:
61e0 184b8400 lshift2 temp ,temp 
61e1 79200400 set1 rfcomm_address_ext_len ,temp 
61e2 6fe245ac fetch 1 ,mem_rfcomm_initiator 
61e3 205a61e9 call set_cr_bit ,blank 
61e4 20600000 rtn 

channel_to_dlci:
61e5 18438400 lshift temp ,temp 
61e6 6fe245ac fetch 1 ,mem_rfcomm_initiator 
61e7 793a0400 setflag blank ,0 ,temp 
61e8 20600000 rtn 

set_cr_bit:
61e9 18418402 or_into 0x02 ,temp 
61ea 20600000 rtn 

scheduler_process:
61eb 4751c034 bpatchx patch34_3 ,mem_patch34 
61ec 20407206 call check_51cmd 
61ed 2040414f call app_process_bb_event 
61ee 2040414b call app_process_bt 
61ef 20405b74 call process_conn_sm 
61f0 20404513 call hfp_hsp_process 
61f1 20406b73 call sp_calc_sequence 
61f2 20406b50 call simple_pairing_sequence 
61f3 20406b5f call master_simple_paring_sequence 
61f4 20404a61 call l2cap_malloc_is_fifo_empty 
61f5 247a0000 nrtn blank 
61f6 204072dd call upper_sm_single_step 
61f7 204049bf call l2cap_prepare_send_config_req 
61f8 2040492c call l2cap_prepare_send_connect_res_succ 
61f9 47524034 bpatchx patch34_4 ,mem_patch34 
61fa 20404a5f call l2cap_malloc_is_fifo_nearly_full 
61fb 247a0000 nrtn blank 
61fc 204060b2 call rfc_prepare_send_signal_ms 
61fd 20404a5f call l2cap_malloc_is_fifo_nearly_full 
61fe 247a0000 nrtn blank 
61ff c595e205 bmark0 mark_sco_flag ,handle_avrcp 
6200 2034e205 branch handle_avrcp ,master 
6201 6fe20092 fetch 1 ,mem_current_sniff_attempt 
6202 68420073 fetcht 1 ,mem_sniff_attempt 
6203 98467c00 isub temp ,null 
6204 20628000 rtn zero 

handle_avrcp:
6205 2040426f call avc_send_avr_vd_get_cap 
6206 20404b45 call l2cap_check_empty_chenel_info 
6207 20344b91 branch l2cap_trigger_nochannel_waicthdog ,user 
6208 20204b8f branch l2cap_clear_nochannel_watchdog 

scheduler_tx_l2cap_pkt:
6209 4752c034 bpatchx patch34_5 ,mem_patch34 
620a 20404a61 call l2cap_malloc_is_fifo_empty 
620b 207a0000 rtn blank 
620c 6fe2004b fetch 1 ,mem_op 
620d c3830000 rtnbit1 op_txl2cap 
620e 20404a44 call l2cap_malloc_fifo_out 
620f 67e4013a store 2 ,mem_txptr 
6210 1fe20c00 copy pdata ,contr 
6211 efe40006 ifetch 2 ,contr 
6212 1fe0fe04 increase 4 ,pdata 
6213 67e40099 store 2 ,mem_tx_len 
6214 70009806 jam 6 ,mem_tx_lch 
6215 6fe4434b fetch 2 ,mem_l2cap_tx_multi_offset 
6216 203a6223 branch scheduler_tx_l2cap_start_pkt ,blank 
6217 6fe2004b fetch 1 ,mem_op 
6218 c4038000 rtnbit0 op_pkt_comp 
6219 793ffe07 set0 op_pkt_comp ,pdata 
621a 67e2004b store 1 ,mem_op 
621b 70009805 jam 5 ,mem_tx_lch 
621c 6844434b fetcht 2 ,mem_l2cap_tx_multi_offset 
621d 6fe4013a fetch 2 ,mem_txptr 
621e 9840fe00 iadd temp ,pdata 
621f 67e4013a store 2 ,mem_txptr 
6220 6fe40099 fetch 2 ,mem_tx_len 
6221 98467e00 isub temp ,pdata 
6222 67e40099 store 2 ,mem_tx_len 

scheduler_tx_l2cap_start_pkt:
6223 6fe40099 fetch 2 ,mem_tx_len 
6224 203a3b25 branch assert ,blank 
6225 d8400104 arg l2cap_max_pkt_len ,temp 
6226 98467e00 isub temp ,pdata 
6227 2421622d nbranch scheduler_tx_l2cap_last_pkt ,positive 
6228 60440099 storet 2 ,mem_tx_len 
6229 6fe4434b fetch 2 ,mem_l2cap_tx_multi_offset 
622a 9840fe00 iadd temp ,pdata 
622b 67e4434b store 2 ,mem_l2cap_tx_multi_offset 
622c 2020622f branch scheduler_tx_l2cap_pkt_end 

scheduler_tx_l2cap_last_pkt:
622d 58000000 setarg 0 
622e 67e4434b store 2 ,mem_l2cap_tx_multi_offset 

scheduler_tx_l2cap_pkt_end:
622f 6fe2004b fetch 1 ,mem_op 
6230 79207e06 set1 op_txl2cap ,pdata 
6231 67e2004b store 1 ,mem_op 
6232 20600000 rtn 

sdp_process:
6233 47534034 bpatchx patch34_6 ,mem_patch34 
6234 6fe40311 fetch 2 ,mem_l2cap_payload_ptr 
6235 98000c00 iforce contr 
6236 ea420006 ifetchr regb ,1 ,contr 
6237 6242058c storer regb ,1 ,mem_sdp_pduid 
6238 efe40006 ifetch 2 ,contr 
6239 67e4058d store 2 ,mem_sdp_transactionid 
623a efe20006 ifetch 1 ,contr 
623b 1fed1600 lshift8 pdata ,timeup 
623c efe20006 ifetch 1 ,contr 
623d 99609600 iadd timeup ,timeup 
623e 4753c034 bpatchx patch34_7 ,mem_patch34 
623f 18c20400 copy contr ,temp 
6240 df200004 arg 4 ,loopcnt 
6241 d8a0059b arg mem_sdp_handle_list ,contw 
6242 2040775e call memset0 
6243 18420c00 copy temp ,contr 
6244 1a427e00 deposit regb 
6245 c000e3f1 beq sdp_error_res ,sdp_process_error_res 
6246 c001624d beq sdp_search_req ,sdp_process_ss_req 
6247 c001e3d9 beq sdp_search_res ,sdp_process_ss_res 
6248 c0026275 beq sdp_attribute_req ,sdp_process_sa_req 
6249 c002e3e6 beq sdp_attribute_res ,sdp_process_sa_res 
624a c0036321 beq sdp_searchattrib_req ,sdp_process_ssa_req 
624b c003e3d8 beq sdp_searchattrib_res ,sdp_process_ssa_res 
624c 20206447 branch sdp_insufficient_resource 

sdp_process_ss_req:
624d 47544035 bpatchx patch35_0 ,mem_patch35 
624e 20406456 call ask_serviceclassid 
624f 2841fe01 compare 1 ,temp ,0xff 
6250 2020e4c3 branch ss_empty_rsp ,true 
6251 2841feff compare 0xff ,temp ,0xff 
6252 2020e44a branch sdp_invalid_request_syntax ,true 
6253 efe40006 ifetch 2 ,contr 
6254 67e40593 store 2 ,mem_sdp_record_maxcnt 
6255 196097fe increase -2 ,timeup 
6256 196097ff increase -1 ,timeup 
6257 2422e444 nbranch sdp_invalid_pdu_size ,zero 
6258 d9600582 arg mem_sdp_uuid_search_ptr ,timeup 
6259 efe4000b ifetch 2 ,timeup 
625a 207a0000 rtn blank 
625b 20406504 call search_all_uuid 
625c 20404ac2 call l2cap_get_sdp_tx_payload 
625d 18007e03 force 3 ,pdata 
625e e7e20005 istore 1 ,contw 
625f 6fe4058d fetch 2 ,mem_sdp_transactionid 
6260 e7e40005 istore 2 ,contw 
6261 18ebfe00 lshift2 queue ,pdata 
6262 1fe0fe05 add pdata ,5 ,pdata 
6263 1fe0a605 add pdata ,5 ,regc 
6264 1ff0fe00 byteswap pdata ,pdata 
6265 e7e40005 istore 2 ,contw 
6266 18e27e00 deposit queue 
6267 1ff0fe00 byteswap pdata ,pdata 
6268 e7e40005 istore 2 ,contw 
6269 e7e40005 istore 2 ,contw 
626a d8c0059b arg mem_sdp_handle_list ,contr 
626b 18e27200 copy queue ,loopcnt 
626c 2022e270 branch ss_req_blank ,zero 

ss_req_loop:
626d efe80006 ifetch 4 ,contr 
626e e7e80005 istore 4 ,contw 
626f c200626d loop ss_req_loop 

ss_req_blank:
6270 18007e00 force 0 ,pdata 
6271 e7e20005 istore 1 ,contw 
6272 1a627e00 deposit regc 
6273 67e4031d store 2 ,mem_sdp_tx_pkt_length 
6274 20600000 rtn 

sdp_process_sa_req:
6275 4754c035 bpatchx patch35_1 ,mem_patch35 
6276 efe80006 ifetch 4 ,contr 
6277 67e80595 store 4 ,mem_sdp_record_handle 
6278 196097fc increase -4 ,timeup 
6279 2040634d call sdp_store_maxbyte 
627a 67e40591 store 2 ,mem_sdp_attribute_maxbyte 
627b 196097fe increase -2 ,timeup 
627c 204064ad call dataelementtype6 
627d 2022e44a branch sdp_invalid_request_syntax ,zero 
627e 2a21fe05 compare 5 ,rega ,0xff 
627f 2020e283 branch sa_judge_wholerange ,true 

sa_isnot_wholerange:
6280 d8a0059b arg mem_sdp_attrib_list ,contw 
6281 18000e00 force 0 ,queue 
6282 20206292 branch sa_req_loop 

sa_judge_wholerange:
6283 efe20006 ifetch 1 ,contr 
6284 c085644a bne sdp_attribute_range ,sdp_invalid_request_syntax 
6285 efe40006 ifetch 2 ,contr 
6286 243a6290 nbranch sa_judge_wholerange_false1 ,blank 
6287 efe20006 ifetch 1 ,contr 
6288 c0ffe28e bne 0xff ,sa_judge_wholerange_false2 
6289 efe20006 ifetch 1 ,contr 
628a c0ffe28c bne 0xff ,sa_judge_wholerange_false3 
628b 202062d9 branch sa_req_all 

sa_judge_wholerange_false3:
628c 18c08dfb increase -5 ,contr 
628d 20206280 branch sa_isnot_wholerange 

sa_judge_wholerange_false2:
628e 18c08dfc increase -4 ,contr 
628f 20206280 branch sa_isnot_wholerange 

sa_judge_wholerange_false1:
6290 18c08dfd increase -3 ,contr 
6291 20206280 branch sa_isnot_wholerange 

sa_req_loop:
6292 efe20006 ifetch 1 ,contr 
6293 c004e2a7 beq sdp_attribute_id ,sa_req_one_id 
6294 c0056295 beq sdp_attribute_range ,sa_req_range 

sa_req_range:
6295 efe40006 ifetch 2 ,contr 
6296 e7e40005 istore 2 ,contw 
6297 18e08e01 increase 1 ,queue 
6298 1ff0a400 byteswap pdata ,regb 
6299 efe40006 ifetch 2 ,contr 
629a 1ff0fe00 byteswap pdata ,pdata 

sa_req_range_id_increase:
629b 1a40a401 increase 1 ,regb 
629c 9a467c00 isub regb ,null 
629d 242162a4 nbranch sa_req_range_id_finish ,positive 
629e 1fe22600 copy pdata ,regc 
629f 1a50fe00 byteswap regb ,pdata 
62a0 e7e40005 istore 2 ,contw 
62a1 18e08e01 increase 1 ,queue 
62a2 1a627e00 copy regc ,pdata 
62a3 2020629b branch sa_req_range_id_increase 

sa_req_range_id_finish:
62a4 196097fb increase -5 ,timeup 
62a5 1a20a3fb increase -5 ,rega 
62a6 202062ac branch sa_req_check_next_id 

sa_req_one_id:
62a7 efe40006 ifetch 2 ,contr 
62a8 e7e40005 istore 2 ,contw 
62a9 18e08e01 increase 1 ,queue 
62aa 196097fd increase -3 ,timeup 
62ab 1a20a3fd increase -3 ,rega 

sa_req_check_next_id:
62ac 2421644a nbranch sdp_invalid_request_syntax ,positive 
62ad 2422e292 nbranch sa_req_loop ,zero 
62ae 196097ff increase -1 ,timeup 
62af 2422e44a nbranch sdp_invalid_request_syntax ,zero 
62b0 20404ac2 call l2cap_get_sdp_tx_payload 
62b1 18a08a0a increase 10 ,contw 
62b2 da20059b arg mem_sdp_attrib_list ,rega 

sa_req_handle_attributelist_next:
62b3 18e27e00 copy queue ,pdata 
62b4 203a62c6 branch sa_req_handle_attributelist_end ,blank 
62b5 efe40011 ifetch 2 ,rega 
62b6 203a62c6 branch sa_req_handle_attributelist_end ,blank 
62b7 98002400 iforce regb 
62b8 6fe80595 fetch 4 ,mem_sdp_record_handle 
62b9 98000400 iforce temp 
62ba 20406566 call search_handle_attrib 
62bb 18c27e00 copy contr ,pdata 
62bc 203a62c3 branch sa_req_handle_attributelist_notfound ,blank 
62bd 18c08dfd increase -3 ,contr 
62be efe60006 ifetch 3 ,contr 
62bf e7e60005 istore 3 ,contw 
62c0 204064dd call sdp_data_len 
62c1 98007200 iforce loopcnt 
62c2 2040779f call memcpy 

sa_req_handle_attributelist_notfound:
62c3 1a20a202 increase 2 ,rega 
62c4 18e08fff increase -1 ,queue 
62c5 202062b3 branch sa_req_handle_attributelist_next 

sa_req_handle_attributelist_end:
62c6 da200005 arg sdp_attribute_res ,rega 
62c7 204063a2 call ssa_req_range_lastfreg_common 
62c8 6fe4031d fetch 2 ,mem_sdp_tx_pkt_length 
62c9 c005e4c6 beq 11 ,sa_empty_rsp 
62ca 202063b8 branch ssa_req_range_attrbutes_length_no_continue 

sdp_store_continue_common:
62cb efe20006 ifetch 1 ,contr 
62cc c00062cf beq 0 ,sdp_store_continue_0byte 
62cd c000e2d1 beq 1 ,sdp_store_continue_1byte 
62ce c00162d4 beq 2 ,sdp_store_continue_2byte 

sdp_store_continue_0byte:
62cf 196097ff increase -1 ,timeup 
62d0 202062d7 branch sdp_store_continue_end 

sdp_store_continue_1byte:
62d1 efe20006 ifetch 1 ,contr 
62d2 196097fe increase -2 ,timeup 
62d3 202062d7 branch sdp_store_continue_end 

sdp_store_continue_2byte:
62d4 efe40006 ifetch 2 ,contr 
62d5 1ff0fe00 byteswap pdata ,pdata 
62d6 196097fd increase -3 ,timeup 

sdp_store_continue_end:
62d7 67e4058a store 2 ,mem_sdp_continue_byte 
62d8 20600000 rtn 

sa_req_all:
62d9 196097fb increase -5 ,timeup 
62da 204062cb call sdp_store_continue_common 
62db 2422e444 nbranch sdp_invalid_pdu_size ,zero 
62dc 68480595 fetcht 4 ,mem_sdp_record_handle 
62dd 20406532 call search_handle 
62de 2422e441 nbranch sdp_invalid_service_record_handle ,zero 
62df 18c22200 copy contr ,rega 
62e0 20404ac2 call l2cap_get_sdp_tx_payload 
62e1 1a220c00 copy rega ,contr 
62e2 18a08a03 increase 3 ,contw 
62e3 18c21600 copy contr ,timeup 
62e4 204064e4 call sdp_get_data 
62e5 1fe22200 copy pdata ,rega 
62e6 6a44058a fetchr regb ,2 ,mem_sdp_continue_byte 
62e7 1a227e00 copy rega ,pdata 
62e8 9a462400 isub regb ,regb 
62e9 6fe40591 fetch 2 ,mem_sdp_attribute_maxbyte 
62ea 9a467c00 isub regb ,null 
62eb 24216307 nbranch sa_req_all_fragment_sdp ,positive 
62ec 78547c00 disable user 
62ed 6fe4058a fetch 2 ,mem_sdp_continue_byte 
62ee 203a62fa branch sa_req_all_fisrt_fragment ,blank 
62ef 99608c00 iadd timeup ,contr 
62f0 1a40a403 increase 3 ,regb 
62f1 1a427200 copy regb ,loopcnt 
62f2 1f227e00 copy loopcnt ,pdata 
62f3 1fe0fe03 increase 3 ,pdata 
62f4 1ff0fe00 byteswap pdata ,pdata 
62f5 e7e40005 istore 2 ,contw 
62f6 1f227e00 copy loopcnt ,pdata 
62f7 1ff0fe00 byteswap pdata ,pdata 
62f8 e7e40005 istore 2 ,contw 
62f9 20206314 branch sa_req_all_answer_attributelist_full_loop 

sa_req_all_fisrt_fragment:
62fa 1a20f206 add rega ,6 ,loopcnt 
62fb 203462fe branch sa_req_all_parlength_continue_byte ,user 
62fc 1f30fe00 byteswap loopcnt ,pdata 
62fd 20206301 branch sa_req_all_parlength_continue_byte_end 

sa_req_all_parlength_continue_byte:
62fe 1f227e00 copy loopcnt ,pdata 
62ff 1fe0fe02 increase 2 ,pdata 
6300 1ff0fe00 byteswap pdata ,pdata 

sa_req_all_parlength_continue_byte_end:
6301 e7e40005 istore 2 ,contw 
6302 1f20f3fd increase -3 ,loopcnt 
6303 1f30fe00 byteswap loopcnt ,pdata 
6304 e7e40005 istore 2 ,contw 
6305 19620c00 copy timeup ,contr 
6306 20206314 branch sa_req_all_answer_attributelist_full_loop 

sa_req_all_fragment_sdp:
6307 78347c00 enable user 
6308 6a240591 fetchr rega ,2 ,mem_sdp_attribute_maxbyte 
6309 1a227200 copy rega ,loopcnt 
630a 6fe4058a fetch 2 ,mem_sdp_continue_byte 
630b 203a62fa branch sa_req_all_fisrt_fragment ,blank 
630c 99608c00 iadd timeup ,contr 
630d 1a227e00 copy rega ,pdata 
630e 1fe0fe05 increase 5 ,pdata 
630f 1ff0fe00 byteswap pdata ,pdata 
6310 e7e40005 istore 2 ,contw 
6311 1a227e00 copy rega ,pdata 
6312 1ff0fe00 byteswap pdata ,pdata 
6313 e7e40005 istore 2 ,contw 

sa_req_all_answer_attributelist_full_loop:
6314 2040779f call memcpy 
6315 2434631d nbranch sa_req_all_last_frag_continue ,user 
6316 18007e02 force 2 ,pdata 
6317 e7e20005 istore 1 ,contw 
6318 18c27e00 copy contr ,pdata 
6319 99667e00 isub timeup ,pdata 
631a 1ff0fe00 byteswap pdata ,pdata 
631b e7e40005 istore 2 ,contw 
631c 2020631f branch sa_req_all_frag_end 

sa_req_all_last_frag_continue:
631d 18007e00 force 0 ,pdata 
631e e7e20005 istore 1 ,contw 

sa_req_all_frag_end:
631f da200005 arg sdp_attribute_res ,rega 
6320 202063ce branch ssa_req_range_common 

sdp_process_ssa_req:
6321 47554035 bpatchx patch35_2 ,mem_patch35 
6322 20406456 call ask_serviceclassid 
6323 2841feff compare 0xff ,temp ,0xff 
6324 2020e44a branch sdp_invalid_request_syntax ,true 
6325 2040634d call sdp_store_maxbyte 
6326 67e40591 store 2 ,mem_sdp_attribute_maxbyte 
6327 196097fe increase -2 ,timeup 
6328 204064ad call dataelementtype6 
6329 d8a0059b arg mem_sdp_attrib_list ,contw 
632a 18000e00 force 0 ,queue 

ssa_req_loop:
632b efe20006 ifetch 1 ,contr 
632c c0056355 beq sdp_attribute_range ,ssa_req_range 
632d efe40006 ifetch 2 ,contr 
632e e7e40005 istore 2 ,contw 
632f 18e08e01 increase 1 ,queue 
6330 196097fd increase -3 ,timeup 
6331 1a20a3fd increase -3 ,rega 
6332 2421644a nbranch sdp_invalid_request_syntax ,positive 
6333 2422e32b nbranch ssa_req_loop ,zero 
6334 196097ff increase -1 ,timeup 
6335 2422e44a nbranch sdp_invalid_request_syntax ,zero 
6336 20404ac2 call l2cap_get_sdp_tx_payload 
6337 18a08a0d increase 13 ,contw 
6338 6fe40582 fetch 2 ,mem_sdp_uuid_search_ptr 
6339 98002600 iforce regc 
633a da20059b arg mem_sdp_attrib_list ,rega 

ssa_req_attributelist_next:
633b efe40011 ifetch 2 ,rega 
633c 203a6348 branch ssa_req_attributelist_end ,blank 
633d 98002400 iforce regb 
633e 20406546 call search_attrib 
633f 203a6346 branch ssa_req_attributelist_notfound ,blank 
6340 18c08dfd increase -3 ,contr 
6341 efe60006 ifetch 3 ,contr 
6342 e7e60005 istore 3 ,contw 
6343 204064dd call sdp_data_len 
6344 98007200 iforce loopcnt 
6345 2040779f call memcpy 

ssa_req_attributelist_notfound:
6346 1a20a202 increase 2 ,rega 
6347 2020633b branch ssa_req_attributelist_next 

ssa_req_attributelist_end:
6348 204063a1 call ssa_req_range_lastfreg 
6349 6fe4031d fetch 2 ,mem_sdp_tx_pkt_length 
634a c00764c9 beq 14 ,ssa_empty_rsp 
634b 204063b8 call ssa_req_range_attrbutes_length_no_continue 
634c 202063b8 branch ssa_req_range_attrbutes_length_no_continue 

sdp_store_maxbyte:
634d efe40006 ifetch 2 ,contr 
634e 1ff0fe00 byteswap pdata ,pdata 
634f 1fe0fffd increase -3 ,pdata 
6350 d84000c8 arg 200 ,temp 
6351 98467c00 isub temp ,null 
6352 24610000 nrtn positive 
6353 580000c8 setarg 200 
6354 20600000 rtn 

ssa_req_range:
6355 18c08c04 increase 4 ,contr 
6356 196097fb increase -5 ,timeup 
6357 1a20a3fb increase -5 ,rega 
6358 2422e44a nbranch sdp_invalid_request_syntax ,zero 
6359 204062cb call sdp_store_continue_common 
635a 2422e444 nbranch sdp_invalid_pdu_size ,zero 
635b d9600582 arg mem_sdp_uuid_search_ptr ,timeup 
635c 20406504 call search_all_uuid 
635d 18e27e00 deposit queue 
635e 203a64c9 branch ssa_empty_rsp ,blank 
635f 67e205bf store 1 ,mem_handle_humber 
6360 624405bd storer regb ,2 ,mem_sdp_all_length 
6361 d8e00000 arg 0 ,queue 
6362 da200000 arg 0 ,rega 
6363 20404ac2 call l2cap_get_sdp_tx_payload 
6364 18a08a0a increase 10 ,contw 

ssa_req_range_find_handle:
6365 2040638a call ssa_req_range_get_length 
6366 24343b25 nbranch assert ,user 
6367 18c21600 copy contr ,timeup 
6368 1fe22600 copy pdata ,regc 
6369 9a20a200 iadd rega ,rega 
636a 6fe4058a fetch 2 ,mem_sdp_continue_byte 
636b 1fe22400 copy pdata ,regb 
636c 203a6393 branch ssa_req_range_first_freg ,blank 

ssa_req_range_later_freg_with_continue:
636d 1a227e00 copy rega ,pdata 
636e 9a462400 isub regb ,regb 
636f 2022e385 branch ssa_req_range_next_handle ,zero 
6370 24216385 nbranch ssa_req_range_next_handle ,positive 
6371 6fe40591 fetch 2 ,mem_sdp_attribute_maxbyte 
6372 9a467c00 isub regb ,null 
6373 2022e37c branch ssa_req_range_maxbyte_with_continue ,zero 
6374 2421637c nbranch ssa_req_range_maxbyte_with_continue ,positive 

ssa_req_range_send_not_maxbyte:
6375 1a427200 copy regb ,loopcnt 
6376 2040637f call ssa_req_range_maxbyte_with_continue_cpy 
6377 6fe205bf fetch 1 ,mem_handle_humber 
6378 18e08e01 increase 1 ,queue 
6379 98e67c00 isub queue ,null 
637a 2022e3a1 branch ssa_req_range_lastfreg ,zero 
637b 202063be branch ssa_req_range_freg_with_continue 

ssa_req_range_maxbyte_with_continue:
637c 1fe27200 copy pdata ,loopcnt 
637d 2040637f call ssa_req_range_maxbyte_with_continue_cpy 
637e 202063be branch ssa_req_range_freg_with_continue 

ssa_req_range_maxbyte_with_continue_cpy:
637f 18a08bfd increase -3 ,contw 
6380 1f220400 copy loopcnt ,temp 
6381 1a627e00 copy regc ,pdata 
6382 9a467e00 isub regb ,pdata 
6383 99608c00 iadd timeup ,contr 
6384 2020779f branch memcpy 

ssa_req_range_next_handle:
6385 6fe205bf fetch 1 ,mem_handle_humber 
6386 18e08e01 increase 1 ,queue 
6387 98e67c00 isub queue ,null 
6388 20628000 rtn zero 
6389 20206365 branch ssa_req_range_find_handle 

ssa_req_range_get_length:
638a 204078ec call disable_user 
638b d8c0059b arg mem_sdp_handle_list ,contr 
638c 18ebfe00 lshift2 queue ,pdata 
638d 98c08c00 iadd contr ,contr 
638e e8480006 ifetcht 4 ,contr 
638f 20406532 call search_handle 
6390 24628000 nrtn zero 
6391 204064dd call sdp_data_len 
6392 20207903 branch enable_user 

ssa_req_range_first_freg:
6393 6fe40591 fetch 2 ,mem_sdp_attribute_maxbyte 
6394 9a267c00 isub rega ,null 
6395 242163ad nbranch ssa_req_range_firstfreg_maxbyte_with_continue ,positive 
6396 1a227200 copy rega ,loopcnt 
6397 1f220400 copy loopcnt ,temp 
6398 19620c00 copy timeup ,contr 
6399 2040779f call memcpy 
639a 6fe405bd fetch 2 ,mem_sdp_all_length 
639b 9a267c00 isub rega ,null 
639c 2022e39f branch ssa_req_range_freg_no_continue ,zero 

ssa_req_range_firstfreg_not_maxbyte_with_continue:
639d 204063be call ssa_req_range_freg_with_continue 
639e 202063b2 branch ssa_req_range_attrbutes_length 

ssa_req_range_freg_no_continue:
639f 204063a1 call ssa_req_range_lastfreg 
63a0 202063b2 branch ssa_req_range_attrbutes_length 

ssa_req_range_lastfreg:
63a1 da200007 arg sdp_searchattrib_res ,rega 

ssa_req_range_lastfreg_common:
63a2 18007e00 force 0 ,pdata 
63a3 e7e20005 istore 1 ,contw 
63a4 204063ce call ssa_req_range_common 
63a5 6844031d fetcht 2 ,mem_sdp_tx_pkt_length 
63a6 184085fb increase -5 ,temp 
63a7 1850fe00 byteswap temp ,pdata 
63a8 e7e40005 istore 2 ,contw 
63a9 184085fd increase -3 ,temp 
63aa 1850fe00 byteswap temp ,pdata 
63ab e7e40005 istore 2 ,contw 
63ac 20600000 rtn 

ssa_req_range_firstfreg_maxbyte_with_continue:
63ad 1fe27200 copy pdata ,loopcnt 
63ae 1f220400 copy loopcnt ,temp 
63af 19620c00 copy timeup ,contr 
63b0 2040779f call memcpy 
63b1 204063be call ssa_req_range_freg_with_continue 

ssa_req_range_attrbutes_length:
63b2 58000036 setarg 0x36 
63b3 e7e20005 istore 1 ,contw 
63b4 6fe405bd fetch 2 ,mem_sdp_all_length 
63b5 1ff0fe00 byteswap pdata ,pdata 
63b6 e7e40005 istore 2 ,contw 
63b7 20600000 rtn 

ssa_req_range_attrbutes_length_no_continue:
63b8 58000036 setarg 0x36 
63b9 e7e20005 istore 1 ,contw 
63ba 184085fd increase -3 ,temp 
63bb 1850fe00 byteswap temp ,pdata 
63bc e7e40005 istore 2 ,contw 
63bd 20600000 rtn 

ssa_req_range_freg_with_continue:
63be da200007 arg sdp_searchattrib_res ,rega 
63bf 58000002 setarg 2 
63c0 e7e20005 istore 1 ,contw 
63c1 6fe4058a fetch 2 ,mem_sdp_continue_byte 
63c2 98408400 iadd temp ,temp 
63c3 1850fe00 byteswap temp ,pdata 
63c4 e7e40005 istore 2 ,contw 
63c5 204063ce call ssa_req_range_common 
63c6 6844031d fetcht 2 ,mem_sdp_tx_pkt_length 
63c7 184085fb increase -5 ,temp 
63c8 1850fe00 byteswap temp ,pdata 
63c9 e7e40005 istore 2 ,contw 
63ca 184085fb increase -5 ,temp 
63cb 1850fe00 byteswap temp ,pdata 
63cc e7e40005 istore 2 ,contw 
63cd 20600000 rtn 

ssa_req_range_common:
63ce 6fe4031b fetch 2 ,mem_sdp_tx_payload_ptr 
63cf 98a67e00 isub contw ,pdata 
63d0 1fe67e00 sub pdata ,0 ,pdata 
63d1 67e4031d store 2 ,mem_sdp_tx_pkt_length 
63d2 20404ac2 call l2cap_get_sdp_tx_payload 
63d3 1a227e00 copy rega ,pdata 
63d4 e7e20005 istore 1 ,contw 
63d5 6fe4058d fetch 2 ,mem_sdp_transactionid 
63d6 e7e40005 istore 2 ,contw 
63d7 20600000 rtn 

sdp_process_ssa_res:
63d8 20600000 rtn 

sdp_process_ss_res:
63d9 4755c035 bpatchx patch35_3 ,mem_patch35 
63da efe40006 ifetch 2 ,contr 
63db efe40006 ifetch 2 ,contr 
63dc 1ff0fe00 byteswap pdata ,pdata 
63dd c080bb25 bne 1 ,assert 
63de efe80006 ifetch 4 ,contr 
63df 67e80595 store 4 ,mem_sdp_record_handle 
63e0 6a6445f5 fetchr regc ,2 ,mem_sdp_l2capch_ptr 
63e1 1a60a601 add regc ,offset_lc_state ,regc 
63e2 efe20013 ifetch 1 ,regc 
63e3 79207e06 set1 l2cap_channel_state_recv_search_res ,pdata 
63e4 e7e20013 istore 1 ,regc 
63e5 20600000 rtn 

sdp_process_sa_res:
63e6 47564035 bpatchx patch35_4 ,mem_patch35 
63e7 6a6445f5 fetchr regc ,2 ,mem_sdp_l2capch_ptr 
63e8 1a60a601 add regc ,offset_lc_state ,regc 
63e9 efe20013 ifetch 1 ,regc 
63ea 79207e07 set1 l2cap_channel_state_recv_attrib_res ,pdata 
63eb e7e20013 istore 1 ,regc 
63ec 18420c00 copy temp ,contr 
63ed efe40006 ifetch 2 ,contr 
63ee 20406580 call search_rfcomm_cn 
63ef 67e245b6 store 1 ,mem_profile_channel 
63f0 20600000 rtn 

sdp_process_error_res:
63f1 20600000 rtn 

attribute_reading:
63f2 204064ad call dataelementtype6 
63f3 2022e43f branch rdnortn ,zero 
63f4 18002400 force 0 ,regb 
63f5 efe20006 ifetch 1 ,contr 
63f6 1a20a3ff increase -1 ,rega 
63f7 196097ff increase -1 ,timeup 
63f8 2fe1f018 compare 0x18 ,pdata ,0xf8 
63f9 2420e439 nbranch rduuid3 ,true 
63fa 2fe00e04 compare 0x04 ,pdata ,0x07 
63fb 2420e401 nbranch is032 ,true 
63fc 18002401 force 1 ,regb 

skp2bytes:
63fd 18c08c02 increase 2 ,contr 
63fe 1a20a3fe increase -2 ,rega 
63ff 196097fe increase -2 ,timeup 
6400 20206406 branch rduuid1 

is032:
6401 2fe00e02 compare 0x02 ,pdata ,0x07 
6402 2420e404 nbranch is016 ,true 
6403 202063fd branch skp2bytes 

is016:
6404 2fe00e01 compare 0x01 ,pdata ,0x07 
6405 2420e439 nbranch rduuid3 ,true 

rduuid1:
6406 efe20006 ifetch 1 ,contr 
6407 1a20a3ff increase -1 ,rega 
6408 196097ff increase -1 ,timeup 
6409 c080e410 bne 0x01 ,rduuid2 
640a efe20006 ifetch 1 ,contr 
640b 1a20a3ff increase -1 ,rega 
640c 196097ff increase -1 ,timeup 
640d c0806439 bne 0x00 ,rduuid3 
640e 700599ff jam 0xff ,mem_sdp_lacap_found 
640f 20206439 branch rduuid3 

rduuid2:
6410 c0806439 bne 0x00 ,rduuid3 
6411 efe20006 ifetch 1 ,contr 
6412 1a20a3ff increase -1 ,rega 
6413 196097ff increase -1 ,timeup 
6414 c081e439 bne 0x03 ,rduuid3 
6415 1a427c00 copy regb ,null 
6416 2022e419 branch not16by ,zero 
6417 18c08df4 increase -12 ,contr 
6418 196097f4 increase -12 ,timeup 

not16by:
6419 18007eff force 0xff ,pdata 
641a 67e2059a store 1 ,mem_sdp_rfcomm_found 
641b efe20006 ifetch 1 ,contr 
641c 1a20a3ff increase -1 ,rega 
641d 196097ff increase -1 ,timeup 
641e 2fe1f008 compare 0x08 ,pdata ,0xf8 
641f 2420e439 nbranch rduuid3 ,true 
6420 2fe00e00 compare 0x00 ,pdata ,0x07 
6421 2020e436 branch unsign1 ,true 
6422 2fe00e01 compare 0x01 ,pdata ,0x07 
6423 2020e433 branch unsign2 ,true 
6424 2fe00e02 compare 0x02 ,pdata ,0x07 
6425 2020e430 branch unsign4 ,true 
6426 2fe00e03 compare 0x03 ,pdata ,0x07 
6427 2020e42d branch unsign8 ,true 
6428 2fe00e04 compare 0x04 ,pdata ,0x07 
6429 2420e439 nbranch rduuid3 ,true 
642a 18c08c08 increase 8 ,contr 
642b 1a20a3f8 increase -8 ,rega 
642c 196097f8 increase -8 ,timeup 

unsign8:
642d 18c08c04 increase 4 ,contr 
642e 1a20a3fc increase -4 ,rega 
642f 196097fc increase -4 ,timeup 

unsign4:
6430 18c08c02 increase 2 ,contr 
6431 1a20a3fe increase -2 ,rega 
6432 196097fe increase -2 ,timeup 

unsign2:
6433 18c08c01 increase 1 ,contr 
6434 1a20a3ff increase -1 ,rega 
6435 196097ff increase -1 ,timeup 

unsign1:
6436 efe20006 ifetch 1 ,contr 
6437 1a20a3ff increase -1 ,rega 
6438 196097ff increase -1 ,timeup 

rduuid3:
6439 196097ff increase -1 ,timeup 
643a 1a20a3ff increase -1 ,rega 
643b 20216439 branch rduuid3 ,positive 
643c 19609601 increase 1 ,timeup 
643d 18007e01 force 0x01 ,pdata 
643e 20600000 rtn 

rdnortn:
643f 18007e00 force 0x00 ,pdata 
6440 20600000 rtn 

sdp_invalid_service_record_handle:
6441 58000200 setarg 0x0200 
6442 67e405bb store 2 ,mem_sdp_error_code 
6443 2020644c branch sdp_error_response 

sdp_invalid_pdu_size:
6444 58000400 setarg 0x0400 
6445 67e405bb store 2 ,mem_sdp_error_code 
6446 2020644c branch sdp_error_response 

sdp_insufficient_resource:
6447 58000600 setarg 0x0600 
6448 67e405bb store 2 ,mem_sdp_error_code 
6449 2020644c branch sdp_error_response 

sdp_invalid_request_syntax:
644a 58000300 setarg 0x0300 
644b 67e405bb store 2 ,mem_sdp_error_code 

sdp_error_response:
644c 20404ac2 call l2cap_get_sdp_tx_payload 
644d e7e20005 istore 1 ,contw 
644e 6fe4058d fetch 2 ,mem_sdp_transactionid 
644f e7e40005 istore 2 ,contw 
6450 58000200 setarg 0x0200 
6451 e7e40005 istore 2 ,contw 
6452 6fe405bb fetch 2 ,mem_sdp_error_code 
6453 e7e40005 istore 2 ,contw 
6454 70031d07 jam 7 ,mem_sdp_tx_pkt_length 
6455 20600000 rtn 

ask_serviceclassid:
6456 da400000 arg 0 ,regb 
6457 18000400 force 0 ,temp 
6458 d8a00582 arg mem_sdp_uuid_search_ptr ,contw 
6459 204064ad call dataelementtype6 
645a 2022e4ab branch asksrv_error ,zero 

classidloop:
645b 1a40a401 increase 1 ,regb 
645c efe20006 ifetch 1 ,contr 
645d 1a20a3ff increase -1 ,rega 
645e 196097ff increase -1 ,timeup 
645f 2fe1f018 compare 0x18 ,pdata ,0xf8 
6460 2420e4ab nbranch asksrv_error ,true 
6461 2fe00e04 compare 0x04 ,pdata ,0x07 
6462 2420e479 nbranch cmp032 ,true 
6463 18000401 force 1 ,temp 

skip2bytes:
6464 efe20006 ifetch 1 ,contr 
6465 1a20a3ff increase -1 ,rega 
6466 196097ff increase -1 ,timeup 
6467 c080646d bne 0x00 ,frstbwrong 
6468 efe20006 ifetch 1 ,contr 
6469 1a20a3ff increase -1 ,rega 
646a 196097ff increase -1 ,timeup 
646b c000647e beq 0x00 ,cmpuuid 
646c 20206470 branch scndbwrong 

frstbwrong:
646d 18c08c01 increase 1 ,contr 
646e 1a20a3ff increase -1 ,rega 
646f 196097ff increase -1 ,timeup 

scndbwrong:
6470 18c08c02 increase 2 ,contr 
6471 1a20a3fe increase -2 ,rega 
6472 196097fe increase -2 ,timeup 
6473 2841fe00 compare 0x00 ,temp ,0xff 
6474 2020e4a6 branch loopornot ,true 
6475 18c08c0c increase 12 ,contr 
6476 1a20a3f4 increase -12 ,rega 
6477 196097f4 increase -12 ,timeup 
6478 202064a6 branch loopornot 

cmp032:
6479 2fe00e02 compare 0x02 ,pdata ,0x07 
647a 2420e47c nbranch cmp016 ,true 
647b 20206464 branch skip2bytes 

cmp016:
647c 2fe00e01 compare 0x01 ,pdata ,0x07 
647d 2420e4ab nbranch asksrv_error ,true 

cmpuuid:
647e 1a20a3fe increase -2 ,rega 
647f 196097fe increase -2 ,timeup 
6480 efe40006 ifetch 2 ,contr 
6481 1a467c04 sub regb ,4 ,null 
6482 2022e484 branch uuidsize ,zero 
6483 e7e40005 istore 2 ,contw 

uuidsize:
6484 2841fe00 compare 0x00 ,temp ,0xff 
6485 2020e4a6 branch loopornot ,true 
6486 18c20400 copy contr ,temp 
6487 efe20006 ifetch 1 ,contr 
6488 c080649f bne 0x00 ,wrong12b 
6489 efe20006 ifetch 1 ,contr 
648a c080649f bne 0x00 ,wrong12b 
648b efe20006 ifetch 1 ,contr 
648c c088649f bne 0x10 ,wrong12b 
648d efe20006 ifetch 1 ,contr 
648e c080649f bne 0x00 ,wrong12b 
648f efe20006 ifetch 1 ,contr 
6490 c0c0649f bne 0x80 ,wrong12b 
6491 efe20006 ifetch 1 ,contr 
6492 c080649f bne 0x00 ,wrong12b 
6493 efe20006 ifetch 1 ,contr 
6494 c080649f bne 0x00 ,wrong12b 
6495 efe20006 ifetch 1 ,contr 
6496 c0c0649f bne 0x80 ,wrong12b 
6497 efe20006 ifetch 1 ,contr 
6498 c0afe49f bne 0x5f ,wrong12b 
6499 efe20006 ifetch 1 ,contr 
649a c0cde49f bne 0x9b ,wrong12b 
649b efe20006 ifetch 1 ,contr 
649c c09a649f bne 0x34 ,wrong12b 
649d efe20006 ifetch 1 ,contr 
649e c07de4a4 beq 0xfb ,chck12dn 

wrong12b:
649f 18420c00 copy temp ,contr 

wrong12b1:
64a0 18c08c0c increase 12 ,contr 
64a1 18000e00 force 0x00 ,queue 
64a2 18000400 force 0x00 ,temp 
64a3 202064a4 branch chck12dn 

chck12dn:
64a4 196097f4 increase -12 ,timeup 
64a5 1a20a3f4 increase -12 ,rega 

loopornot:
64a6 2a21fe00 compare 0x00 ,rega ,0xff 
64a7 2420e45b nbranch classidloop ,true 
64a8 18007e00 force 0 ,pdata 
64a9 e7e40005 istore 2 ,contw 
64aa 20600000 rtn 

asksrv_error:
64ab d84000ff arg 0xff ,temp 
64ac 20600000 rtn 

dataelementtype6:
64ad efe20006 ifetch 1 ,contr 
64ae 196097ff increase -1 ,timeup 
64af 2fe1f030 compare 0x30 ,pdata ,0xf8 
64b0 2420e4c1 nbranch dsize_error ,true 
64b1 2fe00e07 compare 0x07 ,pdata ,0x07 
64b2 2020e4ba branch dsize32 ,true 
64b3 2fe00e06 compare 0x06 ,pdata ,0x07 
64b4 2020e4bc branch dsize16 ,true 
64b5 2fe00e05 compare 0x05 ,pdata ,0x07 
64b6 2420e4c1 nbranch dsize_error ,true 
64b7 ea220006 ifetchr rega ,1 ,contr 
64b8 196097ff increase -1 ,timeup 
64b9 202064bf branch dsize 

dsize32:
64ba 18c08c02 increase 2 ,contr 
64bb 196097fe increase -2 ,timeup 

dsize16:
64bc efe40006 ifetch 2 ,contr 
64bd 1ff0a200 byteswap pdata ,rega 
64be 196097fe increase -2 ,timeup 

dsize:
64bf 18007e01 force 0x01 ,pdata 
64c0 20600000 rtn 

dsize_error:
64c1 18007e00 force 0x00 ,pdata 
64c2 20600000 rtn 

ss_empty_rsp:
64c3 58000003 setarg sdp_search_res 
64c4 67e2058c store 1 ,mem_sdp_pduid 
64c5 202064cb branch empty_response 

sa_empty_rsp:
64c6 58000005 setarg sdp_attribute_res 
64c7 67e2058c store 1 ,mem_sdp_pduid 
64c8 202064cb branch empty_response 

ssa_empty_rsp:
64c9 58000007 setarg sdp_searchattrib_res 
64ca 67e2058c store 1 ,mem_sdp_pduid 

empty_response:
64cb 20404ac2 call l2cap_get_sdp_tx_payload 
64cc 6a42058c fetchr regb ,1 ,mem_sdp_pduid 
64cd e2420005 istorer regb ,1 ,contw 
64ce 6fe4058d fetch 2 ,mem_sdp_transactionid 
64cf e7e40005 istore 2 ,contw 
64d0 58000500 setarg 0x0500 
64d1 e7e40005 istore 2 ,contw 
64d2 2a41fe05 compare sdp_attribute_res ,regb ,0xff 
64d3 2020e4d9 branch fullsearch ,true 
64d4 2a41fe07 compare sdp_searchattrib_res ,regb ,0xff 
64d5 2020e4d9 branch fullsearch ,true 
64d6 58000000 setarg 0x000000 
64d7 e7ea0005 istore 5 ,contw 
64d8 202064db branch outempty 

fullsearch:
64d9 58350200 setarg 0x350200 
64da e7ea0005 istore 5 ,contw 

outempty:
64db 70031d0a jam 10 ,mem_sdp_tx_pkt_length 
64dc 20600000 rtn 

sdp_data_len:
64dd 20407778 call store_contw 
64de 2040777b call store_contr 
64df 204064e4 call sdp_get_data 
64e0 20407772 call get_contw 
64e1 20407775 call get_contr 
64e2 18427e00 copy temp ,pdata 
64e3 20600000 rtn 

sdp_get_data:
64e4 efe20006 ifetch 1 ,contr 
64e5 1fe17207 and pdata ,0x7 ,loopcnt 
64e6 1fe97e00 rshift3 pdata ,pdata 
64e7 c08064ee bne 0 ,sdp_get_data_type_not0 

sdp_get_data_type0:
64e8 18007e01 force 1 ,pdata 
64e9 18000401 force 1 ,temp 
64ea 20600000 rtn 

sdp_get_data_type_not0_sizeindex01234:
64eb 2040771c call left_shift_n 
64ec 1fe08401 add pdata ,1 ,temp 
64ed 20600000 rtn 

sdp_get_data_type_not0:
64ee 1f227e00 deposit loopcnt 
64ef 1fe67c04 sub pdata ,4 ,null 
64f0 202164eb branch sdp_get_data_type_not0_sizeindex01234 ,positive 
64f1 c002e4f5 beq 5 ,sdp_get_data_type_not0_sizeindex5 
64f2 c00364f8 beq 6 ,sdp_get_data_type_not0_sizeindex6 
64f3 c003e4fc beq 7 ,sdp_get_data_type_not0_sizeindex7 
64f4 20600000 rtn 

sdp_get_data_type_not0_sizeindex5:
64f5 efe20006 ifetch 1 ,contr 
64f6 1fe08402 add pdata ,2 ,temp 
64f7 20600000 rtn 

sdp_get_data_type_not0_sizeindex6:
64f8 efe40006 ifetch 2 ,contr 
64f9 1ff0fe00 byteswap pdata ,pdata 
64fa 1fe08403 add pdata ,3 ,temp 
64fb 20600000 rtn 

sdp_get_data_type_not0_sizeindex7:
64fc efe40006 ifetch 2 ,contr 
64fd 1ff0fe00 byteswap pdata ,pdata 
64fe e8440006 ifetcht 2 ,contr 
64ff 18508400 byteswap temp ,temp 
6500 18500400 lshift16 temp ,temp 
6501 9840fe00 iadd temp ,pdata 
6502 1fe08405 add pdata ,5 ,temp 
6503 20600000 rtn 

search_all_uuid:
6504 18000e00 force 0 ,queue 
6505 da400000 arg 0 ,regb 
6506 d8a0059b arg mem_sdp_handle_list ,contw 

search_all_uuid_llop:
6507 efe4000b ifetch 2 ,timeup 
6508 207a0000 rtn blank 
6509 2040650e call search_uuid 
650a 18e27e00 copy queue ,pdata 
650b c1038000 rtneq sdp_max_handle_number 
650c 19609602 increase 2 ,timeup 
650d 20206507 branch search_all_uuid_llop 

search_uuid:
650e 98002600 iforce regc 
650f 6fe445bb fetch 2 ,mem_ui_uuid_table 
6510 98000c00 iforce contr 

search_uuid_next:
6511 18e27e00 copy queue ,pdata 
6512 c1038000 rtneq sdp_max_handle_number 
6513 78547c00 disable user 
6514 efe20006 ifetch 1 ,contr 
6515 207a0000 rtn blank 
6516 98007200 iforce loopcnt 

search_uuid_loop:
6517 efe40006 ifetch 2 ,contr 
6518 9a667c00 isub regc ,null 
6519 2422e51b nbranch search_uuid_not_found ,zero 
651a 78347c00 enable user 

search_uuid_not_found:
651b c2006517 loop search_uuid_loop 
651c e8480006 ifetcht 4 ,contr 
651d 18c22200 copy contr ,rega 
651e 2434652e nbranch search_uuid_nomatch ,user 
651f d8c0059b arg mem_sdp_handle_list ,contr 
6520 df200007 arg sdp_max_handle_number ,loopcnt 

search_uuid_check_same_handle:
6521 efe80006 ifetch 4 ,contr 
6522 203a6527 branch search_uuid_store_handle ,blank 
6523 98467c00 isub temp ,null 
6524 2022e52e branch search_uuid_nomatch ,zero 
6525 c2006521 loop search_uuid_check_same_handle 
6526 20600000 rtn 

search_uuid_store_handle:
6527 e0480005 istoret 4 ,contw 
6528 18e08e01 increase 1 ,queue 
6529 1a220c00 copy rega ,contr 
652a 204064dd call sdp_data_len 
652b 9a40a400 iadd regb ,regb 
652c 98c08c00 iadd contr ,contr 
652d 20206511 branch search_uuid_next 

search_uuid_nomatch:
652e 1a220c00 copy rega ,contr 
652f 204064e4 call sdp_get_data 
6530 98c08c00 iadd contr ,contr 
6531 20206511 branch search_uuid_next 

search_handle:
6532 6fe445bb fetch 2 ,mem_ui_uuid_table 
6533 98000c00 iforce contr 

search_handle_loop:
6534 efe20006 ifetch 1 ,contr 
6535 203a78fc branch disable_zero ,blank 
6536 1fe3fe00 lshift pdata ,pdata 
6537 98c08c00 iadd contr ,contr 
6538 efe80006 ifetch 4 ,contr 
6539 98467c00 isub temp ,null 
653a 20628000 rtn zero 
653b 18a27e00 deposit contw 
653c 67e40b27 store 2 ,mem_contw 
653d 60500b0d storet 8 ,mem_temp 
653e 204064e4 call sdp_get_data 
653f 98c08c00 iadd contr ,contr 
6540 18c27e00 copy contr ,pdata 
6541 68440b27 fetcht 2 ,mem_contw 
6542 18420a00 copy temp ,contw 
6543 68500b0d fetcht 8 ,mem_temp 
6544 1fe20c00 copy pdata ,contr 
6545 20206534 branch search_handle_loop 

search_attrib:
6546 6fe445bb fetch 2 ,mem_ui_uuid_table 
6547 98000c00 iforce contr 

search_attrib_next:
6548 efe20006 ifetch 1 ,contr 
6549 203a6563 branch search_attrib_end ,blank 
654a 98007200 iforce loopcnt 

search_attrib_loop:
654b efe40006 ifetch 2 ,contr 
654c 9a667c00 isub regc ,null 
654d 2022e553 branch search_attrib_found_uuid ,zero 
654e c200654b loop search_attrib_loop 
654f 18c08c04 increase 4 ,contr 
6550 204064e4 call sdp_get_data 
6551 98c08c00 iadd contr ,contr 
6552 20206548 branch search_attrib_next 

search_attrib_found_uuid:
6553 1f20f3ff increase -1 ,loopcnt 
6554 1f23fe00 lshift loopcnt ,pdata 
6555 98c08c00 iadd contr ,contr 
6556 18c08c04 increase 4 ,contr 
6557 204064e4 call sdp_get_data 
6558 98c09600 iadd contr ,timeup 

search_attrib_loop_attribs:
6559 18c08c01 increase 1 ,contr 
655a efe40006 ifetch 2 ,contr 
655b 9a467c00 isub regb ,null 
655c 2022f905 branch setarg1 ,zero 
655d 204064dd call sdp_data_len 
655e 98c08c00 iadd contr ,contr 
655f 19627e00 deposit timeup 
6560 98c67c00 isub contr ,null 
6561 2022e563 branch search_attrib_end ,zero 
6562 20206559 branch search_attrib_loop_attribs 

search_attrib_end:
6563 18000c00 force 0 ,contr 
6564 18007e00 force 0 ,pdata 
6565 20600000 rtn 

search_handle_attrib:
6566 6fe445bb fetch 2 ,mem_ui_uuid_table 
6567 98000c00 iforce contr 

search_handle_attrib_next:
6568 efe20006 ifetch 1 ,contr 
6569 203a657e branch search_handle_attrib_end ,blank 
656a 1fe3fe00 lshift pdata ,pdata 
656b 98c08c00 iadd contr ,contr 
656c efe80006 ifetch 4 ,contr 
656d 98467c00 isub temp ,null 
656e 2022e572 branch search_handl_attrib_found_handle ,zero 
656f 204064e4 call sdp_get_data 
6570 98c08c00 iadd contr ,contr 
6571 20206568 branch search_handle_attrib_next 

search_handl_attrib_found_handle:
6572 204064e4 call sdp_get_data 
6573 98c09600 iadd contr ,timeup 

search_handle_attrib_loop_attribs:
6574 18c08c01 increase 1 ,contr 
6575 efe40006 ifetch 2 ,contr 
6576 9a467c00 isub regb ,null 
6577 20628000 rtn zero 
6578 204064dd call sdp_data_len 
6579 98c08c00 iadd contr ,contr 
657a 19627e00 deposit timeup 
657b 98c67c00 isub contr ,null 
657c 2022e57e branch search_handle_attrib_end ,zero 
657d 20206574 branch search_handle_attrib_loop_attribs 

search_handle_attrib_end:
657e 18000c00 force 0 ,contr 
657f 20600000 rtn 

search_rfcomm_cn:
6580 da400400 arg 0x0400 ,regb 
6581 20406572 call search_handl_attrib_found_handle 
6582 da400300 arg 0x0300 ,regb 
6583 2040658b call search_uuid_in_data 
6584 24740000 nrtn user 
6585 1a267c03 sub rega ,3 ,null 
6586 202178ec branch disable_user ,positive 
6587 efe20006 ifetch 1 ,contr 
6588 c08478ec bne 0x08 ,disable_user 
6589 efe20006 ifetch 1 ,contr 
658a 20600000 rtn 

search_uuid_in_data:
658b 204064e4 call sdp_get_data 
658c 1fe22200 copy pdata ,rega 

search_uuid_in_data_loop:
658d efe20006 ifetch 1 ,contr 
658e 1fe17207 and pdata ,0x7 ,loopcnt 
658f 1fe97e00 rshift3 pdata ,pdata 
6590 1fe67c03 sub pdata ,3 ,null 
6591 2022e5a6 branch search_uuid_in_data_found_uuid ,zero 
6592 1f227e00 copy loopcnt ,pdata 
6593 c002e59d beq 5 ,search_uuid_in_data_found_element_index5 
6594 c00365a0 beq 6 ,search_uuid_in_data_found_element_index6 
6595 c003e5a3 beq 7 ,search_uuid_in_data_found_element_index7 
6596 18c08dff increase -1 ,contr 
6597 204064e4 call sdp_get_data 
6598 98c08c00 iadd contr ,contr 
6599 1a227e00 copy rega ,pdata 
659a 98462200 isub temp ,rega 
659b 2022f8ec branch disable_user ,zero 
659c 2020658d branch search_uuid_in_data_loop 

search_uuid_in_data_found_element_index5:
659d 1a20a3fe increase -2 ,rega 
659e 18c08c01 increase 1 ,contr 
659f 2020658d branch search_uuid_in_data_loop 

search_uuid_in_data_found_element_index6:
65a0 1a20a3fd increase -3 ,rega 
65a1 18c08c02 increase 2 ,contr 
65a2 2020658d branch search_uuid_in_data_loop 

search_uuid_in_data_found_element_index7:
65a3 1a20a3fb increase -5 ,rega 
65a4 18c08c04 increase 4 ,contr 
65a5 2020658d branch search_uuid_in_data_loop 

search_uuid_in_data_found_uuid:
65a6 1a20a3ff increase -1 ,rega 
65a7 1f227e00 copy loopcnt ,pdata 
65a8 c000e5af beq 1 ,search_uuid_in_data_type_uuid_16 
65a9 c00165ad beq 2 ,search_uuid_in_data_type_uuid_32 
65aa c00265ac beq 4 ,search_uuid_in_data_type_uuid_128 
65ab 202078ec branch disable_user 

search_uuid_in_data_type_uuid_128:
65ac 1a20a3f4 increase -12 ,rega 

search_uuid_in_data_type_uuid_32:
65ad efe40006 ifetch 2 ,contr 
65ae 1a20a3fe increase -2 ,rega 

search_uuid_in_data_type_uuid_16:
65af efe40006 ifetch 2 ,contr 
65b0 9a467c00 isub regb ,null 
65b1 2022f903 branch enable_user ,zero 
65b2 1a20a3fe increase -2 ,rega 
65b3 2022f8ec branch disable_user ,zero 
65b4 2020658d branch search_uuid_in_data_loop 

sdp_send_search_req:
65b5 20404ab2 call l2cap_malloc_sdp_req 
65b6 58000002 setarg sdp_search_req 
65b7 e7e20005 istore 1 ,contw 
65b8 6fe4058f fetch 2 ,mem_sdp_transactionid_local 
65b9 1ff0fe00 byteswap pdata ,pdata 
65ba e7e40005 istore 2 ,contw 
65bb 1a20a3fb increase -5 ,rega 
65bc 1a30a200 byteswap rega ,rega 
65bd e2240005 istorer rega ,2 ,contw 
65be 58000335 setarg 0x0335 
65bf e7e40005 istore 2 ,contw 
65c0 58000019 setarg 0x19 
65c1 e7e20005 istore 1 ,contw 
65c2 6fe405c0 fetch 2 ,mem_search_uuid 
65c3 e7e40005 istore 2 ,contw 
65c4 58000008 setarg 0x0008 
65c5 e7e40005 istore 2 ,contw 
65c6 58000000 setarg 0 
65c7 e7e20005 istore 1 ,contw 
65c8 20600000 rtn 

sdp_send_attribute_req:
65c9 20404ab2 call l2cap_malloc_sdp_req 
65ca 58000004 setarg sdp_attribute_req 
65cb e7e20005 istore 1 ,contw 
65cc 6fe4058f fetch 2 ,mem_sdp_transactionid_local 
65cd 1ff0fe00 byteswap pdata ,pdata 
65ce e7e40005 istore 2 ,contw 
65cf 1a20a3fb increase -5 ,rega 
65d0 1a30a200 byteswap rega ,rega 
65d1 e2240005 istorer rega ,2 ,contw 
65d2 6fe80595 fetch 4 ,mem_sdp_record_handle 
65d3 e7e80005 istore 4 ,contw 
65d4 58002c01 setarg 0x2c01 
65d5 e7e40005 istore 2 ,contw 
65d6 58000535 setarg 0x0535 
65d7 e7e40005 istore 2 ,contw 
65d8 5800000a setarg 0x0a 
65d9 e7e20005 istore 1 ,contw 
65da 58000000 setarg 0 
65db e7e40005 istore 2 ,contw 
65dc 5fffffff setarg -1 
65dd e7e40005 istore 2 ,contw 
65de 58000000 setarg 0 
65df e7e20005 istore 1 ,contw 
65e0 20600000 rtn 

sdp_send_spp_request:
65e1 20404ac2 call l2cap_get_sdp_tx_payload 
65e2 1fe20a00 copy pdata ,contw 
65e3 58000006 setarg 6 
65e4 e7e20005 istore 1 ,contw 
65e5 5800006e setarg sdp_tid_spp 
65e6 e7e40005 istore 2 ,contw 
65e7 58000f00 setarg 0x0f00 
65e8 e7e40005 istore 2 ,contw 
65e9 581a0535 setarg 0x1a0535 
65ea e7e60005 istore 3 ,contw 
65eb 58000111 setarg 0x0111 
65ec 1ff07e00 lshift16 pdata ,pdata 
65ed e7e80005 istore 4 ,contw 
65ee 58002600 setarg 0x2600 
65ef e7e40005 istore 2 ,contw 
65f0 58000335 setarg 0x0335 
65f1 e7e40005 istore 2 ,contw 
65f2 58000009 setarg 0x0009 
65f3 e7e40005 istore 2 ,contw 
65f4 58000004 setarg 0x0004 
65f5 e7e40005 istore 2 ,contw 
65f6 70031d14 jam 0x14 ,mem_sdp_tx_pkt_length 
65f7 20600000 rtn 

function_g2:
65f8 4756c035 bpatchx patch35_5 ,mem_patch35 
65f9 70065650 jam 80 ,mem_aes_cmac_data_length 
65fa d8a00657 arg memdat ,contw 
65fb d8c04467 arg mem_le_srand ,contr 
65fc 20407758 call memcpy16 
65fd d8c04618 arg mem_le_pubkey_local_x_256 ,contr 
65fe 20407754 call memcpy32 
65ff d8c00a2f arg mem_le_pubkey_remote_x_256 ,contr 
6600 20407754 call memcpy32 
6601 204066b2 call inverse_memdat 
6602 d8c0049d arg mem_le_mrand ,contr 
6603 204066ad call store_inverse_k 
6604 20406679 call function_aes_cmac 
6605 d8a00b84 arg mem_aes_cmac_temp ,contw 
6606 204066a9 call load_inverse_result 
6607 580f4240 setarg 1000000 
6608 1fe22200 copy pdata ,rega 
6609 6fe80b84 fetch 4 ,mem_aes_cmac_temp 
660a 9a26fc00 idiv rega 
660b 2040782e call wait_div_end 
660c 18077e00 remainder pdata 
660d 67e80a2b store 4 ,mem_gkey 
660e 20600000 rtn 

function_f6_eb:
660f 70065641 jam 65 ,mem_aes_cmac_data_length 
6610 d8a00657 arg memdat ,contw 
6611 2040665e call store_addr_common_a 
6612 20406659 call store_addr_common_b 
6613 6fe64481 fetch 3 ,mem_le_pres + 1 
6614 e7e60005 istore 3 ,contw 
6615 2040661f call get_r 
6616 d8c0049d arg mem_le_mrand ,contr 
6617 20407758 call memcpy16 
6618 d8c04467 arg mem_le_srand ,contr 
6619 20407758 call memcpy16 
661a 204066b2 call inverse_memdat 
661b d8c00ba4 arg mem_le_mackey ,contr 
661c d8a00b54 arg mem_aes_cmac_k ,contw 
661d 20407758 call memcpy16 
661e 20206679 branch function_aes_cmac 

get_r:
661f 6fe8448a fetch 4 ,mem_le_tk 
6620 e7e80005 istore 4 ,contw 
6621 20407765 call memset0_4 
6622 20207762 branch memset0_8 

function_f6_ea:
6623 47574035 bpatchx patch35_6 ,mem_patch35 
6624 70065641 jam 65 ,mem_aes_cmac_data_length 
6625 d8a00657 arg memdat ,contw 
6626 20406659 call store_addr_common_b 
6627 2040665e call store_addr_common_a 
6628 6fe6447a fetch 3 ,mem_le_preq + 1 
6629 e7e60005 istore 3 ,contw 
662a 2040661f call get_r 
662b d8c04467 arg mem_le_srand ,contr 
662c 20407758 call memcpy16 
662d d8c0049d arg mem_le_mrand ,contr 
662e 20407758 call memcpy16 
662f 204066b2 call inverse_memdat 
6630 d8c00ba4 arg mem_le_mackey ,contr 
6631 d8a00b54 arg mem_aes_cmac_k ,contw 
6632 20407758 call memcpy16 
6633 20406679 call function_aes_cmac 
6634 d8a00b84 arg mem_aes_cmac_temp ,contw 
6635 202066a9 branch load_inverse_result 

function_f5:
6636 70065620 jam 32 ,mem_aes_cmac_data_length 
6637 d8c00a6f arg mem_le_dhkey_256 ,contr 
6638 d8a00657 arg memdat ,contw 
6639 20407754 call memcpy32 
663a 204066b2 call inverse_memdat 
663b d8c00a0f arg mem_le_slat ,contr 
663c 204066ad call store_inverse_k 
663d 20406679 call function_aes_cmac 
663e d8a00b54 arg mem_aes_cmac_k ,contw 
663f 20406932 call store_aes_result 
6640 d8400001 arg 1 ,temp 
6641 20406648 call function_f5_common 
6642 d8a04446 arg mem_le_ltk ,contw 
6643 204066a9 call load_inverse_result 
6644 d8400000 arg 0 ,temp 
6645 20406648 call function_f5_common 
6646 d8a00ba4 arg mem_le_mackey ,contw 
6647 20206932 branch store_aes_result 

function_f5_common:
6648 4757c035 bpatchx patch35_7 ,mem_patch35 
6649 70065635 jam 53 ,mem_aes_cmac_data_length 
664a 58000100 setarg 0x100 
664b 67e40657 store 2 ,memdat 
664c 20406659 call store_addr_common_b 
664d 2040665e call store_addr_common_a 
664e d8c04467 arg mem_le_srand ,contr 
664f 20407758 call memcpy16 
6650 d8c0049d arg mem_le_mrand ,contr 
6651 20407758 call memcpy16 
6652 58006c65 setarg 0x6c65 
6653 e7e40005 istore 2 ,contw 
6654 58006274 setarg 0x6274 
6655 e7e40005 istore 2 ,contw 
6656 e0420005 istoret 1 ,contw 
6657 204066b2 call inverse_memdat 
6658 20206679 branch function_aes_cmac 

store_addr_common_b:
6659 6fec450c fetch 6 ,mem_le_lap 
665a e7ec0005 istore 6 ,contw 
665b 6fe24500 fetch 1 ,mem_le_conn_own_addr_type 
665c e7e20005 istore 1 ,contw 
665d 20600000 rtn 

store_addr_common_a:
665e 6fec04bd fetch 6 ,mem_le_plap 
665f e7ec0005 istore 6 ,contw 
6660 6fe244f9 fetch 1 ,mem_le_conn_peer_addr_type 
6661 e7e20005 istore 1 ,contw 
6662 20600000 rtn 

function_f4_ca:
6663 70065641 jam 65 ,mem_aes_cmac_data_length 
6664 6fe246ab fetch 1 ,mem_passkey_1bit 
6665 67e20657 store 1 ,memdat 
6666 d8c04618 arg mem_le_pubkey_local_x_256 ,contr 
6667 20407754 call memcpy32 
6668 d8c00a2f arg mem_le_pubkey_remote_x_256 ,contr 
6669 20407754 call memcpy32 
666a 204066b2 call inverse_memdat 
666b d8c0049d arg mem_le_mrand ,contr 
666c 204066ad call store_inverse_k 
666d 20206679 branch function_aes_cmac 

function_f4_cb:
666e 70065641 jam 65 ,mem_aes_cmac_data_length 
666f 6fe246ab fetch 1 ,mem_passkey_1bit 
6670 67e20657 store 1 ,memdat 
6671 d8c00a2f arg mem_le_pubkey_remote_x_256 ,contr 
6672 20407754 call memcpy32 
6673 d8c04618 arg mem_le_pubkey_local_x_256 ,contr 
6674 20407754 call memcpy32 
6675 204066b2 call inverse_memdat 
6676 d8c04467 arg mem_le_srand ,contr 
6677 204066ad call store_inverse_k 
6678 20206679 branch function_aes_cmac 

function_aes_cmac:
6679 204066c7 call function_aes_cmac_generate_subkey 
667a 6fe20656 fetch 1 ,mem_aes_cmac_data_length 
667b 1fe20400 copy pdata ,temp 

function_ceil16:
667c 1fe0fe0f increase 15 ,pdata 
667d 1ff1fe00 rshift4 pdata ,pdata 
667e 1fe22400 copy pdata ,regb 
667f 203a668a branch function_aes_cmac_set_flag_0_balnk ,blank 
6680 18417e0f and temp ,0x0f ,pdata 
6681 243a668d nbranch function_aes_cmac_set_flag_0 ,blank 
6682 da600b64 arg mem_aes_cmac_k1 ,regc 
6683 dfe00657 arg memdat ,pdata 
6684 1fe0fff0 increase -16 ,pdata 
6685 9840a200 iadd temp ,rega 
6686 d8a00b94 arg mem_aes_cmac_m_last ,contw 
6687 df200004 arg 4 ,loopcnt 
6688 204077c6 call xor_loop 
6689 20206698 branch function_aes_cmac_aes 

function_aes_cmac_set_flag_0_balnk:
668a da400001 arg 1 ,regb 
668b da200000 arg 0 ,rega 
668c 2020668e branch function_aes_cmac_set_flag_0_common 

function_aes_cmac_set_flag_0:
668d 1841220f and temp ,0x0f ,rega 

function_aes_cmac_set_flag_0_common:
668e dfe00657 arg memdat ,pdata 
668f 9840fe00 iadd temp ,pdata 
6690 9a260c00 isub rega ,contr 
6691 d8a00b84 arg mem_aes_cmac_temp ,contw 
6692 204066ec call function_aes_cmac_padding 
6693 da600b74 arg mem_aes_cmac_k2 ,regc 
6694 da200b84 arg mem_aes_cmac_temp ,rega 
6695 d8a00b94 arg mem_aes_cmac_m_last ,contw 
6696 df200004 arg 4 ,loopcnt 
6697 204077c6 call xor_loop 

function_aes_cmac_aes:
6698 2040692c call aes_clear_data 
6699 204068ce call aes_init 
669a d8c00657 arg memdat ,contr 

function_aes_cmac_aes_loop:
669b 1a40a5ff increase -1 ,regb 
669c 1a427e00 deposit regb 
669d 203a66a1 branch function_aes_cmac_aes_loop_end ,blank 
669e 20406921 call load_data128 
669f 204068c2 call do_aes_cbc 
66a0 2020669b branch function_aes_cmac_aes_loop 

function_aes_cmac_aes_loop_end:
66a1 d8a00b84 arg mem_aes_cmac_temp ,contw 
66a2 20406932 call store_aes_result 
66a3 d8c00b94 arg mem_aes_cmac_m_last ,contr 
66a4 20406921 call load_data128 
66a5 204068ce call aes_init 
66a6 d8c00b84 arg mem_aes_cmac_temp ,contr 
66a7 20406921 call load_data128 
66a8 202068c2 branch do_aes_cbc 

load_inverse_result:
66a9 18a22200 copy contw ,rega 
66aa 20406932 call store_aes_result 
66ab df200010 arg 16 ,loopcnt 
66ac 202077ce branch inverse_data 

store_inverse_k:
66ad d8a00b54 arg mem_aes_cmac_k ,contw 
66ae 20407758 call memcpy16 

inverse_k:
66af df200010 arg 16 ,loopcnt 
66b0 da200b54 arg mem_aes_cmac_k ,rega 
66b1 202077ce branch inverse_data 

inverse_memdat:
66b2 6fe20656 fetch 1 ,mem_aes_cmac_data_length 
66b3 1fe27200 copy pdata ,loopcnt 
66b4 da200657 arg memdat ,rega 
66b5 202077ce branch inverse_data 

bn_lshift_0_inverse:
66b6 efe20011 ifetch 1 ,rega 
66b7 1fe3fe00 lshift pdata ,pdata 
66b8 2a6ffe00 isolate1 0 ,regc 
66b9 7920fe00 setflag true ,0 ,pdata 
66ba 2feffe08 isolate1 8 ,pdata 
66bb 7920a600 setflag true ,0 ,regc 
66bc e7e20011 istore 1 ,rega 
66bd 1a20a3ff increase -1 ,rega 
66be c20066b6 loop bn_lshift_0_inverse 
66bf 20600000 rtn 

function_aes_cmac_k1_inverse:
66c0 da200b64 arg mem_aes_cmac_k1 ,rega 

function_aes_cmac_inverse_common:
66c1 1a20a20f increase 15 ,rega 
66c2 18007210 force 16 ,loopcnt 
66c3 18002600 force 0 ,regc 
66c4 202066b6 branch bn_lshift_0_inverse 

function_aes_cmac_k2_inverse:
66c5 da200b74 arg mem_aes_cmac_k2 ,rega 
66c6 202066c1 branch function_aes_cmac_inverse_common 

function_aes_cmac_generate_subkey:
66c7 d8c00b54 arg mem_aes_cmac_k ,contr 
66c8 2040691e call load_key128 
66c9 18007008 force regidx_xor ,regext_index 
66ca 2040692d call aes_clear 
66cb 2040692c call aes_clear_data 
66cc 204068bf call do_aes_ecb 
66cd d8a00b64 arg mem_aes_cmac_k1 ,contw 
66ce 20406932 call store_aes_result 

function_aes_cmac_k1:
66cf 6fe20b64 fetch 1 ,mem_aes_cmac_k1 
66d0 2feffe07 isolate1 7 ,pdata 
66d1 2420e6d7 nbranch function_aes_cmac_k1_0 ,true 
66d2 204066c0 call function_aes_cmac_k1_inverse 
66d3 da600b64 arg mem_aes_cmac_k1 ,regc 
66d4 d8a00b64 arg mem_aes_cmac_k1 ,contw 
66d5 204066e1 call function_aes_cmac_xor_rb 
66d6 202066d8 branch function_aes_cmac_k2 

function_aes_cmac_k1_0:
66d7 204066c0 call function_aes_cmac_k1_inverse 

function_aes_cmac_k2:
66d8 d8c00b64 arg mem_aes_cmac_k1 ,contr 
66d9 d8a00b74 arg mem_aes_cmac_k2 ,contw 
66da 20407758 call memcpy16 
66db 6fe20b74 fetch 1 ,mem_aes_cmac_k2 
66dc 2feffe07 isolate1 7 ,pdata 
66dd 2420e6c5 nbranch function_aes_cmac_k2_inverse ,true 
66de 204066c5 call function_aes_cmac_k2_inverse 
66df da600b74 arg mem_aes_cmac_k2 ,regc 
66e0 d8a00b74 arg mem_aes_cmac_k2 ,contw 

function_aes_cmac_xor_rb:
66e1 df200003 arg 3 ,loopcnt 

function_aes_cmac_xor_rb_loop:
66e2 d8400000 arg 0 ,temp 
66e3 204066e8 call function_aes_cmac_xor_loop_common 
66e4 1a60a604 increase 4 ,regc 
66e5 c20066e2 loop function_aes_cmac_xor_rb_loop 
66e6 d8408700 arg 0x8700 ,temp 
66e7 18500400 lshift16 temp ,temp 

function_aes_cmac_xor_loop_common:
66e8 efe80013 ifetch 4 ,regc 
66e9 9842fe00 ixor temp ,pdata 
66ea e7e80005 istore 4 ,contw 
66eb 20600000 rtn 

function_aes_cmac_padding:
66ec 47584036 bpatchx patch36_0 ,mem_patch36 
66ed df200010 arg 16 ,loopcnt 
66ee dfe00000 arg 0 ,pdata 

function_aes_cmac_padding_loop:
66ef 9a267c00 isub rega ,null 
66f0 2022e6f7 branch function_aes_cmac_padding_beq_length ,zero 
66f1 202166fa branch function_aes_cmac_padding_big_length ,positive 
66f2 e8420006 ifetcht 1 ,contr 
66f3 e0420005 istoret 1 ,contw 

function_aes_cmac_padding_loop2:
66f4 1fe0fe01 increase 1 ,pdata 
66f5 c20066ef loop function_aes_cmac_padding_loop 
66f6 20600000 rtn 

function_aes_cmac_padding_beq_length:
66f7 d8400080 arg 0x80 ,temp 

function_aes_cmac_padding_common:
66f8 e0420005 istoret 1 ,contw 
66f9 202066f4 branch function_aes_cmac_padding_loop2 

function_aes_cmac_padding_big_length:
66fa d8400000 arg 0 ,temp 
66fb 202066f8 branch function_aes_cmac_padding_common 

generate_kinit:
66fc 2040670f call function_e22 
66fd d8c00603 arg mem_input_store ,contr 
66fe d8a005f3 arg mem_kinit ,contw 
66ff 20207758 branch memcpy16 

function_e21:
6700 78547c00 disable user 
6701 204067fd call function_expand 
6702 d8c005d3 arg mem_random_number ,contr 
6703 d8a00613 arg mem_x ,contw 
6704 1800720f force 15 ,loopcnt 
6705 2040779f call memcpy 
6706 efe20006 ifetch 1 ,contr 
6707 1fe2fe06 xor_into 6 ,pdata 
6708 e7e20005 istore 1 ,contw 
6709 58000623 setarg mem_y 
670a 67e40647 store 2 ,memp_ar_input 
670b 58000613 setarg mem_x 
670c 67e40645 store 2 ,memp_ar_key 
670d 79200012 set1 mark_ar2 ,mark 
670e 2020674f branch function_ar 

function_e22:
670f 684246cb fetcht 1 ,mem_pin_length 
6710 18002410 force 16 ,regb 
6711 1840a606 add temp ,6 ,regc 
6712 1a667c10 sub regc ,16 ,null 
6713 20216715 branch function_e22_pin_init ,positive 
6714 18002610 force 16 ,regc 

function_e22_pin_init:
6715 d8a00613 arg mem_x ,contw 

function_e22_genx_pin:
6716 d8c046cc arg mem_pin ,contr 
6717 18427200 copy temp ,loopcnt 
6718 78547c00 disable user 

function_e22_genx_loop:
6719 efe20006 ifetch 1 ,contr 
671a e7e20005 istore 1 ,contw 
671b 1a40a5ff increase -1 ,regb 
671c 2022e723 branch function_e22_genx_end ,zero 
671d c2006719 loop function_e22_genx_loop 
671e 20346716 branch function_e22_genx_pin ,user 
671f 78347c00 enable user 
6720 18007206 force 6 ,loopcnt 
6721 1a220c00 copy rega ,contr 
6722 20206719 branch function_e22_genx_loop 

function_e22_genx_end:
6723 d8c005d3 arg mem_random_number ,contr 
6724 d8a00623 arg mem_y ,contw 
6725 20407758 call memcpy16 
6726 6fe20632 fetch 1 ,mem_y15 
6727 9a62fe00 ixor regc ,pdata 
6728 67e20632 store 1 ,mem_y15 
6729 58000623 setarg mem_y 
672a 67e40647 store 2 ,memp_ar_input 
672b 58000613 setarg mem_x 
672c 67e40645 store 2 ,memp_ar_key 
672d 79200012 set1 mark_ar2 ,mark 
672e 2020674f branch function_ar 

function_e1:
672f 78547c00 disable user 
6730 204067fd call function_expand 
6731 20206739 branch function_hash 

function_e3:
6732 da200056 arg mem_aco ,rega 
6733 78347c00 enable user 
6734 204067fd call function_expand 
6735 20406739 call function_hash 
6736 d8c00603 arg mem_input_store ,contr 
6737 d8a00062 arg mem_kc ,contw 
6738 20207758 branch memcpy16 

function_hash:
6739 580005d3 setarg mem_random_number 
673a 67e40647 store 2 ,memp_ar_input 
673b 58004274 setarg mem_link_key 
673c 67e40645 store 2 ,memp_ar_key 
673d 793f8012 set0 mark_ar2 ,mark 
673e 2040674f call function_ar 
673f da200603 arg mem_input_store ,rega 
6740 da4005d3 arg mem_random_number ,regb 
6741 d8a00613 arg mem_x ,contw 
6742 204067f0 call xor16 
6743 da200613 arg mem_x ,rega 
6744 da400623 arg mem_y ,regb 
6745 1a420a00 copy regb ,contw 
6746 78347c00 enable user 
6747 204067ee call add16 
6748 20406808 call key_offset 
6749 58000623 setarg mem_y 
674a 67e40647 store 2 ,memp_ar_input 
674b 58000613 setarg mem_x 
674c 67e40645 store 2 ,memp_ar_key 
674d 79200012 set1 mark_ar2 ,mark 
674e 2020674f branch function_ar 

function_ar:
674f 70064900 jam 0 ,mem_ar_hround 
6750 6fe40645 fetch 2 ,memp_ar_key 
6751 98000c00 iforce contr 
6752 d8a00633 arg mem_key_store ,contw 
6753 20407758 call memcpy16 
6754 6fe40647 fetch 2 ,memp_ar_input 
6755 98000c00 iforce contr 
6756 d8a00603 arg mem_input_store ,contw 
6757 20407758 call memcpy16 

function_ar_loop:
6758 20406775 call key_scheduling 
6759 78547c00 disable user 
675a c589675f bmark0 mark_ar2 ,function_ar_original 
675b 6fe20649 fetch 1 ,mem_ar_hround 
675c c082675f bne 4 ,function_ar_original 
675d 6a440647 fetchr regb ,2 ,memp_ar_input 
675e 204067a7 call xor_mod32_ar2 

function_ar_original:
675f 204067a6 call xor_mod32 
6760 204067b8 call el_boxes 
6761 6fe20649 fetch 1 ,mem_ar_hround 
6762 1fe0fe01 increase 1 ,pdata 
6763 67e20649 store 1 ,mem_ar_hround 
6764 20406775 call key_scheduling 
6765 78347c00 enable user 
6766 204067a6 call xor_mod32 
6767 204067c7 call pht 
6768 204067d4 call permute 
6769 204067c7 call pht 
676a 204067d4 call permute 
676b 204067c7 call pht 
676c 204067d4 call permute 
676d 204067c7 call pht 
676e 6fe20649 fetch 1 ,mem_ar_hround 
676f 1fe0fe01 increase 1 ,pdata 
6770 67e20649 store 1 ,mem_ar_hround 
6771 c0886758 bne 16 ,function_ar_loop 
6772 20406775 call key_scheduling 
6773 78547c00 disable user 
6774 202067a6 branch xor_mod32 

key_scheduling:
6775 6fe20649 fetch 1 ,mem_ar_hround 
6776 d8c00633 arg mem_key_store ,contr 
6777 203a679c branch key_sched_zero ,blank 
6778 98002400 iforce regb 
6779 18007211 force 17 ,loopcnt 
677a 18c20a00 copy contr ,contw 

key_rotateloop:
677b efe20006 ifetch 1 ,contr 
677c 1fe98400 lshift3 pdata ,temp 
677d 1feb7e00 rshift2 pdata ,pdata 
677e 1fe97e00 rshift3 pdata ,pdata 
677f 9841fe00 ior temp ,pdata 
6780 e7e20005 istore 1 ,contw 
6781 c200677b loop key_rotateloop 
6782 58000633 setarg mem_key_store 
6783 9a408c00 iadd regb ,contr 
6784 18007210 force 16 ,loopcnt 
6785 d8a005e3 arg mem_round_key ,contw 

key_select_octet_loop:
6786 efe20006 ifetch 1 ,contr 
6787 e7e20005 istore 1 ,contw 
6788 28c1fe44 compare mem_key_store_end ,contr ,0xff 
6789 2420e78b nbranch key_select_octet_nwrap ,true 
678a 18c08def increase -17 ,contr 

key_select_octet_nwrap:
678b c2006786 loop key_select_octet_loop 
678c 18002200 force 0 ,rega 
678d 1a40a7ff add regb ,-1 ,regc 
678e 1a6ba600 lshift2 regc ,regc 
678f 1a6ba600 lshift2 regc ,regc 
6790 20406954 call enable_authrom 
6791 58008400 setarg mem_b_box 
6792 9a60a600 iadd regc ,regc 
6793 d8a005e3 arg mem_round_key ,contw 
6794 18007210 force 16 ,loopcnt 

bias_round_key_loop:
6795 e8420013 ifetcht 1 ,regc 
6796 efe20005 ifetch 1 ,contw 
6797 9840fe00 iadd temp ,pdata 
6798 e7e20005 istore 1 ,contw 
6799 1a60a601 increase 1 ,regc 
679a c2006795 loop bias_round_key_loop 
679b 20206958 branch disable_authrom 

key_sched_zero:
679c 18007210 force 16 ,loopcnt 
679d 18000400 force 0 ,temp 

create_byte_16_loop:
679e efe20006 ifetch 1 ,contr 
679f 98428400 ixor temp ,temp 
67a0 c200679e loop create_byte_16_loop 
67a1 18427e00 deposit temp 
67a2 e7e20006 istore 1 ,contr 
67a3 d8c00633 arg mem_key_store ,contr 
67a4 d8a005e3 arg mem_round_key ,contw 
67a5 20207758 branch memcpy16 

xor_mod32:
67a6 da4005e3 arg mem_round_key ,regb 

xor_mod32_ar2:
67a7 18007210 force 16 ,loopcnt 
67a8 da200603 arg mem_input_store ,rega 
67a9 1a220a00 copy rega ,contw 

xor_mod32_loop:
67aa e8420011 ifetcht 1 ,rega 
67ab efe20012 ifetch 1 ,regb 
67ac 9842e000 ixor temp ,alarm 
67ad 1f212603 and loopcnt ,3 ,regc 
67ae 243467b0 nbranch xor_mod32_invert ,user 
67af 1a62a603 xor_into 3 ,regc 

xor_mod32_invert:
67b0 1a662601 sub regc ,1 ,regc 
67b1 202167b3 branch xor_even ,positive 
67b2 9840e000 iadd temp ,alarm 

xor_even:
67b3 e6020005 istorer alarm ,1 ,contw 
67b4 1a20a201 increase 1 ,rega 
67b5 1a40a401 increase 1 ,regb 
67b6 c20067aa loop xor_mod32_loop 
67b7 20600000 rtn 

el_boxes:
67b8 20406954 call enable_authrom 
67b9 18007210 force 16 ,loopcnt 
67ba da200603 arg mem_input_store ,rega 

el_box_loop:
67bb efe20011 ifetch 1 ,rega 
67bc d8c08500 arg mem_e_box ,contr 
67bd 1f212603 and loopcnt ,3 ,regc 
67be 1a667c01 sub regc ,1 ,null 
67bf 202167c1 branch e_boxes ,positive 
67c0 d8c08600 arg mem_l_box ,contr 

e_boxes:
67c1 98c08c00 iadd contr ,contr 
67c2 efe20006 ifetch 1 ,contr 
67c3 e7e20011 istore 1 ,rega 
67c4 1a20a201 increase 1 ,rega 
67c5 c20067bb loop el_box_loop 
67c6 20206958 branch disable_authrom 

pht:
67c7 18007208 force 8 ,loopcnt 
67c8 d8c00603 arg mem_input_store ,contr 
67c9 18c20a00 copy contr ,contw 

pht_loop:
67ca ea220006 ifetchr rega ,1 ,contr 
67cb ea420006 ifetchr regb ,1 ,contr 
67cc 1a23fe00 lshift rega ,pdata 
67cd 9a40fe00 iadd regb ,pdata 
67ce e7e20005 istore 1 ,contw 
67cf 1a227e00 deposit rega 
67d0 9a40fe00 iadd regb ,pdata 
67d1 e7e20005 istore 1 ,contw 
67d2 c20067ca loop pht_loop 
67d3 20600000 rtn 

permute:
67d4 588ae42c setarg 0x8ae42c 
67d5 98000400 iforce temp 
67d6 18007207 force 7 ,loopcnt 
67d7 204067e1 call permute_exchange 
67d8 580d751b setarg 0xd751b 
67d9 98000400 iforce temp 
67da 18007205 force 5 ,loopcnt 
67db 204067e1 call permute_exchange 
67dc 6a220612 fetchr rega ,1 ,mem_input_store + 15 
67dd 6fe20606 fetch 1 ,mem_input_store + 3 
67de 67e20612 store 1 ,mem_input_store + 15 
67df 62220606 storer rega ,1 ,mem_input_store + 3 
67e0 20600000 rtn 

permute_exchange:
67e1 1841240f and temp ,0xf ,regb 

permute_loop:
67e2 18417e0f and temp ,0xf ,pdata 
67e3 d8a00603 arg mem_input_store ,contw 
67e4 98a08a00 iadd contw ,contw 
67e5 ea620005 ifetchr regc ,1 ,contw 
67e6 e2220005 istorer rega ,1 ,contw 
67e7 1a622200 copy regc ,rega 
67e8 18518400 rshift4 temp ,temp 
67e9 c20067e2 loop permute_loop 
67ea 58000603 setarg mem_input_store 
67eb 9a408a00 iadd regb ,contw 
67ec e2220005 istorer rega ,1 ,contw 
67ed 20600000 rtn 

add16:
67ee 78347c00 enable user 
67ef 202067f1 branch xor_add16 

xor16:
67f0 78547c00 disable user 

xor_add16:
67f1 18007210 force 16 ,loopcnt 

xoradd_loop:
67f2 e8420011 ifetcht 1 ,rega 
67f3 efe20012 ifetch 1 ,regb 
67f4 203467f7 branch xoradd_add ,user 
67f5 9842fe00 ixor temp ,pdata 
67f6 202067f8 branch xoradd_store 

xoradd_add:
67f7 9840fe00 iadd temp ,pdata 

xoradd_store:
67f8 e7e20005 istore 1 ,contw 
67f9 1a20a201 increase 1 ,rega 
67fa 1a40a401 increase 1 ,regb 
67fb c20067f2 loop xoradd_loop 
67fc 20600000 rtn 

function_expand:
67fd d8a00623 arg mem_y ,contw 
67fe efec0011 ifetch 6 ,rega 
67ff e7ec0005 istore 6 ,contw 
6800 20346803 branch expand_12 ,user 
6801 efec0011 ifetch 6 ,rega 
6802 20206804 branch expand_cont 

expand_12:
6803 efec0006 ifetch 6 ,contr 

expand_cont:
6804 e7ec0005 istore 6 ,contw 
6805 efe80011 ifetch 4 ,rega 
6806 e7e80005 istore 4 ,contw 
6807 20600000 rtn 

key_offset:
6808 d8c04274 arg mem_link_key ,contr 
6809 d8a00613 arg mem_x ,contw 
680a d8400000 arg 0 ,temp 
680b 588395a7 setarg 0x8395a7 
680c 20406829 call concatenate_temp24 
680d 58b3c1df setarg 0xb3c1df 
680e 20406829 call concatenate_temp24 
680f 5800e5e9 setarg 0xe5e9 
6810 2040682a call concatenate_temp16 
6811 18422800 copy temp ,regab 
6812 78547c00 disable user 
6813 20406817 call key_addxor 
6814 1a820400 copy regab ,temp 
6815 78347c00 enable user 
6816 20206817 branch key_addxor 

key_addxor:
6817 18007208 force 8 ,loopcnt 

key_addxor_loop:
6818 efe20006 ifetch 1 ,contr 
6819 2f200201 compare 1 ,loopcnt ,1 
681a 2034681e branch key_high ,user 
681b 2020e81f branch key_xor ,true 

key_add:
681c 9840fe00 iadd temp ,pdata 
681d 20206820 branch key_store 

key_high:
681e 2020e81c branch key_add ,true 

key_xor:
681f 9842fe00 ixor temp ,pdata 

key_store:
6820 e7e20005 istore 1 ,contw 
6821 184c8400 rshift8 temp ,temp 
6822 c2006818 loop key_addxor_loop 
6823 20600000 rtn 

copy_aco:
6824 6fec0607 fetch 6 ,mem_input_store + 4 
6825 67ec0056 store 6 ,mem_aco 
6826 efec0006 ifetch 6 ,contr 
6827 e7ec0005 istore 6 ,contw 
6828 20600000 rtn 

concatenate_temp24:
6829 184d0400 lshift8 temp ,temp 

concatenate_temp16:
682a 18500400 lshift16 temp ,temp 
682b 98418400 ior temp ,temp 
682c 20600000 rtn 

loop1:
682d 2020682d branch loop1 

generate_stk:
682e 204068d1 call function_s1 
682f d8a04446 arg mem_le_ltk ,contw 
6830 20206932 branch store_aes_result 

authenticate_rconfirm:
6831 d8a04467 arg mem_le_srand ,contw 
6832 2034e834 branch authenticate_mconfirm ,master 
6833 d8a0049d arg mem_le_mrand ,contw 

authenticate_mconfirm:
6834 18c22200 copy contr ,rega 
6835 20407758 call memcpy16 
6836 204068e3 call function_c1 
6837 d8c04457 arg mem_le_rconfirm ,contr 
6838 2020694b branch compare_res 

generate_confirm:
6839 da20049d arg mem_le_mrand ,rega 
683a 2034e83c branch generate_mrand ,master 
683b da204467 arg mem_le_srand ,rega 

generate_mrand:
683c 1a220a00 copy rega ,contw 
683d 20405b65 call generate_random 
683e 202068e3 branch function_c1 

generate_sk:
683f d8c0046d arg mem_le_skdm ,contr 
6840 20406921 call load_data128 
6841 d8c04446 arg mem_le_ltk ,contr 
6842 2040691e call load_key128 
6843 18006c50 force aes_big_endian | aes_load ,aes_ctrl 
6844 18006c00 force 0 ,aes_ctrl 
6845 204068b7 call wait_aes 
6846 d8a004eb arg mem_le_sk ,contw 
6847 20206932 branch store_aes_result 

first_block_counter:
6848 18007e49 force 0x49 ,pdata 
6849 2020684b branch first_block 

first_block_data:
684a 18007e01 force 1 ,pdata 

first_block:
684b 18007000 force regidx_data ,regext_index 
684c 184d5e00 lshift8 temp ,regext 
684d 9de1de00 ior regext ,regext 
684e 1f00f001 increase 1 ,regext_index 
684f 184cde00 rshift8 temp ,regext 
6850 1df15e00 rshift16 regext ,regext 
6851 6fe4443e fetch 2 ,mem_le_ivm 
6852 1ff07e00 lshift16 pdata ,pdata 
6853 9de1de00 ior regext ,regext 
6854 1f00f001 increase 1 ,regext_index 
6855 efe80006 ifetch 4 ,contr 
6856 98005e00 iforce regext 
6857 1f00f001 increase 1 ,regext_index 
6858 efe40006 ifetch 2 ,contr 
6859 1a30de00 byteswap rega ,regext 
685a 1df05e00 lshift16 regext ,regext 
685b 9de1de00 ior regext ,regext 
685c 1f00f001 increase 1 ,regext_index 
685d 20600000 rtn 

generate_mic:
685e 1a608c01 add regc ,1 ,contr 
685f ea220006 ifetchr rega ,1 ,contr 
6860 20406848 call first_block_counter 
6861 204068bf call do_aes_ecb 
6862 18007000 force regidx_data ,regext_index 
6863 efe20013 ifetch 1 ,regc 
6864 1fe17e03 and_into 0x3 ,pdata 
6865 1ff05e00 lshift16 pdata ,regext 
6866 79205e08 set1 8 ,regext 
6867 2040692a call clear_hidata 
6868 204068c2 call do_aes_cbc 
6869 1a227200 copy rega ,loopcnt 
686a 1a608c02 add regc ,2 ,contr 
686b 20406906 call padding_data 

generate_mic_loop:
686c 20406910 call aes_load_data 
686d 204068c2 call do_aes_cbc 
686e 1f227e00 deposit loopcnt 
686f 203a6871 branch generate_mic_end ,blank 
6870 2020686c branch generate_mic_loop 

generate_mic_end:
6871 1800700c force regidx_result ,regext_index 
6872 1de22400 copy regext ,regb 
6873 62480465 storer regb ,4 ,mem_le_mic 
6874 20600000 rtn 

aes_crypt_data:
6875 1a20a201 increase 1 ,rega 
6876 2040684a call first_block_data 
6877 204068ce call aes_init 
6878 1a620c00 copy regc ,contr 
6879 20406921 call load_data128 
687a 204068c5 call do_aes_cfb 
687b 20406939 call store_enc_data 
687c 1a60a610 increase 16 ,regc 
687d 1a40a5f0 increase -16 ,regb 
687e 20216875 branch aes_crypt_data ,positive 
687f 20600000 rtn 

le_encrypt:
6880 da604409 arg mem_le_txheader ,regc 
6881 684a4430 fetcht 5 ,mem_le_pcnt_tx 
6882 2040685e call generate_mic 
6883 18002200 force 0 ,rega 
6884 2040684a call first_block_data 
6885 204068ce call aes_init 
6886 18007000 force regidx_data ,regext_index 
6887 1a425e00 copy regb ,regext 
6888 204068c5 call do_aes_cfb 
6889 da60440b arg mem_le_txpayload ,regc 
688a 6fe2440a fetch 1 ,mem_le_txlen 
688b 1fe0a5ff add pdata ,-1 ,regb 
688c 9a608a00 iadd regc ,contw 
688d 1800700c force regidx_result ,regext_index 
688e e5e80005 istorer regext ,4 ,contw 
688f 18002200 force 0 ,rega 
6890 20406875 call aes_crypt_data 
6891 6fe2440a fetch 1 ,mem_le_txlen 
6892 1fe0fe04 increase 4 ,pdata 
6893 67e2440a store 1 ,mem_le_txlen 
6894 684a4430 fetcht 5 ,mem_le_pcnt_tx 
6895 18408401 increase 1 ,temp 
6896 604a4430 storet 5 ,mem_le_pcnt_tx 
6897 20600000 rtn 

le_decrypt:
6898 684a4435 fetcht 5 ,mem_le_pcnt_rx 
6899 18002200 force 0 ,rega 
689a 2040684a call first_block_data 
689b 204068ce call aes_init 
689c 6fe20366 fetch 1 ,mem_le_rxbuf + 1 
689d da600367 arg mem_le_rxbuf + 2 ,regc 
689e 1fe0a5ff add pdata ,-1 ,regb 
689f 1fe0fffc increase -4 ,pdata 
68a0 67e20366 store 1 ,mem_le_rxbuf + 1 
68a1 9a608c00 iadd regc ,contr 
68a2 18007000 force regidx_data ,regext_index 
68a3 ede80006 ifetchr regext ,4 ,contr 
68a4 204068c5 call do_aes_cfb 
68a5 1800700c force regidx_result ,regext_index 
68a6 65e80469 storer regext ,4 ,mem_le_peer_mic 
68a7 18002200 force 0 ,rega 
68a8 20406875 call aes_crypt_data 
68a9 da600365 arg mem_le_rxbuf ,regc 
68aa 2040685e call generate_mic 
68ab 6fe80469 fetch 4 ,mem_le_peer_mic 
68ac 9a467e00 isub regb ,pdata 
68ad 247a0000 nrtn blank 
68ae 6fe8443a fetch 4 ,mem_le_last_mic 
68af 9a467e00 isub regb ,pdata 
68b0 207a0000 rtn blank 
68b1 6048443a storet 4 ,mem_le_last_mic 
68b2 6fea4435 fetch 5 ,mem_le_pcnt_rx 
68b3 1fe0fe01 increase 1 ,pdata 
68b4 67ea4435 store 5 ,mem_le_pcnt_rx 
68b5 18007e00 force 0 ,pdata 
68b6 20600000 rtn 

wait_aes:
68b7 243be8b7 nbranch wait_aes ,aes_ready 
68b8 20600000 rtn 

do_aes_ecb256:
68b9 18006c48 force aes_load | aes_256 ,aes_ctrl 
68ba 18006c08 force aes_256 ,aes_ctrl 
68bb 202068b7 branch wait_aes 

do_aes_ecb192:
68bc 18006c44 force aes_load | aes_192 ,aes_ctrl 
68bd 18006c04 force aes_192 ,aes_ctrl 
68be 202068b7 branch wait_aes 

do_aes_ecb:
68bf 18006c40 force aes_load ,aes_ctrl 
68c0 18006c00 force 0 ,aes_ctrl 
68c1 202068b7 branch wait_aes 

do_aes_cbc:
68c2 18006c41 force aes_load | aes_cbc ,aes_ctrl 
68c3 18006c00 force 0 ,aes_ctrl 
68c4 202068b7 branch wait_aes 

do_aes_cfb:
68c5 18006c42 force aes_load | aes_cfb ,aes_ctrl 
68c6 18006c02 force aes_cfb ,aes_ctrl 
68c7 202068b7 branch wait_aes 

do_aes_ecb_be:
68c8 18006c50 force aes_big_endian | aes_load ,aes_ctrl 
68c9 18006c10 force aes_big_endian ,aes_ctrl 
68ca 202068b7 branch wait_aes 

do_aes_cbc_be:
68cb 18006c51 force aes_big_endian | aes_load | aes_cbc ,aes_ctrl 
68cc 18006c10 force aes_big_endian ,aes_ctrl 
68cd 202068b7 branch wait_aes 

aes_init:
68ce 18006c20 force aes_initialize ,aes_ctrl 
68cf 18006c00 force 0 ,aes_ctrl 
68d0 20600000 rtn 

function_s1:
68d1 18007000 force regidx_data ,regext_index 
68d2 6fe8049d fetch 4 ,mem_le_mrand 
68d3 98005e00 iforce regext 
68d4 1f00f001 increase 1 ,regext_index 
68d5 efe80006 ifetch 4 ,contr 
68d6 98005e00 iforce regext 
68d7 1f00f001 increase 1 ,regext_index 
68d8 6fe84467 fetch 4 ,mem_le_srand 
68d9 98005e00 iforce regext 
68da 1f00f001 increase 1 ,regext_index 
68db efe80006 ifetch 4 ,contr 
68dc 98005e00 iforce regext 
68dd 1f00f001 increase 1 ,regext_index 
68de 2040692d call aes_clear 
68df 1f00f1fc increase -4 ,regext_index 
68e0 6fe8448a fetch 4 ,mem_le_tk 
68e1 1fe25e00 copy pdata ,regext 
68e2 202068c8 branch do_aes_ecb_be 

function_c1:
68e3 1a220c00 copy rega ,contr 
68e4 20406921 call load_data128 
68e5 18006c30 force aes_big_endian | aes_initialize ,aes_ctrl 
68e6 18006c00 force 0 ,aes_ctrl 
68e7 6fe244f9 fetch 1 ,mem_le_conn_peer_addr_type 
68e8 684244ef fetcht 1 ,mem_le_adv_own_addr_type 
68e9 2434e8ec nbranch function_c1_irat ,master 
68ea 6fe24500 fetch 1 ,mem_le_conn_own_addr_type 
68eb 684244f9 fetcht 1 ,mem_le_conn_peer_addr_type 

function_c1_irat:
68ec 67e24477 store 1 ,mem_le_iat 
68ed 60424478 storet 1 ,mem_le_rat 
68ee d8c04477 arg mem_le_iat ,contr 
68ef 20406921 call load_data128 
68f0 2040692d call aes_clear 
68f1 1f00f1fc increase -4 ,regext_index 
68f2 6fe8448a fetch 4 ,mem_le_tk 
68f3 1fe25e00 copy pdata ,regext 
68f4 18006c51 force aes_big_endian | aes_cbc | aes_load ,aes_ctrl 
68f5 18006c10 force aes_big_endian ,aes_ctrl 
68f6 6fec450c fetch 6 ,mem_le_lap 
68f7 684c04bd fetcht 6 ,mem_le_plap 
68f8 2034e8fb branch function_c1_master ,master 
68f9 6fec04bd fetch 6 ,mem_le_plap 
68fa 684c450c fetcht 6 ,mem_le_lap 

function_c1_master:
68fb 18007000 force regidx_data ,regext_index 
68fc 18425e00 copy temp ,regext 
68fd 1f00f001 increase 1 ,regext_index 
68fe 184f5e00 rshift32 temp ,regext 
68ff 1ff07e00 lshift16 pdata ,pdata 
6900 9de1de00 ior regext ,regext 
6901 1f00f001 increase 1 ,regext_index 
6902 1fef5e00 rshift32 pdata ,regext 
6903 1f00f001 increase 1 ,regext_index 
6904 18005e00 force 0 ,regext 
6905 202068cb branch do_aes_cbc_be 

padding_data:
6906 2f200600 compare 0 ,loopcnt ,3 
6907 20608000 rtn true 
6908 18c27e00 deposit contr 
6909 9f208a00 iadd loopcnt ,contw 
690a 18007e00 force 0 ,pdata 

padding_loop:
690b e7e20005 istore 1 ,contw 
690c 1f20f201 increase 1 ,loopcnt 
690d 2f200600 compare 0 ,loopcnt ,3 
690e 20608000 rtn true 
690f 2020690b branch padding_loop 

aes_load_data:
6910 18007000 force regidx_data ,regext_index 

load_data_loop:
6911 1f227e00 deposit loopcnt 
6912 203a6915 branch load_data_padding ,blank 
6913 efe80006 ifetch 4 ,contr 
6914 1f20f3fc increase -4 ,loopcnt 

load_data_padding:
6915 98005e00 iforce regext 
6916 1f00f001 increase 1 ,regext_index 
6917 2f001e04 compare regidx_key ,regext_index ,0xf 
6918 20608000 rtn true 
6919 20206911 branch load_data_loop 

load_key256:
691a 18007208 force 8 ,loopcnt 
691b 2020691f branch load_key 

load_key192:
691c 18007206 force 6 ,loopcnt 
691d 2020691f branch load_key 

load_key128:
691e 18007204 force 4 ,loopcnt 

load_key:
691f 18007004 force regidx_key ,regext_index 
6920 20206923 branch load_regext_loop 

load_data128:
6921 18007000 force regidx_data ,regext_index 
6922 18007204 force 4 ,loopcnt 

load_regext_loop:
6923 efe80006 ifetch 4 ,contr 
6924 1fe25e00 icopy regext 
6925 1f00f001 increase 1 ,regext_index 
6926 c2006923 loop load_regext_loop 
6927 20600000 rtn 

load_sk:
6928 d8c004eb arg mem_le_sk ,contr 
6929 2020691e branch load_key128 

clear_hidata:
692a 18007204 force 4 ,loopcnt 
692b 2020692f branch clear_data_rest 

aes_clear_data:
692c 18007000 force regidx_data ,regext_index 

aes_clear:
692d 18007204 force 4 ,loopcnt 

clear_loop:
692e 18005e00 force 0 ,regext 

clear_data_rest:
692f 1f00f001 increase 1 ,regext_index 
6930 c200692e loop clear_loop 
6931 20600000 rtn 

store_aes_result:
6932 1800700c force regidx_result ,regext_index 
6933 18007204 force 4 ,loopcnt 

send_aes_result_loop:
6934 1de27e00 deposit regext 
6935 e7e80005 istore 4 ,contw 
6936 1f00f001 increase 1 ,regext_index 
6937 c2006934 loop send_aes_result_loop 
6938 20600000 rtn 

store_enc_data:
6939 1800700c force regidx_result ,regext_index 
693a 1a620a00 copy regc ,contw 
693b 1a40f201 add regb ,1 ,loopcnt 
693c 1f267c0f sub loopcnt ,15 ,null 
693d 2021693f branch store_enc_loop ,positive 
693e 18007210 force 16 ,loopcnt 

store_enc_loop:
693f 1de27e00 deposit regext 
6940 1f267c03 sub loopcnt ,3 ,null 
6941 20216947 branch store_enc_byte ,positive 
6942 e7e80005 istore 4 ,contw 
6943 1f20f3fc increase -4 ,loopcnt 
6944 20628000 rtn zero 
6945 1f00f001 increase 1 ,regext_index 
6946 2020693f branch store_enc_loop 

store_enc_byte:
6947 e7e20005 istore 1 ,contw 
6948 1fecfe00 rshift8 pdata ,pdata 
6949 c2006947 loop store_enc_byte 
694a 20600000 rtn 

compare_res:
694b 1800700c force regidx_result ,regext_index 
694c 18007204 force 4 ,loopcnt 

compare_res_loop:
694d efe80006 ifetch 4 ,contr 
694e 9de67c00 isub regext ,null 
694f 24628000 nrtn zero 
6950 1f00f001 increase 1 ,regext_index 
6951 c200694d loop compare_res_loop 
6952 18007c00 force 0 ,null 
6953 20600000 rtn 

enable_authrom:
6954 6fe28050 fetch 1 ,core_clkoff 
6955 793ffe00 set0 clock_off_auth_rom ,pdata 
6956 67e28050 store 1 ,core_clkoff 
6957 20600000 rtn 

disable_authrom:
6958 6fe28050 fetch 1 ,core_clkoff 
6959 79207e00 set1 clock_off_auth_rom ,pdata 
695a 67e28050 store 1 ,core_clkoff 
695b 20600000 rtn 

init_memp:
695c d8a008f7 arg mem_p ,contw 
695d 3803ffff setsect 0 ,0x3ffff 
695e 3807ffff setsect 1 ,0x3ffff 
695f 380bffff setsect 2 ,0x3ffff 
6960 380ffbff setsect 3 ,0x3fbff 
6961 e7f20005 istore 9 ,contw 
6962 3803ffff setsect 0 ,0x3ffff 
6963 3807ffff setsect 1 ,0x3ffff 
6964 380bffff setsect 2 ,0x3ffff 
6965 380fffff setsect 3 ,0x3ffff 
6966 e7f20005 istore 9 ,contw 
6967 3803ffff setsect 0 ,0x3ffff 
6968 3807ffff setsect 1 ,0x3ffff 
6969 380bcfff setsect 2 ,0x3cfff 
696a 380fffff setsect 3 ,0x3ffff 
696b e7f20005 istore 9 ,contw 
696c 3803ffff setsect 0 ,0x3ffff 
696d 3807ffff setsect 1 ,0x3ffff 
696e 380bffef setsect 2 ,0x3ffef 
696f 380fffff setsect 3 ,0x3ffff 
6970 e7f20005 istore 9 ,contw 
6971 3803ffff setsect 0 ,0x3ffff 
6972 3807ffff setsect 1 ,0x3ffff 
6973 380bffff setsect 2 ,0x3ffff 
6974 380fffff setsect 3 ,0x3ffff 
6975 e7f20005 istore 9 ,contw 
6976 3803ffff setsect 0 ,0x3ffff 
6977 38066c7f setsect 1 ,0x26c7f 
6978 3808146b setsect 2 ,0x146b 
6979 380f7bb3 setsect 3 ,0x37bb3 
697a e7f20005 istore 9 ,contw 
697b 3801feb8 setsect 0 ,0x1feb8 
697c 38050c12 setsect 1 ,0x10c12 
697d 380ab722 setsect 2 ,0x2b722 
697e 380e9fa6 setsect 3 ,0x29fa6 
697f e7f20005 istore 9 ,contw 
6980 3800e70f setsect 0 ,0xe70f 
6981 38056720 setsect 1 ,0x16720 
6982 3808519e setsect 2 ,0x519e 
6983 380d9084 setsect 3 ,0x19084 
6984 e7f20005 istore 9 ,contw 
6985 38031012 setsect 0 ,0x31012 
6986 380760bf setsect 1 ,0x360bf 
6987 380bf0af setsect 2 ,0x3f0af 
6988 380c03d3 setsect 3 ,0x3d3 
6989 e7f20005 istore 9 ,contw 
698a 3803a188 setsect 0 ,0x3a188 
698b 38043ad0 setsect 1 ,0x3ad0 
698c 380bcbf2 setsect 2 ,0x3cbf2 
698d 380e43d9 setsect 3 ,0x243d9 
698e e7f20005 istore 9 ,contw 
698f 3802b030 setsect 0 ,0x2b030 
6990 38076a03 setsect 1 ,0x36a03 
6991 38091188 setsect 2 ,0x11188 
6992 380de520 setsect 3 ,0x1e520 
6993 e7f20005 istore 9 ,contw 
6994 3803a11e setsect 0 ,0x3a11e 
6995 3804fe5d setsect 1 ,0xfe5d 
6996 3808dd57 setsect 2 ,0xdd57 
6997 380dac93 setsect 3 ,0x1ac93 
6998 e7f20005 istore 9 ,contw 
6999 380011ed setsect 0 ,0x11ed 
699a 380618c4 setsect 1 ,0x218c4 
699b 38088da7 setsect 2 ,0x8da7 
699c 380e57ff setsect 3 ,0x257ff 
699d e7f20005 istore 9 ,contw 
699e 3803192b setsect 0 ,0x3192b 
699f 38074641 setsect 1 ,0x34641 
69a0 3809be0c setsect 2 ,0x1be0c 
69a1 380f66ad setsect 3 ,0x366ad 
69a2 e7f20005 istore 9 ,contw 
69a3 38001f83 setsect 0 ,0x1f83 
69a4 38055a23 setsect 1 ,0x15a23 
69a5 380bf9b0 setsect 2 ,0x3f9b0 
69a6 380c3949 setsect 3 ,0x3949 
69a7 e7f20005 istore 9 ,contw 
69a8 38013a51 setsect 0 ,0x13a51 
69a9 380553fd setsect 1 ,0x153fd 
69aa 380b372a setsect 2 ,0x3372a 
69ab 380cf1bb setsect 3 ,0xf1bb 
69ac e7f20005 istore 9 ,contw 
69ad 3803ae85 setsect 0 ,0x3ae85 
69ae 3805eed9 setsect 1 ,0x1eed9 
69af 38089e66 setsect 2 ,0x9e66 
69b0 380c01a8 setsect 3 ,0x1a8 
69b1 e7f00005 istore 8 ,contw 
69b2 20600000 rtn 

init_memp_256:
69b3 d8a0098f arg mem_p_256 ,contw 
69b4 3803ffff setsect 0 ,0x3ffff 
69b5 3807ffff setsect 1 ,0x3ffff 
69b6 380bffff setsect 2 ,0x3ffff 
69b7 380fffff setsect 3 ,0x3ffff 
69b8 e7f20005 istore 9 ,contw 
69b9 3803ffff setsect 0 ,0x3ffff 
69ba 3804003f setsect 1 ,0x3f 
69bb 38080000 setsect 2 ,0x0 
69bc 380c0000 setsect 3 ,0x0 
69bd e7f20005 istore 9 ,contw 
69be 38000000 setsect 0 ,0x0 
69bf 38040000 setsect 1 ,0x0 
69c0 38081000 setsect 2 ,0x1000 
69c1 380c0000 setsect 3 ,0x0 
69c2 e7f20005 istore 9 ,contw 
69c3 3803ff00 setsect 0 ,0x3ff00 
69c4 3807ffff setsect 1 ,0x3ffff 
69c5 380bffcf setsect 2 ,0x3ffcf 
69c6 380fffff setsect 3 ,0x3ffff 
69c7 e7f20005 istore 9 ,contw 
69c8 3803ffff setsect 0 ,0x3ffff 
69c9 3807ffff setsect 1 ,0x3ffff 
69ca 380bffff setsect 2 ,0x3ffff 
69cb 380c03ff setsect 3 ,0x3ff 
69cc e7f20005 istore 9 ,contw 
69cd 38000000 setsect 0 ,0x0 
69ce 38040000 setsect 1 ,0x0 
69cf 38080000 setsect 2 ,0x0 
69d0 380c0000 setsect 3 ,0x0 
69d1 e7f20005 istore 9 ,contw 
69d2 38010000 setsect 0 ,0x10000 
69d3 38040000 setsect 1 ,0x0 
69d4 380bf000 setsect 2 ,0x3f000 
69d5 380fffff setsect 3 ,0x3ffff 
69d6 e7f20005 istore 9 ,contw 
69d7 380296ff setsect 0 ,0x296ff 
69d8 38062630 setsect 1 ,0x22630 
69d9 380b945d setsect 2 ,0x3945d 
69da 380fd284 setsect 3 ,0x3d284 
69db e7f20005 istore 9 ,contw 
69dc 380333a0 setsect 0 ,0x333a0 
69dd 38044b7a setsect 1 ,0x4b7a 
69de 380837d8 setsect 2 ,0x37d8 
69df 380fc9dc setsect 3 ,0x3c9dc 
69e0 e7f20005 istore 9 ,contw 
69e1 3803a440 setsect 0 ,0x3a440 
69e2 3805b958 setsect 1 ,0x1b958 
69e3 380b8bce setsect 2 ,0x38bce 
69e4 380d091f setsect 3 ,0x1091f 
69e5 e7f20005 istore 9 ,contw 
69e6 3802e12c setsect 0 ,0x2e12c 
69e7 3805f47c setsect 1 ,0x1f47c 
69e8 380b56b1 setsect 2 ,0x356b1 
69e9 380efd47 setsect 3 ,0x2fd47 
69ea e7f20005 istore 9 ,contw 
69eb 38006837 setsect 0 ,0x6837 
69ec 3806ed90 setsect 1 ,0x2ed90 
69ed 3809ecec setsect 2 ,0x1ecec 
69ee 380dacc5 setsect 3 ,0x1acc5 
69ef e7f20005 istore 9 ,contw 
69f0 38023357 setsect 0 ,0x23357 
69f1 38058af3 setsect 1 ,0x18af3 
69f2 3808f9e1 setsect 2 ,0xf9e1 
69f3 380d29f0 setsect 3 ,0x129f0 
69f4 e7f20005 istore 9 ,contw 
69f5 3802e7eb setsect 0 ,0x2e7eb 
69f6 3807e6e3 setsect 1 ,0x3e6e3 
69f7 380be1a7 setsect 2 ,0x3e1a7 
69f8 380d0b8b setsect 3 ,0x10b8b 
69f9 e7f20005 istore 9 ,contw 
69fa 38024fe3 setsect 0 ,0x24fe3 
69fb 380420ef setsect 1 ,0x20ef 
69fc 3809b5a6 setsect 2 ,0x1b5a6 
69fd 380cdc2f setsect 3 ,0xdc2f 
69fe e7f20005 istore 9 ,contw 
69ff 38013860 setsect 0 ,0x13860 
6a00 3806bd69 setsect 1 ,0x2bd69 
6a01 3808391a setsect 2 ,0x391a 
6a02 380db222 setsect 3 ,0x1b222 
6a03 e7f20005 istore 9 ,contw 
6a04 20600000 rtn 

publickey_init:
6a05 6fe246a0 fetch 1 ,mem_ssp_enable 
6a06 243a6a18 nbranch sp_initialize ,blank 
6a07 20206f0e branch sp_initialize_256 

publickey_calc:
6a08 4758c036 bpatchx patch36_1 ,mem_patch36 
6a09 6fe246a0 fetch 1 ,mem_ssp_enable 
6a0a 207a0000 rtn blank 
6a0b 6fe245f7 fetch 1 ,mem_sp_local_key_invalid 
6a0c c1808000 rtnne sp_key_valid 
6a0d 6fe244a9 fetch 1 ,mem_le_secure_connect_enable 
6a0e 207a0000 rtn blank 
6a0f 6fe244ae fetch 1 ,mem_le_sc_local_key_invalid 
6a10 c1018000 rtneq sp_key_valid_256 
6a11 6fe446c1 fetch 2 ,mem_ui_state_map 
6a12 c2806a16 bbit1 ui_state_bt_connected ,stop_publickey_calc_256 
6a13 6fe244ab fetch 1 ,mem_le_sc_calc 
6a14 c0006f0e beq sp_calc_standby ,sp_initialize_256 
6a15 20600000 rtn 

stop_publickey_calc_256:
6a16 7044ab00 jam sp_calc_standby ,mem_le_sc_calc 
6a17 20600000 rtn 

sp_initialize:
6a18 6fe246a0 fetch 1 ,mem_ssp_enable 
6a19 203a5951 branch ssp_disable ,blank 
6a1a 2040594b call ssp_enable 
6a1b 20406a1d call sp_clear_flags 
6a1c 20206b08 branch sp_pubkey_calc 

sp_clear_flags:
6a1d 58000000 setarg 0 
6a1e 67f00a1f store 8 ,mem_sp_state_start 
6a1f 67e80a27 store 4 ,mem_sp_flag_start 
6a20 67ee46a6 store 7 ,mem_sp_iocap_remote 
6a21 20600000 rtn 

sp_generate_local_key:
6a22 700a2101 jam sp_flag_commit ,mem_sp_flag 
6a23 20206a27 branch sp_generate_local_key0 

sp_master_generate_local_key:
6a24 6fe245f7 fetch 1 ,mem_sp_local_key_invalid 
6a25 c000eb25 beq sp_key_valid ,sp_dhkey_calc 
6a26 20203b25 branch assert 

sp_generate_local_key0:
6a27 6fe245f7 fetch 1 ,mem_sp_local_key_invalid 
6a28 c000ea2a beq sp_key_valid ,sp_start_send_pubkey 
6a29 20206b08 branch sp_pubkey_calc 

sp_start_send_pubkey:
6a2a 20406b25 call sp_dhkey_calc 
6a2b 6fe20a20 fetch 1 ,mem_master_sp_state 
6a2c 247a0000 nrtn blank 
6a2d 700a1f03 jam sp_stat_key_send ,mem_sp_state 
6a2e 20600000 rtn 

sp_calc_check_publickey_256:
6a2f 20406a4a call sp_calc_b256 
6a30 da200a4f arg mem_le_pubkey_remote_y_256 ,rega 
6a31 d8a008d7 arg mem_t7_256 ,contw 
6a32 20407110 call bn_sqrmod_256 
6a33 da200a2f arg mem_le_pubkey_remote_x_256 ,rega 
6a34 d8a00897 arg mem_t2_256 ,contw 
6a35 20407110 call bn_sqrmod_256 
6a36 da200897 arg mem_t2_256 ,rega 
6a37 da400a2f arg mem_le_pubkey_remote_x_256 ,regb 
6a38 d8a00897 arg mem_t2_256 ,contw 
6a39 20407078 call bn_mulmod_256 
6a3a da2009af arg mem_a_256 ,rega 
6a3b da400a2f arg mem_le_pubkey_remote_x_256 ,regb 
6a3c d8a008b7 arg mem_t3_256 ,contw 
6a3d 20407078 call bn_mulmod_256 
6a3e da2008b7 arg mem_t3_256 ,rega 
6a3f da400897 arg mem_t2_256 ,regb 
6a40 d8a00897 arg mem_t2_256 ,contw 
6a41 20407114 call bn_addmod_256 
6a42 da200877 arg mem_t0_256 ,rega 
6a43 da400897 arg mem_t2_256 ,regb 
6a44 d8a00877 arg mem_t0_256 ,contw 
6a45 20407114 call bn_addmod_256 
6a46 df200020 arg 32 ,loopcnt 
6a47 da2008d7 arg mem_t7_256 ,rega 
6a48 da400877 arg mem_t0_256 ,regb 
6a49 20207856 branch string_compare 

sp_calc_b256:
6a4a da2009ef arg mem_gy_256 ,rega 
6a4b d8a00877 arg mem_t0_256 ,contw 
6a4c 20407110 call bn_sqrmod_256 
6a4d da2009cf arg mem_gx_256 ,rega 
6a4e d8a00897 arg mem_t2_256 ,contw 
6a4f 20407110 call bn_sqrmod_256 
6a50 da200897 arg mem_t2_256 ,rega 
6a51 da4009cf arg mem_gx_256 ,regb 
6a52 d8a00897 arg mem_t2_256 ,contw 
6a53 20407078 call bn_mulmod_256 
6a54 da2009af arg mem_a_256 ,rega 
6a55 da4009cf arg mem_gx_256 ,regb 
6a56 d8a008b7 arg mem_t3_256 ,contw 
6a57 20407078 call bn_mulmod_256 
6a58 da2008b7 arg mem_t3_256 ,rega 
6a59 da400897 arg mem_t2_256 ,regb 
6a5a d8a00897 arg mem_t2_256 ,contw 
6a5b 20407114 call bn_addmod_256 
6a5c da200877 arg mem_t0_256 ,rega 
6a5d da400897 arg mem_t2_256 ,regb 
6a5e d8a00877 arg mem_t0_256 ,contw 
6a5f 2020712d branch bn_submod_256 

sp_calc_check_publickey:
6a60 20406a7b call sp_calc_b 
6a61 da200a4f arg mem_sp_pubkey_remote_y ,rega 
6a62 d8a008d7 arg mem_t7_256 ,contw 
6a63 20406c3f call bn_sqrmod 
6a64 da200a37 arg mem_sp_pubkey_remote_x ,rega 
6a65 d8a00897 arg mem_t2_256 ,contw 
6a66 20406c3f call bn_sqrmod 
6a67 da200897 arg mem_t2_256 ,rega 
6a68 da400a37 arg mem_sp_pubkey_remote_x ,regb 
6a69 d8a00897 arg mem_t2_256 ,contw 
6a6a 20406c1d call bn_mulmod 
6a6b da20090f arg mem_a ,rega 
6a6c da400a37 arg mem_sp_pubkey_remote_x ,regb 
6a6d d8a008b7 arg mem_t3_256 ,contw 
6a6e 20406c1d call bn_mulmod 
6a6f da2008b7 arg mem_t3_256 ,rega 
6a70 da400897 arg mem_t2_256 ,regb 
6a71 d8a00897 arg mem_t2_256 ,contw 
6a72 20406bec call bn_addmod 
6a73 da200877 arg mem_t0_256 ,rega 
6a74 da400897 arg mem_t2_256 ,regb 
6a75 d8a00877 arg mem_t0_256 ,contw 
6a76 20406bec call bn_addmod 
6a77 df200018 arg 24 ,loopcnt 
6a78 da2008d7 arg mem_t7_256 ,rega 
6a79 da400877 arg mem_t0_256 ,regb 
6a7a 20207856 branch string_compare 

sp_calc_b:
6a7b da200957 arg mem_gy ,rega 
6a7c d8a00877 arg mem_t0_256 ,contw 
6a7d 20406c3f call bn_sqrmod 
6a7e da20093f arg mem_gx ,rega 
6a7f d8a00897 arg mem_t2_256 ,contw 
6a80 20406c3f call bn_sqrmod 
6a81 da200897 arg mem_t2_256 ,rega 
6a82 da40093f arg mem_gx ,regb 
6a83 d8a00897 arg mem_t2_256 ,contw 
6a84 20406c1d call bn_mulmod 
6a85 da20090f arg mem_a ,rega 
6a86 da40093f arg mem_gx ,regb 
6a87 d8a008b7 arg mem_t3_256 ,contw 
6a88 20406c1d call bn_mulmod 
6a89 da2008b7 arg mem_t3_256 ,rega 
6a8a da400897 arg mem_t2_256 ,regb 
6a8b d8a00897 arg mem_t2_256 ,contw 
6a8c 20406bec call bn_addmod 
6a8d da200877 arg mem_t0_256 ,rega 
6a8e da400897 arg mem_t2_256 ,regb 
6a8f d8a00877 arg mem_t0_256 ,contw 
6a90 20206bef branch bn_submod 

sp_calculate_commitment:
6a91 6fe20a23 fetch 1 ,mem_sp_calc 
6a92 c0806aaf bne sp_calc_standby ,sp_calculate_commitment_wait_dhkey_calc 
6a93 20406aac call sp_local_random_key_generator 
6a94 d8a00aef arg mem_sp_prarm_stack ,contw 
6a95 58000a9f setarg mem_sp_random_local_end 
6a96 e7e40005 istore 2 ,contw 
6a97 58004688 setarg mem_sp_pubkey_local_x_end 
6a98 e7e40005 istore 2 ,contw 
6a99 58000a4f setarg mem_sp_pubkey_remote_x_end 
6a9a e7e40005 istore 2 ,contw 
6a9b 20206aa3 branch sp_calculate_commitment0 

master_sp_calculate_commitment:
6a9c d8a00aef arg mem_sp_prarm_stack ,contw 
6a9d 58000aaf setarg mem_sp_random_remote_end 
6a9e e7e40005 istore 2 ,contw 
6a9f 58000a4f setarg mem_sp_pubkey_remote_x_end 
6aa0 e7e40005 istore 2 ,contw 
6aa1 58004688 setarg mem_sp_pubkey_local_x_end 
6aa2 e7e40005 istore 2 ,contw 

sp_calculate_commitment0:
6aa3 20406e37 call function_f1 
6aa4 6fe20a20 fetch 1 ,mem_master_sp_state 
6aa5 c0026aa9 beq sp_stat_commit_calc ,master_sp_calculate_commitment0 
6aa6 700a2101 jam sp_flag_commit ,mem_sp_flag 
6aa7 700a1f05 jam sp_stat_commit_send ,mem_sp_state 
6aa8 20600000 rtn 

master_sp_calculate_commitment0:
6aa9 700a2014 jam sp_stat_commitment_compare ,mem_master_sp_state 
6aaa 20406a24 call sp_master_generate_local_key 
6aab 20206b6f branch master_set_mem_master_sp_flag 

sp_local_random_key_generator:
6aac d8a00a8f arg mem_sp_random_local ,contw 
6aad 18000e08 force 8 ,queue 
6aae 20206b3d branch random_generator 

sp_calculate_commitment_wait_dhkey_calc:
6aaf 700a2101 jam sp_flag_commit ,mem_sp_flag 
6ab0 20600000 rtn 

sp_confirm_check:
6ab1 d8a00798 arg mem_addr_value ,contw 
6ab2 6fec4140 fetch 6 ,mem_lap 
6ab3 e7ec0005 istore 6 ,contw 
6ab4 6fec0040 fetch 6 ,mem_plap 
6ab5 e7ec0005 istore 6 ,contw 
6ab6 6fe646a6 fetch 3 ,mem_sp_iocap_remote 
6ab7 e7e60005 istore 3 ,contw 
6ab8 20406ea4 call function_f3a 
6ab9 da200abf arg mem_sp_calc_result_high ,rega 
6aba da400acf arg mem_sp_check_result ,regb 
6abb 18000e04 force 4 ,queue 
6abc 20406b42 call compare4 
6abd 2420eacc nbranch sp_confirm_check_failed ,true 
6abe 20406a60 call sp_calc_check_publickey 
6abf 2422eacc nbranch sp_confirm_check_failed ,zero 
6ac0 20406ac3 call sp_confirm_check_success 
6ac1 70007d41 jam lmp_dhkey_check ,mem_lmi_opcode2 
6ac2 20205b51 branch tid_set_reply 

sp_confirm_check_success:
6ac3 6fe20a20 fetch 1 ,mem_master_sp_state 
6ac4 c004eac9 beq sp_stat_confirm_check ,sp_confirm_check_success_master 
6ac5 700a1f0a jam sp_stat_confirm_calc ,mem_sp_state 
6ac6 700a2101 jam sp_flag_commit ,mem_sp_flag 
6ac7 70007c03 jam lmp_accepted ,mem_lmo_opcode2 
6ac8 20600000 rtn 

sp_confirm_check_success_master:
6ac9 70007c03 jam lmp_accepted ,mem_lmo_opcode2 
6aca 700a2015 jam sp_state_end ,mem_master_sp_state 
6acb 20206b6f branch master_set_mem_master_sp_flag 

sp_confirm_check_failed:
6acc 6fe20a20 fetch 1 ,mem_master_sp_state 
6acd c004ead2 beq sp_stat_confirm_check ,sp_confirm_check_failed_master 
6ace 700a1f00 jam sp_stat_null ,mem_sp_state 
6acf 70007c04 jam lmp_not_accepted ,mem_lmo_opcode2 
6ad0 70007e05 jam authentication_failure_error ,mem_lmo_reason2 
6ad1 20600000 rtn 

sp_confirm_check_failed_master:
6ad2 70007c04 jam lmp_not_accepted ,mem_lmo_opcode2 
6ad3 700a2000 jam sp_stat_null ,mem_master_sp_state 
6ad4 20600000 rtn 

sp_confirm_calc:
6ad5 6fe20a24 fetch 1 ,mem_sp_dh_ready 
6ad6 c000ead9 beq sp_flag_commit ,sp_confirm_calc_ready 
6ad7 700a200a jam sp_stat_confirm_calc ,mem_master_sp_state 
6ad8 20206b6f branch master_set_mem_master_sp_flag 

sp_confirm_calc_ready:
6ad9 d8a00798 arg mem_addr_value ,contw 
6ada 6fec0040 fetch 6 ,mem_plap 
6adb e7ec0005 istore 6 ,contw 
6adc 6fec4140 fetch 6 ,mem_lap 
6add e7ec0005 istore 6 ,contw 
6ade 6fe646a1 fetch 3 ,mem_sp_iocap_local 
6adf e7e60005 istore 3 ,contw 
6ae0 20406ebb call function_f3b 
6ae1 6fe20a20 fetch 1 ,mem_master_sp_state 
6ae2 c0056ae6 beq sp_stat_confirm_calc ,sp_confirm_calc_master 
6ae3 700a1f0b jam sp_stat_confirm_send ,mem_sp_state 
6ae4 700a2101 jam sp_flag_commit ,mem_sp_flag 
6ae5 20600000 rtn 

sp_confirm_calc_master:
6ae6 700a200b jam sp_stat_confirm_send ,mem_master_sp_state 
6ae7 700a2201 jam sp_flag_commit ,mem_master_sp_flag 
6ae8 20600000 rtn 

sp_master_key_prarm_push:
6ae9 d8a00aef arg mem_sp_prarm_stack ,contw 
6aea 6fec0040 fetch 6 ,mem_plap 
6aeb e7ec0005 istore 6 ,contw 
6aec 6fec4140 fetch 6 ,mem_lap 
6aed e7ec0005 istore 6 ,contw 
6aee 58000a9f setarg mem_sp_random_local_end 
6aef e7e40005 istore 2 ,contw 
6af0 58000aaf setarg mem_sp_random_remote_end 
6af1 e7e40005 istore 2 ,contw 
6af2 20206afd branch sp_link_key_calc 

sp_link_key_prarm_push:
6af3 700a1f0f jam sp_stat_done ,mem_sp_state 
6af4 d8a00aef arg mem_sp_prarm_stack ,contw 
6af5 6fec4140 fetch 6 ,mem_lap 
6af6 e7ec0005 istore 6 ,contw 
6af7 6fec0040 fetch 6 ,mem_plap 
6af8 e7ec0005 istore 6 ,contw 
6af9 58000aaf setarg mem_sp_random_remote_end 
6afa e7e40005 istore 2 ,contw 
6afb 58000a9f setarg mem_sp_random_local_end 
6afc e7e40005 istore 2 ,contw 

sp_link_key_calc:
6afd d8a00798 arg mem_addr_value ,contw 
6afe 6fec0aef fetch 6 ,mem_sp_prarm_stack 
6aff e7ec0005 istore 6 ,contw 
6b00 6fec0af5 fetch 6 ,mem_sp_prarm_stack + 6 
6b01 e7ec0005 istore 6 ,contw 
6b02 20406e6e call function_f2 
6b03 70427001 jam 1 ,mem_link_key_exists 
6b04 d8a04274 arg mem_link_key ,contw 
6b05 d8c00abf arg mem_sp_calc_result_high ,contr 
6b06 20407758 call memcpy16 
6b07 202031eb branch generate_linkkey_continue 

sp_pubkey_calc:
6b08 47594036 bpatchx patch36_2 ,mem_patch36 
6b09 6fe245f7 fetch 1 ,mem_sp_local_key_invalid 
6b0a c1800000 rtnne sp_key_invalid 
6b0b 6fe20a23 fetch 1 ,mem_sp_calc 
6b0c c1800000 rtnne sp_calc_standby 
6b0d d8a04658 arg mem_sp_private_key ,contw 
6b0e 18000e0b force 11 ,queue 
6b0f 20406b3d call random_generator 
6b10 180a7e00 random pdata 
6b11 1fe37e00 rshift pdata ,pdata 
6b12 e7e40005 istore 2 ,contw 
6b13 d8a0072f arg mem_k ,contw 
6b14 d8c04658 arg mem_sp_private_key ,contr 
6b15 20407756 call memcpy24 
6b16 d8a00657 arg mem_ax ,contw 
6b17 d8c0093f arg mem_gx ,contr 
6b18 20407750 call memcpy48 
6b19 d8a00687 arg mem_az ,contw 
6b1a 2040775d call bn_zero 
6b1b 70068701 jam 1 ,mem_az 
6b1c 20406ef4 call eckp_calc_init 
6b1d 700a2301 jam sp_calc_pubkey ,mem_sp_calc 
6b1e 20600000 rtn 

sp_pubkey_generated:
6b1f d8a04670 arg mem_sp_pubkey_local ,contw 
6b20 d8c0069f arg mem_bx ,contr 
6b21 20407750 call memcpy48 
6b22 7045f701 jam sp_key_valid ,mem_sp_local_key_invalid 
6b23 700a2300 jam sp_calc_standby ,mem_sp_calc 
6b24 20600000 rtn 

sp_dhkey_calc:
6b25 4759c036 bpatchx patch36_3 ,mem_patch36 
6b26 6fe20a2a fetch 1 ,mem_sp_dhkey_invalid 
6b27 c1800000 rtnne sp_key_invalid 
6b28 6fe20a23 fetch 1 ,mem_sp_calc 
6b29 c1800000 rtnne sp_calc_standby 
6b2a d8a0072f arg mem_k ,contw 
6b2b d8c04658 arg mem_sp_private_key ,contr 
6b2c 20407756 call memcpy24 
6b2d d8a00657 arg mem_ax ,contw 
6b2e d8c00a37 arg mem_sp_pubkey_remote ,contr 
6b2f 20407750 call memcpy48 
6b30 d8a00687 arg mem_az ,contw 
6b31 2040775d call bn_zero 
6b32 70068701 jam 1 ,mem_az 
6b33 20406ef4 call eckp_calc_init 
6b34 700a2302 jam sp_calc_dhkey ,mem_sp_calc 
6b35 20600000 rtn 

sp_dhkey_generated:
6b36 700a2401 jam sp_flag_commit ,mem_sp_dh_ready 
6b37 d8a00a77 arg mem_sp_dhkey ,contw 
6b38 d8c0069f arg mem_bx ,contr 
6b39 20407756 call memcpy24 
6b3a 700a2a01 jam sp_key_valid ,mem_sp_dhkey_invalid 
6b3b 700a2300 jam sp_calc_standby ,mem_sp_calc 
6b3c 20600000 rtn 

random_generator:
6b3d 18e08fff increase -1 ,queue 
6b3e 24610000 nrtn positive 
6b3f 180a7e00 random pdata 
6b40 e7e40005 istore 2 ,contw 
6b41 20206b3d branch random_generator 

compare4:
6b42 18e08fff increase -1 ,queue 
6b43 24216b4e nbranch compare4_success ,positive 
6b44 efe80011 ifetch 4 ,rega 
6b45 1fe20400 copy pdata ,temp 
6b46 efe80012 ifetch 4 ,regb 
6b47 9842fe00 iflip temp ,pdata 
6b48 2422eb4c nbranch compare4_failed ,zero 
6b49 1a20a204 increase 4 ,rega 
6b4a 1a40a404 increase 4 ,regb 
6b4b 20206b42 branch compare4 

compare4_failed:
6b4c 7840fc00 disable true 
6b4d 20600000 rtn 

compare4_success:
6b4e 7820fc00 enable true 
6b4f 20600000 rtn 

simple_pairing_sequence:
6b50 475a4036 bpatchx patch36_4 ,mem_patch36 
6b51 6fe20a21 fetch 1 ,mem_sp_flag 
6b52 207a0000 rtn blank 
6b53 700a2100 jam sp_flag_standby ,mem_sp_flag 
6b54 6fe20a1f fetch 1 ,mem_sp_state 
6b55 c001da64 beq sp_stat_key_send ,sp_send_lmp_encapsulated_header 
6b56 c002da81 beq sp_stat_commit_send ,sp_send_lmp_simple_pairing_comfirm 
6b57 c003da8c beq sp_stat_random_send ,sp_send_lmp_simple_pairing_number 
6b58 c005daa2 beq sp_stat_confirm_send ,sp_send_lmp_dhkey_check 
6b59 c0016a22 beq sp_stat_key_generate ,sp_generate_local_key 
6b5a c0026a91 beq sp_stat_commit_calc ,sp_calculate_commitment 
6b5b c004eab1 beq sp_stat_confirm_check ,sp_confirm_check 
6b5c c0056ad5 beq sp_stat_confirm_calc ,sp_confirm_calc 
6b5d c0066af3 beq sp_stat_link_key_calc ,sp_link_key_prarm_push 
6b5e 20600000 rtn 

master_simple_paring_sequence:
6b5f 475ac036 bpatchx patch36_5 ,mem_patch36 
6b60 6fe20a22 fetch 1 ,mem_master_sp_flag 
6b61 207a0000 rtn blank 
6b62 700a2200 jam sp_flag_standby ,mem_master_sp_flag 
6b63 6fe20a20 fetch 1 ,mem_master_sp_state 
6b64 c0095a45 beq sp_master_stat_start_skip ,sp_master_send_io_cap_get 
6b65 c009da4c beq sp_master_stat_start_done ,sp_master_send_io_cap_send 
6b66 c001da50 beq sp_stat_key_send ,sp_master_send_lmp_encapsulated_header 
6b67 c0026a9c beq sp_stat_commit_calc ,master_sp_calculate_commitment 
6b68 c00a5a54 beq sp_stat_commitment_compare ,sp_master_commitment_compare 
6b69 c003da62 beq sp_stat_random_send ,sp_master_send_lmp_simple_pairing_number 
6b6a c0056ad5 beq sp_stat_confirm_calc ,sp_confirm_calc 
6b6b c005daa1 beq sp_stat_confirm_send ,master_sp_send_lmp_dhkey_check 
6b6c c004eab1 beq sp_stat_confirm_check ,sp_confirm_check 
6b6d c00ada9b beq sp_state_end ,master_sp_sm_end 
6b6e 20600000 rtn 

master_set_mem_master_sp_flag:
6b6f 700a2201 jam sp_flag_commit ,mem_master_sp_flag 
6b70 20600000 rtn 

master_clear_mem_master_sp_flag:
6b71 700a2200 jam sp_flag_standby ,mem_master_sp_flag 
6b72 20600000 rtn 

sp_calc_sequence:
6b73 475b4036 bpatchx patch36_6 ,mem_patch36 
6b74 6fe246a0 fetch 1 ,mem_ssp_enable 
6b75 207a0000 rtn blank 
6b76 6fe20a23 fetch 1 ,mem_sp_calc 
6b77 207a0000 rtn blank 
6b78 1fe0fe80 increase 0x80 ,pdata 
6b79 67e20a23 store 1 ,mem_sp_calc 
6b7a c3838000 rtnbit1 7 
6b7b 6fe20654 fetch 1 ,mem_ec_loopc 
6b7c 203a6b7e branch sp_calc_sequence_done ,blank 
6b7d 20206eff branch eckp_calc 

sp_calc_sequence_done:
6b7e 20406d6a call ecunmapz 
6b7f 6fe20a23 fetch 1 ,mem_sp_calc 
6b80 c000eb1f beq sp_calc_pubkey ,sp_pubkey_generated 
6b81 c0016b36 beq sp_calc_dhkey ,sp_dhkey_generated 
6b82 20600000 rtn 

bn_testbit:
6b83 1fe10e07 and pdata ,7 ,queue 
6b84 1fe97e00 rshift3 pdata ,pdata 
6b85 98c08c00 iadd contr ,contr 
6b86 efe20006 ifetch 1 ,contr 
6b87 afec0000 qisolate0 pdata 
6b88 20600000 rtn 

ec_copy:
6b89 20407756 call memcpy24 
6b8a 20407756 call memcpy24 
6b8b 20207756 branch memcpy24 

bn_eq_zero:
6b8c eff00006 ifetch 8 ,contr 
6b8d 247a0000 nrtn blank 
6b8e eff00006 ifetch 8 ,contr 
6b8f 247a0000 nrtn blank 
6b90 eff00006 ifetch 8 ,contr 
6b91 20600000 rtn 

bn_eq_0:
6b92 efe80011 ifetch 4 ,rega 
6b93 98000400 iforce temp 
6b94 efe80012 ifetch 4 ,regb 
6b95 98467c00 isub temp ,null 
6b96 24628000 nrtn zero 
6b97 1a20a204 increase 4 ,rega 
6b98 1a40a404 increase 4 ,regb 
6b99 c2006b92 loop bn_eq_0 
6b9a 20600000 rtn 

bn_bigeq:
6b9b 18007206 force 6 ,loopcnt 
6b9c 1a20a214 increase 20 ,rega 
6b9d 1a40a414 increase 20 ,regb 

bn_bigeq_0:
6b9e efe80012 ifetch 4 ,regb 
6b9f 98000400 iforce temp 
6ba0 efe80011 ifetch 4 ,rega 
6ba1 98467e00 isub temp ,pdata 
6ba2 24610000 nrtn positive 
6ba3 247a0000 nrtn blank 
6ba4 1a20a3fc increase -4 ,rega 
6ba5 1a40a5fc increase -4 ,regb 
6ba6 c2006b9e loop bn_bigeq_0 
6ba7 20600000 rtn 

bn_add:
6ba8 18007206 force 6 ,loopcnt 
6ba9 18002600 force 0 ,regc 

bn_add_0:
6baa efe80011 ifetch 4 ,rega 
6bab 98000400 iforce temp 
6bac efe80012 ifetch 4 ,regb 
6bad 9840fe00 iadd temp ,pdata 
6bae 9a60fe00 iadd regc ,pdata 
6baf e7e80005 istore 4 ,contw 
6bb0 2feffe20 isolate1 32 ,pdata 
6bb1 7920a600 setflag true ,0 ,regc 
6bb2 1a20a204 increase 4 ,rega 
6bb3 1a40a404 increase 4 ,regb 
6bb4 c2006baa loop bn_add_0 
6bb5 20600000 rtn 

bn_sub:
6bb6 18007206 force 6 ,loopcnt 
6bb7 18002600 force 0 ,regc 

bn_sub_0:
6bb8 efe80012 ifetch 4 ,regb 
6bb9 98000400 iforce temp 
6bba efe80011 ifetch 4 ,rega 
6bbb 98467e00 isub temp ,pdata 
6bbc 9a667e00 isub regc ,pdata 
6bbd e7e80005 istore 4 ,contw 
6bbe 2feffe20 isolate1 32 ,pdata 
6bbf 7920a600 setflag true ,0 ,regc 
6bc0 1a20a204 increase 4 ,rega 
6bc1 1a40a404 increase 4 ,regb 
6bc2 c2006bb8 loop bn_sub_0 
6bc3 20600000 rtn 

bn_rshift6:
6bc4 18007206 force 6 ,loopcnt 
6bc5 1a20a214 increase 20 ,rega 

bn_rshift:
6bc6 18002600 force 0 ,regc 

bn_rshift_0:
6bc7 efe80011 ifetch 4 ,rega 
6bc8 2feffe00 isolate1 0 ,pdata 
6bc9 7920a601 setflag true ,1 ,regc 
6bca 1fe37e00 rshift pdata ,pdata 
6bcb 2a6ffe00 isolate1 0 ,regc 
6bcc 7920fe1f setflag true ,31 ,pdata 
6bcd e7e80011 istore 4 ,rega 
6bce 1a20a3fc increase -4 ,rega 
6bcf 1a632600 rshift regc ,regc 
6bd0 c2006bc7 loop bn_rshift_0 
6bd1 20600000 rtn 

bn_lshift:
6bd2 18007206 force 6 ,loopcnt 
6bd3 18002600 force 0 ,regc 

bn_lshift_0:
6bd4 efe80011 ifetch 4 ,rega 
6bd5 2feffe1f isolate1 31 ,pdata 
6bd6 7920a601 setflag true ,1 ,regc 
6bd7 1fe3fe00 lshift pdata ,pdata 
6bd8 2a6ffe00 isolate1 0 ,regc 
6bd9 7920fe00 setflag true ,0 ,pdata 
6bda e7e80011 istore 4 ,rega 
6bdb 1a20a204 increase 4 ,rega 
6bdc 1a632600 rshift regc ,regc 
6bdd c2006bd4 loop bn_lshift_0 
6bde 20600000 rtn 

bn_lshiftmod:
6bdf 20406bd2 call bn_lshift 

bn_lshiftmod_ismod:
6be0 2a6ffe00 isolate1 0 ,regc 
6be1 2020ebe8 branch bn_lshiftmod_0 ,true 
6be2 da4008f7 arg mem_p ,regb 
6be3 1a222600 copy rega ,regc 
6be4 1a20a3e8 increase -24 ,rega 
6be5 20406b9b call bn_bigeq 
6be6 24610000 nrtn positive 
6be7 1a622200 copy regc ,rega 

bn_lshiftmod_0:
6be8 1a20a3e8 increase -24 ,rega 
6be9 da4008f7 arg mem_p ,regb 
6bea 1a220a00 copy rega ,contw 
6beb 20206bb6 branch bn_sub 

bn_addmod:
6bec 20406ba8 call bn_add 
6bed 18a22200 copy contw ,rega 
6bee 20206be0 branch bn_lshiftmod_ismod 

bn_submod:
6bef 20406bb6 call bn_sub 
6bf0 2a6c0000 isolate0 0 ,regc 
6bf1 20608000 rtn true 
6bf2 da4008f7 arg mem_p ,regb 
6bf3 18a0a3e8 add contw ,-24 ,rega 
6bf4 1a220a00 copy rega ,contw 
6bf5 20206ba8 branch bn_add 

bn_p192mod:
6bf6 18a21600 copy contw ,timeup 
6bf7 1a226000 copy rega ,alarm 
6bf8 da400787 arg mem_tmp2 ,regb 
6bf9 1a420a00 copy regb ,contw 
6bfa 1a208c18 add rega ,24 ,contr 
6bfb eff00006 ifetch 8 ,contr 
6bfc e7f00005 istore 8 ,contw 
6bfd e7f00005 istore 8 ,contw 
6bfe 18007e00 force 0 ,pdata 
6bff e7f00005 istore 8 ,contw 
6c00 19620a00 copy timeup ,contw 
6c01 20406bec call bn_addmod 
6c02 da400787 arg mem_tmp2 ,regb 
6c03 1a420a00 copy regb ,contw 
6c04 18007e00 force 0 ,pdata 
6c05 e7f00005 istore 8 ,contw 
6c06 1e008c20 add alarm ,32 ,contr 
6c07 eff00006 ifetch 8 ,contr 
6c08 e7f00005 istore 8 ,contw 
6c09 e7f00005 istore 8 ,contw 
6c0a 19622200 copy timeup ,rega 
6c0b 1a220a00 copy rega ,contw 
6c0c 20406bec call bn_addmod 
6c0d da400787 arg mem_tmp2 ,regb 
6c0e 1a420a00 copy regb ,contw 
6c0f 1e008c28 add alarm ,40 ,contr 
6c10 eff00006 ifetch 8 ,contr 
6c11 e7f00005 istore 8 ,contw 
6c12 e7f00005 istore 8 ,contw 
6c13 e7f00005 istore 8 ,contw 
6c14 19622200 copy timeup ,rega 
6c15 1a220a00 copy rega ,contw 
6c16 20206bec branch bn_addmod 

bn_load:
6c17 18007206 force 6 ,loopcnt 

bn_load_0:
6c18 efe80006 ifetch 4 ,contr 
6c19 98005e00 iforce regext 
6c1a 1f00f001 increase 1 ,regext_index 
6c1b c2006c18 loop bn_load_0 
6c1c 20600000 rtn 

bn_mulmod:
6c1d 18a21600 copy contw ,timeup 
6c1e d8a00757 arg mem_tmp1 ,contw 
6c1f 2040775d call bn_zero 
6c20 d8a00757 arg mem_tmp1 ,contw 
6c21 1a220c00 copy rega ,contr 
6c22 18007000 force 0 ,regext_index 
6c23 20406c17 call bn_load 
6c24 1a420c00 copy regb ,contr 
6c25 20406c17 call bn_load 
6c26 18002400 force 0 ,regb 

bn_mulmod_1:
6c27 18000400 force 0 ,temp 
6c28 18002606 force 6 ,regc 

bn_mulmod_0:
6c29 efe80005 ifetch 4 ,contw 
6c2a 98002200 iforce rega 
6c2b 1a427000 copy regb ,regext_index 
6c2c 1de27e00 deposit regext 
6c2d 1a627000 copy regc ,regext_index 
6c2e 9deffe00 imul32 regext ,pdata 
6c2f 9a20fe00 iadd rega ,pdata 
6c30 9840fe00 iadd temp ,pdata 
6c31 e7e80005 istore 4 ,contw 
6c32 1fef0400 rshift32 pdata ,temp 
6c33 1a60a601 increase 1 ,regc 
6c34 2a61fe0c compare 12 ,regc ,0xff 
6c35 2420ec29 nbranch bn_mulmod_0 ,true 
6c36 18427e00 deposit temp 
6c37 e7e80005 istore 4 ,contw 
6c38 18a08be8 increase -24 ,contw 
6c39 1a40a401 increase 1 ,regb 
6c3a 2a41fe06 compare 6 ,regb ,0xff 
6c3b 2420ec27 nbranch bn_mulmod_1 ,true 
6c3c da200757 arg mem_tmp1 ,rega 
6c3d 19620a00 copy timeup ,contw 
6c3e 20206bf6 branch bn_p192mod 

bn_sqrmod:
6c3f 1a222400 copy rega ,regb 
6c40 20206c1d branch bn_mulmod 

bn_rshifteven:
6c41 1a226000 copy rega ,alarm 

bn_rshifteven_1:
6c42 1e022200 copy alarm ,rega 
6c43 efe20011 ifetch 1 ,rega 
6c44 2feffe00 isolate1 0 ,pdata 
6c45 20608000 rtn true 
6c46 20406bc4 call bn_rshift6 
6c47 efe20012 ifetch 1 ,regb 
6c48 2fec0000 isolate0 0 ,pdata 
6c49 2020ec51 branch bn_rshifteven_0 ,true 
6c4a da2008f7 arg mem_p ,rega 
6c4b 1a420a00 copy regb ,contw 
6c4c 20406ba8 call bn_add 
6c4d efe20012 ifetch 1 ,regb 
6c4e 9a60fe00 iadd regc ,pdata 
6c4f e7e20012 istore 1 ,regb 
6c50 1a40a5e8 increase -24 ,regb 

bn_rshifteven_0:
6c51 1a40a218 add regb ,24 ,rega 
6c52 18007207 force 7 ,loopcnt 
6c53 20406bc6 call bn_rshift 
6c54 20206c42 branch bn_rshifteven_1 

bn_invmod:
6c55 18a21600 copy contw ,timeup 
6c56 d8a007b7 arg mem_tmp0 ,contw 
6c57 2040775d call bn_zero 
6c58 18007e00 force 0 ,pdata 
6c59 67e8076f store 4 ,mem_tmp5 
6c5a 67e807cf store 4 ,mem_t2 
6c5b 7007b701 jam 1 ,mem_tmp0 
6c5c d8a00757 arg mem_tmp1 ,contw 
6c5d 2040775d call bn_zero 
6c5e d8c008f7 arg mem_p ,contr 
6c5f d8a00787 arg mem_tmp2 ,contw 
6c60 20407756 call memcpy24 
6c61 1a220c00 copy rega ,contr 
6c62 d8a0079f arg mem_tmp3 ,contw 
6c63 20407756 call memcpy24 

bn_invmod_2:
6c64 d8c0079f arg mem_tmp3 ,contr 
6c65 20406b8c call bn_eq_zero 
6c66 203a6c8d branch bn_invmod_0 ,blank 
6c67 da20079f arg mem_tmp3 ,rega 
6c68 da4007b7 arg mem_tmp0 ,regb 
6c69 20406c41 call bn_rshifteven 
6c6a da200787 arg mem_tmp2 ,rega 
6c6b da400757 arg mem_tmp1 ,regb 
6c6c 20406c41 call bn_rshifteven 
6c6d da20079f arg mem_tmp3 ,rega 
6c6e da400787 arg mem_tmp2 ,regb 
6c6f 20406b9b call bn_bigeq 
6c70 20216c7f branch bn_invmod_1 ,positive 
6c71 da200787 arg mem_tmp2 ,rega 
6c72 da40079f arg mem_tmp3 ,regb 
6c73 1a220a00 copy rega ,contw 
6c74 20406bb6 call bn_sub 
6c75 da2007b7 arg mem_tmp0 ,rega 
6c76 da400757 arg mem_tmp1 ,regb 
6c77 1a420a00 copy regb ,contw 
6c78 20406ba8 call bn_add 
6c79 efe20011 ifetch 1 ,rega 
6c7a 9a60a600 iadd regc ,regc 
6c7b efe20012 ifetch 1 ,regb 
6c7c 9a60fe00 iadd regc ,pdata 
6c7d e7e20012 istore 1 ,regb 
6c7e 20206c64 branch bn_invmod_2 

bn_invmod_1:
6c7f da20079f arg mem_tmp3 ,rega 
6c80 da400787 arg mem_tmp2 ,regb 
6c81 1a220a00 copy rega ,contw 
6c82 20406bb6 call bn_sub 
6c83 da200757 arg mem_tmp1 ,rega 
6c84 da4007b7 arg mem_tmp0 ,regb 
6c85 1a420a00 copy regb ,contw 
6c86 20406ba8 call bn_add 
6c87 efe20011 ifetch 1 ,rega 
6c88 9a60a600 iadd regc ,regc 
6c89 efe20012 ifetch 1 ,regb 
6c8a 9a60fe00 iadd regc ,pdata 
6c8b e7e20012 istore 1 ,regb 
6c8c 20206c64 branch bn_invmod_2 

bn_invmod_0:
6c8d d8a007b7 arg mem_tmp0 ,contw 
6c8e 2040775d call bn_zero 
6c8f 6fe2076f fetch 1 ,mem_tmp5 
6c90 67e207b7 store 1 ,mem_tmp0 
6c91 67e207bf store 1 ,mem_tmp0a 
6c92 da2007b7 arg mem_tmp0 ,rega 
6c93 da400757 arg mem_tmp1 ,regb 
6c94 1a420a00 copy regb ,contw 
6c95 20406bec call bn_addmod 
6c96 da2008f7 arg mem_p ,rega 
6c97 da400757 arg mem_tmp1 ,regb 
6c98 19620a00 copy timeup ,contw 
6c99 20206bef branch bn_submod 

ecdbl:
6c9a da200717 arg mem_cz ,rega 
6c9b d8a007cf arg mem_t2 ,contw 
6c9c 20406c3f call bn_sqrmod 
6c9d da2007cf arg mem_t2 ,rega 
6c9e d8a007e7 arg mem_t3 ,contw 
6c9f 20406c3f call bn_sqrmod 
6ca0 da20090f arg mem_a ,rega 
6ca1 da4007e7 arg mem_t3 ,regb 
6ca2 d8a007e7 arg mem_t3 ,contw 
6ca3 20406c1d call bn_mulmod 
6ca4 da2006e7 arg mem_cx ,rega 
6ca5 d8a007cf arg mem_t2 ,contw 
6ca6 20406c3f call bn_sqrmod 
6ca7 d8c007cf arg mem_t2 ,contr 
6ca8 d8a0079f arg mem_t1 ,contw 
6ca9 20407756 call memcpy24 
6caa da20079f arg mem_t1 ,rega 
6cab 20406bdf call bn_lshiftmod 
6cac da2007cf arg mem_t2 ,rega 
6cad da40079f arg mem_t1 ,regb 
6cae d8a007cf arg mem_t2 ,contw 
6caf 20406bec call bn_addmod 
6cb0 da2007cf arg mem_t2 ,rega 
6cb1 da4007e7 arg mem_t3 ,regb 
6cb2 d8a007cf arg mem_t2 ,contw 
6cb3 20406bec call bn_addmod 
6cb4 d8c006e7 arg mem_cx ,contr 
6cb5 d8a0079f arg mem_t1 ,contw 
6cb6 20407756 call memcpy24 
6cb7 da2006ff arg mem_cy ,rega 
6cb8 d8a007e7 arg mem_t3 ,contw 
6cb9 20406c3f call bn_sqrmod 
6cba da20079f arg mem_t1 ,rega 
6cbb 20406bdf call bn_lshiftmod 
6cbc da20079f arg mem_t1 ,rega 
6cbd 20406bdf call bn_lshiftmod 
6cbe da20079f arg mem_t1 ,rega 
6cbf da4007e7 arg mem_t3 ,regb 
6cc0 d8a0079f arg mem_t1 ,contw 
6cc1 20406c1d call bn_mulmod 
6cc2 da2007e7 arg mem_t3 ,rega 
6cc3 d8a007b7 arg mem_t0 ,contw 
6cc4 20406c3f call bn_sqrmod 
6cc5 da2007b7 arg mem_t0 ,rega 
6cc6 20406bdf call bn_lshiftmod 
6cc7 da2007b7 arg mem_t0 ,rega 
6cc8 20406bdf call bn_lshiftmod 
6cc9 da2007b7 arg mem_t0 ,rega 
6cca 20406bdf call bn_lshiftmod 
6ccb d8c006ff arg mem_cy ,contr 
6ccc d8a007e7 arg mem_t3 ,contw 
6ccd 20407756 call memcpy24 
6cce da2007e7 arg mem_t3 ,rega 
6ccf 20406bdf call bn_lshiftmod 
6cd0 da2007e7 arg mem_t3 ,rega 
6cd1 da400717 arg mem_cz ,regb 
6cd2 d8a00717 arg mem_cz ,contw 
6cd3 20406c1d call bn_mulmod 
6cd4 da2007cf arg mem_t2 ,rega 
6cd5 d8a007e7 arg mem_t3 ,contw 
6cd6 20406c3f call bn_sqrmod 
6cd7 da2007e7 arg mem_t3 ,rega 
6cd8 da40079f arg mem_t1 ,regb 
6cd9 d8a007e7 arg mem_t3 ,contw 
6cda 20406bef call bn_submod 
6cdb da2007e7 arg mem_t3 ,rega 
6cdc da40079f arg mem_t1 ,regb 
6cdd d8a006e7 arg mem_cx ,contw 
6cde 20406bef call bn_submod 
6cdf da20079f arg mem_t1 ,rega 
6ce0 da4006e7 arg mem_cx ,regb 
6ce1 d8a007e7 arg mem_t3 ,contw 
6ce2 20406bef call bn_submod 
6ce3 da2007e7 arg mem_t3 ,rega 
6ce4 da4007cf arg mem_t2 ,regb 
6ce5 d8a007e7 arg mem_t3 ,contw 
6ce6 20406c1d call bn_mulmod 
6ce7 da2007e7 arg mem_t3 ,rega 
6ce8 da4007b7 arg mem_t0 ,regb 
6ce9 d8a006ff arg mem_cy ,contw 
6cea 20206bef branch bn_submod 

ecadd:
6ceb da200687 arg mem_az ,rega 
6cec d8a007ff arg mem_t7 ,contw 
6ced 20406c3f call bn_sqrmod 
6cee da2006e7 arg mem_cx ,rega 
6cef da4007ff arg mem_t7 ,regb 
6cf0 d8a007b7 arg mem_t0 ,contw 
6cf1 20406c1d call bn_mulmod 
6cf2 da200687 arg mem_az ,rega 
6cf3 da4007ff arg mem_t7 ,regb 
6cf4 d8a007ff arg mem_t7 ,contw 
6cf5 20406c1d call bn_mulmod 
6cf6 da2006ff arg mem_cy ,rega 
6cf7 da4007ff arg mem_t7 ,regb 
6cf8 d8a0079f arg mem_t1 ,contw 
6cf9 20406c1d call bn_mulmod 
6cfa da200717 arg mem_cz ,rega 
6cfb d8a007ff arg mem_t7 ,contw 
6cfc 20406c3f call bn_sqrmod 
6cfd da200657 arg mem_ax ,rega 
6cfe da4007ff arg mem_t7 ,regb 
6cff d8a007cf arg mem_t2 ,contw 
6d00 20406c1d call bn_mulmod 
6d01 da200717 arg mem_cz ,rega 
6d02 da4007ff arg mem_t7 ,regb 
6d03 d8a007ff arg mem_t7 ,contw 
6d04 20406c1d call bn_mulmod 
6d05 da20066f arg mem_ay ,rega 
6d06 da4007ff arg mem_t7 ,regb 
6d07 d8a007e7 arg mem_t3 ,contw 
6d08 20406c1d call bn_mulmod 
6d09 da2007b7 arg mem_t0 ,rega 
6d0a da4007cf arg mem_t2 ,regb 
6d0b d8a007ff arg mem_t7 ,contw 
6d0c 20406bef call bn_submod 
6d0d da2007b7 arg mem_t0 ,rega 
6d0e da4007cf arg mem_t2 ,regb 
6d0f d8a007b7 arg mem_t0 ,contw 
6d10 20406bec call bn_addmod 
6d11 da20079f arg mem_t1 ,rega 
6d12 da4007e7 arg mem_t3 ,regb 
6d13 d8a007cf arg mem_t2 ,contw 
6d14 20406bef call bn_submod 
6d15 da20079f arg mem_t1 ,rega 
6d16 da4007e7 arg mem_t3 ,regb 
6d17 d8a0079f arg mem_t1 ,contw 
6d18 20406bec call bn_addmod 
6d19 da20079f arg mem_t1 ,rega 
6d1a da4007ff arg mem_t7 ,regb 
6d1b d8a0079f arg mem_t1 ,contw 
6d1c 20406c1d call bn_mulmod 
6d1d da200717 arg mem_cz ,rega 
6d1e da400687 arg mem_az ,regb 
6d1f d8a007e7 arg mem_t3 ,contw 
6d20 20406c1d call bn_mulmod 
6d21 da2007e7 arg mem_t3 ,rega 
6d22 da4007ff arg mem_t7 ,regb 
6d23 d8a00717 arg mem_cz ,contw 
6d24 20406c1d call bn_mulmod 
6d25 da2007ff arg mem_t7 ,rega 
6d26 d8a007ff arg mem_t7 ,contw 
6d27 20406c3f call bn_sqrmod 
6d28 da2007ff arg mem_t7 ,rega 
6d29 da4007b7 arg mem_t0 ,regb 
6d2a d8a007e7 arg mem_t3 ,contw 
6d2b 20406c1d call bn_mulmod 
6d2c da2007ff arg mem_t7 ,rega 
6d2d da40079f arg mem_t1 ,regb 
6d2e d8a0079f arg mem_t1 ,contw 
6d2f 20406c1d call bn_mulmod 
6d30 da2007cf arg mem_t2 ,rega 
6d31 d8a006e7 arg mem_cx ,contw 
6d32 20406c3f call bn_sqrmod 
6d33 da2006e7 arg mem_cx ,rega 
6d34 da4007e7 arg mem_t3 ,regb 
6d35 d8a006e7 arg mem_cx ,contw 
6d36 20406bef call bn_submod 
6d37 d8c006e7 arg mem_cx ,contr 
6d38 d8a007ff arg mem_t7 ,contw 
6d39 20407756 call memcpy24 
6d3a da2007ff arg mem_t7 ,rega 
6d3b 20406bdf call bn_lshiftmod 
6d3c da2007e7 arg mem_t3 ,rega 
6d3d da4007ff arg mem_t7 ,regb 
6d3e d8a007e7 arg mem_t3 ,contw 
6d3f 20406bef call bn_submod 
6d40 da2007e7 arg mem_t3 ,rega 
6d41 da4007cf arg mem_t2 ,regb 
6d42 d8a007cf arg mem_t2 ,contw 
6d43 20406c1d call bn_mulmod 
6d44 da2007cf arg mem_t2 ,rega 
6d45 da40079f arg mem_t1 ,regb 
6d46 d8a006ff arg mem_cy ,contw 
6d47 20406bef call bn_submod 
6d48 da2006ff arg mem_cy ,rega 
6d49 da4008f7 arg mem_p ,regb 
6d4a d8a006ff arg mem_cy ,contw 
6d4b 18002600 force 0 ,regc 
6d4c 6fe206ff fetch 1 ,mem_cy 
6d4d 2feffe00 isolate1 0 ,pdata 
6d4e 2040eba8 call bn_add ,true 
6d4f 1a626000 copy regc ,alarm 
6d50 da2006ff arg mem_cy ,rega 
6d51 20406bc4 call bn_rshift6 
6d52 6fe20716 fetch 1 ,mem_cy5 
6d53 2e0ffe00 isolate1 0 ,alarm 
6d54 7920fe07 setflag true ,7 ,pdata 
6d55 67e20716 store 1 ,mem_cy5 
6d56 20600000 rtn 

eckp_0:
6d57 6fe20654 fetch 1 ,mem_ec_loopc 
6d58 1fe0ffff increase -1 ,pdata 
6d59 24610000 nrtn positive 
6d5a 67e20654 store 1 ,mem_ec_loopc 
6d5b 6fe20653 fetch 1 ,mem_ec_infinite 
6d5c 205a6c9a call ecdbl ,blank 
6d5d 6fe20654 fetch 1 ,mem_ec_loopc 
6d5e d8c0072f arg mem_k ,contr 
6d5f 20406b83 call bn_testbit 
6d60 2020ed57 branch eckp_0 ,true 
6d61 6fe20653 fetch 1 ,mem_ec_infinite 
6d62 243a6d65 nbranch eckp_1 ,blank 
6d63 20406ceb call ecadd 
6d64 20206d57 branch eckp_0 

eckp_1:
6d65 70065300 jam 0 ,mem_ec_infinite 
6d66 d8c00657 arg mem_ax ,contr 
6d67 d8a006e7 arg mem_cx ,contw 
6d68 20406b89 call ec_copy 
6d69 20206d57 branch eckp_0 

ecunmapz:
6d6a da200717 arg mem_cz ,rega 
6d6b d8a007e7 arg mem_t3 ,contw 
6d6c 20406c55 call bn_invmod 
6d6d da2007e7 arg mem_t3 ,rega 
6d6e d8a0079f arg mem_t1 ,contw 
6d6f 20406c3f call bn_sqrmod 
6d70 da2006e7 arg mem_cx ,rega 
6d71 da40079f arg mem_t1 ,regb 
6d72 d8a0069f arg mem_bx ,contw 
6d73 20406c1d call bn_mulmod 
6d74 da2007e7 arg mem_t3 ,rega 
6d75 da40079f arg mem_t1 ,regb 
6d76 d8a007cf arg mem_t2 ,contw 
6d77 20406c1d call bn_mulmod 
6d78 da2006ff arg mem_cy ,rega 
6d79 da4007cf arg mem_t2 ,regb 
6d7a d8a006b7 arg mem_by ,contw 
6d7b 20206c1d branch bn_mulmod 

sha_endian_swap2:
6d7c efe80006 ifetch 4 ,contr 
6d7d 18002204 force 4 ,rega 
6d7e 18a08a03 increase 3 ,contw 

sha_endian_loop:
6d7f e7e20005 istore 1 ,contw 
6d80 1fecfe00 rshift8 pdata ,pdata 
6d81 18a08bfe increase -2 ,contw 
6d82 1a20a3ff increase -1 ,rega 
6d83 2422ed7f nbranch sha_endian_loop ,zero 
6d84 18a08a05 increase 5 ,contw 
6d85 c2006d7c loop sha_endian_swap2 
6d86 20600000 rtn 

sha_getw:
6d87 18ebfe00 lshift2 queue ,pdata 
6d88 99608c00 iadd timeup ,contr 
6d89 efe80006 ifetch 4 ,contr 
6d8a 20600000 rtn 

sha_r:
6d8b 18006010 force 16 ,alarm 
6d8c d9600657 arg memdat ,timeup 

sha_r_loop:
6d8d 1e008ff9 add alarm ,-7 ,queue 
6d8e 20406d87 call sha_getw 
6d8f 98000400 iforce temp 
6d90 1e008ff0 add alarm ,-16 ,queue 
6d91 20406d87 call sha_getw 
6d92 98408400 iadd temp ,temp 
6d93 1e008ffe add alarm ,-2 ,queue 
6d94 20406d87 call sha_getw 
6d95 1fee7e01 shasx pdata ,1 ,pdata 
6d96 98408400 iadd temp ,temp 
6d97 1e008ff1 add alarm ,-15 ,queue 
6d98 20406d87 call sha_getw 
6d99 1fee7e00 shasx pdata ,0 ,pdata 
6d9a 98408400 iadd temp ,temp 
6d9b 1e0bfe00 lshift2 alarm ,pdata 
6d9c 99608a00 iadd timeup ,contw 
6d9d e0480005 istoret 4 ,contw 
6d9e 1e00e001 increase 1 ,alarm 
6d9f 2e01fe40 compare 64 ,alarm ,0xff 
6da0 2420ed8d nbranch sha_r_loop ,true 
6da1 20600000 rtn 

sha_init:
6da2 d8c0096f arg memh0 ,contr 
6da3 18007007 force 7 ,regext_index 

sha_init_0:
6da4 efe80006 ifetch 4 ,contr 
6da5 98005e00 iforce regext 
6da6 1f00f1ff increase -1 ,regext_index 
6da7 20216da4 branch sha_init_0 ,positive 
6da8 20600000 rtn 

sha:
6da9 475bc036 bpatchx patch36_7 ,mem_patch36 
6daa 20406d8b call sha_r 
6dab d8a00757 arg memahbak ,contw 
6dac 18007000 force 0 ,regext_index 

sha_0:
6dad 1de27e00 deposit regext 
6dae e7e80005 istore 4 ,contw 
6daf 1f00f001 increase 1 ,regext_index 
6db0 2f01fe08 compare 8 ,regext_index ,0xff 
6db1 2420edad nbranch sha_0 ,true 
6db2 20406954 call enable_authrom 
6db3 d9608700 arg memk ,timeup 
6db4 de000657 arg memdat ,alarm 
6db5 18007240 force 64 ,loopcnt 

sha_loop:
6db6 e8480030 ifetcht 4 ,alarm 
6db7 efe8000b ifetch 4 ,timeup 
6db8 19609604 increase 4 ,timeup 
6db9 1e00e004 increase 4 ,alarm 
6dba 9840fe00 iadd temp ,pdata 
6dbb 18007007 force 7 ,regext_index 
6dbc 9de08400 iadd regext ,temp 
6dbd 18007004 force 4 ,regext_index 
6dbe 1dee7e03 shasx regext ,3 ,pdata 
6dbf 98408400 iadd temp ,temp 
6dc0 18007005 force 5 ,regext_index 
6dc1 1de27e00 deposit regext 
6dc2 18007006 force 6 ,regext_index 
6dc3 9de2fe00 ixor regext ,pdata 
6dc4 18007004 force 4 ,regext_index 
6dc5 9de17e00 iand regext ,pdata 
6dc6 18007006 force 6 ,regext_index 
6dc7 9de2fe00 ixor regext ,pdata 
6dc8 98408400 iadd temp ,temp 
6dc9 18007007 force 7 ,regext_index 
6dca 18425e00 copy temp ,regext 
6dcb 18007003 force 3 ,regext_index 
6dcc 1de27e00 deposit regext 
6dcd 9840de00 iadd temp ,regext 
6dce 18007000 force 0 ,regext_index 
6dcf 1de27e00 deposit regext 
6dd0 18007001 force 1 ,regext_index 
6dd1 9de10400 iand regext ,temp 
6dd2 9de1fe00 ior regext ,pdata 
6dd3 18007002 force 2 ,regext_index 
6dd4 9de17e00 iand regext ,pdata 
6dd5 98418400 ior temp ,temp 
6dd6 18007000 force 0 ,regext_index 
6dd7 1dee7e02 shasx regext ,2 ,pdata 
6dd8 9840fe00 iadd temp ,pdata 
6dd9 18007007 force 7 ,regext_index 
6dda 9de0de00 iadd regext ,regext 
6ddb 980efc00 regexrot 
6ddc c2006db6 loop sha_loop 
6ddd d8c00757 arg memahbak ,contr 
6dde 18007000 force 0 ,regext_index 

sha_1:
6ddf efe80006 ifetch 4 ,contr 
6de0 9de0de00 iadd regext ,regext 
6de1 1f00f001 increase 1 ,regext_index 
6de2 2f01fe08 compare 8 ,regext_index ,0xff 
6de3 2420eddf nbranch sha_1 ,true 
6de4 20206958 branch disable_authrom 

sha_result:
6de5 d8a00aaf arg memresult ,contw 
6de6 18007007 force 7 ,regext_index 

sha_regext_save:
6de7 1de27e00 deposit regext 
6de8 e7e80005 istore 4 ,contw 
6de9 1f00f1ff increase -1 ,regext_index 
6dea 20216de7 branch sha_regext_save ,positive 
6deb 20600000 rtn 

pad_xor:
6dec d8a00657 arg memdat ,contw 
6ded 18c08dfc increase -4 ,contr 
6dee 1f262210 sub loopcnt ,16 ,rega 

pad_xor_0:
6def efe80006 ifetch 4 ,contr 
6df0 9842fe00 ixor temp ,pdata 
6df1 e7e80005 istore 4 ,contw 
6df2 18c08df8 increase -8 ,contr 
6df3 c2006def loop pad_xor_0 
6df4 1a227200 copy rega ,loopcnt 
6df5 18427e00 deposit temp 

pad_xor_1:
6df6 e7e80005 istore 4 ,contw 
6df7 c2006df6 loop pad_xor_1 
6df8 20600000 rtn 

g_noninit_number_confirm:
6df9 20406dfe call g_noninit0 
6dfa 20406de5 call sha_result 
6dfb 20206e24 branch g_common0 

g_noninit:
6dfc 20406dfe call g_noninit0 
6dfd 20206e24 branch g_common0 

g_noninit0:
6dfe d8c00a4f arg mem_sp_pubkey_remote_x_end ,contr 
6dff d8a00657 arg memdat ,contw 
6e00 18007206 force 6 ,loopcnt 
6e01 20406f08 call memcpy_dword_swap 
6e02 d8c04688 arg mem_sp_pubkey_local_x_end ,contr 
6e03 18007206 force 6 ,loopcnt 
6e04 20406f08 call memcpy_dword_swap 
6e05 d8c00aaf arg mem_sp_random_remote_end ,contr 
6e06 20406f07 call memcpy_dword_swap4 
6e07 20406da2 call sha_init 
6e08 20406da9 call sha 
6e09 d8c00a9f arg mem_sp_random_local_end ,contr 
6e0a d8a00657 arg memdat ,contw 
6e0b 20206e1b branch g_common 

g_init:
6e0c d8c04688 arg mem_sp_pubkey_local_x_end ,contr 
6e0d d8a00657 arg memdat ,contw 
6e0e 18007206 force 6 ,loopcnt 
6e0f 20406f08 call memcpy_dword_swap 
6e10 d8c00a4f arg mem_sp_pubkey_remote_x_end ,contr 
6e11 18007206 force 6 ,loopcnt 
6e12 20406f08 call memcpy_dword_swap 
6e13 d8c00a9f arg mem_sp_random_local_end ,contr 
6e14 20406f07 call memcpy_dword_swap4 
6e15 20406da2 call sha_init 
6e16 20406da9 call sha 
6e17 d8c00aaf arg mem_sp_random_remote_end ,contr 
6e18 d8a00657 arg memdat ,contw 
6e19 20406e1b call g_common 
6e1a 20206e24 branch g_common0 

g_common:
6e1b 20406f07 call memcpy_dword_swap4 
6e1c 58800000 setarg 0x800000 
6e1d 1fed7e00 lshift8 pdata ,pdata 
6e1e e7e80005 istore 4 ,contw 
6e1f 18007205 force 5 ,loopcnt 
6e20 2040775e call memset0 
6e21 58000280 setarg 640 
6e22 e7e80005 istore 4 ,contw 
6e23 20206da9 branch sha 

g_common0:
6e24 6fe80aaf fetch 4 ,memresult 
6e25 da2003e8 arg 1000 ,rega 
6e26 9a26fc00 idiv rega 
6e27 2040782e call wait_div_end 
6e28 18077e00 remainder pdata 
6e29 67e80a2b store 4 ,mem_gkey 
6e2a 1807fe00 quotient pdata 
6e2b da2003e8 arg 1000 ,rega 
6e2c 9a26fc00 idiv rega 
6e2d 2040782e call wait_div_end 
6e2e 18077e00 remainder pdata 
6e2f da2003e8 arg 1000 ,rega 
6e30 9a2ffe00 imul32 rega ,pdata 
6e31 68480a2b fetcht 4 ,mem_gkey 
6e32 9840fe00 iadd temp ,pdata 
6e33 67e80a2b store 4 ,mem_gkey 
6e34 20600000 rtn 

function_f1_no_key:
6e35 7046ab00 jam 0 ,mem_passkey_1bit 
6e36 20206e39 branch function_f1_common 

function_f1:
6e37 6fe246a4 fetch 1 ,mem_ssp_mode_flag 
6e38 c0816e35 bne ssp_mode_passkey_entry_flag ,function_f1_no_key 

function_f1_common:
6e39 475c4037 bpatchx patch37_0 ,mem_patch37 
6e3a 58363636 setarg 0x363636 
6e3b 1fed0400 lshift8 pdata ,temp 
6e3c 18418436 or_into 0x36 ,temp 
6e3d 6fe40aef fetch 2 ,mem_sp_prarm_stack 
6e3e 1fe20c00 copy pdata ,contr 
6e3f 18007204 force 4 ,loopcnt 
6e40 20406dec call pad_xor 
6e41 20406da2 call sha_init 
6e42 20406da9 call sha 
6e43 6fe40af1 fetch 2 ,mem_sp_prarm_stack + 2 
6e44 1fe20c00 copy pdata ,contr 
6e45 d8a00657 arg memdat ,contw 
6e46 18007206 force 6 ,loopcnt 
6e47 20406f08 call memcpy_dword_swap 
6e48 6fe40af3 fetch 2 ,mem_sp_prarm_stack + 4 
6e49 1fe20c00 copy pdata ,contr 
6e4a 18007206 force 6 ,loopcnt 
6e4b 20406f08 call memcpy_dword_swap 
6e4c 58800000 setarg 0x800000 
6e4d e7e60005 istore 3 ,contw 
6e4e 6fe246ab fetch 1 ,mem_passkey_1bit 
6e4f e7e20005 istore 1 ,contw 
6e50 18007e00 force 0 ,pdata 
6e51 e7f00005 istore 8 ,contw 
6e52 58000388 setarg 0x0388 
6e53 e7e80005 istore 4 ,contw 
6e54 20406da9 call sha 
6e55 20406de5 call sha_result 
6e56 d8c00aaf arg memresult ,contr 
6e57 d8a00777 arg memahsave ,contw 
6e58 20407754 call memcpy32 
6e59 585c5c5c setarg 0x5c5c5c 
6e5a 1fed0400 lshift8 pdata ,temp 
6e5b 1841845c or_into 0x5c ,temp 
6e5c 6fe40aef fetch 2 ,mem_sp_prarm_stack 
6e5d 1fe20c00 copy pdata ,contr 
6e5e 18007204 force 4 ,loopcnt 
6e5f 20406dec call pad_xor 
6e60 20406da2 call sha_init 
6e61 20406da9 call sha 
6e62 d8c00797 arg memahsave_end ,contr 
6e63 d8a00657 arg memdat ,contw 
6e64 18007208 force 8 ,loopcnt 
6e65 20406f08 call memcpy_dword_swap 
6e66 58800000 setarg 0x800000 
6e67 1fed7e00 lshift8 pdata ,pdata 
6e68 e7e80005 istore 4 ,contw 
6e69 2040775d call bn_zero 
6e6a 58000300 setarg 0x0300 
6e6b e7e80005 istore 4 ,contw 
6e6c 20406da9 call sha 
6e6d 20206de5 branch sha_result 

function_f2:
6e6e 58363636 setarg 0x363636 
6e6f 1fed0400 lshift8 pdata ,temp 
6e70 18418436 or_into 0x36 ,temp 
6e71 d8c00a8f arg mem_sp_dhkey_end ,contr 
6e72 18007206 force 6 ,loopcnt 
6e73 20406dec call pad_xor 
6e74 20406da2 call sha_init 
6e75 20406da9 call sha 
6e76 6fe40afb fetch 2 ,mem_sp_prarm_stack + 12 
6e77 1fe20c00 copy pdata ,contr 
6e78 d8a00657 arg memdat ,contw 
6e79 20406f07 call memcpy_dword_swap4 
6e7a 6fe40afd fetch 2 ,mem_sp_prarm_stack + 14 
6e7b 1fe20c00 copy pdata ,contr 
6e7c 20406f07 call memcpy_dword_swap4 
6e7d 5862746c setarg 0x62746c 
6e7e 1fed7e00 lshift8 pdata ,pdata 
6e7f 1fe1fe6b or_into 0x6b ,pdata 
6e80 e7e80005 istore 4 ,contw 
6e81 d8c007a4 arg mem_addr_value_end ,contr 
6e82 18007203 force 3 ,loopcnt 
6e83 20406f08 call memcpy_dword_swap 
6e84 58800000 setarg 0x800000 
6e85 1fed7e00 lshift8 pdata ,pdata 
6e86 e7e80005 istore 4 ,contw 
6e87 18007e00 force 0 ,pdata 
6e88 e7f00005 istore 8 ,contw 
6e89 58000380 setarg 0x0380 
6e8a e7e80005 istore 4 ,contw 
6e8b 20406da9 call sha 
6e8c 20406de5 call sha_result 
6e8d d8c00aaf arg memresult ,contr 
6e8e d8a00777 arg memahsave ,contw 
6e8f 20407754 call memcpy32 
6e90 585c5c5c setarg 0x5c5c5c 
6e91 1fed0400 lshift8 pdata ,temp 
6e92 1841845c or_into 0x5c ,temp 
6e93 d8c00a8f arg mem_sp_dhkey_end ,contr 
6e94 18007206 force 6 ,loopcnt 
6e95 20406dec call pad_xor 
6e96 20406da2 call sha_init 
6e97 20406da9 call sha 
6e98 d8c00797 arg memahsave_end ,contr 
6e99 d8a00657 arg memdat ,contw 
6e9a 18007208 force 8 ,loopcnt 
6e9b 20406f08 call memcpy_dword_swap 
6e9c 58800000 setarg 0x800000 
6e9d 1fed7e00 lshift8 pdata ,pdata 
6e9e e7e80005 istore 4 ,contw 
6e9f 2040775d call bn_zero 
6ea0 58000300 setarg 0x0300 
6ea1 e7e80005 istore 4 ,contw 
6ea2 20406da9 call sha 
6ea3 20206de5 branch sha_result 

function_f3a:
6ea4 6fe246a4 fetch 1 ,mem_ssp_mode_flag 
6ea5 c0816eb5 bne ssp_mode_passkey_entry_flag ,function_f3a_no_pin 

function_f3a_common:
6ea6 475cc037 bpatchx patch37_1 ,mem_patch37 
6ea7 58363636 setarg 0x363636 
6ea8 1fed0400 lshift8 pdata ,temp 
6ea9 18418436 or_into 0x36 ,temp 
6eaa d8c00a8f arg mem_sp_dhkey_end ,contr 
6eab 18007206 force 6 ,loopcnt 
6eac 20406dec call pad_xor 
6ead 20406da2 call sha_init 
6eae 20406da9 call sha 
6eaf d8c00aaf arg mem_sp_random_remote_end ,contr 
6eb0 d8a00657 arg memdat ,contw 
6eb1 20406f07 call memcpy_dword_swap4 
6eb2 d8c00a9f arg mem_sp_random_local_end ,contr 
6eb3 20406f07 call memcpy_dword_swap4 
6eb4 20206eca branch function_f3_common 

function_f3a_no_pin:
6eb5 58000000 setarg 0 
6eb6 67e846cc store 4 ,mem_pin 
6eb7 20206ea6 branch function_f3a_common 

function_f3b_no_pin:
6eb8 58000000 setarg 0 
6eb9 67e846cc store 4 ,mem_pin 
6eba 20206ebd branch function_f3b_common 

function_f3b:
6ebb 6fe246a4 fetch 1 ,mem_ssp_mode_flag 
6ebc c0816eb8 bne ssp_mode_passkey_entry_flag ,function_f3b_no_pin 

function_f3b_common:
6ebd 58363636 setarg 0x363636 
6ebe 1fed0400 lshift8 pdata ,temp 
6ebf 18418436 or_into 0x36 ,temp 
6ec0 d8c00a8f arg mem_sp_dhkey_end ,contr 
6ec1 18007206 force 6 ,loopcnt 
6ec2 20406dec call pad_xor 
6ec3 20406da2 call sha_init 
6ec4 20406da9 call sha 
6ec5 d8c00a9f arg mem_sp_random_local_end ,contr 
6ec6 d8a00657 arg memdat ,contw 
6ec7 20406f07 call memcpy_dword_swap4 
6ec8 d8c00aaf arg mem_sp_random_remote_end ,contr 
6ec9 20406f07 call memcpy_dword_swap4 

function_f3_common:
6eca 58000000 setarg 0x0 
6ecb e7f00005 istore 8 ,contw 
6ecc e7e80005 istore 4 ,contw 
6ecd 6fe846cc fetch 4 ,mem_pin 
6ece e7e80005 istore 4 ,contw 
6ecf 18a20400 copy contw ,temp 
6ed0 70079780 jam 0x80 ,mem_addr_padding 
6ed1 18420a00 copy temp ,contw 
6ed2 d8c007a7 arg mem_addr_iocap_end ,contr 
6ed3 20406f07 call memcpy_dword_swap4 
6ed4 20406da9 call sha 
6ed5 d8a00657 arg memdat ,contw 
6ed6 18007207 force 7 ,loopcnt 
6ed7 2040775e call memset0 
6ed8 e7e80005 istore 4 ,contw 
6ed9 580003f8 setarg 0x03F8 
6eda e7e80005 istore 4 ,contw 
6edb 20406da9 call sha 
6edc 20406de5 call sha_result 
6edd d8c00aaf arg memresult ,contr 
6ede d8a00777 arg memahsave ,contw 
6edf 20407754 call memcpy32 
6ee0 585c5c5c setarg 0x5c5c5c 
6ee1 1fed0400 lshift8 pdata ,temp 
6ee2 1841845c or_into 0x5c ,temp 
6ee3 d8c00a8f arg mem_sp_dhkey_end ,contr 
6ee4 18007206 force 6 ,loopcnt 
6ee5 20406dec call pad_xor 
6ee6 20406da2 call sha_init 
6ee7 20406da9 call sha 
6ee8 d8c00797 arg memahsave_end ,contr 
6ee9 d8a00657 arg memdat ,contw 
6eea 18007208 force 8 ,loopcnt 
6eeb 20406f08 call memcpy_dword_swap 
6eec 58800000 setarg 0x800000 
6eed 1fed7e00 lshift8 pdata ,pdata 
6eee e7e80005 istore 4 ,contw 
6eef 2040775d call bn_zero 
6ef0 58000300 setarg 0x0300 
6ef1 e7e80005 istore 4 ,contw 
6ef2 20406da9 call sha 
6ef3 20206de5 branch sha_result 

eckp_calc_init:
6ef4 700654c0 jam 192 ,mem_ec_loopc 

eckp_calc_init_1:
6ef5 6fe20654 fetch 1 ,mem_ec_loopc 
6ef6 207a0000 rtn blank 
6ef7 1fe0ffff increase -1 ,pdata 
6ef8 67e20654 store 1 ,mem_ec_loopc 
6ef9 d8c0072f arg mem_k ,contr 
6efa 20406b83 call bn_testbit 
6efb 2020eef5 branch eckp_calc_init_1 ,true 
6efc d8c00657 arg mem_ax ,contr 
6efd d8a006e7 arg mem_cx ,contw 
6efe 20206b89 branch ec_copy 

eckp_calc:
6eff 20406c9a call ecdbl 
6f00 6fe20654 fetch 1 ,mem_ec_loopc 
6f01 1fe0ffff increase -1 ,pdata 
6f02 67e20654 store 1 ,mem_ec_loopc 
6f03 d8c0072f arg mem_k ,contr 
6f04 20406b83 call bn_testbit 
6f05 20608000 rtn true 
6f06 20206ceb branch ecadd 

memcpy_dword_swap4:
6f07 18007204 force 4 ,loopcnt 

memcpy_dword_swap:
6f08 18c08dfc increase -4 ,contr 

memcpy_dword_swap_loop:
6f09 efe80006 ifetch 4 ,contr 
6f0a e7e80005 istore 4 ,contw 
6f0b 18c08df8 increase -8 ,contr 
6f0c c2006f09 loop memcpy_dword_swap_loop 
6f0d 20600000 rtn 

sp_initialize_256:
6f0e 475d4037 bpatchx patch37_2 ,mem_patch37 
6f0f 6fe244a9 fetch 1 ,mem_le_secure_connect_enable 
6f10 203a52ee branch le_secure_connection_disable ,blank 
6f11 204052ea call le_secure_connection_enable 
6f12 20406a1d call sp_clear_flags 
6f13 20206f14 branch sp_pubkey_calc_256 

sp_pubkey_calc_256:
6f14 6fe244ae fetch 1 ,mem_le_sc_local_key_invalid 
6f15 c1800000 rtnne sp_key_invalid 
6f16 6fe244ab fetch 1 ,mem_le_sc_calc 
6f17 c1800000 rtnne sp_calc_standby 
6f18 d8a045f8 arg mem_le_private_key_256 ,contw 
6f19 18000e0f force 15 ,queue 
6f1a 20406b3d call random_generator 
6f1b 180a7e00 random pdata 
6f1c 1fe37e00 rshift pdata ,pdata 
6f1d e7e40005 istore 2 ,contw 
6f1e d8a007d7 arg mem_k_256 ,contw 
6f1f d8c045f8 arg mem_le_private_key_256 ,contr 
6f20 20407754 call memcpy32 
6f21 d8a006b7 arg mem_ax_256 ,contw 
6f22 d8c009cf arg mem_gx_256 ,contr 
6f23 20407747 call memcpy64 
6f24 d8a006f7 arg mem_az_256 ,contw 
6f25 20407768 call clear_mem_256 
6f26 7006f701 jam 1 ,mem_az_256 
6f27 20406f5e call eckp_calc_init_256 
6f28 7044ab03 jam sp_calc_pubkey_256 ,mem_le_sc_calc 
6f29 20600000 rtn 

sp_pubkey_generated_256:
6f2a d8a04618 arg mem_le_pubkey_local_x_256 ,contw 
6f2b d8c00717 arg mem_bx_256 ,contr 
6f2c 20407747 call memcpy64 
6f2d 7044ae03 jam sp_key_valid_256 ,mem_le_sc_local_key_invalid 
6f2e 7044ab00 jam sp_calc_standby ,mem_le_sc_calc 
6f2f 20600000 rtn 

sp_dhkey_calc_256:
6f30 6fe20a2a fetch 1 ,mem_sp_dhkey_invalid 
6f31 c1800000 rtnne sp_key_invalid 
6f32 6fe244ab fetch 1 ,mem_le_sc_calc 
6f33 c1800000 rtnne sp_calc_standby 
6f34 d8a007d7 arg mem_k_256 ,contw 
6f35 d8c045f8 arg mem_le_private_key_256 ,contr 
6f36 20407754 call memcpy32 
6f37 d8a006b7 arg mem_ax_256 ,contw 
6f38 d8c00a2f arg mem_le_pubkey_remote_x_256 ,contr 
6f39 20407747 call memcpy64 
6f3a d8a006f7 arg mem_az_256 ,contw 
6f3b 20407768 call clear_mem_256 
6f3c 7006f701 jam 1 ,mem_az_256 
6f3d 20406f5e call eckp_calc_init_256 
6f3e 7044ab04 jam sp_calc_dhkey_256 ,mem_le_sc_calc 
6f3f 20600000 rtn 

sp_dhkey_generated_256:
6f40 d8a00a6f arg mem_le_dhkey_256 ,contw 
6f41 d8c00717 arg mem_bx_256 ,contr 
6f42 20407754 call memcpy32 
6f43 700a2a03 jam sp_key_valid_256 ,mem_sp_dhkey_invalid 
6f44 7044ab00 jam sp_calc_standby ,mem_le_sc_calc 
6f45 20600000 rtn 

sp_calc_sequence_256:
6f46 6fe244a9 fetch 1 ,mem_le_secure_connect_enable 
6f47 207a0000 rtn blank 
6f48 6fe244ab fetch 1 ,mem_le_sc_calc 
6f49 207a0000 rtn blank 
6f4a 1fe0fe80 increase 0x80 ,pdata 
6f4b 67e244ab store 1 ,mem_le_sc_calc 
6f4c c3838000 rtnbit1 7 
6f4d 6fe40654 fetch 2 ,mem_ec_loopc 
6f4e 203a6f50 branch sp_calc_sequence_done_256 ,blank 
6f4f 20206f56 branch eckp_calc_256 

sp_calc_sequence_done_256:
6f50 475dc037 bpatchx patch37_3 ,mem_patch37 
6f51 20406f6b call ecunmapz_256 
6f52 6fe244ab fetch 1 ,mem_le_sc_calc 
6f53 c001ef2a beq sp_calc_pubkey_256 ,sp_pubkey_generated_256 
6f54 c0026f40 beq sp_calc_dhkey_256 ,sp_dhkey_generated_256 
6f55 20600000 rtn 

eckp_calc_256:
6f56 20406f7d call ecdbl_256 
6f57 6fe40654 fetch 2 ,mem_ec_loopc 
6f58 1fe0ffff increase -1 ,pdata 
6f59 67e40654 store 2 ,mem_ec_loopc 
6f5a d8c007d7 arg mem_k_256 ,contr 
6f5b 20406b83 call bn_testbit 
6f5c 20608000 rtn true 
6f5d 20206fce branch ecadd_256 

eckp_calc_init_256:
6f5e 475e4037 bpatchx patch37_4 ,mem_patch37 
6f5f 58000100 setarg 256 ,pdata 
6f60 67e40654 store 2 ,mem_ec_loopc 

eckp_calc_init_256_1:
6f61 6fe40654 fetch 2 ,mem_ec_loopc 
6f62 207a0000 rtn blank 
6f63 1fe0ffff increase -1 ,pdata 
6f64 67e40654 store 2 ,mem_ec_loopc 
6f65 d8c007d7 arg mem_k_256 ,contr 
6f66 20406b83 call bn_testbit 
6f67 2020ef61 branch eckp_calc_init_256_1 ,true 
6f68 d8c006b7 arg mem_ax_256 ,contr 
6f69 d8a00777 arg mem_cx_256 ,contw 
6f6a 20207746 branch memcpy96 

ecunmapz_256:
6f6b da2007b7 arg mem_cz_256 ,rega 
6f6c d8a008b7 arg mem_t3_256 ,contw 
6f6d 2040703a call bn_invmod_256 
6f6e da2008b7 arg mem_t3_256 ,rega 
6f6f d8a00857 arg mem_t1_256 ,contw 
6f70 20407110 call bn_sqrmod_256 
6f71 da200777 arg mem_cx_256 ,rega 
6f72 da400857 arg mem_t1_256 ,regb 
6f73 d8a00717 arg mem_bx_256 ,contw 
6f74 20407078 call bn_mulmod_256 
6f75 da2008b7 arg mem_t3_256 ,rega 
6f76 da400857 arg mem_t1_256 ,regb 
6f77 d8a00897 arg mem_t2_256 ,contw 
6f78 20407078 call bn_mulmod_256 
6f79 da200797 arg mem_cy_256 ,rega 
6f7a da400897 arg mem_t2_256 ,regb 
6f7b d8a00737 arg mem_by_256 ,contw 
6f7c 20207078 branch bn_mulmod_256 

ecdbl_256:
6f7d da2007b7 arg mem_cz_256 ,rega 
6f7e d8a00897 arg mem_t2_256 ,contw 
6f7f 20407110 call bn_sqrmod_256 
6f80 da200897 arg mem_t2_256 ,rega 
6f81 d8a008b7 arg mem_t3_256 ,contw 
6f82 20407110 call bn_sqrmod_256 
6f83 da2009af arg mem_a_256 ,rega 
6f84 da4008b7 arg mem_t3_256 ,regb 
6f85 d8a008b7 arg mem_t3_256 ,contw 
6f86 20407078 call bn_mulmod_256 
6f87 da200777 arg mem_cx_256 ,rega 
6f88 d8a00897 arg mem_t2_256 ,contw 
6f89 20407110 call bn_sqrmod_256 
6f8a d8c00897 arg mem_t2_256 ,contr 
6f8b d8a00857 arg mem_t1_256 ,contw 
6f8c 20407754 call memcpy32 
6f8d da200857 arg mem_t1_256 ,rega 
6f8e 20407117 call bn_lshiftmod_256 
6f8f da200897 arg mem_t2_256 ,rega 
6f90 da400857 arg mem_t1_256 ,regb 
6f91 d8a00897 arg mem_t2_256 ,contw 
6f92 20407114 call bn_addmod_256 
6f93 da200897 arg mem_t2_256 ,rega 
6f94 da4008b7 arg mem_t3_256 ,regb 
6f95 d8a00897 arg mem_t2_256 ,contw 
6f96 20407114 call bn_addmod_256 
6f97 d8c00777 arg mem_cx_256 ,contr 
6f98 d8a00857 arg mem_t1_256 ,contw 
6f99 20407754 call memcpy32 
6f9a da200797 arg mem_cy_256 ,rega 
6f9b d8a008b7 arg mem_t3_256 ,contw 
6f9c 20407110 call bn_sqrmod_256 
6f9d da200857 arg mem_t1_256 ,rega 
6f9e 20407117 call bn_lshiftmod_256 
6f9f da200857 arg mem_t1_256 ,rega 
6fa0 20407117 call bn_lshiftmod_256 
6fa1 da200857 arg mem_t1_256 ,rega 
6fa2 da4008b7 arg mem_t3_256 ,regb 
6fa3 d8a00857 arg mem_t1_256 ,contw 
6fa4 20407078 call bn_mulmod_256 
6fa5 da2008b7 arg mem_t3_256 ,rega 
6fa6 d8a00877 arg mem_t0_256 ,contw 
6fa7 20407110 call bn_sqrmod_256 
6fa8 da200877 arg mem_t0_256 ,rega 
6fa9 20407117 call bn_lshiftmod_256 
6faa da200877 arg mem_t0_256 ,rega 
6fab 20407117 call bn_lshiftmod_256 
6fac da200877 arg mem_t0_256 ,rega 
6fad 20407117 call bn_lshiftmod_256 
6fae d8c00797 arg mem_cy_256 ,contr 
6faf d8a008b7 arg mem_t3_256 ,contw 
6fb0 20407754 call memcpy32 
6fb1 da2008b7 arg mem_t3_256 ,rega 
6fb2 20407117 call bn_lshiftmod_256 
6fb3 da2008b7 arg mem_t3_256 ,rega 
6fb4 da4007b7 arg mem_cz_256 ,regb 
6fb5 d8a007b7 arg mem_cz_256 ,contw 
6fb6 20407078 call bn_mulmod_256 
6fb7 da200897 arg mem_t2_256 ,rega 
6fb8 d8a008b7 arg mem_t3_256 ,contw 
6fb9 20407110 call bn_sqrmod_256 
6fba da2008b7 arg mem_t3_256 ,rega 
6fbb da400857 arg mem_t1_256 ,regb 
6fbc d8a008b7 arg mem_t3_256 ,contw 
6fbd 2040712d call bn_submod_256 
6fbe da2008b7 arg mem_t3_256 ,rega 
6fbf da400857 arg mem_t1_256 ,regb 
6fc0 d8a00777 arg mem_cx_256 ,contw 
6fc1 2040712d call bn_submod_256 
6fc2 da200857 arg mem_t1_256 ,rega 
6fc3 da400777 arg mem_cx_256 ,regb 
6fc4 d8a008b7 arg mem_t3_256 ,contw 
6fc5 2040712d call bn_submod_256 
6fc6 da2008b7 arg mem_t3_256 ,rega 
6fc7 da400897 arg mem_t2_256 ,regb 
6fc8 d8a008b7 arg mem_t3_256 ,contw 
6fc9 20407078 call bn_mulmod_256 
6fca da2008b7 arg mem_t3_256 ,rega 
6fcb da400877 arg mem_t0_256 ,regb 
6fcc d8a00797 arg mem_cy_256 ,contw 
6fcd 2020712d branch bn_submod_256 

ecadd_256:
6fce da2006f7 arg mem_az_256 ,rega 
6fcf d8a008d7 arg mem_t7_256 ,contw 
6fd0 20407110 call bn_sqrmod_256 
6fd1 da200777 arg mem_cx_256 ,rega 
6fd2 da4008d7 arg mem_t7_256 ,regb 
6fd3 d8a00877 arg mem_t0_256 ,contw 
6fd4 20407078 call bn_mulmod_256 
6fd5 da2006f7 arg mem_az_256 ,rega 
6fd6 da4008d7 arg mem_t7_256 ,regb 
6fd7 d8a008d7 arg mem_t7_256 ,contw 
6fd8 20407078 call bn_mulmod_256 
6fd9 da200797 arg mem_cy_256 ,rega 
6fda da4008d7 arg mem_t7_256 ,regb 
6fdb d8a00857 arg mem_t1_256 ,contw 
6fdc 20407078 call bn_mulmod_256 
6fdd da2007b7 arg mem_cz_256 ,rega 
6fde d8a008d7 arg mem_t7_256 ,contw 
6fdf 20407110 call bn_sqrmod_256 
6fe0 da2006b7 arg mem_ax_256 ,rega 
6fe1 da4008d7 arg mem_t7_256 ,regb 
6fe2 d8a00897 arg mem_t2_256 ,contw 
6fe3 20407078 call bn_mulmod_256 
6fe4 da2007b7 arg mem_cz_256 ,rega 
6fe5 da4008d7 arg mem_t7_256 ,regb 
6fe6 d8a008d7 arg mem_t7_256 ,contw 
6fe7 20407078 call bn_mulmod_256 
6fe8 da2006d7 arg mem_ay_256 ,rega 
6fe9 da4008d7 arg mem_t7_256 ,regb 
6fea d8a008b7 arg mem_t3_256 ,contw 
6feb 20407078 call bn_mulmod_256 
6fec da400877 arg mem_t0_256 ,regb 
6fed da200897 arg mem_t2_256 ,rega 
6fee d8a008d7 arg mem_t7_256 ,contw 
6fef 2040712d call bn_submod_256 
6ff0 da200877 arg mem_t0_256 ,rega 
6ff1 da400897 arg mem_t2_256 ,regb 
6ff2 d8a00877 arg mem_t0_256 ,contw 
6ff3 20407114 call bn_addmod_256 
6ff4 da400857 arg mem_t1_256 ,regb 
6ff5 da2008b7 arg mem_t3_256 ,rega 
6ff6 d8a00897 arg mem_t2_256 ,contw 
6ff7 2040712d call bn_submod_256 
6ff8 da200857 arg mem_t1_256 ,rega 
6ff9 da4008b7 arg mem_t3_256 ,regb 
6ffa d8a00857 arg mem_t1_256 ,contw 
6ffb 20407114 call bn_addmod_256 
6ffc da200857 arg mem_t1_256 ,rega 
6ffd da4008d7 arg mem_t7_256 ,regb 
6ffe d8a00857 arg mem_t1_256 ,contw 
6fff 20407078 call bn_mulmod_256 
7000 da2007b7 arg mem_cz_256 ,rega 
7001 da4006f7 arg mem_az_256 ,regb 
7002 d8a008b7 arg mem_t3_256 ,contw 
7003 20407078 call bn_mulmod_256 
7004 da2008b7 arg mem_t3_256 ,rega 
7005 da4008d7 arg mem_t7_256 ,regb 
7006 d8a007b7 arg mem_cz_256 ,contw 
7007 20407078 call bn_mulmod_256 
7008 da2008d7 arg mem_t7_256 ,rega 
7009 d8a008d7 arg mem_t7_256 ,contw 
700a 20407110 call bn_sqrmod_256 
700b da2008d7 arg mem_t7_256 ,rega 
700c da400877 arg mem_t0_256 ,regb 
700d d8a008b7 arg mem_t3_256 ,contw 
700e 20407078 call bn_mulmod_256 
700f da2008d7 arg mem_t7_256 ,rega 
7010 da400857 arg mem_t1_256 ,regb 
7011 d8a00857 arg mem_t1_256 ,contw 
7012 20407078 call bn_mulmod_256 
7013 da200897 arg mem_t2_256 ,rega 
7014 d8a00777 arg mem_cx_256 ,contw 
7015 20407110 call bn_sqrmod_256 
7016 da200777 arg mem_cx_256 ,rega 
7017 da4008b7 arg mem_t3_256 ,regb 
7018 d8a00777 arg mem_cx_256 ,contw 
7019 2040712d call bn_submod_256 
701a d8c00777 arg mem_cx_256 ,contr 
701b d8a008d7 arg mem_t7_256 ,contw 
701c 20407754 call memcpy32 
701d da2008d7 arg mem_t7_256 ,rega 
701e 20407117 call bn_lshiftmod_256 
701f da2008b7 arg mem_t3_256 ,rega 
7020 da4008d7 arg mem_t7_256 ,regb 
7021 d8a008b7 arg mem_t3_256 ,contw 
7022 2040712d call bn_submod_256 
7023 da2008b7 arg mem_t3_256 ,rega 
7024 da400897 arg mem_t2_256 ,regb 
7025 d8a00897 arg mem_t2_256 ,contw 
7026 20407078 call bn_mulmod_256 
7027 da200897 arg mem_t2_256 ,rega 
7028 da400857 arg mem_t1_256 ,regb 
7029 d8a00797 arg mem_cy_256 ,contw 
702a 2040712d call bn_submod_256 
702b da200797 arg mem_cy_256 ,rega 
702c da40098f arg mem_p_256 ,regb 
702d d8a00797 arg mem_cy_256 ,contw 
702e 18002600 force 0 ,regc 
702f 6fe20797 fetch 1 ,mem_cy_256 
7030 2feffe00 isolate1 0 ,pdata 
7031 2040f112 call bn_add_256 ,true 
7032 1a626000 copy regc ,alarm 
7033 da200797 arg mem_cy_256 ,rega 
7034 20407142 call bn_rshift_256 
7035 6fe207b6 fetch 1 ,mem_cy5_256 
7036 2e0ffe00 isolate1 0 ,alarm 
7037 7920fe07 setflag true ,7 ,pdata 
7038 67e207b6 store 1 ,mem_cy5_256 
7039 20600000 rtn 

bn_invmod_256:
703a 18a21600 copy contw ,timeup 
703b d8a00877 arg mem_tmp0_256 ,contw 
703c 20407768 call clear_mem_256 
703d 18007e00 force 0 ,pdata 
703e 67e80897 store 4 ,mem_t2_256 
703f 70087701 jam 1 ,mem_tmp0_256 
7040 d8a007f7 arg mem_tmp1_256 ,contw 
7041 2040776a call clear_mem_512 
7042 d8c0098f arg mem_p_256 ,contr 
7043 d8a00837 arg mem_tmp2_256 ,contw 
7044 20407754 call memcpy32 
7045 1a220c00 copy rega ,contr 
7046 d8a00857 arg mem_tmp3_256 ,contw 
7047 20407754 call memcpy32 

bn_invmod_256_2:
7048 d8c00857 arg mem_tmp3_256 ,contr 
7049 2040714c call bn_eq_zero_256 
704a 203a7071 branch bn_invmod_256_0 ,blank 
704b da200857 arg mem_tmp3_256 ,rega 
704c da400877 arg mem_tmp0_256 ,regb 
704d 2040714f call bn_rshifteven_256 
704e da200837 arg mem_tmp2_256 ,rega 
704f da4007f7 arg mem_tmp1_256 ,regb 
7050 2040714f call bn_rshifteven_256 
7051 da200857 arg mem_tmp3_256 ,rega 
7052 da400837 arg mem_tmp2_256 ,regb 
7053 20407148 call bn_bigeq_256 
7054 20217063 branch bn_invmod_256_1 ,positive 
7055 da200837 arg mem_tmp2_256 ,rega 
7056 da400857 arg mem_tmp3_256 ,regb 
7057 1a220a00 copy rega ,contw 
7058 20407140 call bn_sub_256 
7059 da200877 arg mem_tmp0_256 ,rega 
705a da4007f7 arg mem_tmp1_256 ,regb 
705b 1a420a00 copy regb ,contw 
705c 20407112 call bn_add_256 
705d efe20011 ifetch 1 ,rega 
705e 9a60a600 iadd regc ,regc 
705f efe20012 ifetch 1 ,regb 
7060 9a60fe00 iadd regc ,pdata 
7061 e7e20012 istore 1 ,regb 
7062 20207048 branch bn_invmod_256_2 

bn_invmod_256_1:
7063 da200857 arg mem_tmp3_256 ,rega 
7064 da400837 arg mem_tmp2_256 ,regb 
7065 1a220a00 copy rega ,contw 
7066 20407140 call bn_sub_256 
7067 da2007f7 arg mem_tmp1_256 ,rega 
7068 da400877 arg mem_tmp0_256 ,regb 
7069 1a420a00 copy regb ,contw 
706a 20407112 call bn_add_256 
706b efe20011 ifetch 1 ,rega 
706c 9a60a600 iadd regc ,regc 
706d efe20012 ifetch 1 ,regb 
706e 9a60fe00 iadd regc ,pdata 
706f e7e20012 istore 1 ,regb 
7070 20207048 branch bn_invmod_256_2 

bn_invmod_256_0:
7071 da2007f7 arg mem_tmp1_256 ,rega 
7072 19620a00 copy timeup ,contw 
7073 204070a1 call bn_p256mod 
7074 da20098f arg mem_p_256 ,rega 
7075 19622400 copy timeup ,regb 
7076 19620a00 copy timeup ,contw 
7077 2020712d branch bn_submod_256 

bn_mulmod_256:
7078 18a21600 copy contw ,timeup 
7079 18007000 force 0 ,regext_index 
707a d8a007f7 arg mem_tmp1_256 ,contw 
707b 2040776a call clear_mem_512 
707c d8a00b64 arg mem_regext ,contw 
707d 2040776a call clear_mem_512 
707e 1a220c00 copy rega ,contr 
707f 700b6400 jam 0 ,mem_regext 
7080 58000000 setarg 0 
7081 2040710a call bn_load_mem 
7082 1a420c00 copy regb ,contr 
7083 2040710e call bn_load_256 
7084 18000e00 force 0 ,queue 
7085 d8a007f7 arg mem_tmp1_256 ,contw 

bn_mulmod_256_1:
7086 d8400b64 arg mem_regext ,temp 
7087 18e22400 copy queue ,regb 
7088 1a4bfe00 lshift2 regb ,pdata 
7089 9840a400 iadd temp ,regb 
708a 18000400 force 0 ,temp 
708b 18002600 force 0 ,regc 

bn_mulmod_256_0:
708c efe80005 ifetch 4 ,contw 
708d 98002200 iforce rega 
708e efe80012 ifetch 4 ,regb 
708f 1a627000 copy regc ,regext_index 
7090 9deffe00 imul32 regext ,pdata 
7091 9a20fe00 iadd rega ,pdata 
7092 9840fe00 iadd temp ,pdata 
7093 e7e80005 istore 4 ,contw 
7094 1fef0400 rshift32 pdata ,temp 
7095 1a60a601 increase 1 ,regc 
7096 2a61fe08 compare 8 ,regc ,0xff 
7097 2420f08c nbranch bn_mulmod_256_0 ,true 
7098 18427e00 deposit temp 
7099 e7e80005 istore 4 ,contw 
709a 18a08be0 increase -32 ,contw 
709b 18e08e01 increase 1 ,queue 
709c 28e1fe08 compare 8 ,queue ,0xff 
709d 2420f086 nbranch bn_mulmod_256_1 ,true 
709e da2007f7 arg mem_tmp1_256 ,rega 
709f 19620a00 copy timeup ,contw 
70a0 202070a1 branch bn_p256mod 

bn_p256mod:
70a1 475ec037 bpatchx patch37_5 ,mem_patch37 
70a2 18a21600 copy contw ,timeup 
70a3 1a226000 copy rega ,alarm 
70a4 da400837 arg mem_tmp2_256 ,regb 
70a5 1a420a00 copy regb ,contw 
70a6 20407765 call memset0_4 
70a7 e7f00005 istore 8 ,contw 
70a8 1a208c2c add rega ,44 ,contr 
70a9 2040774d call memcpy8 
70aa 20407749 call memcpy12 
70ab 1a422200 copy regb ,rega 
70ac 20407117 call bn_lshiftmod_256 
70ad da400837 arg mem_tmp2_256 ,regb 
70ae 1e022200 copy alarm ,rega 
70af 19620a00 copy timeup ,contw 
70b0 20407114 call bn_addmod_256 
70b1 da400837 arg mem_tmp2_256 ,regb 
70b2 1a420a00 copy regb ,contw 
70b3 20407765 call memset0_4 
70b4 e7f00005 istore 8 ,contw 
70b5 1e008c30 add alarm ,48 ,contr 
70b6 20407758 call memcpy16 
70b7 20407765 call memset0_4 
70b8 1a422200 copy regb ,rega 
70b9 20407117 call bn_lshiftmod_256 
70ba da400837 arg mem_tmp2_256 ,regb 
70bb 19622200 copy timeup ,rega 
70bc 1a220a00 copy rega ,contw 
70bd 20407114 call bn_addmod_256 
70be da400837 arg mem_tmp2_256 ,regb 
70bf 1a420a00 copy regb ,contw 
70c0 1e008c20 add alarm ,32 ,contr 
70c1 20407749 call memcpy12 
70c2 20407765 call memset0_4 
70c3 e7f00005 istore 8 ,contw 
70c4 1e008c38 add alarm ,56 ,contr 
70c5 2040774d call memcpy8 
70c6 19622200 copy timeup ,rega 
70c7 1a220a00 copy rega ,contw 
70c8 20407114 call bn_addmod_256 
70c9 da400837 arg mem_tmp2_256 ,regb 
70ca 1a420a00 copy regb ,contw 
70cb 1e008c24 add alarm ,36 ,contr 
70cc 20407749 call memcpy12 
70cd 1e008c34 add alarm ,52 ,contr 
70ce 20407749 call memcpy12 
70cf 1e008c34 add alarm ,52 ,contr 
70d0 2040774a call memcpy4 
70d1 1e008c20 add alarm ,32 ,contr 
70d2 2040774a call memcpy4 
70d3 19622200 copy timeup ,rega 
70d4 1a220a00 copy rega ,contw 
70d5 20407114 call bn_addmod_256 
70d6 da400837 arg mem_tmp2_256 ,regb 
70d7 1a420a00 copy regb ,contw 
70d8 1e008c2c add alarm ,44 ,contr 
70d9 20407749 call memcpy12 
70da 20407765 call memset0_4 
70db e7f00005 istore 8 ,contw 
70dc 1e008c20 add alarm ,32 ,contr 
70dd 2040774a call memcpy4 
70de 1e008c28 add alarm ,40 ,contr 
70df 2040774a call memcpy4 
70e0 19622200 copy timeup ,rega 
70e1 1a220a00 copy rega ,contw 
70e2 2040712d call bn_submod_256 
70e3 da400837 arg mem_tmp2_256 ,regb 
70e4 1a420a00 copy regb ,contw 
70e5 1e008c30 add alarm ,48 ,contr 
70e6 2040774d call memcpy8 
70e7 2040774d call memcpy8 
70e8 18007e00 force 0 ,pdata 
70e9 e7f00005 istore 8 ,contw 
70ea 1e008c24 add alarm ,36 ,contr 
70eb 2040774a call memcpy4 
70ec 1e008c2c add alarm ,44 ,contr 
70ed 2040774a call memcpy4 
70ee 19622200 copy timeup ,rega 
70ef 1a220a00 copy rega ,contw 
70f0 2040712d call bn_submod_256 
70f1 da400837 arg mem_tmp2_256 ,regb 
70f2 1a420a00 copy regb ,contw 
70f3 1e008c34 add alarm ,52 ,contr 
70f4 20407749 call memcpy12 
70f5 1e008c20 add alarm ,32 ,contr 
70f6 20407749 call memcpy12 
70f7 20407765 call memset0_4 
70f8 1e008c30 add alarm ,48 ,contr 
70f9 2040774a call memcpy4 
70fa 19622200 copy timeup ,rega 
70fb 1a220a00 copy rega ,contw 
70fc 2040712d call bn_submod_256 
70fd da400837 arg mem_tmp2_256 ,regb 
70fe 1a420a00 copy regb ,contw 
70ff 1e008c38 add alarm ,56 ,contr 
7100 2040774d call memcpy8 
7101 20407765 call memset0_4 
7102 1e008c24 add alarm ,36 ,contr 
7103 20407749 call memcpy12 
7104 20407765 call memset0_4 
7105 1e008c34 add alarm ,52 ,contr 
7106 2040774a call memcpy4 
7107 19622200 copy timeup ,rega 
7108 1a220a00 copy rega ,contw 
7109 2020712d branch bn_submod_256 

bn_load_mem:
710a 18007220 force 32 ,loopcnt 
710b d8a00b64 arg mem_regext ,contw 
710c 98a08a00 iadd contw ,contw 
710d 2020779f branch memcpy 

bn_load_256:
710e 18007208 force 8 ,loopcnt 
710f 20206c18 branch bn_load_0 

bn_sqrmod_256:
7110 1a222400 copy rega ,regb 
7111 20207078 branch bn_mulmod_256 

bn_add_256:
7112 18007208 force 8 ,loopcnt 
7113 20206ba9 branch bn_add + 1 

bn_addmod_256:
7114 20407112 call bn_add_256 
7115 18a22200 copy contw ,rega 
7116 20207118 branch bn_lshiftmod_ismod_256 

bn_lshiftmod_256:
7117 20407145 call bn_lshift_256 

bn_lshiftmod_ismod_256:
7118 2a6ffe00 isolate1 0 ,regc 
7119 2020f121 branch bn_lshiftmod_p_256 ,true 
711a da40098f arg mem_p_256 ,regb 
711b 1a222600 copy rega ,regc 
711c 1a20a3e0 increase -32 ,rega 
711d 20407148 call bn_bigeq_256 
711e 24610000 nrtn positive 
711f 1a622200 copy regc ,rega 
7120 20207129 branch sub_p2_256 

bn_lshiftmod_p_256:
7121 20407129 call sub_p2_256 
7122 1a222600 copy rega ,regc 
7123 1a20a3e0 increase -32 ,rega 
7124 da40098f arg mem_p_256 ,regb 
7125 20407148 call bn_bigeq_256 
7126 24610000 nrtn positive 
7127 1a622200 copy regc ,rega 
7128 20207129 branch sub_p2_256 

sub_p2_256:
7129 1a20a3e0 increase -32 ,rega 
712a da40098f arg mem_p_256 ,regb 
712b 1a220a00 copy rega ,contw 
712c 20207140 branch bn_sub_256 

bn_submod_256:
712d 20407140 call bn_sub_256 
712e 2020f137 branch bn_submod_256_np ,true 
712f 18a0a3e0 add contw ,-32 ,rega 
7130 da40098f arg mem_p_256 ,regb 
7131 20407148 call bn_bigeq_256 
7132 24610000 nrtn positive 
7133 da40098f arg mem_p_256 ,regb 
7134 18a0a3e0 add contw ,-32 ,rega 
7135 1a220a00 copy rega ,contw 
7136 20207140 branch bn_sub_256 

bn_submod_256_np:
7137 18a0a3e0 add contw ,-32 ,rega 
7138 da40098f arg mem_p_256 ,regb 
7139 1a220a00 copy rega ,contw 
713a 20407112 call bn_add_256 
713b 20608000 rtn true 
713c 18a0a3e0 add contw ,-32 ,rega 
713d da40098f arg mem_p_256 ,regb 
713e 1a220a00 copy rega ,contw 
713f 20207112 branch bn_add_256 

bn_sub_256:
7140 18007208 force 8 ,loopcnt 
7141 20206bb7 branch bn_sub + 1 

bn_rshift_256:
7142 18007208 force 8 ,loopcnt 
7143 1a20a21c increase 28 ,rega 
7144 20206bc6 branch bn_rshift 

bn_lshift_256:
7145 18007208 force 8 ,loopcnt 
7146 18002600 force 0 ,regc 
7147 20206bd4 branch bn_lshift_0 

bn_bigeq_256:
7148 18007208 force 8 ,loopcnt 
7149 1a20a21c increase 28 ,rega 
714a 1a40a41c increase 28 ,regb 
714b 20206b9e branch bn_bigeq_0 

bn_eq_zero_256:
714c eff00006 ifetch 8 ,contr 
714d 247a0000 nrtn blank 
714e 20206b8c branch bn_eq_zero 

bn_rshifteven_256:
714f 1a226000 copy rega ,alarm 

bn_rshifteven_256_1:
7150 1e022200 copy alarm ,rega 
7151 efe20011 ifetch 1 ,rega 
7152 2feffe00 isolate1 0 ,pdata 
7153 20608000 rtn true 
7154 20407142 call bn_rshift_256 
7155 efe20012 ifetch 1 ,regb 
7156 2fec0000 isolate0 0 ,pdata 
7157 2020f15f branch bn_rshifteven_256_0 ,true 
7158 da20098f arg mem_p_256 ,rega 
7159 1a420a00 copy regb ,contw 
715a 20407112 call bn_add_256 
715b efe20012 ifetch 1 ,regb 
715c 9a60fe00 iadd regc ,pdata 
715d e7e20012 istore 1 ,regb 
715e 1a40a5e0 increase -32 ,regb 

bn_rshifteven_256_0:
715f 1a40a220 add regb ,32 ,rega 
7160 18007209 force 9 ,loopcnt 
7161 20406bc6 call bn_rshift 
7162 20207150 branch bn_rshifteven_256_1 

ui_init:
7163 20758000 rtn wake 
7164 2040716b call ui_button_init 
7165 204071dc call ui_timer_init 
7166 2020719d branch ui_led_init 

ui_dispatch:
7167 6fe24132 fetch 1 ,mem_device_option 
7168 c1008000 rtneq dvc_op_hci 
7169 204071b6 call ui_led_blink_polling 
716a 202071cb branch ui_timer_check 

ui_button_init:
716b 6fe246ca fetch 1 ,mem_ui_button_gpio 
716c c17f8000 rtneq ui_button_gpio_disable 
716d 98000400 iforce temp 
716e 20405e97 call gpio_out_inactive 
716f 684246ca fetcht 1 ,mem_ui_button_gpio 
7170 20405e97 call gpio_out_inactive 
7171 20000064 nop 100 
7172 684246ca fetcht 1 ,mem_ui_button_gpio 
7173 20405e84 call gpio_config_input 
7174 20207177 branch ui_button_polling 

ui_button_disable:
7175 7046caff jam ui_button_gpio_disable ,mem_ui_button_gpio 
7176 20600000 rtn 

ui_button_polling:
7177 6fe246ca fetch 1 ,mem_ui_button_gpio 
7178 c17f8000 rtneq ui_button_gpio_disable 
7179 1fe20400 copy pdata ,temp 
717a 20405e8b call gpio_get_bit 
717b 2420f188 nbranch ui_button_up ,true 

ui_button_down:
717c 20407192 call ui_button_check_long_press 
717d 6fe446c1 fetch 2 ,mem_ui_state_map 
717e 79207e0c set1 ui_state_btn_down 
717f 67e446c1 store 2 ,mem_ui_state_map 
7180 6fe246bb fetch 1 ,mem_ui_button_last_state 
7181 c1000000 rtneq ui_button_state_down 
7182 7046bb00 jam ui_button_state_down ,mem_ui_button_last_state 
7183 6fe246c9 fetch 1 ,mem_ui_button_timeout 
7184 67e246ba store 1 ,mem_ui_button_timer 
7185 20407199 call lpm_button_get_wake_lock 
7186 700b082c jam bt_evt_button_down ,mem_fifo_temp 
7187 202071ee branch ui_ipc_send_event 

ui_button_up:
7188 6fe446c1 fetch 2 ,mem_ui_state_map 
7189 793ffe0c set0 ui_state_btn_down 
718a 67e446c1 store 2 ,mem_ui_state_map 
718b 6fe246bb fetch 1 ,mem_ui_button_last_state 
718c c1008000 rtneq ui_button_state_up 
718d 7046bb01 jam ui_button_state_up ,mem_ui_button_last_state 
718e 7046ba00 jam 0 ,mem_ui_button_timer 
718f 2040719b call lpm_button_clean_wake_lock 
7190 700b082d jam bt_evt_button_up ,mem_fifo_temp 
7191 202071ee branch ui_ipc_send_event 

ui_button_check_long_press:
7192 6fe246ba fetch 1 ,mem_ui_button_timer 
7193 207a0000 rtn blank 
7194 1fe0ffff increase -1 ,pdata 
7195 67e246ba store 1 ,mem_ui_button_timer 
7196 247a0000 nrtn blank 
7197 700b0810 jam bt_evt_button_long_pressed ,mem_fifo_temp 
7198 202071ee branch ui_ipc_send_event 

lpm_button_get_wake_lock:
7199 d8e00007 arg wake_lock_button ,queue 
719a 20203cac branch lpm_get_wake_lock 

lpm_button_clean_wake_lock:
719b d8e00007 arg wake_lock_button ,queue 
719c 20203cb0 branch lpm_put_wake_lock 

ui_led_init:
719d 6fe246c4 fetch 1 ,mem_led_gpio 
719e c17f8000 rtneq ui_button_gpio_disable 
719f 98000400 iforce temp 
71a0 20405e97 call gpio_out_inactive 
71a1 202071a6 branch ui_led_off 

ui_led_blink_stop:
71a2 6fe446c1 fetch 2 ,mem_ui_state_map 
71a3 793ffe0d set0 ui_state_led_blink 
71a4 67e446c1 store 2 ,mem_ui_state_map 
71a5 7046b900 jam ui_led_stop ,mem_led_switch 

ui_led_off:
71a6 6fe446c1 fetch 2 ,mem_ui_state_map 
71a7 793ffe0e set0 ui_state_led_on 
71a8 67e446c1 store 2 ,mem_ui_state_map 
71a9 684246c4 fetcht 1 ,mem_led_gpio 
71aa 20205e97 branch gpio_out_inactive 

ui_led_on:
71ab 6fe446c1 fetch 2 ,mem_ui_state_map 
71ac 79207e0e set1 ui_state_led_on 
71ad 67e446c1 store 2 ,mem_ui_state_map 
71ae 7046b900 jam ui_led_stop ,mem_led_switch 
71af 684246c4 fetcht 1 ,mem_led_gpio 
71b0 20205e99 branch gpio_out_active 

ui_led_blink_start:
71b1 6fe446c1 fetch 2 ,mem_ui_state_map 
71b2 79207e0d set1 ui_state_led_blink 
71b3 67e446c1 store 2 ,mem_ui_state_map 
71b4 7046b901 jam ui_led_start ,mem_led_switch 
71b5 20600000 rtn 

ui_led_blink_polling:
71b6 6fe246b9 fetch 1 ,mem_led_switch 
71b7 c1000000 rtneq ui_led_stop 
71b8 d8e00009 arg ui_led_blink ,queue 
71b9 204077ad call timer_check 
71ba 247a0000 nrtn blank 
71bb 6fe246b9 fetch 1 ,mem_led_switch 
71bc c00171c1 beq ui_led_dark_time ,ui_led_blink_polling_dark 
71bd 204071ab call ui_led_on 
71be 7046b902 jam ui_led_dark_time ,mem_led_switch 
71bf 6fe446c7 fetch 2 ,mem_led_light_time 
71c0 202071c4 branch ui_led_blink_timer_start 

ui_led_blink_polling_dark:
71c1 204071a6 call ui_led_off 
71c2 7046b903 jam ui_led_light_time ,mem_led_switch 
71c3 6fe446c5 fetch 2 ,mem_led_dark_time 

ui_led_blink_timer_start:
71c4 d8e00009 arg ui_led_blink ,queue 
71c5 202077a6 branch timer_init 

p_ui_timer_timeout:
71c6 58000010 setarg 0x10 
71c7 d8e00003 arg 3 ,queue 
71c8 204077c1 call lshift8_queue 
71c9 9a40a400 iadd regb ,regb 
71ca 20600000 rtn 

ui_timer_check:
71cb 476e403b bpatchx patch3b_4 ,mem_patch3b 
71cc da200000 arg 0 ,rega 
71cd 684846bc fetcht 4 ,mem_ui_timer_last_btclk 
71ce 1c422400 copy clkn_bt ,regb 
71cf 1a427e00 copy regb ,pdata 
71d0 98467c00 isub temp ,null 
71d1 244171c6 ncall p_ui_timer_timeout ,positive 

ui_timer_check_loop:
71d2 1a427e00 copy regb ,pdata 
71d3 184084a0 increase 160 ,temp 
71d4 184084a0 increase 160 ,temp 
71d5 98467c00 isub temp ,null 
71d6 242171df nbranch ui_timer_check_end ,positive 
71d7 1a20a201 increase 1 ,rega 
71d8 1a217e0f and rega ,0x0f ,pdata 
71d9 243a71d2 nbranch ui_timer_check_loop ,blank 
71da da200000 arg 0 ,rega 
71db 204071e6 call ui_timer_check_send_evt 

ui_timer_init:
71dc 1c427e00 copy clkn_bt ,pdata 
71dd 67e846bc store 4 ,mem_ui_timer_last_btclk 
71de 20600000 rtn 

ui_timer_check_end:
71df 476ec03b bpatchx patch3b_5 ,mem_patch3b 
71e0 1a227e00 copy rega ,pdata 
71e1 207a0000 rtn blank 
71e2 18408560 increase -160 ,temp 
71e3 18408560 increase -160 ,temp 
71e4 793f841c set0 28 ,temp 
71e5 604846bc storet 4 ,mem_ui_timer_last_btclk 

ui_timer_check_send_evt:
71e6 202041b3 branch app_evt_timer 

ui_ipc_get_lock:
71e7 7046ad01 jam 1 ,mem_ipc_lock_bt 

ui_ipc_get_lock_wait:
71e8 6fe246ae fetch 1 ,mem_ipc_lock_c51 
71e9 243a71e8 nbranch ui_ipc_get_lock_wait ,blank 
71ea 20600000 rtn 

ui_ipc_put_lock:
71eb 7046ad00 jam 0 ,mem_ipc_lock_bt 
71ec 20600000 rtn 

ui_ipc_fifo_out:
71ed 202078c9 branch fifo_out 

ui_ipc_send_event:
71ee 476f403b bpatchx patch3b_6 ,mem_patch3b 
71ef 2040485e call ipc_tx_bt_event 
71f0 6fe24132 fetch 1 ,mem_device_option 
71f1 c1008000 rtneq dvc_op_hci 
71f2 204071e7 call ui_ipc_get_lock 
71f3 62280b00 storer rega ,4 ,mem_ipc_rega_temp 
71f4 da2046af arg mem_ipc_fifo_bt2c51 ,rega 
71f5 204078bd call fifo_in 
71f6 6a280b00 fetchr rega ,4 ,mem_ipc_rega_temp 
71f7 202071eb branch ui_ipc_put_lock 

ui_ipc_send_cmd:
71f8 476fc03b bpatchx patch3b_7 ,mem_patch3b 
71f9 6fe24132 fetch 1 ,mem_device_option 
71fa c1008000 rtneq dvc_op_hci 
71fb 204071e7 call ui_ipc_get_lock 
71fc 62280b00 storer rega ,4 ,mem_ipc_rega_temp 
71fd da2046b4 arg mem_ipc_fifo_c512bt ,rega 
71fe 204078bd call fifo_in 
71ff 6a280b00 fetchr rega ,4 ,mem_ipc_rega_temp 
7200 202071eb branch ui_ipc_put_lock 

ui_ipc_clean_all_fifo:
7201 4770403c bpatchx patch3c_0 ,mem_patch3c 
7202 58000000 setarg 0 
7203 67ea46b4 store util_fifo_len ,mem_ipc_fifo_c512bt 
7204 67ea46af store util_fifo_len ,mem_ipc_fifo_bt2c51 
7205 20600000 rtn 

check_51cmd:
7206 4770c03c bpatchx patch3c_1 ,mem_patch3c 
7207 6fe24284 fetch 1 ,mem_hci_cmd 
7208 247a0000 nrtn blank 
7209 da2046b4 arg mem_ipc_fifo_c512bt ,rega 
720a 204078d5 call fifo_is_empty 
720b 207a0000 rtn blank 
720c 700aff00 jam ipc_continue_process ,mem_ipc_skip_continue_proc 
720d 20407211 call check_51cmd_once 
720e 6fe20aff fetch 1 ,mem_ipc_skip_continue_proc 
720f 203a7206 branch check_51cmd ,blank 
7210 20600000 rtn 

check_51cmd_once:
7211 4771403c bpatchx patch3c_2 ,mem_patch3c 
7212 204071e7 call ui_ipc_get_lock 
7213 da2046b4 arg mem_ipc_fifo_c512bt ,rega 
7214 204078c9 call fifo_out 
7215 1fe20400 copy pdata ,temp 
7216 204071eb call ui_ipc_put_lock 
7217 18427e00 copy temp ,pdata 
7218 207a0000 rtn blank 
7219 c0094dd2 beq bt_cmd_le_update_conn ,le_send_update_paramter 
721a c010cdca beq bt_cmd_mtu_exchange ,le_send_update_att_mtu 
721b c016dfe3 beq bt_cmd_load_flash_params ,load_le_ltk 
721c c000f255 beq bt_cmd_start_discovery ,check_51cmd_start_discovery 
721d c001725a beq bt_cmd_stop_discovery ,check_51cmd_stop_discovery 
721e c001f25f beq bt_cmd_reconnect ,check_51cmd_reconnect 
721f c004f264 beq bt_cmd_sniff_test ,check_51cmd_sniff_test 
7220 c005f267 beq bt_cmd_start_inquiry ,check_51cmd_inq 
7221 c0067268 beq bt_cmd_stop_inquiry ,check_51cmd_stop_inq 
7222 c006f269 beq bt_cmd_start_adv ,check_51cmd_adv 
7223 c007726c beq bt_cmd_stop_adv ,check_51cmd_stop_adv 
7224 c007f26e beq bt_cmd_start_direct_adv ,check_51cmd_direct_adv 
7225 c0087271 beq bt_cmd_stop_direct_adv ,check_51cmd_stop_direct_adv 
7226 c00bf274 beq bt_cmd_le_start_scan ,check_51cmd_start_scan 
7227 c00c7276 beq bt_cmd_le_stop_scan ,check_51cmd_stop_scan 
7228 c00cf27a beq bt_cmd_enter_hibernate ,check_51cmd_hibernate 
7229 c00df279 beq bt_cmd_le_smp_security_request ,check_51cmd_le_smp_sec_req 
722a c00f7284 beq bt_cmd_bb_reconn_cancel ,check_51cmd_bb_reconn_cancel 
722b 67e20b08 store 1 ,mem_fifo_temp 
722c 6fe2007c fetch 1 ,mem_lmo_opcode2 
722d 203a7231 branch check_51cmd_once_continue ,blank 
722e 20405b1e call lmo_fifo_process 
722f 6fe2007c fetch 1 ,mem_lmo_opcode2 
7230 243a724a nbranch check_51cmd_restore ,blank 

check_51cmd_once_continue:
7231 4771c03c bpatchx patch3c_3 ,mem_patch3c 
7232 6fe20b08 fetch 1 ,mem_fifo_temp 
7233 c584f245 bmark0 mark_context ,check_51cmd_check_idle 
7234 c01243de beq bt_cmd_rmv_esco_req ,cmd_disconn_esco 
7235 c011c3d6 beq bt_cmd_est_esco_req ,cmd_setup_esco 
7236 c01343de beq bt_cmd_rmv_sco_req ,cmd_disconn_sco 
7237 c012c3da beq bt_cmd_est_sco_req ,cmd_setup_sco 
7238 c002c3bc beq bt_cmd_enter_sniff ,cmd_in_sniff 
7239 c00343d4 beq bt_cmd_exit_sniff ,cmd_exit_sniff 
723a c0057265 beq bt_cmd_set_pin_code ,check_51cmd_pincode 
723b c0027261 beq bt_cmd_disconnect ,check_51cmd_disconnect 
723c c008f273 beq bt_cmd_le_disconnect ,check_51cmd_le_disconnect 
723d c00ef24c beq bt_cmd_role_switch ,check_51cmd_role_switch 
723e c00ff909 beq bt_cmd_store_reconn_info_le ,nv_store_le_reconn_info 
723f c010790d beq bt_cmd_store_reconn_info_bt ,nv_store_bd_reconn_info 
7240 c0117242 beq bt_cmd_dhkey_not_accept ,check_51_cmd_dhkey_not_accept 
7241 20600000 rtn 

check_51_cmd_dhkey_not_accept:
7242 20405b51 call tid_set_reply 
7243 70007d41 jam lmp_dhkey_check ,mem_lmi_opcode2 
7244 20205758 branch parse_lmp_dhkey_check_reject 

check_51cmd_check_idle:
7245 67e20b08 store 1 ,mem_fifo_temp 
7246 20403280 call context_check_idle 
7247 2022f24a branch check_51cmd_restore ,zero 
7248 2040328b call context_search_plap 
7249 24628000 nrtn zero 

check_51cmd_restore:
724a 700aff01 jam ipc_skip_continue_process ,mem_ipc_skip_continue_proc 
724b 202071f8 branch ui_ipc_send_cmd 

check_51cmd_role_switch:
724c 70007c34 jam lmp_slot_offset ,mem_lmo_opcode2 
724d 79200003 set1 mark_switch_initiated ,mark 
724e 24748000 nrtn master 
724f 7045a200 jam switch_flag_init ,mem_switch_flag 
7250 70007c13 jam lmp_switch_req ,mem_lmo_opcode2 
7251 6fe20138 fetch 1 ,mem_connection_options 
7252 793ffe02 set0 connection_switch ,pdata 
7253 67e20138 store 1 ,mem_connection_options 
7254 20600000 rtn 

check_51cmd_start_discovery:
7255 6fe446c1 fetch 2 ,mem_ui_state_map 
7256 79207e06 set1 ui_state_bt_discovery 
7257 67e446c1 store 2 ,mem_ui_state_map 
7258 70413303 jam 3 ,mem_scan_mode 
7259 20600000 rtn 

check_51cmd_stop_discovery:
725a 70413300 jam 0 ,mem_scan_mode 
725b 6fe446c1 fetch 2 ,mem_ui_state_map 
725c 793ffe06 set0 ui_state_bt_discovery 
725d 67e446c1 store 2 ,mem_ui_state_map 
725e 20600000 rtn 

check_51cmd_reconnect:
725f 70428405 jam hci_cmd_create_conn ,mem_hci_cmd 
7260 20600000 rtn 

check_51cmd_disconnect:
7261 70007c07 jam lmp_detach ,mem_lmo_opcode2 
7262 70052e13 jam other_end_terminated ,mem_disconn_reason_send 
7263 20600000 rtn 

check_51cmd_sniff_test:
7264 20600000 rtn 

check_51cmd_pincode:
7265 70053802 jam pincode_state_pincode_ready ,mem_pincode_state 
7266 20204382 branch cmd_pair 

check_51cmd_inq:
7267 20600000 rtn 

check_51cmd_stop_inq:
7268 20600000 rtn 

check_51cmd_adv:
7269 7043b101 jam on ,mem_le_adv_enable 
726a 7044ee00 jam adv_ind ,mem_le_adv_type 
726b 20600000 rtn 

check_51cmd_stop_adv:
726c 7043b100 jam off ,mem_le_adv_enable 
726d 20600000 rtn 

check_51cmd_direct_adv:
726e 7043b101 jam on ,mem_le_adv_enable 
726f 7044ee01 jam adv_direct_ind ,mem_le_adv_type 
7270 20600000 rtn 

check_51cmd_stop_direct_adv:
7271 7043b100 jam off ,mem_le_adv_enable 
7272 20600000 rtn 

check_51cmd_le_disconnect:
7273 20205147 branch le_send_terminate_remote_user_ended_conn 

check_51cmd_start_scan:
7274 7043ab01 jam on ,mem_le_scan_enable 
7275 20600000 rtn 

check_51cmd_stop_scan:
7276 7043ab00 jam off ,mem_le_scan_enable 
7277 70428400 jam 0 ,mem_hci_cmd 
7278 20600000 rtn 

check_51cmd_le_smp_sec_req:
7279 20205301 branch le_send_smp_security_request 

check_51cmd_hibernate:
727a 4772403c bpatchx patch3c_4 ,mem_patch3c 
727b 6fe442bb fetch 2 ,mem_cb_before_hibernate 
727c 20407897 call callback_func 
727d 6fe246ca fetch 1 ,mem_ui_button_gpio 
727e c07ff281 beq ui_button_gpio_disable ,check_51cmd_hibernate_btn_disabled 
727f 1fe20400 copy pdata ,temp 
7280 20405e84 call gpio_config_input 

check_51cmd_hibernate_btn_disabled:
7281 204071a6 call ui_led_off 
7282 20407201 call ui_ipc_clean_all_fifo 
7283 20203bb6 branch lpm_hibernate 

check_51cmd_bb_reconn_cancel:
7284 18000e04 force page_length_timer ,queue 
7285 202077a5 branch timer_stop 

ui_check_paring_button:
7286 6fe246c1 fetch 1 ,mem_ui_state_map 
7287 c4060000 rtnbit0 ui_state_btn_down 
7288 c4038000 rtnbit0 ui_state_bt_reconnect 
7289 20207284 branch check_51cmd_bb_reconn_cancel 

ui_load_audio_from_flash:
728a 6fe40260 fetch 2 ,mem_audio_offset 
728b 243a7293 nbranch ui_load_audio_continue ,blank 

ui_load_audio_start:
728c 62260b4d storer rega ,3 ,mem_flash_address 
728d 5800025e setarg mem_audio_size 
728e 67e40b50 store 2 ,mem_flash_data_address 
728f 58000002 setarg 2 
7290 67e40b52 store 2 ,mem_flash_trans_length 
7291 20405f01 call qspi_nmode 
7292 20405f25 call qspi_read 

ui_load_audio_continue:
7293 6fe4025e fetch 2 ,mem_audio_size 
7294 68440260 fetcht 2 ,mem_audio_offset 
7295 98467e00 isub temp ,pdata 
7296 d8402000 arg audio_pcm_max_block ,temp 
7297 204078db call not_greater_than 
7298 1fe22400 copy pdata ,regb 
7299 68448100 fetcht 2 ,core_dac_saddr 
729a 98460400 isub temp ,temp 
729b 6fe48102 fetch 2 ,core_dac_len 
729c 1fe0fe01 increase 1 ,pdata 
729d 98467e00 isub temp ,pdata 
729e 1a420400 copy regb ,temp 
729f 204078db call not_greater_than 
72a0 207a0000 rtn blank 
72a1 67e40b52 store 2 ,mem_flash_trans_length 
72a2 67e40b50 store 2 ,mem_flash_data_address 
72a3 1a20a202 increase 2 ,rega 
72a4 6fe40260 fetch 2 ,mem_audio_offset 
72a5 9a20fe00 iadd rega ,pdata 
72a6 67e60b4d store 3 ,mem_flash_address 
72a7 20405efd call qspi_mmode 
72a8 20405f05 call mqspi_read 
72a9 6fe40b52 fetch 2 ,mem_flash_trans_length 
72aa 1fe22400 copy pdata ,regb 
72ab 68440260 fetcht 2 ,mem_audio_offset 
72ac 98408400 iadd temp ,temp 
72ad 60440260 storet 2 ,mem_audio_offset 
72ae 6fe40260 fetch 2 ,mem_audio_offset 
72af 6844025e fetcht 2 ,mem_audio_size 
72b0 98467c00 isub temp ,null 
72b1 24628000 nrtn zero 
72b2 6fe4025e fetch 2 ,mem_audio_size 
72b3 d8400000 arg 0 ,temp 
72b4 6048025e storet 4 ,mem_audio_size 
72b5 20600000 rtn 

upper_init_reconnect:
72b6 4772c03c bpatchx patch3c_5 ,mem_patch3c 
72b7 204072d8 call upper_clear_upper_sm 
72b8 6fe246c3 fetch 1 ,mem_ui_profile_supported 
72b9 2feffe00 isolate1 support_hid ,pdata 
72ba 2040f2ce call upper_init_reconnect_hid ,true 
72bb 6fe246c3 fetch 1 ,mem_ui_profile_supported 
72bc 2feffe03 isolate1 support_hf_hs ,pdata 
72bd 2040f2d1 call upper_init_reconnect_hf ,true 
72be 20600000 rtn 

upper_reset_sm:
72bf 4773403c bpatchx patch3c_6 ,mem_patch3c 
72c0 7046e300 jam 0 ,mem_uppersm_disl2capch_index 
72c1 7046dc00 jam 0 ,mem_major_uppersm 
72c2 7046dd00 jam 0 ,mem_sub_uppersm 
72c3 da2046de arg mem_uppersm_list ,rega 
72c4 202078c9 branch fifo_out 

upper_int_reconnect_audio:
72c5 7046dc02 jam up_major_sm_connect_server ,mem_major_uppersm 
72c6 700b0804 jam up_recnnect_audio ,mem_fifo_temp 
72c7 7046dd01 jam up_sub_sm_creat_avdtp_sig ,mem_sub_uppersm 
72c8 202072d4 branch upper_init_reconnect_single 

upper_disconnect_all_l2cap:
72c9 6fe246dc fetch 1 ,mem_major_uppersm 
72ca c1800000 rtnne 0 
72cb 7046dd01 jam up_sub_disc_rfc_send_server_disc ,mem_sub_uppersm 
72cc 7046dc03 jam up_major_sm_disconnect_server ,mem_major_uppersm 
72cd 202072d8 branch upper_clear_upper_sm 

upper_init_reconnect_hid:
72ce 7046dc02 jam up_major_sm_connect_server ,mem_major_uppersm 
72cf 700b0801 jam up_recnnect_hid ,mem_fifo_temp 
72d0 202072d4 branch upper_init_reconnect_single 

upper_init_reconnect_hf:
72d1 7046dc01 jam up_major_sm_ask_sevrver ,mem_major_uppersm 
72d2 7046dd01 jam up_sub_sm_creat_sdp ,mem_sub_uppersm 
72d3 700b0802 jam up_recnnect_hf ,mem_fifo_temp 

upper_init_reconnect_single:
72d4 da2046de arg mem_uppersm_list ,rega 
72d5 202078bd branch fifo_in 

upper_get_first_upper_sm:
72d6 6fe246e2 fetch 1 ,mem_uppersm_list + 4 
72d7 20600000 rtn 

upper_clear_upper_sm:
72d8 4773c03c bpatchx patch3c_7 ,mem_patch3c 
72d9 58000000 setarg 0 
72da 67ea46de store 5 ,mem_uppersm_list 
72db 67e246e3 store 1 ,mem_uppersm_disl2capch_index 
72dc 20600000 rtn 

upper_sm_single_step:
72dd 4774403d bpatchx patch3d_0 ,mem_patch3d 
72de 6fe20535 fetch 1 ,mem_lmp_conn_state 
72df c4010000 rtnbit0 received_setup_complete 
72e0 c4018000 rtnbit0 sent_setup_complete 
72e1 6fe246dc fetch 1 ,mem_major_uppersm 
72e2 207a0000 rtn blank 
72e3 c000f2e7 beq up_major_sm_ask_sevrver ,upper_major_sm_ask_sever_process 
72e4 c001732e beq up_major_sm_connect_server ,upper_major_sm_connect_sever_process 
72e5 c001f383 beq up_major_sm_disconnect_server ,upper_major_sm_disconnect_server_process 
72e6 20203b25 branch assert 

upper_major_sm_ask_sever_process:
72e7 4774c03d bpatchx patch3d_1 ,mem_patch3d 
72e8 6fe246dd fetch 1 ,mem_sub_uppersm 
72e9 c000f2f4 beq up_sub_sm_creat_sdp ,upper_sub_sm_create_sdp 
72ea c00172f9 beq up_sub_sm_creat_sdp_wait ,upper_sub_sm_create_sdp_wait 
72eb c001f2ff beq up_sub_sm_config_sdp ,upper_sub_sm_config_sdp 
72ec c0027301 beq up_sub_sm_config_sdp_wait ,upper_sub_sm_config_sdp_wait 
72ed c002f308 beq up_sub_sm_search_service ,upper_sub_sm_search_service 
72ee c0037311 beq up_sub_sm_search_service_wait ,upper_sub_sm_search_service_wait 
72ef c003f319 beq up_sub_sm_search_attrib ,upper_sub_sm_search_attrib 
72f0 c004731d beq up_sub_sm_search_attrib_wait ,upper_sub_sm_search_wait 
72f1 c004f323 beq up_sub_sm_disconnect_sdp ,upper_sub_sm_sdp_disconenct 
72f2 c0057326 beq up_sub_sm_disconenct_sdp_wait ,upper_sub_sm_sdp_disconenct_wait 
72f3 20600000 rtn 

upper_sub_sm_create_sdp:
72f4 7046dd02 jam up_sub_sm_creat_sdp_wait ,mem_sub_uppersm 
72f5 db000001 arg psm_sdp ,regd 
72f6 20404ac7 call l2cap_send_server_conn 
72f7 626445f5 storer regc ,2 ,mem_sdp_l2capch_ptr 
72f8 20600000 rtn 

upper_sub_sm_create_sdp_wait:
72f9 6a6445f5 fetchr regc ,2 ,mem_sdp_l2capch_ptr 
72fa 1a60a601 add regc ,offset_lc_state ,regc 
72fb efe20013 ifetch 1 ,regc 
72fc c4008000 rtnbit0 l2cap_channel_state_conn_res 
72fd 7046dd03 jam up_sub_sm_config_sdp ,mem_sub_uppersm 
72fe 20600000 rtn 

upper_sub_sm_config_sdp:
72ff 7046dd04 jam up_sub_sm_config_sdp_wait ,mem_sub_uppersm 
7300 20600000 rtn 

upper_sub_sm_config_sdp_wait:
7301 6a6445f5 fetchr regc ,2 ,mem_sdp_l2capch_ptr 
7302 1a60a601 add regc ,offset_lc_state ,regc 
7303 efe20013 ifetch 1 ,regc 
7304 c4028000 rtnbit0 l2cap_channel_state_rcv_cfg_res 
7305 c4020000 rtnbit0 l2cap_channel_state_rcv_cfg_req 
7306 7046dd05 jam up_sub_sm_search_service ,mem_sub_uppersm 
7307 20600000 rtn 

upper_sub_sm_search_service:
7308 7046dd06 jam up_sub_sm_search_service_wait ,mem_sub_uppersm 
7309 204072d6 call upper_get_first_upper_sm 
730a c001730c beq up_recnnect_hf ,upper_major_sm_search_service_audio_gateway 
730b 20203b25 branch assert 

upper_major_sm_search_service_audio_gateway:
730c da20000d arg 13 ,rega 
730d 58001f11 setarg sdp_uuid_hs_audio_gateway 
730e 67e405c0 store 2 ,mem_search_uuid 
730f 6b0445f5 fetchr regd ,2 ,mem_sdp_l2capch_ptr 
7310 202065b5 branch sdp_send_search_req 

upper_sub_sm_search_service_wait:
7311 6a6445f5 fetchr regc ,2 ,mem_sdp_l2capch_ptr 
7312 1a60a601 add regc ,offset_lc_state ,regc 
7313 efe20013 ifetch 1 ,regc 
7314 c4030000 rtnbit0 l2cap_channel_state_recv_search_res 
7315 6fe80595 fetch 4 ,mem_sdp_record_handle 
7316 203a4231 branch app_bt_disconnect ,blank 
7317 7046dd07 jam up_sub_sm_search_attrib ,mem_sub_uppersm 
7318 20600000 rtn 

upper_sub_sm_search_attrib:
7319 7046dd08 jam up_sub_sm_search_attrib_wait ,mem_sub_uppersm 
731a da200013 arg 19 ,rega 
731b 6b0445f5 fetchr regd ,2 ,mem_sdp_l2capch_ptr 
731c 202065c9 branch sdp_send_attribute_req 

upper_sub_sm_search_wait:
731d 6a6445f5 fetchr regc ,2 ,mem_sdp_l2capch_ptr 
731e 1a60a601 add regc ,offset_lc_state ,regc 
731f efe20013 ifetch 1 ,regc 
7320 c4038000 rtnbit0 l2cap_channel_state_recv_attrib_res 
7321 7046dd09 jam up_sub_sm_disconnect_sdp ,mem_sub_uppersm 
7322 20600000 rtn 

upper_sub_sm_sdp_disconenct:
7323 7046dd0a jam up_sub_sm_disconenct_sdp_wait ,mem_sub_uppersm 
7324 6b0445f5 fetchr regd ,2 ,mem_sdp_l2capch_ptr 
7325 20204adf branch l2cap_send_server_disconnct 

upper_sub_sm_sdp_disconenct_wait:
7326 6a6445f5 fetchr regc ,2 ,mem_sdp_l2capch_ptr 
7327 1a60a601 add regc ,offset_lc_state ,regc 
7328 efe20013 ifetch 1 ,regc 
7329 58000000 setarg 0 
732a 67e445f5 store 2 ,mem_sdp_l2capch_ptr 
732b 7046dc02 jam up_major_sm_connect_server ,mem_major_uppersm 
732c 7046dd01 jam up_sub_sm_creat_rfcomm ,mem_sub_uppersm 
732d 20600000 rtn 

upper_major_sm_connect_sever_process:
732e 4775403d bpatchx patch3d_2 ,mem_patch3d 
732f 204072d6 call upper_get_first_upper_sm 
7330 c0017334 beq up_recnnect_hf ,upper_major_connect_hf 
7331 c000f3b0 beq up_recnnect_hid ,upper_major_connect_hid 
7332 c00273e2 beq up_recnnect_audio ,upper_major_connect_audio 
7333 20203b25 branch assert 

upper_major_connect_hf:
7334 4775c03d bpatchx patch3d_3 ,mem_patch3d 
7335 6fe246dd fetch 1 ,mem_sub_uppersm 
7336 c000f343 beq up_sub_sm_creat_rfcomm ,upper_sub_connect_rfcomm 
7337 c0017348 beq up_sub_sm_creat_rfcomm_wait ,upper_sub_connect_rfcomm_wait 
7338 c001f34e beq up_sub_sm_config_rfcomm ,upper_sub_config_rfcomm 
7339 c0027350 beq up_sub_sm_config_rfcomm_wait ,upper_sub_config_rfcomm_wait 
733a c002f357 beq up_sub_sm_rfcomm_signal_sabm ,upper_sub_rfcomm_singnal_connect 
733b c003735e beq up_sub_sm_rfcomm_signal_sabm_wait ,upper_sub_rfcomm_singnal_connect_wait 
733c c003f363 beq up_sub_sm_rfcomm_signal_cmd_pn ,upper_sub_rfcomm_signal_cmd_pn 
733d c004736a beq up_sub_sm_rfcomm_signal_cmd_pn_wait ,upper_sub_rfcomm_signal_cmd_pn_wait 
733e c004f36e beq up_sub_sm_rfcomm_server_sabm ,upper_sub_connect_rfcomm_server 
733f c005737a beq up_sub_sm_rfcomm_server_sabm_wait ,upper_sub_connect_rfcomm_server_wait 
7340 c005f37e beq up_sub_sm_rfcomm_sever_cmd_ms ,upper_sub_connect_server_cmd_ms 
7341 c0067380 beq up_sub_sm_rfcomm_sever_cmd_ms_wait ,upper_sub_connect_server_cmd_ms_wait 
7342 20203b25 branch assert 

upper_sub_connect_rfcomm:
7343 7046dd02 jam up_sub_sm_creat_rfcomm_wait ,mem_sub_uppersm 
7344 db000003 arg psm_rfcomm ,regd 
7345 20404ac7 call l2cap_send_server_conn 
7346 626445b7 storer regc ,2 ,mem_rfc_l2capch_ptr 
7347 20600000 rtn 

upper_sub_connect_rfcomm_wait:
7348 6a6445b7 fetchr regc ,2 ,mem_rfc_l2capch_ptr 
7349 1a60a601 add regc ,offset_lc_state ,regc 
734a efe20013 ifetch 1 ,regc 
734b c4008000 rtnbit0 l2cap_channel_state_conn_res 
734c 7046dd03 jam up_sub_sm_config_rfcomm ,mem_sub_uppersm 
734d 20600000 rtn 

upper_sub_config_rfcomm:
734e 7046dd04 jam up_sub_sm_config_rfcomm_wait ,mem_sub_uppersm 
734f 20600000 rtn 

upper_sub_config_rfcomm_wait:
7350 6a6445b7 fetchr regc ,2 ,mem_rfc_l2capch_ptr 
7351 1a60a601 add regc ,offset_lc_state ,regc 
7352 efe20013 ifetch 1 ,regc 
7353 c4028000 rtnbit0 l2cap_channel_state_rcv_cfg_res 
7354 c4020000 rtnbit0 l2cap_channel_state_rcv_cfg_req 
7355 7046dd05 jam up_sub_sm_rfcomm_signal_sabm ,mem_sub_uppersm 
7356 20600000 rtn 

upper_sub_rfcomm_singnal_connect:
7357 6b0445b7 fetchr regd ,2 ,mem_rfc_l2capch_ptr 
7358 2040614c call rfc_send_signal_sabm 
7359 7046dd06 jam up_sub_sm_rfcomm_signal_sabm_wait ,mem_sub_uppersm 
735a 6fe445b9 fetch 2 ,mem_rfc_server_state 
735b 79207e08 set1 rfc_signal_sabm ,pdata 
735c 67e445b9 store 2 ,mem_rfc_server_state 
735d 20600000 rtn 

upper_sub_rfcomm_singnal_connect_wait:
735e 6fe445b9 fetch 2 ,mem_rfc_server_state 
735f c4048000 rtnbit0 rfc_signal_ua 
7360 c4040000 rtnbit0 rfc_signal_sabm 
7361 7046dd07 jam up_sub_sm_rfcomm_signal_cmd_pn ,mem_sub_uppersm 
7362 20600000 rtn 

upper_sub_rfcomm_signal_cmd_pn:
7363 6b0445b7 fetchr regd ,2 ,mem_rfc_l2capch_ptr 
7364 20406130 call rfc_send_signal_cmd_pn 
7365 6fe445b9 fetch 2 ,mem_rfc_server_state 
7366 79207e00 set1 rfc_signal_pn_cmd ,pdata 
7367 67e445b9 store 2 ,mem_rfc_server_state 
7368 7046dd08 jam up_sub_sm_rfcomm_signal_cmd_pn_wait ,mem_sub_uppersm 
7369 20600000 rtn 

upper_sub_rfcomm_signal_cmd_pn_wait:
736a 6fe445b9 fetch 2 ,mem_rfc_server_state 
736b c4008000 rtnbit0 rfc_signal_pn_res 
736c 7046dd09 jam up_sub_sm_rfcomm_server_sabm ,mem_sub_uppersm 
736d 20600000 rtn 

upper_sub_connect_rfcomm_server:
736e 6b0445b7 fetchr regd ,2 ,mem_rfc_l2capch_ptr 
736f 20406151 call rfc_send_server_sabm 
7370 6fe445b9 fetch 2 ,mem_rfc_server_state 
7371 79207e02 set1 rfc_server_sabm 
7372 67e445b9 store 2 ,mem_rfc_server_state 
7373 7046dd0a jam up_sub_sm_rfcomm_server_sabm_wait ,mem_sub_uppersm 
7374 6fe245b6 fetch 1 ,mem_profile_channel 
7375 1fe9fe00 lshift3 pdata ,pdata 
7376 1fe1fe03 or_into 3 ,pdata 
7377 d84045ae arg mem_hiufcs_spp ,temp 
7378 6044056b storet 2 ,mem_contw_temp 
7379 2020619c branch rfcomm_save_fcs_uih 

upper_sub_connect_rfcomm_server_wait:
737a 6fe445b9 fetch 2 ,mem_rfc_server_state 
737b c4018000 rtnbit0 rfc_server_ua 
737c 7046dd0b jam up_sub_sm_rfcomm_sever_cmd_ms ,mem_sub_uppersm 
737d 20600000 rtn 

upper_sub_connect_server_cmd_ms:
737e 7046dd0c jam up_sub_sm_rfcomm_sever_cmd_ms_wait ,mem_sub_uppersm 
737f 20600000 rtn 

upper_sub_connect_server_cmd_ms_wait:
7380 6fe445b9 fetch 2 ,mem_rfc_server_state 
7381 c1ff8000 rtnne rfcomm_channel_setup_complete 
7382 202072bf branch upper_reset_sm 

upper_major_sm_disconnect_server_process:
7383 6fe246dd fetch 1 ,mem_sub_uppersm 
7384 c000f388 beq up_sub_disc_rfc_send_server_disc ,upper_sub_sm_hf_send_sever_disc 
7385 c0017390 beq up_sub_disc_rfc_send_server_disc_wait ,upper_sub_sm_hf_wait_ua 
7386 c001f394 beq up_sub_disc_rfc_send_signal_disc ,upper_sub_sm_hf_send_signal_disc 
7387 20207398 branch upper_sub_sm_disconnect_l2cap 

upper_sub_sm_hf_send_sever_disc:
7388 6fe445b7 fetch 2 ,mem_rfc_l2capch_ptr 
7389 1fe23000 copy pdata ,regd 
738a 203a7396 branch upper_sub_sm_start_disc_l2cap ,blank 
738b 6fe445b9 fetch 2 ,mem_rfc_server_state 
738c c0fff394 bne rfcomm_channel_setup_complete ,upper_sub_sm_hf_send_signal_disc 
738d 20406161 call rfc_send_server_disc 
738e 7046dd02 jam up_sub_disc_rfc_send_server_disc_wait ,mem_sub_uppersm 
738f 20600000 rtn 

upper_sub_sm_hf_wait_ua:
7390 6fe445b9 fetch 2 ,mem_rfc_server_state 
7391 c1800000 rtnne 0 
7392 7046dd03 jam up_sub_disc_rfc_send_signal_disc ,mem_sub_uppersm 
7393 20600000 rtn 

upper_sub_sm_hf_send_signal_disc:
7394 6b0445b7 fetchr regd ,2 ,mem_rfc_l2capch_ptr 
7395 20406169 call rfc_send_signal_disc 

upper_sub_sm_start_disc_l2cap:
7396 7046dd04 jam up_sub_sm_disc_l2capch ,mem_sub_uppersm 
7397 20600000 rtn 

upper_sub_sm_disconnect_l2cap:
7398 4776403d bpatchx patch3d_4 ,mem_patch3d 
7399 6fe246e3 fetch 1 ,mem_uppersm_disl2capch_index 
739a c00473ae beq l2cap_channel_count ,upper_major_sm_disconnect_server_complete 
739b 1fe23000 copy pdata ,regd 
739c 1b0fb006 mul32 regd ,l2cap_channel_size ,regd 
739d 58004364 setarg mem_l2cap_ch_info 
739e 9b00b000 iadd regd ,regd 
739f 1b008c01 add regd ,offset_lc_state ,contr 
73a0 efe20006 ifetch 1 ,contr 
73a1 1fe17e03 and pdata ,0x3 ,pdata 
73a2 c081f3a9 bne 3 ,upper_major_sm_disconnect_server_next 
73a3 6fe246dd fetch 1 ,mem_sub_uppersm 
73a4 c002f3a7 beq up_sub_sm_disc_l2capch_wait ,upper_major_sm_disconnect_server_process_wait 
73a5 7046dd05 jam up_sub_sm_disc_l2capch_wait ,mem_sub_uppersm 
73a6 20204adf branch l2cap_send_server_disconnct 

upper_major_sm_disconnect_server_process_wait:
73a7 efec0018 ifetch 6 ,regd 
73a8 247a0000 nrtn blank 

upper_major_sm_disconnect_server_next:
73a9 7046dd04 jam up_sub_sm_disc_l2capch ,mem_sub_uppersm 
73aa 6fe246e3 fetch 1 ,mem_uppersm_disl2capch_index 
73ab 1fe0fe01 increase 1 ,pdata 
73ac 67e246e3 store 1 ,mem_uppersm_disl2capch_index 
73ad 20600000 rtn 

upper_major_sm_disconnect_server_complete:
73ae 204072bf call upper_reset_sm 
73af 20204231 branch app_bt_disconnect 

upper_major_connect_hid:
73b0 4776c03d bpatchx patch3d_5 ,mem_patch3d 
73b1 6fe246dd fetch 1 ,mem_sub_uppersm 
73b2 c000f3bb beq up_sub_sm_creat_hid ,upper_sub_connect_hid 
73b3 c00173c0 beq up_sub_sm_creat_hid_wait ,upper_sub_connect_hid_wait 
73b4 c001f3c6 beq up_sub_sm_config_hid ,upper_sub_config_hid 
73b5 c00273c8 beq up_sub_sm_config_hid_wait ,upper_sub_config_hid_wait 
73b6 c002f3cf beq up_sub_sm_creat_hidint ,upper_sub_connect_hidint 
73b7 c00373d4 beq up_sub_sm_creat_hidint_wait ,upper_sub_connect_hidint_wait 
73b8 c003f3da beq up_sub_sm_config_hidint ,upper_sub_config_hidint 
73b9 c00473dc beq up_sub_sm_config_hidint_wait ,upper_sub_config_hidint_wait 
73ba 20203b25 branch assert 

upper_sub_connect_hid:
73bb 7046dd02 jam up_sub_sm_creat_hid_wait ,mem_sub_uppersm 
73bc db000011 arg psm_hid_control ,regd 
73bd 20404ac7 call l2cap_send_server_conn 
73be 626442f5 storer regc ,2 ,mem_hid_l2capch_ptr 
73bf 20600000 rtn 

upper_sub_connect_hid_wait:
73c0 6a6442f5 fetchr regc ,2 ,mem_hid_l2capch_ptr 
73c1 1a60a601 add regc ,offset_lc_state ,regc 
73c2 efe20013 ifetch 1 ,regc 
73c3 c4008000 rtnbit0 l2cap_channel_state_conn_res 
73c4 7046dd03 jam up_sub_sm_config_hid ,mem_sub_uppersm 
73c5 20600000 rtn 

upper_sub_config_hid:
73c6 7046dd04 jam up_sub_sm_config_hid_wait ,mem_sub_uppersm 
73c7 20600000 rtn 

upper_sub_config_hid_wait:
73c8 6a6442f5 fetchr regc ,2 ,mem_hid_l2capch_ptr 
73c9 1a60a601 add regc ,offset_lc_state ,regc 
73ca efe20013 ifetch 1 ,regc 
73cb c4028000 rtnbit0 l2cap_channel_state_rcv_cfg_res 
73cc c4020000 rtnbit0 l2cap_channel_state_rcv_cfg_req 
73cd 7046dd05 jam up_sub_sm_creat_hidint ,mem_sub_uppersm 
73ce 20600000 rtn 

upper_sub_connect_hidint:
73cf 7046dd06 jam up_sub_sm_creat_hidint_wait ,mem_sub_uppersm 
73d0 db000013 arg psm_hid_interrupt ,regd 
73d1 20404ac7 call l2cap_send_server_conn 
73d2 626442f7 storer regc ,2 ,mem_hidint_l2capch_ptr 
73d3 20600000 rtn 

upper_sub_connect_hidint_wait:
73d4 6a6442f7 fetchr regc ,2 ,mem_hidint_l2capch_ptr 
73d5 1a60a601 add regc ,offset_lc_state ,regc 
73d6 efe20013 ifetch 1 ,regc 
73d7 c4008000 rtnbit0 l2cap_channel_state_conn_res 
73d8 7046dd07 jam up_sub_sm_config_hidint ,mem_sub_uppersm 
73d9 20600000 rtn 

upper_sub_config_hidint:
73da 7046dd08 jam up_sub_sm_config_hidint_wait ,mem_sub_uppersm 
73db 20600000 rtn 

upper_sub_config_hidint_wait:
73dc 6a6442f7 fetchr regc ,2 ,mem_hidint_l2capch_ptr 
73dd 1a60a601 add regc ,offset_lc_state ,regc 
73de efe20013 ifetch 1 ,regc 
73df c4028000 rtnbit0 l2cap_channel_state_rcv_cfg_res 
73e0 c4020000 rtnbit0 l2cap_channel_state_rcv_cfg_req 
73e1 202072bf branch upper_reset_sm 

upper_major_connect_audio:
73e2 4777403d bpatchx patch3d_6 ,mem_patch3d 
73e3 6fe246dd fetch 1 ,mem_sub_uppersm 
73e4 c000f3f5 beq up_sub_sm_creat_avdtp_sig ,upper_sub_connect_avdtp_sig 
73e5 c00173fa beq up_sub_sm_creat_avdtp_sig_wait ,upper_sub_connect_avdtp_sig_wait 
73e6 c001f400 beq up_sub_sm_config_avdtp_sig ,upper_sub_config_avdtp_sig 
73e7 c0027402 beq up_sub_sm_config_avdtp_sig_wait ,upper_sub_config_avdtp_sig_wait 
73e8 c002f409 beq up_sub_sm_avdtp_discover ,upper_sub_avdtp_sig_discover 
73e9 c003740b beq up_sub_sm_avdtp_discover_wait ,upper_sub_avdtp_sig_discover_wait 
73ea c003f40f beq up_sub_sm_avdtp_getcap ,upper_sub_avdtp_sig_getcap 
73eb c00472bf beq up_sub_sm_avdtp_getcap_wait ,upper_reset_sm 
73ec c004f415 beq up_sub_sm_avdtp_setconf ,upper_sub_avdtp_sig_setconf 
73ed c0057417 beq up_sub_sm_avdtp_setconf_wait ,upper_sub_avdtp_sig_setconf_wait 
73ee c005f41b beq up_sub_sm_avdtp_open ,upper_sub_avdtp_sig_open 
73ef c006741d beq up_sub_sm_avdtp_open_wait ,upper_sub_avdtp_sig_open_wait 
73f0 c006f421 beq up_sub_sm_creat_avdtp_media ,upper_sub_connect_avdtp_media 
73f1 c0077426 beq up_sub_sm_creat_avdtp_media_wait ,upper_sub_connect_avdtp_media_wait 
73f2 c007f42c beq up_sub_sm_config_avdtp_media ,upper_sub_config_avdtp_media 
73f3 c008742e beq up_sub_sm_config_avdtp_media_wait ,upper_sub_config_avdtp_media_wait 
73f4 20203b25 branch assert 

upper_sub_connect_avdtp_sig:
73f5 7046dd02 jam up_sub_sm_creat_avdtp_sig_wait ,mem_sub_uppersm 
73f6 db000019 arg psm_avdtp ,regd 
73f7 20404ac7 call l2cap_send_server_conn 
73f8 62644292 storer regc ,2 ,mem_avdtpsignal_l2capch_ptr 
73f9 20600000 rtn 

upper_sub_connect_avdtp_sig_wait:
73fa 6a644292 fetchr regc ,2 ,mem_avdtpsignal_l2capch_ptr 
73fb 1a60a601 add regc ,offset_lc_state ,regc 
73fc efe20013 ifetch 1 ,regc 
73fd c4008000 rtnbit0 l2cap_channel_state_conn_res 
73fe 7046dd03 jam up_sub_sm_config_avdtp_sig ,mem_sub_uppersm 
73ff 20600000 rtn 

upper_sub_config_avdtp_sig:
7400 7046dd04 jam up_sub_sm_config_avdtp_sig_wait ,mem_sub_uppersm 
7401 20600000 rtn 

upper_sub_config_avdtp_sig_wait:
7402 6a644292 fetchr regc ,2 ,mem_avdtpsignal_l2capch_ptr 
7403 1a60a601 add regc ,offset_lc_state ,regc 
7404 efe20013 ifetch 1 ,regc 
7405 c4028000 rtnbit0 l2cap_channel_state_rcv_cfg_res 
7406 c4020000 rtnbit0 l2cap_channel_state_rcv_cfg_req 
7407 7046dd05 jam up_sub_sm_avdtp_discover ,mem_sub_uppersm 
7408 20600000 rtn 

upper_sub_avdtp_sig_discover:
7409 7046dd06 jam up_sub_sm_avdtp_discover_wait ,mem_sub_uppersm 
740a 20204117 branch adv_signal_send_discover 

upper_sub_avdtp_sig_discover_wait:
740b 6fe24298 fetch 1 ,mem_audio_src_endpoint 
740c 207a0000 rtn blank 
740d 7046dd07 jam up_sub_sm_avdtp_getcap ,mem_sub_uppersm 
740e 20600000 rtn 

upper_sub_avdtp_sig_getcap:
740f 7046dd08 jam up_sub_sm_avdtp_getcap_wait ,mem_sub_uppersm 
7410 2020411a branch avd_signal_send_getcap 

upper_sub_avdtp_sig_getcap_wait:
7411 6fe24299 fetch 1 ,mem_audio_src_endpoint_state 
7412 c4000000 rtnbit0 avd_src_endpoint_getcap 
7413 7046dd09 jam up_sub_sm_avdtp_setconf ,mem_sub_uppersm 
7414 20600000 rtn 

upper_sub_avdtp_sig_setconf:
7415 7046dd0a jam up_sub_sm_avdtp_setconf_wait ,mem_sub_uppersm 
7416 20204121 branch avd_signal_send_setconf 

upper_sub_avdtp_sig_setconf_wait:
7417 6fe24299 fetch 1 ,mem_audio_src_endpoint_state 
7418 c4008000 rtnbit0 avd_src_endpoint_setconf 
7419 7046dd0b jam up_sub_sm_avdtp_open ,mem_sub_uppersm 
741a 20600000 rtn 

upper_sub_avdtp_sig_open:
741b 7046dd0c jam up_sub_sm_avdtp_open_wait ,mem_sub_uppersm 
741c 20204131 branch avd_signal_send_open 

upper_sub_avdtp_sig_open_wait:
741d 6fe24299 fetch 1 ,mem_audio_src_endpoint_state 
741e c4010000 rtnbit0 avd_src_endpoint_open 
741f 7046dd0d jam up_sub_sm_creat_avdtp_media ,mem_sub_uppersm 
7420 20600000 rtn 

upper_sub_connect_avdtp_media:
7421 7046dd0e jam up_sub_sm_creat_avdtp_media_wait ,mem_sub_uppersm 
7422 db000019 arg psm_avdtp ,regd 
7423 20404ac7 call l2cap_send_server_conn 
7424 62644294 storer regc ,2 ,mem_avdtpmedia_l2capch_ptr 
7425 20600000 rtn 

upper_sub_connect_avdtp_media_wait:
7426 6a644294 fetchr regc ,2 ,mem_avdtpmedia_l2capch_ptr 
7427 1a60a601 add regc ,offset_lc_state ,regc 
7428 efe20013 ifetch 1 ,regc 
7429 c4008000 rtnbit0 l2cap_channel_state_conn_res 
742a 7046dd0f jam up_sub_sm_config_avdtp_media ,mem_sub_uppersm 
742b 20600000 rtn 

upper_sub_config_avdtp_media:
742c 7046dd10 jam up_sub_sm_config_avdtp_media_wait ,mem_sub_uppersm 
742d 20600000 rtn 

upper_sub_config_avdtp_media_wait:
742e 6a644292 fetchr regc ,2 ,mem_avdtpsignal_l2capch_ptr 
742f 1a60a601 add regc ,offset_lc_state ,regc 
7430 efe20013 ifetch 1 ,regc 
7431 c4028000 rtnbit0 l2cap_channel_state_rcv_cfg_res 
7432 c4020000 rtnbit0 l2cap_channel_state_rcv_cfg_req 
7433 202072bf branch upper_reset_sm 

usb_isr:
7434 4777c03d bpatchx patch3d_7 ,mem_patch3d 
7435 6fe28c26 fetch 1 ,core_usb_status 
7436 2feffe07 isolate1 7 ,pdata 
7437 2040f44a call usb_init ,true 
7438 20407477 call usb_nak_state_judge 
7439 6fe28c26 fetch 1 ,core_usb_status 
743a 67e24704 store 1 ,mem_usb_status 
743b 6fe28c27 fetch 1 ,core_usb_fifo_empty 
743c 67e24705 store 1 ,mem_usb_fifo_empty 
743d 67e28c27 store 1 ,core_usb_fifo_empty 
743e 1fe47e00 pinvert 
743f 68424a98 fetcht 1 ,mem_usb_tx_wait 
7440 98417e00 iand temp ,pdata 
7441 67e24a98 store 1 ,mem_usb_tx_wait 
7442 708c26e0 jam 0xe0 ,core_usb_status 
7443 6fe24705 fetch 1 ,mem_usb_fifo_empty 
7444 2fe00201 compare 0x1 ,pdata ,0x1 
7445 2040f48a call usb0_fifo_empty ,true 
7446 6fe24704 fetch 1 ,mem_usb_status 
7447 2fe00201 compare 0x1 ,pdata ,0x1 
7448 2040f493 call usb_status1 ,true 
7449 202076af branch usb_tx 

usb_init:
744a 4778403e bpatchx patch3e_0 ,mem_patch3e 
744b 708c0000 jam 0x00 ,core_usb_config 
744c 20002710 nop 10000 
744d 708c10c0 jam 0xc0 ,core_usb_trig 
744e 6fe48050 fetch 2 ,core_clkoff 
744f 793ffe0a set0 clock_off_usb ,pdata 
7450 67e48050 store 2 ,core_clkoff 
7451 708c003c jam 0x3c ,core_usb_config 
7452 708c26ff jam 0xff ,core_usb_status 
7453 708c27ff jam 0xff ,core_usb_fifo_empty 
7454 708c0400 jam 0 ,core_usb_addr 
7455 704a8b02 jam dev_default ,mem_usb0_state 
7456 58000000 setarg 0 
7457 67e24747 store 1 ,mem_usb_state 
7458 67e24a98 store 1 ,mem_usb_tx_wait 
7459 67e24a97 store 1 ,mem_usb_tx_enable 
745a 67e24a8c store 1 ,mem_usb_remote_wakeup 
745b 67e24a8e store 1 ,mem_usb_ep0_stall_status 
745c 67e24a8f store 1 ,mem_usb_ep1_stall_status 
745d 67e24a90 store 1 ,mem_usb_ep2_stall_status 
745e 67e24a91 store 1 ,mem_usb_ep3_stall_status 
745f 67e44a92 store 2 ,mem_dsc_info_data_pointer 
7460 67e24a94 store 1 ,mem_dsc_info_len 
7461 67e24a7d store 1 ,mem_usb0_data_ready_report 
7462 67e24a7e store 1 ,mem_usb_tx_win_enable 
7463 67e24a7f store 1 ,mem_usb_tx_mac_enable 
7464 67e24a8d store 1 ,mem_usb_clear_remote_wakeup 
7465 67e24a99 store 1 ,mem_usb_device_enumeration_endflag 
7466 67e24a9a store 1 ,mem_usb_wakestate_onetime_flag 
7467 67e24a9b store 1 ,mem_usb_mac_wakeup_trig 
7468 67e24a9c store 1 ,mem_usb_set_high_addr_flag 
7469 67e24a89 store 1 ,mem_usb_set_protocol_status 
746a 67e24a88 store 1 ,mem_usb_get_protocol_flag 
746b 67e24a86 store 1 ,mem_usb_idle_flag 
746c 67e24a9d store 1 ,mem_usb_clear_halt 
746d d8a049b2 arg mem_usb_setup ,contw 
746e df200009 arg 9 ,loopcnt 
746f 2040775e call memset0 
7470 d8a049fa arg mem_usb0_set_report_data ,contw 
7471 df200008 arg 8 ,loopcnt 
7472 2040775e call memset0 
7473 d8a04a3a arg mem_usb0_get_report_data ,contw 
7474 df200008 arg 8 ,loopcnt 
7475 2040775e call memset0 
7476 202076d5 branch usb_tx_fifo_release 

usb_nak_state_judge:
7477 6fe28c26 fetch 1 ,core_usb_status 
7478 c283747a bbit1 usb_status_nak ,usb_nak_state_timer_init 
7479 20600000 rtn 

usb_nak_state_timer_init:
747a 2040747f call usb0_attached_state_judge 
747b 204077ac call timer_reinit 
747c 58000280 setarg timer_nak_delay 
747d d8e00000 arg timer_nak ,queue 
747e 202077a6 branch timer_init 

usb0_attached_state_judge:
747f 6fe24747 fetch 1 ,mem_usb_state 
7480 c0817484 bne usb_connected ,usb_clear_halt_dispose 
7481 704a9a00 jam 0 ,mem_usb_wakestate_onetime_flag 
7482 704a9b00 jam 0 ,mem_usb_mac_wakeup_trig 
7483 20600000 rtn 

usb_clear_halt_dispose:
7484 6fe24a9d fetch 1 ,mem_usb_clear_halt 
7485 207a0000 rtn blank 
7486 704a9d00 jam 0 ,mem_usb_clear_halt 
7487 70474702 jam usb_connected ,mem_usb_state 
7488 704a9901 jam 1 ,mem_usb_device_enumeration_endflag 
7489 20600000 rtn 

usb0_fifo_empty:
748a 708c2701 jam 0x1 ,core_usb_fifo_empty 
748b 20207684 branch usb0_tx 

usb_rx_no_data:
748c 6fe24704 fetch 1 ,mem_usb_status 
748d c282749e bbit1 usb_status_setup ,usb_class_type 
748e 20600000 rtn 

usb_rx_read:
748f 6fe28c18 fetch 1 ,core_usb_ep 
7490 e7e20005 istore 1 ,contw 
7491 c200748f loop usb_rx_read 
7492 20600000 rtn 

usb_status1:
7493 4778c03e bpatchx patch3e_1 ,mem_patch3e 
7494 708c2611 jam 0x11 ,core_usb_status 
7495 6fe28c20 fetch 1 ,core_usb_ep_len 
7496 67e24706 store 1 ,mem_usb_read_len 
7497 1fe27200 copy pdata ,loopcnt 
7498 203a748c branch usb_rx_no_data ,blank 
7499 d8a049b2 arg mem_usb_setup ,contw 
749a 2040748f call usb_rx_read 
749b 6fe24706 fetch 1 ,mem_usb_read_len 
749c 1fe67c07 sub pdata ,7 ,null 
749d 20610000 rtn positive 

usb_class_type:
749e 6fe249b2 fetch 1 ,mem_usb_setup_bmrequesttype 
749f 1fe17e80 and_into 0x80 ,pdata 
74a0 c04074a3 beq in_device ,usb_in_device 
74a1 c00074ac beq out_device ,usb_out_device 
74a2 20203b25 branch assert 

usb_in_device:
74a3 4779403e bpatchx patch3e_2 ,mem_patch3e 
74a4 6fe249b2 fetch 1 ,mem_usb_setup_bmrequesttype 
74a5 1ff1fe00 rshift4 pdata ,pdata 
74a6 1fe37e00 rshift pdata ,pdata 
74a7 1fe17e03 and_into 0x03 ,pdata 
74a8 c00074b5 beq standard_req ,usb_in_standard_req 
74a9 c000f4bb beq class_req ,usb_in_class_req 
74aa c00174c0 beq manufacturer_req ,usb_in_manufacturer_req 
74ab 20203b25 branch assert 

usb_out_device:
74ac 4779c03e bpatchx patch3e_3 ,mem_patch3e 
74ad 6fe249b2 fetch 1 ,mem_usb_setup_bmrequesttype 
74ae 1ff1fe00 rshift4 pdata ,pdata 
74af 1fe37e00 rshift pdata ,pdata 
74b0 1fe17e03 and_into 0x03 ,pdata 
74b1 c00074c1 beq standard_req ,usb_out_standard_req 
74b2 c000f4c9 beq class_req ,usb_out_class_req 
74b3 c00174ce beq manufacturer_req ,usb_out_manufacturer_req 
74b4 20203b25 branch assert 

usb_in_standard_req:
74b5 6fe249b3 fetch 1 ,mem_usb_setup_brequest 
74b6 c00474d5 beq get_configuration ,usb0_request_get_configuration 
74b7 c00374eb beq get_descriptor ,usb0_request_get_descriptor 
74b8 c0057531 beq get_interface ,usb0_request_get_interface 
74b9 c0007543 beq get_status ,usb0_request_get_status 
74ba 202074cf branch usb0_force_stall 

usb_in_class_req:
74bb 6fe249b3 fetch 1 ,mem_usb_setup_brequest 
74bc c001757c beq get_idle ,usb_get_idle 
74bd c000f580 beq get_report ,usb_get_report 
74be c001f592 beq get_protocol ,usb_get_protocol_req 
74bf 202074cf branch usb0_force_stall 

usb_in_manufacturer_req:
74c0 202074cf branch usb0_force_stall 

usb_out_standard_req:
74c1 6fe249b3 fetch 1 ,mem_usb_setup_brequest 
74c2 c000f59c beq clear_feature ,usb0_request_clear_feature 
74c3 c001f5c8 beq set_feature ,usb0_request_set_feature 
74c4 c002f5f2 beq set_address ,usb0_request_set_address 
74c5 c004f60b beq set_configuration ,usb0_request_set_configuration 
74c6 c005f626 beq set_interface ,usb0_request_set_interface 
74c7 c003f4cf beq set_descriptor ,usb0_force_stall 
74c8 202074cf branch usb0_force_stall 

usb_out_class_req:
74c9 6fe249b3 fetch 1 ,mem_usb_setup_brequest 
74ca c0057637 beq set_idle ,usb_set_idle 
74cb c004f649 beq set_report ,usb_set_report 
74cc c005f661 beq set_protocol ,usb_set_protocol_req 
74cd 202074cf branch usb0_force_stall 

usb_out_manufacturer_req:
74ce 202074cf branch usb0_force_stall 

usb0_force_stall:
74cf 6fe28c11 fetch 1 ,core_usb_stall 
74d0 79207e00 set1 0 ,pdata 
74d1 67e28c11 store 1 ,core_usb_stall 
74d2 202074d3 branch usb0_reply_zerolen 

usb0_reply_zerolen:
74d3 708c1240 jam 0x40 ,core_usb_clear 
74d4 20600000 rtn 

usb0_request_get_configuration:
74d5 6fe249b2 fetch 1 ,mem_usb_setup_bmrequesttype 
74d6 c0c074cf bne in_device ,usb0_force_stall 
74d7 6fe249b6 fetch 1 ,mem_usb_setup_windex 
74d8 c08074cf bne 0 ,usb0_force_stall 
74d9 6fe249b7 fetch 1 ,mem_usb_setup_windex + 1 
74da c08074cf bne 0 ,usb0_force_stall 
74db 6fe249b8 fetch 1 ,mem_usb_setup_blength 
74dc c080f4cf bne 1 ,usb0_force_stall 
74dd 6fe249b9 fetch 1 ,mem_usb_setup_blengthh 
74de c08074cf bne 0 ,usb0_force_stall 
74df 6fe249b4 fetch 1 ,mem_usb_setup_bvalue 
74e0 c08074cf bne 0 ,usb0_force_stall 
74e1 6fe249b5 fetch 1 ,mem_usb_setup_bvalue + 1 
74e2 c08074cf bne 0 ,usb0_force_stall 
74e3 6fe24a8b fetch 1 ,mem_usb0_state 
74e4 c00274e7 beq dev_configured ,usb0_request_get_cfg_dev_cfg 
74e5 c001f4e9 beq dev_address ,usb0_request_get_cfg_dev_addr 
74e6 202074cf branch usb0_force_stall 

usb0_request_get_cfg_dev_cfg:
74e7 da400001 arg 1 ,regb 
74e8 2020755b branch usb_send_ones_packet 

usb0_request_get_cfg_dev_addr:
74e9 da400001 arg 1 ,regb 
74ea 20207559 branch usb_send_zero_packet 

usb0_request_get_descriptor:
74eb 477a403e bpatchx patch3e_4 ,mem_patch3e 
74ec 793f8023 set0 mark_isstr ,mark 
74ed 6fe249b5 fetch 1 ,mem_usb_setup_bvalueh 
74ee c000f4ff beq dsc_device ,dsc_device_info 
74ef c0017518 beq dsc_config ,dsc_config_info 
74f0 c001f51b beq dsc_string ,dsc_string_info 
74f1 c010f4f4 beq dsc_hid ,dsc_hid_info 
74f2 c0117529 beq dsc_hid_report ,dsc_hid_report_info 
74f3 202074cf branch usb0_force_stall 

dsc_hid_info:
74f4 704a8800 jam 0 ,mem_usb_get_protocol_flag 
74f5 6fe249b6 fetch 1 ,mem_usb_setup_windex 
74f6 c00074f9 beq 0 ,dsc_hid_info_interface0 
74f7 c000f4fc beq 1 ,dsc_hid_info_interface1 
74f8 202074cf branch usb0_force_stall 

dsc_hid_info_interface0:
74f9 da204902 arg mem_confdesc + 19 ,rega 
74fa 6a424902 fetchr regb ,1 ,mem_confdesc + 19 
74fb 20207670 branch usb0_respond 

dsc_hid_info_interface1:
74fc da20491b arg mem_confdesc + 44 ,rega 
74fd 6a42491b fetchr regb ,1 ,mem_confdesc + 44 
74fe 20207670 branch usb0_respond 

dsc_device_info:
74ff 6fe24a9c fetch 1 ,mem_usb_set_high_addr_flag 
7500 245a7510 ncall usb_set_high_addr ,blank 
7501 5800474b setarg mem_devicedesc 
7502 6842474b fetcht 1 ,mem_devicedesc 

dsc_info_set_data_len:
7503 67e44a92 store 2 ,mem_dsc_info_data_pointer 
7504 60424a94 storet 1 ,mem_dsc_info_len 
7505 6fe249b8 fetch 1 ,mem_usb_setup_blength 
7506 98467c00 isub temp ,null 
7507 2421750e nbranch dsc_info_set_current_data_len ,positive 

dsc_info_set_initial_data_len:
7508 6fe24a94 fetch 1 ,mem_dsc_info_len 

dsc_info_set_data_size_completed:
7509 98002400 iforce regb 
750a 6fe44a92 fetch 2 ,mem_dsc_info_data_pointer 
750b 1fe0fe01 add pdata ,1 ,pdata 
750c 98002200 iforce rega 
750d 20207670 branch usb0_respond 

dsc_info_set_current_data_len:
750e 6fe249b8 fetch 1 ,mem_usb_setup_blength 
750f 20207509 branch dsc_info_set_data_size_completed 

usb_set_high_addr:
7510 6fe28c04 fetch 1 ,core_usb_addr 
7511 245a7514 ncall usb0_set_addr ,blank 
7512 704a9c00 jam 0 ,mem_usb_set_high_addr_flag 
7513 20600000 rtn 

usb0_set_addr:
7514 6fe28c04 fetch 1 ,core_usb_addr 
7515 79207e07 set1 7 ,pdata 
7516 67e28c04 store 1 ,core_usb_addr 
7517 20600000 rtn 

dsc_config_info:
7518 580048ef setarg mem_confdesc 
7519 684248ef fetcht 1 ,mem_confdesc 
751a 20207503 branch dsc_info_set_data_len 

dsc_string_info:
751b 6fe249b4 fetch 1 ,mem_usb_setup_bvalue 
751c 1fe67c03 sub pdata ,3 ,null 
751d 242174cf nbranch usb0_force_stall ,positive 
751e 6fe249b4 fetch 1 ,mem_usb_setup_bvalue 
751f da204953 arg mem_string0 ,rega 
7520 c000766e beq 0 ,usb0_respond_length 
7521 79200023 set1 mark_isstr ,mark 
7522 da204958 arg mem_string1 ,rega 
7523 c000f66e beq 1 ,usb0_respond_length 
7524 da204976 arg mem_string2 ,rega 
7525 c001766e beq 2 ,usb0_respond_length 
7526 da204994 arg mem_string3 ,rega 
7527 c001f66e beq 3 ,usb0_respond_length 
7528 20600000 rtn 

dsc_hid_report_info:
7529 6fe449b6 fetch 2 ,mem_usb_setup_windex 
752a c000f52d beq 1 ,dsc_hid_report_info0 
752b da20475f arg mem_hidreportdesc_kb ,rega 
752c 2020766e branch usb0_respond_length 

dsc_hid_report_info0:
752d 704a9901 jam 1 ,mem_usb_device_enumeration_endflag 
752e 70474701 jam usb_got_report_req ,mem_usb_state 
752f da204827 arg mem_hidreportdesc_m ,rega 
7530 2020766e branch usb0_respond_length 

usb0_request_get_interface:
7531 6fe24a8b fetch 1 ,mem_usb0_state 
7532 c08274cf bne dev_configured ,usb0_force_stall 
7533 6fe249b2 fetch 1 ,mem_usb_setup_bmrequesttype 
7534 c0c0f4cf bne in_interface ,usb0_force_stall 
7535 6fe249b4 fetch 1 ,mem_usb_setup_bvalue 
7536 c08074cf bne 0 ,usb0_force_stall 
7537 6fe249b5 fetch 1 ,mem_usb_setup_bvalueh 
7538 c08074cf bne 0 ,usb0_force_stall 
7539 6fe249b8 fetch 1 ,mem_usb_setup_blength 
753a c080f4cf bne 1 ,usb0_force_stall 
753b 6fe249b9 fetch 1 ,mem_usb_setup_blengthh 
753c c08074cf bne 0 ,usb0_force_stall 
753d 6fe249b6 fetch 1 ,mem_usb_setup_windex 
753e c08074cf bne 0 ,usb0_force_stall 
753f 6fe249b7 fetch 1 ,mem_usb_setup_windex + 1 
7540 c08074cf bne 0 ,usb0_force_stall 
7541 da400001 arg 1 ,regb 
7542 20207559 branch usb_send_zero_packet 

usb0_request_get_status:
7543 6fe24a8b fetch 1 ,mem_usb0_state 
7544 c00174cf beq dev_default ,usb0_force_stall 
7545 6fe249b4 fetch 1 ,mem_usb_setup_bvalue 
7546 c08074cf bne 0 ,usb0_force_stall 
7547 6fe249b5 fetch 1 ,mem_usb_setup_bvalueh 
7548 c08074cf bne 0 ,usb0_force_stall 
7549 6fe249b8 fetch 1 ,mem_usb_setup_blength 
754a c08174cf bne 2 ,usb0_force_stall 
754b 6fe249b9 fetch 1 ,mem_usb_setup_blengthh 
754c c08074cf bne 0 ,usb0_force_stall 
754d 6fe249b7 fetch 1 ,mem_usb_setup_windex + 1 
754e c08074cf bne 0 ,usb0_force_stall 
754f 6fe249b2 fetch 1 ,mem_usb_setup_bmrequesttype 
7550 c0407554 beq in_device ,usb0_get_status_in_device 
7551 c040f55f beq in_interface ,usb0_get_status_in_interface 
7552 c0417563 beq in_endpoint ,usb0_get_status_in_endpoint 
7553 202074cf branch usb0_force_stall 

usb0_get_status_in_device:
7554 6fe249b6 fetch 1 ,mem_usb_setup_windex 
7555 c08074cf bne 0 ,usb0_force_stall 
7556 da400002 arg 2 ,regb 
7557 6fe24a8c fetch 1 ,mem_usb_remote_wakeup 
7558 c000f55d beq 0x01 ,usb_send_two_packet 

usb_send_zero_packet:
7559 da204a80 arg mem_usb_zero_packet ,rega 
755a 20207670 branch usb0_respond 

usb_send_ones_packet:
755b da204a82 arg mem_usb_ones_packet ,rega 
755c 20207670 branch usb0_respond 

usb_send_two_packet:
755d da204a84 arg mem_usb_two_packet ,rega 
755e 20207670 branch usb0_respond 

usb0_get_status_in_interface:
755f 6fe24a8b fetch 1 ,mem_usb0_state 
7560 c08274cf bne dev_configured ,usb0_force_stall 
7561 da400002 arg 2 ,regb 
7562 20207559 branch usb_send_zero_packet 

usb0_get_status_in_endpoint:
7563 6fe24a8b fetch 1 ,mem_usb0_state 
7564 c08274cf bne dev_configured ,usb0_force_stall 
7565 6fe249b6 fetch 1 ,mem_usb_setup_windex 
7566 c040f570 beq in_ep1 ,usb0_get_status_in_ep_in_ep1 
7567 c0417574 beq in_ep2 ,usb0_get_status_in_ep_in_ep2 
7568 c041f578 beq in_ep3 ,usb0_get_status_in_ep_in_ep3 
7569 1fe17e7f and_into 0x7f ,pdata 
756a c000756c beq 0x00 ,usb0_get_status_in_ep_in_ep0 
756b 202074cf branch usb0_force_stall 

usb0_get_status_in_ep_in_ep0:
756c da400002 arg 2 ,regb 
756d 6fe24a8e fetch 1 ,mem_usb_ep0_stall_status 
756e c000f55b beq 1 ,usb_send_ones_packet 
756f 20207559 branch usb_send_zero_packet 

usb0_get_status_in_ep_in_ep1:
7570 da400002 arg 2 ,regb 
7571 6fe24a8f fetch 1 ,mem_usb_ep1_stall_status 
7572 c000f55b beq 1 ,usb_send_ones_packet 
7573 20207559 branch usb_send_zero_packet 

usb0_get_status_in_ep_in_ep2:
7574 da400002 arg 2 ,regb 
7575 6fe24a90 fetch 1 ,mem_usb_ep2_stall_status 
7576 c000f55b beq 1 ,usb_send_ones_packet 
7577 20207559 branch usb_send_zero_packet 

usb0_get_status_in_ep_in_ep3:
7578 da400002 arg 2 ,regb 
7579 6fe24a91 fetch 1 ,mem_usb_ep3_stall_status 
757a c000f55b beq 1 ,usb_send_ones_packet 
757b 20207559 branch usb_send_zero_packet 

usb_get_idle:
757c 704a8601 jam 1 ,mem_usb_idle_flag 
757d da204a87 arg mem_usb_idle_rate ,rega 
757e da400001 arg 1 ,regb 
757f 20207670 branch usb0_respond 

usb_get_report:
7580 6fe449b4 fetch 2 ,mem_usb_setup_bvalue 
7581 d84001ba arg pc_get_report ,temp 
7582 98467c00 isub temp ,null 
7583 2422f4cf nbranch usb0_force_stall ,zero 
7584 793f8023 set0 mark_isstr ,mark 

usb_get_report_dispose:
7585 6fe24a7d fetch 1 ,mem_usb0_data_ready_report 
7586 243a758f nbranch usb_get_report_data_success ,blank 
7587 704a3a00 jam pc_get_nondata ,mem_usb0_get_report_data 

usb_get_report_send_data:
7588 6fe249b8 fetch 1 ,mem_usb_setup_blength 
7589 98002400 iforce regb 
758a da204a3a arg mem_usb0_get_report_data ,rega 
758b 20407670 call usb0_respond 

usb_get_report_data_release:
758c d8a04a3a arg mem_usb0_get_report_data ,contw 
758d df200008 arg 8 ,loopcnt 
758e 2020775e branch memset0 

usb_get_report_data_success:
758f 704a7d00 jam 0 ,mem_usb0_data_ready_report 
7590 704a3a01 jam pc_get_data ,mem_usb0_get_report_data 
7591 20207588 branch usb_get_report_send_data 

usb_get_protocol_req:
7592 6fe249b8 fetch 1 ,mem_usb_setup_blength 
7593 c080f4cf bne 1 ,usb0_force_stall 
7594 704a8801 jam 1 ,mem_usb_get_protocol_flag 
7595 da400001 arg 1 ,regb 
7596 6fe24a8a fetch 1 ,mem_usb_set_protocol_value 
7597 c000759a beq 0 ,usb_get_report_protocol 
7598 c000f59b beq 1 ,usb_get_boot_protocol 
7599 20207559 branch usb_send_zero_packet 

usb_get_report_protocol:
759a 2020755b branch usb_send_ones_packet 

usb_get_boot_protocol:
759b 20207559 branch usb_send_zero_packet 

usb0_request_clear_feature:
759c 6fe24a8b fetch 1 ,mem_usb0_state 
759d c08274cf bne dev_configured ,usb0_force_stall 
759e 6fe249b8 fetch 1 ,mem_usb_setup_blength 
759f c08074cf bne 0 ,usb0_force_stall 
75a0 6fe249b9 fetch 1 ,mem_usb_setup_blengthh 
75a1 c08074cf bne 0 ,usb0_force_stall 
75a2 6fe249b5 fetch 1 ,mem_usb_setup_bvalueh 
75a3 c08074cf bne 0 ,usb0_force_stall 
75a4 6fe249b7 fetch 1 ,mem_usb_setup_windex + 1 
75a5 c08074cf bne 0 ,usb0_force_stall 
75a6 6fe249b2 fetch 1 ,mem_usb_setup_bmrequesttype 
75a7 c00075ab beq out_device ,usb0_request_clear_feature_out_device 
75a8 c000f5b3 beq out_interface ,usb0_request_clear_feature_out_interface 
75a9 c00175b4 beq out_endpoint ,usb0_request_clear_feature_out_endpoint 
75aa 202074cf branch usb0_force_stall 

usb0_request_clear_feature_out_device:
75ab 6fe249b4 fetch 1 ,mem_usb_setup_bvalue 
75ac c080f4cf bne device_remote_wakeup ,usb0_force_stall 
75ad 6fe28c00 fetch 1 ,core_usb_config 
75ae 793ffe07 set0 7 ,pdata 
75af 67e28c00 store 1 ,core_usb_config 
75b0 704a8c00 jam 0 ,mem_usb_remote_wakeup 
75b1 704a8d01 jam 1 ,mem_usb_clear_remote_wakeup 
75b2 202074d3 branch usb0_reply_zerolen 

usb0_request_clear_feature_out_interface:
75b3 202074cf branch usb0_force_stall 

usb0_request_clear_feature_out_endpoint:
75b4 6fe249b4 fetch 1 ,mem_usb_setup_bvalue 
75b5 c08074cf bne endpoint_halt ,usb0_force_stall 
75b6 6fe249b6 fetch 1 ,mem_usb_setup_windex 
75b7 c040f5bf beq in_ep1 ,usb0_force_stall_ep1_in_off 
75b8 c04175c2 beq in_ep2 ,usb0_force_stall_ep2_in_off 
75b9 c041f5c5 beq in_ep3 ,usb0_force_stall_ep3_in_off 
75ba 1fe17e7f and_into 0x7f ,pdata 
75bb c00075bd beq 0x00 ,usb0_force_stall_ep0_in_off 
75bc 202074cf branch usb0_force_stall 

usb0_force_stall_ep0_in_off:
75bd 704a8e00 jam 0 ,mem_usb_ep0_stall_status 
75be 202074d3 branch usb0_reply_zerolen 

usb0_force_stall_ep1_in_off:
75bf 704a9d01 jam 1 ,mem_usb_clear_halt 
75c0 704a8f00 jam 0 ,mem_usb_ep1_stall_status 
75c1 202074d3 branch usb0_reply_zerolen 

usb0_force_stall_ep2_in_off:
75c2 704a9d01 jam 1 ,mem_usb_clear_halt 
75c3 704a9000 jam 0 ,mem_usb_ep2_stall_status 
75c4 202074d3 branch usb0_reply_zerolen 

usb0_force_stall_ep3_in_off:
75c5 704a9d01 jam 1 ,mem_usb_clear_halt 
75c6 704a9100 jam 0 ,mem_usb_ep3_stall_status 
75c7 202074d3 branch usb0_reply_zerolen 

usb0_request_set_feature:
75c8 6fe249b8 fetch 1 ,mem_usb_setup_blength 
75c9 c08074cf bne 0 ,usb0_force_stall 
75ca 6fe249b9 fetch 1 ,mem_usb_setup_blengthh 
75cb c08074cf bne 0 ,usb0_force_stall 
75cc 6fe249b2 fetch 1 ,mem_usb_setup_bmrequesttype 
75cd c00075d1 beq out_device ,usb0_request_set_feature_out_device 
75ce c000f5de beq out_interface ,usb0_request_set_feature_out_interface 
75cf c00175df beq out_endpoint ,usb0_request_set_feature_out_endpoint 
75d0 202074cf branch usb0_force_stall 

usb0_request_set_feature_out_device:
75d1 6fe249b4 fetch 1 ,mem_usb_setup_bvalue 
75d2 c080f4cf bne device_remote_wakeup ,usb0_force_stall 
75d3 6fe28c00 fetch 1 ,core_usb_config 
75d4 79207e07 set1 7 ,pdata 
75d5 67e28c00 store 1 ,core_usb_config 
75d6 704a8c01 jam 1 ,mem_usb_remote_wakeup 
75d7 70474703 jam usb_sleep ,mem_usb_state 
75d8 704a7e00 jam 0 ,mem_usb_tx_win_enable 
75d9 204074d3 call usb0_reply_zerolen 

usb_wakeup_timer_reinit:
75da 204077ac call timer_reinit 
75db 58001388 setarg timer_wakeup_delay 
75dc d8e0000f arg timer_wakeup ,queue 
75dd 202077a6 branch timer_init 

usb0_request_set_feature_out_interface:
75de 202074cf branch usb0_force_stall 

usb0_request_set_feature_out_endpoint:
75df 6fe249b4 fetch 1 ,mem_usb_setup_bvalue 
75e0 c08074cf bne endpoint_halt ,usb0_force_stall 
75e1 6fe249b5 fetch 1 ,mem_usb_setup_bvalueh 
75e2 c08074cf bne 0 ,usb0_force_stall 
75e3 6fe249b6 fetch 1 ,mem_usb_setup_windex 
75e4 c040f5ec beq in_ep1 ,usb0_force_stall_ep1_in_on 
75e5 c04175ee beq in_ep2 ,usb0_force_stall_ep2_in_on 
75e6 c041f5f0 beq in_ep3 ,usb0_force_stall_ep3_in_on 
75e7 1fe17e7f and_into 0x7f ,pdata 
75e8 c00075ea beq 0x00 ,usb0_force_stall_ep0_in_on 
75e9 202074cf branch usb0_force_stall 

usb0_force_stall_ep0_in_on:
75ea 704a8e01 jam 1 ,mem_usb_ep0_stall_status 
75eb 202074d3 branch usb0_reply_zerolen 

usb0_force_stall_ep1_in_on:
75ec 704a8f01 jam 1 ,mem_usb_ep1_stall_status 
75ed 202074d3 branch usb0_reply_zerolen 

usb0_force_stall_ep2_in_on:
75ee 704a9001 jam 1 ,mem_usb_ep2_stall_status 
75ef 202074d3 branch usb0_reply_zerolen 

usb0_force_stall_ep3_in_on:
75f0 704a9101 jam 1 ,mem_usb_ep3_stall_status 
75f1 202074d3 branch usb0_reply_zerolen 

usb0_request_set_address:
75f2 6fe249b2 fetch 1 ,mem_usb_setup_bmrequesttype 
75f3 c08074cf bne out_device ,usb0_force_stall 
75f4 6fe249b6 fetch 1 ,mem_usb_setup_windex 
75f5 c08074cf bne 0 ,usb0_force_stall 
75f6 6fe249b7 fetch 1 ,mem_usb_setup_windex + 1 
75f7 c08074cf bne 0 ,usb0_force_stall 
75f8 6fe249b8 fetch 1 ,mem_usb_setup_blength 
75f9 c08074cf bne 0 ,usb0_force_stall 
75fa 6fe249b9 fetch 1 ,mem_usb_setup_blengthh 
75fb c08074cf bne 0 ,usb0_force_stall 
75fc 6fe249b5 fetch 1 ,mem_usb_setup_bvalueh 
75fd c08074cf bne 0 ,usb0_force_stall 
75fe 6fe249b4 fetch 1 ,mem_usb_setup_bvalue 
75ff 1fe17e80 and_into 0x80 ,pdata 
7600 c08074cf bne 0 ,usb0_force_stall 
7601 6fe249b4 fetch 1 ,mem_usb_setup_bvalue 
7602 c0807609 bne 0 ,usb_usb0_state_set_dev_addr 

usb_usb0_state_set_dev_default:
7603 704a8b02 jam dev_default ,mem_usb0_state 

usb0_request_set_wait_address:
7604 6fe249b4 fetch 1 ,mem_usb_setup_bvalue 
7605 67e28c04 store 1 ,core_usb_addr 
7606 204074d3 call usb0_reply_zerolen 
7607 704a9c01 jam 1 ,mem_usb_set_high_addr_flag 
7608 20600000 rtn 

usb_usb0_state_set_dev_addr:
7609 704a8b03 jam dev_address ,mem_usb0_state 
760a 20207604 branch usb0_request_set_wait_address 

usb0_request_set_configuration:
760b 6fe24a8b fetch 1 ,mem_usb0_state 
760c c00174cf beq dev_default ,usb0_force_stall 
760d 6fe249b2 fetch 1 ,mem_usb_setup_bmrequesttype 
760e c08074cf bne out_device ,usb0_force_stall 
760f 6fe249b6 fetch 1 ,mem_usb_setup_windex 
7610 c08074cf bne 0 ,usb0_force_stall 
7611 6fe249b7 fetch 1 ,mem_usb_setup_windex + 1 
7612 c08074cf bne 0 ,usb0_force_stall 
7613 6fe249b8 fetch 1 ,mem_usb_setup_blength 
7614 c08074cf bne 0 ,usb0_force_stall 
7615 6fe249b9 fetch 1 ,mem_usb_setup_blengthh 
7616 c08074cf bne 0 ,usb0_force_stall 
7617 6fe249b5 fetch 1 ,mem_usb_setup_bvalue + 1 
7618 c08074cf bne 0 ,usb0_force_stall 
7619 6fe249b4 fetch 1 ,mem_usb_setup_bvalue 
761a 1fe67c01 sub pdata ,usb_max_num_cfg ,null 
761b 242174cf nbranch usb0_force_stall ,positive 
761c 6fe24a8b fetch 1 ,mem_usb0_state 
761d c001f620 beq dev_address ,usb0_request_set_cfg_addr_state 
761e c0027620 beq dev_configured ,usb0_request_set_cfg_cfg_state 
761f 202074cf branch usb0_force_stall 

usb0_request_set_cfg_addr_state:

usb0_request_set_cfg_cfg_state:
7620 6fe249b4 fetch 1 ,mem_usb_setup_bvalue 
7621 c0007624 beq 0 ,usb0_request_set_cfg_stay_addr_state 
7622 704a8b04 jam dev_configured ,mem_usb0_state 
7623 202074d3 branch usb0_reply_zerolen 

usb0_request_set_cfg_stay_addr_state:
7624 704a8b03 jam dev_address ,mem_usb0_state 
7625 202074d3 branch usb0_reply_zerolen 

usb0_request_set_interface:
7626 6fe24a8b fetch 1 ,mem_usb0_state 
7627 c08274cf bne dev_configured ,usb0_force_stall 
7628 6fe249b2 fetch 1 ,mem_usb_setup_bmrequesttype 
7629 c080f4cf bne out_interface ,usb0_force_stall 
762a 6fe249b4 fetch 1 ,mem_usb_setup_bvalue 
762b c08074cf bne 0 ,usb0_force_stall 
762c 6fe249b5 fetch 1 ,mem_usb_setup_bvalueh 
762d c08074cf bne 0 ,usb0_force_stall 
762e 6fe249b8 fetch 1 ,mem_usb_setup_blength 
762f c08074cf bne 0 ,usb0_force_stall 
7630 6fe249b9 fetch 1 ,mem_usb_setup_blengthh 
7631 c08074cf bne 0 ,usb0_force_stall 
7632 6fe249b6 fetch 1 ,mem_usb_setup_windex 
7633 c08074cf bne 0 ,usb0_force_stall 
7634 6fe249b7 fetch 1 ,mem_usb_setup_windex + 1 
7635 c08074cf bne 0 ,usb0_force_stall 
7636 202074d3 branch usb0_reply_zerolen 

usb_set_idle:
7637 477ac03e bpatchx patch3e_5 ,mem_patch3e 
7638 704a8601 jam 1 ,mem_usb_idle_flag 
7639 6fe249b5 fetch 1 ,mem_usb_setup_bvalueh 
763a 67e24a87 store 1 ,mem_usb_idle_rate 
763b 6fe249b6 fetch 1 ,mem_usb_setup_windex 
763c 1fe67c01 sub pdata ,1 ,null 
763d 2042f645 call usb_clear_remote_wakeup_set0 ,zero 
763e 6fe24747 fetch 1 ,mem_usb_state 
763f c08274d3 bne usb_resume ,usb0_reply_zerolen 
7640 70474702 jam usb_connected ,mem_usb_state 
7641 204074d3 call usb0_reply_zerolen 
7642 20007530 nop 30000 
7643 20007530 nop 30000 
7644 20600000 rtn 

usb_clear_remote_wakeup_set0:
7645 704a9901 jam 1 ,mem_usb_device_enumeration_endflag 
7646 704a8d00 jam 0 ,mem_usb_clear_remote_wakeup 
7647 70474704 jam usb_resume ,mem_usb_state 
7648 20600000 rtn 

usb_set_report:
7649 704a7c01 jam 1 ,mem_usb0_get_set_report 
764a 20407653 call usb_set_report_resume_judge 
764b 6fe449b4 fetch 2 ,mem_usb_setup_bvalue 
764c 67e44a7a store 2 ,mem_usb_setup_bvalue_temp 
764d 6fe249b8 fetch 1 ,mem_usb_setup_blength 
764e 98007200 iforce loopcnt 
764f d8c049ba arg mem_usb0_setup ,contr 
7650 d8a049fa arg mem_usb0_set_report_data ,contw 
7651 2040779f call memcpy 
7652 202074d3 branch usb0_reply_zerolen 

usb_set_report_resume_judge:
7653 6fe449b4 fetch 2 ,mem_usb_setup_bvalue 
7654 d8400200 arg pc_set_report_bvalue ,temp 
7655 98467c00 isub temp ,null 
7656 24628000 nrtn zero 
7657 6fe449b6 fetch 2 ,mem_usb_setup_windex 
7658 d8400000 arg pc_set_report_windex ,temp 
7659 98467c00 isub temp ,null 
765a 24628000 nrtn zero 
765b 6fe449b8 fetch 2 ,mem_usb_setup_blength 
765c d8400001 arg pc_set_report_blength ,temp 
765d 98467c00 isub temp ,null 
765e 24628000 nrtn zero 
765f 704a7e01 jam 1 ,mem_usb_tx_win_enable 
7660 20600000 rtn 

usb_set_protocol_req:
7661 6fe249b8 fetch 1 ,mem_usb_setup_blength 
7662 c08074cf bne 0 ,usb0_force_stall 
7663 6fe249b4 fetch 1 ,mem_usb_setup_bvalue 
7664 c0007667 beq boot_protocol ,usb_set_boot_protocol 
7665 c000f66a beq report_protocol ,usb_set_report_protocol 
7666 202074cf branch usb0_force_stall 

usb_set_boot_protocol:
7667 704a8900 jam 0 ,mem_usb_set_protocol_status 
7668 704a8a01 jam 1 ,mem_usb_set_protocol_value 
7669 202074d3 branch usb0_reply_zerolen 

usb_set_report_protocol:
766a 704a7f01 jam 1 ,mem_usb_tx_mac_enable 
766b 704a8901 jam 1 ,mem_usb_set_protocol_status 
766c 704a8a00 jam 0 ,mem_usb_set_protocol_value 
766d 202074d3 branch usb0_reply_zerolen 

usb0_respond_length:
766e ea420011 ifetchr regb ,1 ,rega 
766f 1a20a201 increase 1 ,rega 

usb0_respond:
7670 477b403e bpatchx patch3e_6 ,mem_patch3e 
7671 c591f67b bmark0 mark_isstr ,usb0_respond0 
7672 1a40fe01 add regb ,1 ,pdata 
7673 1fe3fe00 lshift pdata ,pdata 
7674 67e28c18 store 1 ,core_usb_dfifo0 
7675 708c1803 jam 3 ,core_usb_dfifo0 
7676 6fe249b8 fetch 1 ,mem_usb_setup_blength 
7677 1fe0fffe increase -2 ,pdata 
7678 1fe37e00 rshift pdata ,pdata 
7679 67e249b8 store 1 ,mem_usb_setup_blength 
767a c0007682 beq 0 ,usb_no_respond_data 

usb0_respond0:
767b 6fe449b8 fetch 2 ,mem_usb_setup_blength 
767c 9a467c00 isub regb ,null 
767d 2021767f branch usb0_respond1 ,positive 
767e 1fe22400 copy pdata ,regb 

usb0_respond1:
767f 62244748 storer rega ,2 ,mem_bufptr 
7680 6242474a storer regb ,1 ,mem_remain 
7681 20207684 branch usb0_tx 

usb_no_respond_data:
7682 d8e00000 arg 0 ,queue 
7683 202076a4 branch usb_trig 

usb0_tx:
7684 477bc03e bpatchx patch3e_7 ,mem_patch3e 
7685 6fe2474a fetch 1 ,mem_remain 
7686 207a0000 rtn blank 
7687 1fe27200 copy pdata ,loopcnt 
7688 1fe67c40 sub pdata ,ep0_packet_size ,null 
7689 2021768b branch usb0_tx_info ,positive 
768a df200040 arg ep0_packet_size ,loopcnt 

usb0_tx_info:
768b 6fe2474a fetch 1 ,mem_remain 
768c 9f267e00 isub loopcnt ,pdata 
768d 67e2474a store 1 ,mem_remain 
768e 6fe44748 fetch 2 ,mem_bufptr 
768f 1fe20c00 copy pdata ,contr 

usb0_tx0:
7690 efe20006 ifetch 1 ,contr 
7691 67e28c18 store 1 ,core_usb_dfifo0 
7692 c591f694 bmark0 mark_isstr ,usb0_tx1 
7693 708c1800 jam 0 ,core_usb_dfifo0 

usb0_tx1:
7694 c2007690 loop usb0_tx0 
7695 18c27e00 copy contr ,pdata 
7696 67e44748 store 2 ,mem_bufptr 
7697 d8e00000 arg 0 ,queue 
7698 204076a4 call usb_trig 
7699 6fe2474a fetch 1 ,mem_remain 
769a 247a0000 nrtn blank 
769b 6fe24747 fetch 1 ,mem_usb_state 
769c c1808000 rtnne usb_got_report_req 
769d 70474702 jam usb_connected ,mem_usb_state 
769e 20600000 rtn 

usb_tx_ep1:
769f da208c19 arg core_usb_dfifo1 ,rega 
76a0 d8e00001 arg 1 ,queue 

usb_tx_loop:
76a1 efe20006 ifetch 1 ,contr 
76a2 e7e20011 istore 1 ,rega 
76a3 c20076a1 loop usb_tx_loop 

usb_trig:
76a4 477c403f bpatchx patch3f_0 ,mem_patch3f 
76a5 58000000 setarg 0 
76a6 f9207e00 qset1 pdata 
76a7 67e28c10 store 1 ,core_usb_trig 
76a8 68424a98 fetcht 1 ,mem_usb_tx_wait 
76a9 9841fe00 ior temp ,pdata 
76aa 67e24a98 store 1 ,mem_usb_tx_wait 
76ab 20600000 rtn 

usb_tx_ep2:
76ac d8e00002 arg 2 ,queue 
76ad da208c1a arg core_usb_dfifo2 ,rega 
76ae 202076a1 branch usb_tx_loop 

usb_tx:
76af 477cc03f bpatchx patch3f_1 ,mem_patch3f 
76b0 6fe24a97 fetch 1 ,mem_usb_tx_enable 
76b1 207a0000 rtn blank 
76b2 6fe24a98 fetch 1 ,mem_usb_tx_wait 
76b3 243a7701 nbranch usb_inwake_state_tx_dispose ,blank 
76b4 6fe24a99 fetch 1 ,mem_usb_device_enumeration_endflag 
76b5 203a76d5 branch usb_tx_fifo_release ,blank 
76b6 6fe24747 fetch 1 ,mem_usb_state 
76b7 c001f70d beq usb_sleep ,usb_windows_wakeup 
76b8 c08176d5 bne usb_connected ,usb_tx_fifo_release 
76b9 6fe24a8d fetch 1 ,mem_usb_clear_remote_wakeup 
76ba 243a76d5 nbranch usb_tx_fifo_release ,blank 
76bb 477d403f bpatchx patch3f_2 ,mem_patch3f 
76bc 204076be call usb_tx_data_ep1 
76bd 202076c9 branch usb_tx_data_ep2 

usb_tx_data_ep1:
76be 6fe24a97 fetch 1 ,mem_usb_tx_enable 
76bf c4008000 rtnbit0 1 
76c0 6fe24a98 fetch 1 ,mem_usb_tx_wait 
76c1 c3808000 rtnbit1 1 
76c2 6fe24a97 fetch 1 ,mem_usb_tx_enable 
76c3 793ffe01 set0 1 ,pdata 
76c4 67e24a97 store 1 ,mem_usb_tx_enable 
76c5 6fe24a95 fetch 1 ,mem_usb_ep1_data 
76c6 207a0000 rtn blank 
76c7 c00876fd beq usb_ep1_kb ,usb_tx_kb_normal_data 
76c8 20203b25 branch assert 

usb_tx_data_ep2:
76c9 6fe24a97 fetch 1 ,mem_usb_tx_enable 
76ca c4010000 rtnbit0 2 
76cb 6fe24a98 fetch 1 ,mem_usb_tx_wait 
76cc c3810000 rtnbit1 2 
76cd 6fe24a97 fetch 1 ,mem_usb_tx_enable 
76ce 793ffe02 set0 2 ,pdata 
76cf 67e24a97 store 1 ,mem_usb_tx_enable 
76d0 6fe24a96 fetch 1 ,mem_usb_ep2_data 
76d1 207a0000 rtn blank 
76d2 c01076de beq usb_ep2_ms ,usb_tx_ms_data 
76d3 c010f6f9 beq usb_ep2_multikey ,usb_tx_kb_multikey_data 
76d4 20203b25 branch assert 

usb_tx_fifo_release:
76d5 d8a04a9e arg mem_usb_mouse_data ,contw 
76d6 df200002 arg 2 ,loopcnt 
76d7 2040775e call memset0 
76d8 d8a04aae arg mem_usb_kb_data ,contw 
76d9 df200002 arg 2 ,loopcnt 
76da 2040775e call memset0 
76db d8a04abe arg mem_usb_kb_multikey ,contw 
76dc df200002 arg 2 ,loopcnt 
76dd 2020775e branch memset0 

usb_tx_ms_data:
76de 6fe24a86 fetch 1 ,mem_usb_idle_flag 
76df 68424a88 fetcht 1 ,mem_usb_get_protocol_flag 
76e0 98417e00 iand temp ,pdata 
76e1 203a76f5 branch usb_tx_ms_data_normal_mode ,blank 
76e2 68424a89 fetcht 1 ,mem_usb_set_protocol_status 
76e3 9840fe00 iadd temp ,pdata 
76e4 c000f6e6 beq mac_boot_mode ,usb_tx_ms_data_mac_boot_mode 
76e5 202076f5 branch usb_tx_ms_data_normal_mode 

usb_tx_ms_data_mac_boot_mode:
76e6 704a9600 jam 0 ,mem_usb_ep2_data 

usb_tx_ms_data_mac_boot_regroup:
76e7 6fe24a9f fetch 1 ,mem_usb_mouse_data + 1 
76e8 c00176f6 beq r_key ,usb_tx_mac_boot_ms_regroup_r_or_lrkey 
76e9 c001f6f6 beq lr_key ,usb_tx_mac_boot_ms_regroup_r_or_lrkey 
76ea 6fe24a9f fetch 1 ,mem_usb_mouse_data + 1 
76eb 67e24a9e store 1 ,mem_usb_mouse_data 
76ec 6fe24aa0 fetch 1 ,mem_usb_mouse_data + 2 
76ed e7e20005 istore 1 ,contw 
76ee 6fe24aa2 fetch 1 ,mem_usb_mouse_data + 4 
76ef e7e20005 istore 1 ,contw 
76f0 6fe24aa4 fetch 1 ,mem_usb_mouse_data + 6 
76f1 e7e20005 istore 1 ,contw 
76f2 df200004 arg 4 ,loopcnt 
76f3 d8c04a9e arg mem_usb_mouse_data ,contr 
76f4 202076ac branch usb_tx_ep2 

usb_tx_ms_data_normal_mode:
76f5 704a9600 jam 0 ,mem_usb_ep2_data 

usb_tx_mac_boot_ms_regroup_r_or_lrkey:
76f6 df200008 arg 8 ,loopcnt 
76f7 d8c04a9e arg mem_usb_mouse_data ,contr 
76f8 202076ac branch usb_tx_ep2 

usb_tx_kb_multikey_data:
76f9 704a9600 jam 0 ,mem_usb_ep2_data 
76fa df200003 arg 3 ,loopcnt 
76fb d8c04abe arg mem_usb_kb_multikey ,contr 
76fc 202076ac branch usb_tx_ep2 

usb_tx_kb_normal_data:
76fd 704a9500 jam 0 ,mem_usb_ep1_data 
76fe df200008 arg 8 ,loopcnt 
76ff d8c04aae arg mem_usb_kb_data ,contr 
7700 2020769f branch usb_tx_ep1 

usb_inwake_state_tx_dispose:
7701 477dc03f bpatchx patch3f_3 ,mem_patch3f 
7702 6fe24747 fetch 1 ,mem_usb_state 
7703 c001f706 beq usb_sleep ,usb_clear_tx_wait 
7704 c0017708 beq usb_connected ,usb_mac_wakeup_trig 
7705 20600000 rtn 

usb_clear_tx_wait:
7706 704a9800 jam 0 ,mem_usb_tx_wait 
7707 20600000 rtn 

usb_mac_wakeup_trig:
7708 6fe28c00 fetch 1 ,core_usb_config 
7709 79207e07 set1 7 ,pdata 
770a 67e28c00 store 1 ,core_usb_config 
770b 704a9b01 jam 1 ,mem_usb_mac_wakeup_trig 
770c 20600000 rtn 

usb_windows_wakeup:
770d 477e403f bpatchx patch3f_4 ,mem_patch3f 
770e d8e0000f arg timer_wakeup ,queue 
770f 204077ad call timer_check 
7710 247a0000 nrtn blank 

usb_wakeup:
7711 6fe28c00 fetch 1 ,core_usb_config 
7712 c4038000 rtnbit0 7 
7713 708c00fc jam 0xfc ,core_usb_config 
7714 20007530 nop 30000 
7715 708c003c jam 0x3c ,core_usb_config 
7716 20600000 rtn 

right_shift_n:
7717 1f267c00 sub loopcnt ,0 ,null 
7718 20628000 rtn zero 

right_shift_n_loop:
7719 1fe37e00 rshift pdata ,pdata 
771a c2007719 loop right_shift_n_loop 
771b 20600000 rtn 

left_shift_n:
771c 18007e01 force 1 ,pdata 
771d 1f267c00 sub loopcnt ,0 ,null 
771e 20628000 rtn zero 

left_shift_n_loop:
771f 1fe3fe00 lshift pdata ,pdata 
7720 c200771f loop left_shift_n_loop 
7721 20600000 rtn 

push_stack:
7722 18a27e00 deposit contw 
7723 67e40b27 store 2 ,mem_contw 
7724 60500b0d storet 8 ,mem_temp 
7725 61680b15 storer timeup ,4 ,mem_timeup 
7726 62280b19 storer rega ,4 ,mem_rega 
7727 62480b1d storer regb ,4 ,mem_regb 
7728 62660b21 storer regc ,3 ,mem_regc 
7729 60c40b25 storer contr ,2 ,mem_contr 
772a 20600000 rtn 

pop_stack:
772b 68500b0d fetcht 8 ,mem_temp 
772c 69680b15 fetchr timeup ,4 ,mem_timeup 
772d 6a280b19 fetchr rega ,4 ,mem_rega 
772e 6a480b1d fetchr regb ,4 ,mem_regb 
772f 6a660b21 fetchr regc ,3 ,mem_regc 
7730 6fe40b27 fetch 2 ,mem_contw 
7731 98000a00 iforce contw 
7732 6fe40b25 fetch 2 ,mem_contr 
7733 98000c00 iforce contr 
7734 20600000 rtn 

save_cont_pointers:
7735 18a27e00 copy contw ,pdata 
7736 67e40b06 store 2 ,mem_hold_contw 
7737 18c27e00 copy contr ,pdata 
7738 67e40b04 store 2 ,mem_hold_contr 
7739 20600000 rtn 

load_cont_pointers:
773a 6fe40b06 fetch 2 ,mem_hold_contw 
773b 1fe20a00 copy pdata ,contw 
773c 6fe40b04 fetch 2 ,mem_hold_contr 
773d 1fe20c00 copy pdata ,contr 
773e 20600000 rtn 

delay_10ms:
773f 1c427e00 copy clkn_bt ,pdata 
7740 1fe0fe10 increase 16 ,pdata 
7741 1fe0fe10 increase 16 ,pdata 

delay_ms_wait:
7742 1c420400 copy clkn_bt ,temp 
7743 98467c00 isub temp ,null 
7744 20217742 branch delay_ms_wait ,positive 
7745 20600000 rtn 

memcpy96:
7746 20407754 call memcpy32 

memcpy64:
7747 20407754 call memcpy32 
7748 20207754 branch memcpy32 

memcpy12:
7749 2040774d call memcpy8 

memcpy4:
774a efe80006 ifetch 4 ,contr 
774b e7e80005 istore 4 ,contw 
774c 20600000 rtn 

memcpy8:
774d eff00006 ifetch 8 ,contr 
774e e7f00005 istore 8 ,contw 
774f 20600000 rtn 

memcpy48:
7750 eff00006 ifetch 8 ,contr 
7751 e7f00005 istore 8 ,contw 

memcpy40:
7752 eff00006 ifetch 8 ,contr 
7753 e7f00005 istore 8 ,contw 

memcpy32:
7754 eff00006 ifetch 8 ,contr 
7755 e7f00005 istore 8 ,contw 

memcpy24:
7756 eff00006 ifetch 8 ,contr 
7757 e7f00005 istore 8 ,contw 

memcpy16:
7758 eff00006 ifetch 8 ,contr 
7759 e7f00005 istore 8 ,contw 
775a eff00006 ifetch 8 ,contr 
775b e7f00005 istore 8 ,contw 
775c 20600000 rtn 

bn_zero:
775d 18007203 force 3 ,loopcnt 

memset0:
775e 18007e00 force 0 ,pdata 

memset8:
775f e7f00005 istore 8 ,contw 
7760 c200775f loop memset8 
7761 20600000 rtn 

memset0_8:
7762 18007e00 force 0 ,pdata 
7763 e7f00005 istore 8 ,contw 
7764 20600000 rtn 

memset0_4:
7765 18007e00 force 0 ,pdata 
7766 e7e80005 istore 4 ,contw 
7767 20600000 rtn 

clear_mem_256:
7768 18007204 force 4 ,loopcnt 
7769 2020775e branch memset0 

clear_mem_512:
776a 18007208 force 8 ,loopcnt 
776b 2020775e branch memset0 

clear_mem:
776c 1f227e00 deposit loopcnt 
776d 207a0000 rtn blank 
776e 58000000 setarg 0 

clear_mem_loop:
776f e7e20005 istore 1 ,contw 
7770 c200776f loop clear_mem_loop 
7771 20600000 rtn 

get_contw:
7772 6fe40b27 fetch 2 ,mem_contw 

get_pdata_contw:
7773 1fe20a00 copy pdata ,contw 
7774 20600000 rtn 

get_contr:
7775 6fe40b25 fetch 2 ,mem_contr 

get_pdata_contr:
7776 1fe20c00 copy pdata ,contr 
7777 20600000 rtn 

store_contw:
7778 18a27e00 copy contw ,pdata 
7779 67e40b27 store 2 ,mem_contw 
777a 20600000 rtn 

store_contr:
777b 18c27e00 copy contr ,pdata 
777c 67e40b25 store 2 ,mem_contr 
777d 20600000 rtn 

memcpy_smart:
777e 1a627e00 copy regc ,pdata 
777f 98a60400 isub contw ,temp 
7780 1f227e00 copy loopcnt ,pdata 
7781 204078db call not_greater_than 
7782 1fe20400 copy pdata ,temp 
7783 1f227e00 copy loopcnt ,pdata 
7784 18427200 copy temp ,loopcnt 
7785 9f260400 isub loopcnt ,temp 
7786 2422f789 nbranch memcpy_smart_long ,zero 
7787 2040779f call memcpy 
7788 2020778d branch memcpy_smart_update_contw 

memcpy_smart_long:
7789 2040779f call memcpy 
778a 18427200 copy temp ,loopcnt 
778b 1a420a00 copy regb ,contw 
778c 2040779f call memcpy 

memcpy_smart_update_contw:
778d 18a27e00 copy contw ,pdata 
778e 9a667c00 isub regc ,null 
778f 24628000 nrtn zero 
7790 1a420a00 copy regb ,contw 
7791 20600000 rtn 

memcpy_fast:
7792 1f227e00 deposit loopcnt 
7793 207a0000 rtn blank 

memcpy_fast_loop:
7794 1f20f3f8 increase -8 ,loopcnt 
7795 2041774d call memcpy8 ,positive 
7796 20628000 rtn zero 
7797 20217794 branch memcpy_fast_loop ,positive 
7798 1f20f208 increase 8 ,loopcnt 

memcpy_fast_loop_four:
7799 1f20f3fc increase -4 ,loopcnt 
779a 2041774a call memcpy4 ,positive 
779b 20628000 rtn zero 
779c 20217799 branch memcpy_fast_loop_four ,positive 
779d 1f20f204 increase 4 ,loopcnt 
779e 2020779f branch memcpy 

memcpy:
779f 1f227e00 deposit loopcnt 
77a0 207a0000 rtn blank 

memcpy_loop:
77a1 efe20006 ifetch 1 ,contr 
77a2 e7e20005 istore 1 ,contw 
77a3 c20077a1 loop memcpy_loop 
77a4 20600000 rtn 

timer_stop:
77a5 58000000 setarg 0 

timer_init:
77a6 d8a04250 arg mem_timers ,contw 
77a7 98000400 iforce temp 
77a8 18e3fe00 lshift queue ,pdata 
77a9 98a08a00 iadd contw ,contw 
77aa e0440005 istoret 2 ,contw 
77ab 20600000 rtn 

timer_reinit:
77ac d8e00000 arg 0 ,queue 

timer_check:
77ad 477ec03f bpatchx patch3f_5 ,mem_patch3f 
77ae 68484134 fetcht 4 ,mem_last_clkn 
77af 1c437e00 rshift clkn_bt ,pdata 
77b0 67e84134 store 4 ,mem_last_clkn 
77b1 98461600 isub temp ,timeup 
77b2 19620400 copy timeup ,temp 
77b3 d8c04250 arg mem_timers ,contr 
77b4 18c20a00 copy contr ,contw 
77b5 df200010 arg 16 ,loopcnt 

timer_loop:
77b6 efe40006 ifetch 2 ,contr 
77b7 98467e00 isub temp ,pdata 
77b8 202177ba branch timer_counting ,positive 
77b9 18007e00 force 0 ,pdata 

timer_counting:
77ba e7e40005 istore 2 ,contw 
77bb c20077b6 loop timer_loop 
77bc d8c04250 arg mem_timers ,contr 
77bd 18e3fe00 lshift queue ,pdata 
77be 98c08c00 iadd contr ,contr 
77bf efe40006 ifetch 2 ,contr 
77c0 20600000 rtn 

lshift8_queue:
77c1 18e08e01 increase 1 ,queue 

lshift8_queue_loop:
77c2 18e08fff increase -1 ,queue 
77c3 20628000 rtn zero 
77c4 1fed7e00 lshift8 pdata ,pdata 
77c5 202077c2 branch lshift8_queue_loop 

xor_loop:
77c6 efe80013 ifetch 4 ,regc 
77c7 e8480011 ifetcht 4 ,rega 
77c8 9842fe00 ixor temp ,pdata 
77c9 e7e80005 istore 4 ,contw 
77ca 1a20a204 increase 4 ,rega 
77cb 1a60a604 increase 4 ,regc 
77cc c20077c6 loop xor_loop 
77cd 20600000 rtn 

inverse_data:
77ce 1f227e00 copy loopcnt ,pdata 
77cf 1fe67c01 sub pdata ,1 ,null 
77d0 20610000 rtn positive 
77d1 9a20a400 iadd rega ,regb 
77d2 1a40a5ff increase -1 ,regb 
77d3 1f237200 rshift loopcnt ,loopcnt 

inverse_loop:
77d4 e8420011 ifetcht 1 ,rega 
77d5 efe20012 ifetch 1 ,regb 
77d6 e7e20011 istore 1 ,rega 
77d7 e0420012 istoret 1 ,regb 
77d8 1a40a5ff increase -1 ,regb 
77d9 1a20a201 increase 1 ,rega 
77da c20077d4 loop inverse_loop 
77db 20600000 rtn 

clk_add:
77dc 98408400 iadd temp ,temp 
77dd 18427200 copy temp ,loopcnt 
77de 58000ea6 setarg 3750 
77df 9f267e00 isub loopcnt ,pdata 
77e0 20610000 rtn positive 
77e1 1fe67e00 sub pdata ,0 ,pdata 
77e2 18510400 rshift16 temp ,temp 
77e3 18408401 increase 1 ,temp 
77e4 18500400 lshift16 temp ,temp 
77e5 98418400 ior temp ,temp 
77e6 20600000 rtn 

clk_diff_rt:
77e7 204077e9 call clk_diff 
77e8 202077f3 branch clk2rt 

clk_diff:
77e9 78547c00 disable user 
77ea 98467e00 isub temp ,pdata 
77eb 202177ee branch clk_diff_pos ,positive 
77ec 78347c00 enable user 
77ed 1fe67e00 sub pdata ,0 ,pdata 

clk_diff_pos:
77ee c4078000 rtnbit0 15 
77ef d85f0ea6 arg -61786 ,temp 
77f0 9840fe00 iadd temp ,pdata 
77f1 793ffe40 set0 64 ,pdata 
77f2 20600000 rtn 

clk2rt:
77f3 d8c0ffff arg 0xffff ,contr 
77f4 98c10c00 iand contr ,contr 
77f5 1ff17e00 rshift16 pdata ,pdata 
77f6 d8400ea6 arg 3750 ,temp 
77f7 984ffe00 imul32 temp ,pdata 
77f8 98c0fe00 iadd contr ,pdata 
77f9 20600000 rtn 

clk2lpo:
77fa 1fed7e00 lshift8 pdata ,pdata 
77fb 1ff27e00 lshift4 pdata ,pdata 
77fc 6846420d fetcht 3 ,mem_clks_per_lpo 
77fd 9846fc00 idiv temp 
77fe 2040782e call wait_div_end 
77ff 18078400 quotient temp 
7800 20600000 rtn 

clk2bt:
7801 d8400ea6 arg 3750 ,temp 
7802 9846fc00 idiv temp 
7803 2040782e call wait_div_end 
7804 1807fe00 quotient pdata 
7805 1ff07e00 lshift16 pdata ,pdata 
7806 18070400 remainder temp 
7807 98418400 ior temp ,temp 
7808 20600000 rtn 

pn9:
7809 18426000 copy temp ,alarm 
780a 580001ff setarg 0x1ff 
780b 18002400 force 0 ,regb 

pn9_loop:
780c 1fe92200 rshift3 pdata ,rega 
780d 1a232200 rshift rega ,rega 
780e 9a22a200 ixor rega ,rega 
780f 2a2ffe00 isolate1 0 ,rega 
7810 7920fe09 setflag true ,9 ,pdata 
7811 18430400 rshift temp ,temp 
7812 2feffe00 isolate1 0 ,pdata 
7813 79208407 setflag true ,7 ,temp 
7814 1fe37e00 rshift pdata ,pdata 
7815 1a40a401 increase 1 ,regb 
7816 2a400e00 compare 0 ,regb ,0x7 
7817 2420f80c nbranch pn9_loop ,true 
7818 e0420005 istoret 1 ,contw 
7819 c200780c loop pn9_loop 
781a 1e020400 copy alarm ,temp 
781b 20600000 rtn 

bcd_byte:
781c 1fe6fc0a div pdata ,10 
781d 2040782e call wait_div_end 
781e 1807fe00 quotient pdata 
781f 1feba200 lshift2 pdata ,rega 
7820 1a2ba200 lshift2 rega ,rega 
7821 18077e00 remainder pdata 
7822 9a21fe00 ior rega ,pdata 
7823 20600000 rtn 

bcd_pack:
7824 2a2ffe00 isolate1 0 ,rega 
7825 2020f828 branch bcd_pack_hi ,true 
7826 98002400 iforce regb 
7827 20600000 rtn 

bcd_pack_hi:
7828 1febfe00 lshift2 pdata ,pdata 
7829 1febfe00 lshift2 pdata ,pdata 
782a 9a41fe00 ior regb ,pdata 
782b e7e20005 istore 1 ,contw 
782c 18a08bfe increase -2 ,contw 
782d 20600000 rtn 

wait_div_end:
782e 207a8000 rtn modone 
782f 2020782e branch wait_div_end 

bcd2:
7830 67f00122 store 8 ,mem_pdatatemp 
7831 18007e20 force 0x20 ,pdata 
7832 18007208 force 8 ,loopcnt 
7833 d8a00028 arg mem_bcd ,contw 

lpo_clear:
7834 e7e20005 istore 1 ,contw 
7835 c2007834 loop lpo_clear 
7836 d8a00028 arg mem_bcd ,contw 
7837 18a08a07 increase 7 ,contw 
7838 6ff00122 fetch 8 ,mem_pdatatemp 

bcd_loop:
7839 1fe6fc0a div pdata ,10 
783a 2040782e call wait_div_end 
783b 18077e00 remainder pdata 
783c 1fe1fe30 or_into 0x30 ,pdata 
783d e7e20005 istore 1 ,contw 
783e 18a08bfe increase -2 ,contw 
783f 1807fe00 quotient pdata 
7840 207a0000 rtn blank 
7841 20207839 branch bcd_loop 

bcd:
7842 67f00122 store 8 ,mem_pdatatemp 
7843 18007e00 force 0 ,pdata 
7844 67f00028 store 8 ,mem_bcd 
7845 d8a00028 arg mem_bcd ,contw 
7846 18a08a07 increase 7 ,contw 
7847 6ff00122 fetch 8 ,mem_pdatatemp 
7848 18002200 force 0 ,rega 

bcd_pack_loop:
7849 1fe6fc0a div pdata ,10 
784a 2040782e call wait_div_end 
784b 18077e00 remainder pdata 
784c 20407824 call bcd_pack 
784d 1a20a201 increase 1 ,rega 
784e 1807fe00 quotient pdata 
784f 1fe67c09 sub pdata ,9 ,null 
7850 24217849 nbranch bcd_pack_loop ,positive 
7851 20407824 call bcd_pack 
7852 2a2ffe00 isolate1 0 ,rega 
7853 20608000 rtn true 
7854 e7e20005 istore 1 ,contw 
7855 20600000 rtn 

string_compare:
7856 efe20011 ifetch 1 ,rega 
7857 e8420012 ifetcht 1 ,regb 
7858 98467c00 isub temp ,null 
7859 24628000 nrtn zero 
785a 1a20a201 increase 1 ,rega 
785b 1a40a401 increase 1 ,regb 
785c c2007856 loop string_compare 
785d 18007c00 force 0 ,null 
785e 20600000 rtn 

ceiling:
785f 98467c00 isub temp ,null 
7860 24610000 nrtn positive 
7861 18427e00 deposit temp 
7862 20600000 rtn 

swap:
7863 9840fe00 iadd temp ,pdata 
7864 98460400 isub temp ,temp 
7865 98467e00 isub temp ,pdata 
7866 20600000 rtn 

clean_mem:
7867 df200200 arg 0x200 ,loopcnt 
7868 d8a04000 arg 0x4000 ,contw 
7869 2020775e branch memset0 

slave_savelist:
786a 6fea00a4 fetch 5 ,mem_sync_clke 
786b 67ea0122 store 5 ,mem_pdatatemp 
786c 6fe4420d fetch 2 ,mem_clks_per_lpo 
786d e7e40005 istore 2 ,contw 
786e 58000000 setarg 0 
786f 7936fe07 setflag match ,7 ,pdata 
7870 7935fe06 setflag wake ,6 ,pdata 
7871 792c7e05 setflag sync ,5 ,pdata 
7872 79377e04 setflag attempt ,4 ,pdata 
7873 e7e20005 istore 1 ,contw 
7874 20207883 branch savelist_2 

le_savelist:
7875 6fea00a4 fetch 5 ,mem_sync_clke 
7876 67ea0122 store 5 ,mem_pdatatemp 
7877 6fe243fa fetch 1 ,mem_le_ch_mapped 
7878 e7e20005 istore 1 ,contw 
7879 6fe404c7 fetch 2 ,mem_le_event_count 
787a d8c00fff arg 0x0fff ,contr 
787b 98c17e00 iand contr ,pdata 
787c 7936fe0f setflag match ,15 ,pdata 
787d 7935fe0e setflag wake ,14 ,pdata 
787e 792c7e0d setflag sync ,13 ,pdata 
787f 79377e0c setflag attempt ,12 ,pdata 
7880 e7e40005 istore 2 ,contw 
7881 20207883 branch savelist_2 

savelist:
7882 67f00122 store 8 ,mem_pdatatemp 

savelist_2:
7883 6fe2416c fetch 1 ,mem_seqi 
7884 c13f8000 rtneq 0x7f 
7885 1fe17e7f and_into 0x7f ,pdata 
7886 1fe9fe00 lshift3 pdata ,pdata 
7887 d8a04c00 arg mem_savelist ,contw 
7888 98a08a00 iadd contw ,contw 
7889 6ff00122 fetch 8 ,mem_pdatatemp 
788a e7f00005 istore 8 ,contw 
788b 6fe2416c fetch 1 ,mem_seqi 
788c 2feffe07 isolate1 7 ,pdata 
788d 1fe0fe01 increase 1 ,pdata 
788e 1fe17e7f and_into 0x7f ,pdata 
788f 7920fe07 setflag true ,7 ,pdata 
7890 67e2416c store 1 ,mem_seqi 
7891 6ff00122 fetch 8 ,mem_pdatatemp 
7892 20600000 rtn 

dirty_mem:
7893 df200800 arg 0x800 ,loopcnt 
7894 d8a00000 arg 0 ,contw 
7895 59010101 setarg 0x01010101 
7896 2020775f branch memset8 

callback_func:
7897 207a0000 rtn blank 
7898 1fe27a00 copy pdata ,pc 

wait_uarttx:
7899 6fe4830e fetch 2 ,core_uart_tx_items 
789a 243a7899 nbranch wait_uarttx ,blank 
789b 20600000 rtn 

get_uart_rrptr:
789c 68648058 fetchr contru ,2 ,core_uart_rx_rptr 
789d 20600000 rtn 

get_uart_twptr:
789e 6944805e fetchr contwu ,2 ,core_uart_tx_wptr 
789f 20600000 rtn 

send_mem_to_uart:
78a0 18c22200 copy contr ,rega 
78a1 2040789e call get_uart_twptr 
78a2 1a220c00 copy rega ,contr 

send_mem_to_uart0:
78a3 20405fee call uart_copy_tx_bytes 
78a4 20405e27 call uartd_send 
78a5 20207899 branch wait_uarttx 

ice_break:
78a6 70820301 jam 0x1 ,core_ice_ctrl 
78a7 20600000 rtn 

ice_setbp:
78a8 67e48205 store 2 ,core_ice_break0 
78a9 6fe28203 fetch 1 ,core_ice_ctrl 
78aa 79207e04 set1 4 ,pdata 
78ab 67e28203 store 1 ,core_ice_ctrl 
78ac 20600000 rtn 

ice_setbp2:
78ad 67e48207 store 2 ,core_ice_break1 
78ae 6fe28203 fetch 1 ,core_ice_ctrl 
78af 79207e06 set1 6 ,pdata 
78b0 67e28203 store 1 ,core_ice_ctrl 
78b1 20600000 rtn 

ice_set_write_bp:
78b2 67e48205 store 2 ,core_ice_break0 
78b3 70820330 jam 0x30 ,core_ice_ctrl 
78b4 20600000 rtn 

test_no_white:
78b5 6fe28043 fetch 1 ,core_config 
78b6 79207e04 set1 whiteoff_bit ,pdata 
78b7 67e28043 store 1 ,core_config 
78b8 20600000 rtn 

test_enable_white:
78b9 6fe28043 fetch 1 ,core_config 
78ba 793ffe04 set0 whiteoff_bit ,pdata 
78bb 67e28043 store 1 ,core_config 
78bc 20600000 rtn 

fifo_in:
78bd 477f403f bpatchx patch3f_6 ,mem_patch3f 
78be e84a0011 ifetcht util_fifo_len ,rega 
78bf 18417eff and temp ,0xff ,pdata 
78c0 243a78c3 nbranch fifo_in_push ,blank 
78c1 184cfe00 rshift8 temp ,pdata 
78c2 e7ea0011 istore util_fifo_len ,rega 

fifo_in_push:
78c3 1a20a204 increase util_fifo_len + util_fifo_offset ,rega 
78c4 efe20011 ifetch 1 ,rega 
78c5 243a3b25 nbranch assert ,blank 
78c6 6fe20b08 fetch 1 ,mem_fifo_temp 
78c7 e7e20011 istore 1 ,rega 
78c8 20600000 rtn 

fifo_out:
78c9 477fc03f bpatchx patch3f_7 ,mem_patch3f 
78ca df200005 arg util_fifo_len ,loopcnt 
78cb efea0011 ifetch util_fifo_len ,rega 
78cc 207a0000 rtn blank 

fifo_out_loop:
78cd efe20011 ifetch 1 ,rega 
78ce 243a78d2 nbranch fifo_out_end ,blank 
78cf 1a20a201 increase 1 ,rega 
78d0 c20078cd loop fifo_out_loop 
78d1 20203b25 branch assert 

fifo_out_end:
78d2 d8400000 arg 0 ,temp 
78d3 e0420011 istoret 1 ,rega 
78d4 20600000 rtn 

fifo_is_empty:
78d5 efea0011 ifetch util_fifo_len ,rega 
78d6 20600000 rtn 

fifo_is_full:
78d7 efe20011 ifetch 1 ,rega 
78d8 20600000 rtn 

fifo_is_near_full:
78d9 efe40011 ifetch 2 ,rega 
78da 20600000 rtn 

not_greater_than:
78db 98467c00 isub temp ,null 
78dc 24610000 nrtn positive 
78dd 18427e00 copy temp ,pdata 
78de 20600000 rtn 

greater_than:
78df 98467c00 isub temp ,null 
78e0 20610000 rtn positive 
78e1 18427e00 copy temp ,pdata 
78e2 20600000 rtn 

check_number_range:
78e3 1de20400 copy regext ,temp 
78e4 204078ee call int_diff 
78e5 242178ec nbranch disable_user ,positive 
78e6 1fe20400 copy pdata ,temp 
78e7 1de27e00 copy regext ,pdata 
78e8 9f20fe00 iadd loopcnt ,pdata 
78e9 204078ee call int_diff 
78ea 2022f8ec branch disable_user ,zero 
78eb 20217903 branch enable_user ,positive 

disable_user:
78ec 78547c00 disable user 
78ed 20600000 rtn 

int_diff:
78ee 98467c00 isub temp ,null 
78ef 2022f8fc branch enable_positive ,zero 
78f0 2feffe1f isolate1 31 ,pdata 
78f1 2020f8f6 branch int_diff_pdata_negative ,true 
78f2 284ffe1f isolate1 31 ,temp 
78f3 2020f8fc branch enable_positive ,true 
78f4 98467c00 isub temp ,null 
78f5 20600000 rtn 

int_diff_pdata_negative:
78f6 284c001f isolate0 31 ,temp 
78f7 2020f8fa branch disable_positive ,true 
78f8 98467c00 isub temp ,null 
78f9 20600000 rtn 

disable_positive:
78fa 18007dff force -1 ,null 
78fb 20600000 rtn 

enable_positive:

disable_zero:
78fc 18007c01 force 1 ,null 
78fd 20600000 rtn 

enable_zero:
78fe 18007c00 force 0 ,null 
78ff 20600000 rtn 

p_delay:
7900 20000001 nop 1 
7901 c2007900 loop p_delay 
7902 20600000 rtn 

enable_user:
7903 78347c00 enable user 
7904 20600000 rtn 

setarg1:
7905 58000001 setarg 1 
7906 20600000 rtn 

setarg0:
7907 58000000 setarg 0 
7908 20600000 rtn 

nv_store_le_reconn_info:
7909 6fec04bd fetch 6 ,mem_le_plap 
790a 67ec0175 store 6 ,mem_temp_lap 
790b 70017434 jam rec_4_mode ,mem_record_bt_mode 
790c 20207930 branch nv_updata_device_record 

nv_store_bd_reconn_info:
790d 6fec0040 fetch 6 ,mem_plap 
790e 67ec0175 store 6 ,mem_temp_lap 
790f 70017433 jam rec_3_mode ,mem_record_bt_mode 

nv_store_reconn_info:
7910 20207930 branch nv_updata_device_record 

nv_find_addr_from_bd_list:
7911 78547c00 disable user 
7912 6fe242e4 fetch 1 ,mem_nv_data_number 
7913 207a0000 rtn blank 
7914 6fe442e2 fetch 2 ,mem_nv_data_ptr 
7915 e842003f ifetcht 1 ,pdata 
7916 1fe0fe01 pincrease 1 
7917 67e4017b store 2 ,mem_list_item_ptr 
7918 60420173 storet 1 ,mem_select_list_item 
7919 6fe242e4 fetch 1 ,mem_nv_data_number 
791a 1fe22600 icopy regc 

nv_find_addr_from_list:
791b 6fe4017b fetch 2 ,mem_list_item_ptr 
791c 1fe22200 copy pdata ,rega 
791d 2040792b call nv_find_addr_from_list_compare 
791e 20740000 rtn user 
791f 6844017b fetcht 2 ,mem_list_item_ptr 
7920 18408418 increase nv_data_len ,temp 
7921 6044017b storet 2 ,mem_list_item_ptr 
7922 184085ff increase -1 ,temp 
7923 efe20002 ifetch 1 ,temp 
7924 67e20173 store 1 ,mem_select_list_item 
7925 1a60a7ff increase -1 ,regc 
7926 2422f91b nbranch nv_find_addr_from_list ,zero 
7927 6fe242e4 fetch 1 ,mem_nv_data_number 
7928 1fe0ffff pincrease decreased_one 
7929 67e20173 store 1 ,mem_select_list_item 
792a 20600000 rtn 

nv_find_addr_from_list_compare:
792b da400174 arg mem_temp_reconn_record ,regb 
792c df200007 arg 7 ,loopcnt 
792d 20407856 call string_compare 
792e 2022f903 branch enable_user ,zero 
792f 20600000 rtn 

nv_updata_device_record:
7930 6fe242e4 fetch 1 ,mem_nv_data_number 
7931 207a0000 rtn blank 
7932 2040795c call nv_check_nvram 
7933 24547954 ncall nv_init_device_list ,user 
7934 20407911 call nv_find_addr_from_bd_list 

nv_write_device_record:
7935 6fe242e4 fetch 1 ,mem_nv_data_number 
7936 1fe22600 icopy regc 
7937 684442e2 fetcht 2 ,mem_nv_data_ptr 
7938 6044017b storet 2 ,mem_list_item_ptr 

nv_write_device_loop_find:
7939 1a627e00 copy regc ,pdata 
793a 203a797c branch nv_store_device ,blank 
793b 1a60a7ff increase -1 ,regc 
793c 18422200 copy temp ,rega 
793d efe20011 ifetch 1 ,rega 
793e 68420173 fetcht 1 ,mem_select_list_item 
793f 98467c00 isub temp ,null 
7940 2042f949 call nv_set_index_finded_device ,zero 
7941 20217945 branch nv_write_device_loop_find0 ,positive 
7942 efe20011 ifetch 1 ,rega 
7943 1fe0fe01 increase 1 ,pdata 
7944 e7e20011 istore 1 ,rega 

nv_write_device_loop_find0:
7945 6844017b fetcht 2 ,mem_list_item_ptr 
7946 18408418 increase nv_data_len ,temp 
7947 6044017b storet 2 ,mem_list_item_ptr 
7948 20207939 branch nv_write_device_loop_find 

nv_set_index_finded_device:
7949 58000000 setarg 0 
794a e7e20011 istore 1 ,rega 
794b 6fee0174 fetch 7 ,mem_temp_reconn_record 
794c e7ee0005 istore 7 ,contw 
794d c099f952 bne rec_3_mode ,set_index_finded_device_ble_mode 
794e d8c04274 arg mem_link_key ,contr 

store_rec_data_common:
794f 20407758 call memcpy16 
7950 18007c01 force 1 ,null 
7951 20600000 rtn 

set_index_finded_device_ble_mode:
7952 d8c04446 arg mem_le_ltk ,contr 
7953 2020794f branch store_rec_data_common 

nv_init_device_list:
7954 6f2242e4 fetchr loopcnt ,1 ,mem_nv_data_number 
7955 684442e2 fetcht 2 ,mem_nv_data_ptr 
7956 58000000 setarg 0 

init_device_list_loop:
7957 e7e20002 istore 1 ,temp 
7958 18408418 increase nv_data_len ,temp 
7959 1fe0fe01 pincrease 1 
795a c2007957 loop init_device_list_loop 
795b 20600000 rtn 

nv_check_nvram:
795c 78547c00 disable user 
795d 6f2242e4 fetchr loopcnt ,1 ,mem_nv_data_number 
795e 1f20ffff add loopcnt ,-1 ,pdata 
795f 20628000 rtn zero 
7960 9f2fa200 imul32 loopcnt ,rega 
7961 1a232200 rshift rega ,rega 
7962 684442e2 fetcht 2 ,mem_nv_data_ptr 
7963 58000000 setarg 0 

nv_check_nvram_loop:
7964 ea420002 ifetchr regb ,1 ,temp 
7965 18408418 increase nv_data_len ,temp 
7966 9a40fe00 iadd regb ,pdata 
7967 c2007964 loop nv_check_nvram_loop 
7968 9a267c00 isub rega ,null 
7969 24628000 nrtn zero 
796a 20207903 branch enable_user 

nv_load_device_list:
796b 70017433 jam rec_3_mode ,mem_temp_reconn_record 
796c 6fec0040 fetch 6 ,mem_plap 
796d 67ec0175 store 6 ,mem_temp_reconn_record + 1 
796e 20407911 call nv_find_addr_from_bd_list 
796f 24347974 nbranch nv_clear_key_exists ,user 
7970 1a220c00 copy rega ,contr 
7971 d8a04274 arg mem_link_key ,contw 
7972 20407758 call memcpy16 
7973 20207976 branch nv_check_link_key_load 

nv_clear_key_exists:
7974 70427000 jam 0 ,mem_link_key_exists 
7975 20600000 rtn 

nv_check_link_key_load:
7976 6ff04274 fetch 8 ,mem_link_key 
7977 6850427c fetcht 8 ,mem_link_key + 8 
7978 9841fe00 ior temp ,pdata 
7979 207a0000 rtn blank 
797a 70427001 jam 1 ,mem_link_key_exists 
797b 20600000 rtn 

nv_store_device:
797c 6fe642d2 fetch 3 ,mem_ef_base 
797d c28bf983 bbit1 23 ,nv_flash_store_device 
797e 6fe242e4 fetch 1 ,mem_nv_data_number 
797f 1fef8418 mul32 pdata ,nv_data_len ,temp 
7980 6a2442e2 fetchr rega ,2 ,mem_nv_data_ptr 
7981 da400000 arg ef_nvram_offset ,regb 
7982 20205d58 branch iicd_write_eep_data 

nv_flash_store_device:
7983 6fe642d2 fetch 3 ,mem_ef_base 
7984 793ffe17 set0 23 ,pdata 
7985 d8400000 arg ef_nvram_offset ,temp 
7986 9840fe00 iadd temp ,pdata 
7987 67e60b4d store 3 ,mem_flash_address 
7988 6fe442e2 fetch 2 ,mem_nv_data_ptr 
7989 67e40b50 store 2 ,mem_flash_data_address 
798a 6fe242e4 fetch 1 ,mem_nv_data_number 
798b 1feffe18 mul32 pdata ,nv_data_len ,pdata 
798c 67e40b52 store 2 ,mem_flash_trans_length 
798d 20205f45 branch qspi_write 

nv_ng_load_nvram:
798e 6fe642d2 fetch 3 ,mem_ef_base 
798f c28bf995 bbit1 23 ,nv_flash_load_device 
7990 6fe242e4 fetch 1 ,mem_nv_data_number 
7991 1fef8418 mul32 pdata ,nv_data_len ,temp 
7992 6a2442e2 fetchr rega ,2 ,mem_nv_data_ptr 
7993 da400000 arg ef_nvram_offset ,regb 
7994 20205d32 branch iicd_read_eep_data 

nv_flash_load_device:
7995 6fe642d2 fetch 3 ,mem_ef_base 
7996 793ffe17 set0 23 ,pdata 
7997 d8400000 arg ef_nvram_offset ,temp 
7998 9840fe00 iadd temp ,pdata 
7999 67e60b4d store 3 ,mem_flash_address 
799a 6fe442e2 fetch 2 ,mem_nv_data_ptr 
799b 67e40b50 store 2 ,mem_flash_data_address 
799c 6fe242e4 fetch 1 ,mem_nv_data_number 
799d 1feffe18 mul32 pdata ,nv_data_len ,pdata 
799e 67e40b52 store 2 ,mem_flash_trans_length 
799f 20405f01 call qspi_nmode 
79a0 20405f25 call qspi_read 
79a1 2040795c call nv_check_nvram 
79a2 2442f954 ncall nv_init_device_list ,zero 
79a3 20600000 rtn 

nv_get_last_record_ptr:
79a4 6fe442e2 fetch 2 ,mem_nv_data_ptr 
79a5 1fe20c00 copy pdata ,contr 

nv_get_last_connect_address_loop:
79a6 efe20006 ifetch 1 ,contr 
79a7 c00079ab beq 0 ,nv_get_last_connect_rtn 
79a8 18c08c17 increase 23 ,contr 
79a9 202079a6 branch nv_get_last_connect_address_loop 
79aa 20600000 rtn 

nv_get_last_connect_rtn:
79ab 18c08c01 increase 1 ,contr 
79ac 18c22600 copy contr ,regc 
79ad 20600000 rtn 

tws_pairing:
79ae 20404e5b call le_enable 
79af 204079c3 call tws_m_wait_connecting 
79b0 20407ac5 call tws_s_wait_connecting 
79b1 20404e5f call le_disable 
79b2 20600000 rtn 

tws_handle_poll:
79b3 475f4037 bpatchx patch37_6 ,mem_patch37 
79b4 6fe246ea fetch 1 ,mem_tws_state 
79b5 c4018000 rtnbit0 tws_state_connected 
79b6 c3037b83 bbit0 tws_state_master ,tws_send_ack_process 
79b7 6fe246f8 fetch 1 ,mem_ack_interval_count 
79b8 243a79bc nbranch tws_decrease_ack_interval ,blank 
79b9 6fe246f7 fetch 1 ,mem_ack_interval 
79ba 67e246f8 store 1 ,mem_ack_interval_count 
79bb 20207a3b branch tws_wait_ack_process 

tws_decrease_ack_interval:
79bc 7046ec01 jam 1 ,mem_tws_rcv_long_pck 
79bd 1fe0ffff increase -1 ,pdata 
79be 67e246f8 store 1 ,mem_ack_interval_count 
79bf 20600000 rtn 

tws_m_conecting:
79c0 20404e5b call le_enable 
79c1 204079c3 call tws_m_wait_connecting 
79c2 20204e5f branch le_disable 

tws_m_wait_connecting:
79c3 475fc037 bpatchx patch37_7 ,mem_patch37 
79c4 6fe246ea fetch 1 ,mem_tws_state 
79c5 c4000000 rtnbit0 tws_state_enable 
79c6 c4010000 rtnbit0 tws_state_connecting 
79c7 c4030000 rtnbit0 tws_state_master 
79c8 d8e00001 arg le_adv_interval_timer ,queue 
79c9 204077ad call timer_check 
79ca 247a0000 nrtn blank 
79cb 204038db call calc_clke 
79cc 20407a18 call tws_set_master_slot 
79cd 78287c00 enable swfine 
79ce 6fe20000 fetch 1 ,mem_le_adv_transmit 
79cf 1fe0fe01 increase 1 ,pdata 
79d0 67e20000 store 1 ,mem_le_adv_transmit 
79d1 20407a38 call tws_reset_connecting 
79d2 20404fde call le_init_adv 
79d3 20404eb3 call le_next_adv_channel 
79d4 20407a22 call tws_send_connecting_info 

tws_m_wait_for_match:
79d5 2436f9e6 nbranch tws_send_info_not_match ,match 
79d6 6fec0367 fetch 6 ,mem_le_rxbuf + 2 
79d7 684c46e4 fetcht 6 ,mem_tws_bdaddr 
79d8 98467c00 isub temp ,null 
79d9 2422f9e6 nbranch tws_send_info_not_match ,zero 
79da 6fe20365 fetch 1 ,mem_le_rxbuf 
79db 1fe17e0f and pdata ,0x0f ,pdata 
79dc c081fa38 bne scan_req ,tws_reset_connecting 
79dd 6fe20bb8 fetch 1 ,mem_tws_connecting_phase 
79de c00079ee beq tws_connecting_phase0 ,tws_send_context_info_keymap 
79df c000fa95 beq tws_connecting_phase1 ,tws_send_context_info 
79e0 c0017a95 beq tws_connecting_phase2 ,tws_send_context_info 
79e1 c001fa95 beq tws_connecting_phase3 ,tws_send_context_info 
79e2 c0027a95 beq tws_connecting_phase4 ,tws_send_context_info 
79e3 c002fa95 beq tws_connecting_phase5 ,tws_send_context_info 
79e4 c00379fe beq tws_connecting_phase6 ,tws_send_context_info_phase_end 
79e5 20207a38 branch tws_reset_connecting 

tws_send_info_not_match:
79e6 47604038 bpatchx patch38_0 ,mem_patch38 
79e7 20407a38 call tws_reset_connecting 
79e8 20002710 nop 10000 
79e9 6fe243fa fetch 1 ,mem_le_ch_mapped 
79ea c093f9c3 bne 39 ,tws_m_wait_connecting 

tws_send_info_not_match_end:
79eb d8e00001 arg le_adv_interval_timer ,queue 
79ec 6fe444ec fetch 2 ,mem_le_adv_interval_max 
79ed 202077a6 branch timer_init 

tws_send_context_info_keymap:
79ee 4760c038 bpatchx patch38_1 ,mem_patch38 
79ef 18027e00 deposit mark 
79f0 67f00080 store 8 ,mem_mark_load 
79f1 700bb801 jam tws_connecting_phase1 ,mem_tws_connecting_phase 
79f2 20407a0f call tws_set_send_context_header 
79f3 5800ff1b setarg 0xff1b 
79f4 e7e40005 istore 2 ,contw 
79f5 d8c04274 arg mem_link_key ,contr 
79f6 18007210 force 16 ,loopcnt 
79f7 2040779f call memcpy 
79f8 d8c041e5 arg mem_afh_classify_channel_map ,contr 
79f9 1800720a force 10 ,loopcnt 
79fa 2040779f call memcpy 
79fb 7856fc00 disable match 
79fc 20407aa6 call tws_transmit_receive_sifs 
79fd 202079d5 branch tws_m_wait_for_match 

tws_send_context_info_phase_end:
79fe 47614038 bpatchx patch38_2 ,mem_patch38 
79ff 20407a0f call tws_set_send_context_header 
7a00 68420bb9 fetcht 1 ,mem_tws_context_offset 
7a01 e0420005 istoret 1 ,contw 
7a02 58004040 setarg mem_context 
7a03 98408c00 iadd temp ,contr 
7a04 1800721e force 30 ,loopcnt 
7a05 2040779f call memcpy 
7a06 7856fc00 disable match 
7a07 20407aa6 call tws_transmit_receive_sifs 
7a08 20407a38 call tws_reset_connecting 
7a09 6fe246ea fetch 1 ,mem_tws_state 
7a0a 79207e03 set1 tws_state_connected ,pdata 
7a0b 67e246ea store 1 ,mem_tws_state 
7a0c 6fe446f3 fetch 2 ,mem_wait_connected_timeout 
7a0d 67e446f1 store 2 ,mem_wait_connected_timeout_count 
7a0e 20600000 rtn 

tws_set_send_context_header:
7a0f 4761c038 bpatchx patch38_3 ,mem_patch38 
7a10 d8400004 arg scan_rsp ,temp 
7a11 793f8406 set0 le_sender_addr_bit ,temp 
7a12 60424409 storet 1 ,mem_le_txheader 
7a13 58000025 setarg 37 
7a14 67e2440a store 1 ,mem_le_txlen 
7a15 6fec46e4 fetch 6 ,mem_tws_bdaddr 
7a16 67ec440b store 6 ,mem_le_txpayload 
7a17 20600000 rtn 

tws_set_master_slot:
7a18 47624038 bpatchx patch38_4 ,mem_patch38 
7a19 d960079e arg 0x79e ,timeup 

tws_set_master_clk11:
7a1a 35330200 until clke_rt ,meet 
7a1b 1d020400 copy clke_bt ,temp 
7a1c 28400603 compare 3 ,temp ,3 
7a1d 2420fa1a nbranch tws_set_master_clk11 ,true 
7a1e 18421600 copy temp ,timeup 
7a1f 19609601 increase 1 ,timeup 
7a20 61680bb4 storer timeup ,4 ,mem_tws_sync_clk 
7a21 20600000 rtn 

tws_send_connecting_info:
7a22 4762c038 bpatchx patch38_5 ,mem_patch38 
7a23 70440900 jam 0 ,mem_le_txheader 
7a24 58000016 setarg 22 ,pdata 
7a25 67e2440a store 1 ,mem_le_txlen 
7a26 6fec46e4 fetch 6 ,mem_tws_bdaddr 
7a27 67ec440b store 6 ,mem_le_txpayload 
7a28 5800ff0d setarg 0xff0d 
7a29 e7e40005 istore 2 ,contw 
7a2a 6fe80bb4 fetch 4 ,mem_tws_sync_clk 
7a2b e7e80005 istore 4 ,contw 
7a2c 6fe442ad fetch 2 ,mem_avdtp_signal 
7a2d e7e40005 istore 2 ,contw 
7a2e 6fe442af fetch 2 ,mem_avdtp_media 
7a2f e7e40005 istore 2 ,contw 
7a30 6fe24296 fetch 1 ,mem_audio_allow 
7a31 e7e20005 istore 1 ,contw 
7a32 6fe242a3 fetch 1 ,mem_conf_sample_freq 
7a33 e7e20005 istore 1 ,contw 
7a34 78287c00 enable swfine 
7a35 db600708 arg 1800 ,stop_watch 
7a36 7856fc00 disable match 
7a37 20207aa6 branch tws_transmit_receive_sifs 

tws_reset_connecting:
7a38 700bb900 jam 0 ,mem_tws_context_offset 
7a39 700bb800 jam 0 ,mem_tws_connecting_phase 
7a3a 20600000 rtn 

tws_wait_ack_process:
7a3b 47634038 bpatchx patch38_6 ,mem_patch38 
7a3c 204036b6 call end_of_packet 
7a3d 20407a6c call tws_set_ack_access 
7a3e 20407ab9 call tws_set_dynamic_freq 
7a3f 204039aa call set_freq_rx 
7a40 20403a82 call start_receiver 
7a41 7826fc00 enable decode_fec0 
7a42 78287c00 enable swfine 
7a43 db6007d0 arg 2000 ,stop_watch 
7a44 37c18400 correlate null ,timeout 
7a45 7846fc00 disable decode_fec0 
7a46 242c7a57 nbranch tws_not_rcv_ack ,sync 
7a47 20407a73 call tws_receive_packet 
7a48 4763c038 bpatchx patch38_7 ,mem_patch38 
7a49 70470100 jam 0 ,mem_tws_loss_ack 
7a4a 6fe24700 fetch 1 ,mem_tws_ack 
7a4b 1fe0fe01 increase 1 ,pdata 
7a4c 67e24700 store 1 ,mem_tws_ack 
7a4d 6fe246ea fetch 1 ,mem_tws_state 
7a4e 79207e05 set1 tws_state_master_listening ,pdata 
7a4f 793ffe02 set0 tws_state_connecting ,pdata 
7a50 67e246ea store 1 ,mem_tws_state 
7a51 6fe446f3 fetch 2 ,mem_wait_connected_timeout 
7a52 67e446f1 store 2 ,mem_wait_connected_timeout_count 

tws_wait_ack_process_end:
7a53 6fe20019 fetch 1 ,mem_rx_type 
7a54 c000b6b6 beq type_poll ,end_of_packet 
7a55 c00036b6 beq type_null ,end_of_packet 
7a56 20203656 branch process_dmh_packet 

tws_not_rcv_ack:
7a57 47644039 bpatchx patch39_0 ,mem_patch39 
7a58 6fe246ea fetch 1 ,mem_tws_state 
7a59 c302fa53 bbit0 tws_state_master_listening ,tws_wait_ack_process_end 
7a5a 6fe24701 fetch 1 ,mem_tws_loss_ack 
7a5b 1fe0fe01 increase 1 ,pdata 
7a5c 67e24701 store 1 ,mem_tws_loss_ack 
7a5d c087fa67 bne tws_max_loss_ack ,tws_not_rcv_ack_error 
7a5e 6fe246fd fetch 1 ,mem_count_master_loss_link 
7a5f 1fe0fe01 increase 1 ,pdata 
7a60 67e246fd store 1 ,mem_count_master_loss_link 
7a61 70470100 jam 0 ,mem_tws_loss_ack 
7a62 6fe246ea fetch 1 ,mem_tws_state 
7a63 793ffe05 set0 tws_state_master_listening ,pdata 
7a64 79207e02 set1 tws_state_connecting ,pdata 
7a65 67e246ea store 1 ,mem_tws_state 
7a66 20207a67 branch tws_not_rcv_ack_error 

tws_not_rcv_ack_error:
7a67 4764c039 bpatchx patch39_1 ,mem_patch39 
7a68 6fe20019 fetch 1 ,mem_rx_type 
7a69 c000b6b6 beq type_poll ,end_of_packet 
7a6a c00036b6 beq type_null ,end_of_packet 
7a6b 202036a0 branch error_payload_crc 

tws_set_ack_access:
7a6c 47654039 bpatchx patch39_2 ,mem_patch39 
7a6d 18005a00 force 0 ,uap 
7a6e 6fe646e4 fetch 3 ,mem_tws_bdaddr 
7a6f 98005800 iforce lap 
7a70 782afc00 pulse recalc 
7a71 20000020 nop 32 
7a72 20600000 rtn 

tws_receive_packet:
7a73 4765c039 bpatchx patch39_3 ,mem_patch39 
7a74 6fe20019 fetch 1 ,mem_rx_type 
7a75 c1070000 rtneq type_dm5 
7a76 c1078000 rtneq type_dh5 
7a77 1c230400 rshift bt_clk ,temp 
7a78 18419c40 or temp ,0x40 ,white_init 
7a79 7823fc00 enable enable_white 
7a7a 78257c00 enable enable_hec 
7a7b 7825fc00 enable decode_fec1 
7a7c 09800003 parse demod ,bucket ,3 
7a7d 198cfe00 rshift8 pwindow ,pdata 
7a7e 67e246fb store 1 ,mem_tws_am_addr 
7a7f 09800004 parse demod ,bucket ,4 
7a80 08008007 inject bucket ,7 
7a81 19827e00 copy pwindow ,pdata 
7a82 67e246fa store 1 ,mem_tws_rx_type 
7a83 09800003 parse demod ,bucket ,3 
7a84 198cfe00 rshift8 pwindow ,pdata 
7a85 67e246fc store 1 ,mem_tws_arq 
7a86 09800008 parse demod ,bucket ,8 
7a87 7845fc00 disable decode_fec1 
7a88 78457c00 disable enable_hec 
7a89 20630000 rtn crc_failed 
7a8a 6fe44702 fetch 2 ,mem_tws_count_poll 
7a8b 1fe0fe01 increase 1 ,pdata 
7a8c 67e44702 store 2 ,mem_tws_count_poll 
7a8d 20600000 rtn 

tws_clear_connected_info:
7a8e 6fe246ea fetch 1 ,mem_tws_state 
7a8f c4000000 rtnbit0 tws_state_enable 
7a90 793ffe03 set0 tws_state_connected 
7a91 793ffe04 set0 tws_state_slave_listening 
7a92 793ffe05 set0 tws_state_master_listening 
7a93 67e246ea store 1 ,mem_tws_state 
7a94 20600000 rtn 

tws_send_context_info:
7a95 47664039 bpatchx patch39_4 ,mem_patch39 
7a96 20407a0f call tws_set_send_context_header 
7a97 68420bb9 fetcht 1 ,mem_tws_context_offset 
7a98 e0420005 istoret 1 ,contw 
7a99 58004040 setarg mem_context 
7a9a 98408c00 iadd temp ,contr 
7a9b 1800721e force 30 ,loopcnt 
7a9c 2040779f call memcpy 
7a9d 6fe20bb9 fetch 1 ,mem_tws_context_offset 
7a9e 1fe0fe1e increase 30 ,pdata 

tws_send_context_info0:
7a9f 67e20bb9 store 1 ,mem_tws_context_offset 
7aa0 6fe20bb8 fetch 1 ,mem_tws_connecting_phase 
7aa1 1fe0fe01 increase 1 ,pdata 
7aa2 67e20bb8 store 1 ,mem_tws_connecting_phase 

tws_send_context_info1:
7aa3 7856fc00 disable match 
7aa4 20407aa6 call tws_transmit_receive_sifs 
7aa5 202079d5 branch tws_m_wait_for_match 

tws_transmit_receive_sifs:
7aa6 4766c039 bpatchx patch39_5 ,mem_patch39 
7aa7 20404f37 call le_transmit 

tws_transmit_receive_sifs_notx:
7aa8 68420017 fetcht 1 ,mem_last_freq 
7aa9 204039aa call set_freq_rx 
7aaa 204039ae call rf_rx_enable 
7aab 78287c00 enable swfine 
7aac d9601388 arg 5000 ,timeup 

tws_receive_rxon:
7aad 20404e64 call le_prep 
7aae 7856fc00 disable match 
7aaf 7826fc00 enable decode_fec0 
7ab0 7830fc00 enable is_rx 
7ab1 78507c00 disable is_tx 
7ab2 19623600 copy timeup ,stop_watch 
7ab3 37c18400 correlate null ,timeout 
7ab4 242c36b6 nbranch end_of_packet ,sync 
7ab5 2437fab8 nbranch tws_transmit_receive_sifs_end ,user3 
7ab6 dd2001e0 arg param_clke_cal_le ,clke_rt 
7ab7 18005000 force 0 ,clke_bt 

tws_transmit_receive_sifs_end:
7ab8 20204f10 branch le_receive_skip 

tws_set_dynamic_freq:
7ab9 47674039 bpatchx patch39_6 ,mem_patch39 
7aba 68420017 fetcht 1 ,mem_last_freq 
7abb 18408405 increase 5 ,temp 
7abc 18467c4e sub temp ,78 ,null 
7abd 20610000 rtn positive 
7abe 18427e00 copy temp ,pdata 
7abf d840004e arg 78 ,temp 
7ac0 98460400 isub temp ,temp 
7ac1 20600000 rtn 

tws_s_conecting:
7ac2 20404e5b call le_enable 
7ac3 20407ac5 call tws_s_wait_connecting 
7ac4 20204e5f branch le_disable 

tws_s_wait_connecting:
7ac5 4767c039 bpatchx patch39_7 ,mem_patch39 
7ac6 6fe246ea fetch 1 ,mem_tws_state 
7ac7 c4000000 rtnbit0 tws_state_enable 
7ac8 c4010000 rtnbit0 tws_state_connecting 
7ac9 c3830000 rtnbit1 tws_state_master 
7aca d8e00003 arg le_scan_interval_timer ,queue 
7acb 204077ad call timer_check 
7acc 247a0000 nrtn blank 
7acd 6fe443ac fetch 2 ,mem_le_scan_interval 
7ace 684443ae fetcht 2 ,mem_le_scan_window 
7acf 98467e00 isub temp ,pdata 
7ad0 d8e00003 arg le_scan_interval_timer ,queue 
7ad1 204077a6 call timer_init 
7ad2 7854fc00 disable master 
7ad3 20407a38 call tws_reset_connecting 
7ad4 20404fde call le_init_adv 
7ad5 7837fc00 enable user3 
7ad6 20407bc4 call tws_wait_adv 
7ad7 7857fc00 disable user3 

tws_s_connecting_wait_match:
7ad8 2436fa38 nbranch tws_reset_connecting ,match 
7ad9 6fe246ff fetch 1 ,mem_tws_adv_match 
7ada 1fe0fe01 increase 1 ,pdata 
7adb 67e246ff store 1 ,mem_tws_adv_match 
7adc 6fe20bb8 fetch 1 ,mem_tws_connecting_phase 
7add c0007ae6 beq tws_connecting_phase0 ,tws_rcv_context_info_btclk 
7ade c000faff beq tws_connecting_phase1 ,tws_rcv_context_info_keymap 
7adf c0017bb1 beq tws_connecting_phase2 ,tws_rcv_context_info_memcontext 
7ae0 c001fbb1 beq tws_connecting_phase3 ,tws_rcv_context_info_memcontext 
7ae1 c0027bb1 beq tws_connecting_phase4 ,tws_rcv_context_info_memcontext 
7ae2 c002fbb1 beq tws_connecting_phase5 ,tws_rcv_context_info_memcontext 
7ae3 c0037bb1 beq tws_connecting_phase6 ,tws_rcv_context_info_memcontext 
7ae4 c003fb0f beq tws_connecting_phase7 ,tws_rcv_context_info_phase_end 
7ae5 20207a38 branch tws_reset_connecting 

tws_rcv_context_info_btclk:
7ae6 4768403a bpatchx patch3a_0 ,mem_patch3a 
7ae7 20407b41 call tws_check_bdaddr_is_match 
7ae8 2422fa38 nbranch tws_reset_connecting ,zero 
7ae9 6fe4036d fetch 2 ,mem_le_rxbuf + 8 
7aea d840ff0d arg 0xff0d ,temp 
7aeb 98467c00 isub temp ,null 
7aec 2422fa38 nbranch tws_reset_connecting ,zero 
7aed efe80006 ifetch 4 ,contr 
7aee 1fe21600 copy pdata ,timeup 
7aef efe40006 ifetch 2 ,contr 
7af0 67e442ad store 2 ,mem_avdtp_signal 
7af1 efe40006 ifetch 2 ,contr 
7af2 67e442af store 2 ,mem_avdtp_media 
7af3 efe20006 ifetch 1 ,contr 
7af4 67e24296 store 1 ,mem_audio_allow 
7af5 efe20006 ifetch 1 ,contr 
7af6 67e242a3 store 1 ,mem_conf_sample_freq 
7af7 1d027e00 deposit clke_bt 
7af8 99609600 iadd timeup ,timeup 
7af9 19625000 copy timeup ,clke_bt 
7afa 18005200 force 0 ,clke_rt 
7afb 204038cd call calc_clke_offset 
7afc 700bb801 jam tws_connecting_phase1 ,mem_tws_connecting_phase 
7afd 20407b37 call tws_send_info_request 
7afe 20207ad8 branch tws_s_connecting_wait_match 

tws_rcv_context_info_keymap:
7aff 4768c03a bpatchx patch3a_1 ,mem_patch3a 
7b00 20407b41 call tws_check_bdaddr_is_match 
7b01 2422fa38 nbranch tws_reset_connecting ,zero 
7b02 6fe4036d fetch 2 ,mem_le_rxbuf + 8 
7b03 d840ff1b arg 0xff1b ,temp 
7b04 98467c00 isub temp ,null 
7b05 2422fa38 nbranch tws_reset_connecting ,zero 
7b06 d8a04274 arg mem_link_key ,contw 
7b07 18007210 force 16 ,loopcnt 
7b08 2040779f call memcpy 
7b09 d8a041e5 arg mem_afh_classify_channel_map ,contw 
7b0a 1800720a force 10 ,loopcnt 
7b0b 2040779f call memcpy 
7b0c 700bb802 jam tws_connecting_phase2 ,mem_tws_connecting_phase 
7b0d 20407b37 call tws_send_info_request 
7b0e 20207ad8 branch tws_s_connecting_wait_match 

tws_rcv_context_info_phase4:

tws_rcv_context_info_phase_end:
7b0f 4769403a bpatchx patch3a_2 ,mem_patch3a 
7b10 20407b41 call tws_check_bdaddr_is_match 
7b11 2422fa38 nbranch tws_reset_connecting ,zero 
7b12 6fe20bb9 fetch 1 ,mem_tws_context_offset 
7b13 6842036d fetcht 1 ,mem_le_rxbuf + 8 
7b14 98467c00 isub temp ,null 
7b15 2422fa38 nbranch tws_reset_connecting ,zero 
7b16 58004040 setarg mem_context 
7b17 98408a00 iadd temp ,contw 
7b18 1800721e force 30 ,loopcnt 
7b19 2040779f call memcpy 
7b1a 20407a38 call tws_reset_connecting 
7b1b 6fe246ea fetch 1 ,mem_tws_state 
7b1c 793ffe02 set0 tws_state_connecting ,pdata 
7b1d 79207e03 set1 tws_state_connected ,pdata 
7b1e 67e246ea store 1 ,mem_tws_state 
7b1f da204040 arg mem_context ,rega 
7b20 20403232 call context_load 
7b21 70427001 jam 1 ,mem_link_key_exists 
7b22 6ff00080 fetch 8 ,mem_mark_load 
7b23 1fe20000 copy pdata ,mark 
7b24 7854fc00 disable master 
7b25 58001420 setarg 0x1420 
7b26 67e4003e store 2 ,mem_rx_window 

tws_slave_wait_match:
7b27 20207b5f branch tws_slave_scan_adv 

tws_slave_wait_match_loop:
7b28 20407b46 call tws_slave_listen 
7b29 2036b24f branch context_save ,match 
7b2a 6fe446f5 fetch 2 ,mem_loss_match 
7b2b d8400320 arg 800 ,temp 
7b2c 98467c00 isub temp ,null 
7b2d 20217b27 branch tws_slave_wait_match ,positive 
7b2e 20207b28 branch tws_slave_wait_match_loop 

tws_check_master_a2dp_start:
7b2f 4769c03a bpatchx patch3a_3 ,mem_patch3a 
7b30 6fe24296 fetch 1 ,mem_audio_allow 
7b31 c1808000 rtnne avd_audio_allow 
7b32 20405fb8 call sbc_hw_wait 
7b33 2040442f call hp_stero_init 
7b34 20205f88 branch sbc_hw_check_err 

tws_check_master_sco_start:
7b35 c6958000 rtnmark0 mark_sco_flag 
7b36 2020479f branch hfp_voice_start 

tws_send_info_request:
7b37 476a403a bpatchx patch3a_4 ,mem_patch3a 
7b38 d8400c03 arg 0x0c03 ,temp 
7b39 793f8406 set0 le_sender_addr_bit ,temp 
7b3a 793f8407 set0 le_receiver_addr_bit ,temp 
7b3b 60444409 storet 2 ,mem_le_txheader 
7b3c 6fec46e4 fetch 6 ,mem_tws_bdaddr 
7b3d e7ec0005 istore 6 ,contw 
7b3e 6fec46e4 fetch 6 ,mem_tws_bdaddr 
7b3f e7ec0005 istore 6 ,contw 
7b40 20207aa6 branch tws_transmit_receive_sifs 

tws_check_bdaddr_is_match:
7b41 6fec0367 fetch 6 ,mem_le_rxbuf + 2 
7b42 684c46e4 fetcht 6 ,mem_tws_bdaddr 
7b43 98467c00 isub temp ,null 
7b44 2442fa38 ncall tws_reset_connecting ,zero 
7b45 20600000 rtn 

tws_slave_listen:
7b46 476ac03a bpatchx patch3a_5 ,mem_patch3a 
7b47 20404e5f call le_disable 
7b48 204038de call calc_clke_tws 
7b49 2040343f call role_switch_slave 
7b4a 20740000 rtn user 
7b4b 2040353d call slave_receive_notsniff 
7b4c 2040355e call tws_slave_conn_recv_packet 
7b4d 2436fb5b nbranch tws_slave_listen_not_match ,match 
7b4e 20407b2f call tws_check_master_a2dp_start 
7b4f 20407b35 call tws_check_master_sco_start 
7b50 58000000 setarg 0 
7b51 67e446f5 store 2 ,mem_loss_match 
7b52 6fe246ea fetch 1 ,mem_tws_state 
7b53 79207e04 set1 tws_state_slave_listening ,pdata 
7b54 67e246ea store 1 ,mem_tws_state 
7b55 58000380 setarg 0x380 
7b56 67e4003e store 2 ,mem_rx_window 
7b57 20405451 call parse_lmp_tws 
7b58 2040379a call parse_l2cap 
7b59 204038cd call calc_clke_offset 
7b5a 20600000 rtn 

tws_slave_listen_not_match:
7b5b 6fe446f5 fetch 2 ,mem_loss_match 
7b5c 1fe0fe01 increase 1 ,pdata 
7b5d 67e446f5 store 2 ,mem_loss_match 
7b5e 20600000 rtn 

tws_slave_scan_adv:
7b5f 476b403a bpatchx patch3a_6 ,mem_patch3a 
7b60 58000000 setarg 0 
7b61 67e446f5 store 2 ,mem_loss_match 
7b62 20000bb8 nop 3000 
7b63 20404e5b call le_enable 
7b64 7854fc00 disable master 
7b65 78577c00 disable attempt 
7b66 20404fde call le_init_adv 
7b67 7837fc00 enable user3 
7b68 20407bc4 call tws_wait_adv 
7b69 7857fc00 disable user3 
7b6a 2436fb5f nbranch tws_slave_scan_adv ,match 
7b6b 20407b41 call tws_check_bdaddr_is_match 
7b6c 2422fb5f nbranch tws_slave_scan_adv ,zero 
7b6d 6fe4036d fetch 2 ,mem_le_rxbuf + 8 
7b6e d840ff0d arg 0xff0d ,temp 
7b6f 98467c00 isub temp ,null 
7b70 2422fb5f nbranch tws_slave_scan_adv ,zero 
7b71 efe80006 ifetch 4 ,contr 
7b72 1fe21600 copy pdata ,timeup 
7b73 efe40006 ifetch 2 ,contr 
7b74 67e442ad store 2 ,mem_avdtp_signal 
7b75 efe40006 ifetch 2 ,contr 
7b76 67e442af store 2 ,mem_avdtp_media 
7b77 efe20006 ifetch 1 ,contr 
7b78 67e24296 store 1 ,mem_audio_allow 
7b79 efe20006 ifetch 1 ,contr 
7b7a 67e242a3 store 1 ,mem_conf_sample_freq 
7b7b 1d027e00 deposit clke_bt 
7b7c 99609600 iadd timeup ,timeup 
7b7d 19625000 copy timeup ,clke_bt 
7b7e 204038cd call calc_clke_offset 
7b7f 6fe246fe fetch 1 ,mem_count_rcv_adv 
7b80 1fe0fe01 increase 1 ,pdata 
7b81 67e246fe store 1 ,mem_count_rcv_adv 
7b82 20207b28 branch tws_slave_wait_match_loop 

tws_send_ack_process:
7b83 476bc03a bpatchx patch3a_7 ,mem_patch3a 
7b84 18227e00 deposit type 
7b85 67e246f9 store 1 ,mem_tws_temp 
7b86 18000210 force type_id ,type 
7b87 6fe20019 fetch 1 ,mem_rx_type 
7b88 c0077b8b beq type_dm5 ,tws_send_ack_process0 
7b89 c007fb8b beq type_dh5 ,tws_send_ack_process0 
7b8a 18000200 force type_null ,type 

tws_send_ack_process0:
7b8b 784efc00 disable encode_fec0 
7b8c 784e7c00 disable encode_fec2 
7b8d 7846fc00 disable decode_fec0 
7b8e 78467c00 disable decode_fec2 
7b8f 7844fc00 disable enable_crc 
7b90 78477c00 disable encrypt 
7b91 7843fc00 disable enable_white 
7b92 20407a6c call tws_set_ack_access 
7b93 20407ab9 call tws_set_dynamic_freq 
7b94 204039b7 call set_freq_tx 
7b95 20403aea call start_transmitter 
7b96 20403afd call send_access_word 
7b97 204037df call transmit_packet 
7b98 476c403b bpatchx patch3b_0 ,mem_patch3b 

tws_slave_rcv_ack:
7b99 6fe24700 fetch 1 ,mem_tws_ack 
7b9a 1fe0fe01 increase 1 ,pdata 
7b9b 67e24700 store 1 ,mem_tws_ack 
7b9c 6fe246f9 fetch 1 ,mem_tws_temp 
7b9d 1fe20200 copy pdata ,type 
7b9e c507b689 bmark1 mark_old_packet ,ack_payload 
7b9f 6fe20019 fetch 1 ,mem_rx_type 
7ba0 c000b6b6 beq type_poll ,end_of_packet 
7ba1 c00036b6 beq type_null ,end_of_packet 
7ba2 20203656 branch process_dmh_packet 

tws_handle_old_packet:
7ba3 476cc03b bpatchx patch3b_1 ,mem_patch3b 
7ba4 20000064 nop 100 
7ba5 d8400b0d arg mem_temp ,temp 

tws_discard_packet:
7ba6 09800008 parse demod ,bucket ,8 
7ba7 19897e00 rshift3 pwindow ,pdata 
7ba8 e7e20002 istore 1 ,temp 
7ba9 c2007ba6 loop tws_discard_packet 
7baa 2020364d branch process_dmh_data_end 

tws_check_is_tws_slave:
7bab 78547c00 disable user 
7bac 6fe246ea fetch 1 ,mem_tws_state 
7bad c4000000 rtnbit0 tws_state_enable 
7bae c3830000 rtnbit1 tws_state_master 
7baf 78347c00 enable user 
7bb0 20600000 rtn 

tws_rcv_context_info_memcontext:
7bb1 476d403b bpatchx patch3b_2 ,mem_patch3b 
7bb2 20407b41 call tws_check_bdaddr_is_match 
7bb3 2422fa38 nbranch tws_reset_connecting ,zero 
7bb4 6fe20bb9 fetch 1 ,mem_tws_context_offset 
7bb5 6842036d fetcht 1 ,mem_le_rxbuf + 8 
7bb6 98467c00 isub temp ,null 
7bb7 2422fa38 nbranch tws_reset_connecting ,zero 
7bb8 58004040 setarg mem_context 
7bb9 98408a00 iadd temp ,contw 
7bba 1800721e force 30 ,loopcnt 
7bbb 2040779f call memcpy 
7bbc 6fe20bb9 fetch 1 ,mem_tws_context_offset 
7bbd 1fe0fe1e increase 30 ,pdata 
7bbe 67e20bb9 store 1 ,mem_tws_context_offset 
7bbf 6fe20bb8 fetch 1 ,mem_tws_connecting_phase 
7bc0 1fe0fe01 increase 1 ,pdata 
7bc1 67e20bb8 store 1 ,mem_tws_connecting_phase 
7bc2 20407b37 call tws_send_info_request 
7bc3 20207ad8 branch tws_s_connecting_wait_match 

tws_wait_adv:
7bc4 476dc03b bpatchx patch3b_3 ,mem_patch3b 
7bc5 6fe20001 fetch 1 ,mem_le_adv_waitcnt 
7bc6 1fe0fe01 increase 1 ,pdata 
7bc7 67e20001 store 1 ,mem_le_adv_waitcnt 
7bc8 20404eb3 call le_next_adv_channel 
7bc9 78487c00 disable swfine 
7bca 696443ae fetchr timeup ,2 ,mem_le_scan_window 
7bcb 20404e6e call lerx_setfreq 
7bcc 20207aad branch tws_receive_rxon 
org 0x10001

z_entrance0:
10001 c0008004  beq zcode_01 ,z_parse_lmp_accepted
10002 c001000f  beq zcode_02 ,z_parse_lmp_not_accepted
10003 20600000  rtn

z_parse_lmp_accepted:
10004 6fe205c3  fetch 1 ,mem_rxbuf + 1
10005 67e2052d  store 1 ,mem_lmi_accepted_opcode
10006 c0198008  beq lmp_host_connection_req ,z_parse_lmp_accepted_hostconn
10007 20205556  branch parse_lmp_accepted + 3

z_parse_lmp_accepted_hostconn:
10008 6fe20535  fetch 1 ,mem_lmp_conn_state
10009 79207e00  set1 received_conn_req ,pdata
1000a 67e20535  store 1 ,mem_lmp_conn_state
1000b 700b0801  jam bt_evt_bb_connected ,mem_fifo_temp
1000c 204071ee  call ui_ipc_send_event
1000d 70007c8b  jam lmp_packet_type_table_req ,mem_lmo_opcode2
1000e 20600000  rtn

z_parse_lmp_not_accepted:
1000f 6fe205c3  fetch 1 ,mem_rxbuf + 1
10010 67e2052d  store 1 ,mem_lmi_accepted_opcode
10011 c00b8013  beq lmp_sniff_req ,z_parse_lmp_not_accept_sniff_req
10012 20205569  branch parse_lmp_not_accepted + 3

z_parse_lmp_not_accept_sniff_req:
10013 6fe442b3  fetch 2 ,mem_sniff_param_interval
10014 1fe0ffec  increase -20 ,pdata
10015 1fe67c3f  sub pdata ,0x3f ,null
10016 20610000  rtn positive
10017 67e442b3  store 2 ,mem_sniff_param_interval
10018 2020424f  branch app_bt_enter_sniff
org 0x20001

z_hfp_hsp_process:
20001 20404a61  call l2cap_malloc_is_fifo_empty
20002 247a0000  nrtn blank
20003 6fe24312  fetch 1 ,mem_hf_state
20004 c0048006  beq hf_state_connected ,z_hfp_connected
20005 20204517  branch hfp_hsp_process + 4

z_hfp_connected:
20006 6fe24a00  fetch 1 ,mem_hfp_battery_state
20007 207a0000  rtn blank
20008 c0008010  beq hf_state_waiting_cscs ,z_hfp_send_cscs
20009 c0018014  beq hf_state_waiting_nerc ,z_hfp_send_nerc
2000a c0028018  beq hf_state_waiting_bia ,z_hfp_send_bia
2000b c003801c  beq hf_state_waiting_xapl ,z_hfp_send_xapl
2000c c0048020  beq hf_state_waiting_xevent ,z_hfp_send_xevent
2000d c0060024  beq hf_state_waiting_android ,z_hfp_send_android_bat
2000e c007002b  beq hf_state_waiting_iphone ,z_hfp_send_iphone_bat
2000f 20600000  rtn

z_hfp_send_cscs:
20010 204045a4  call hfp_send_credit_return
20011 704a0002  jam hf_state_waiting_cscs_ok ,mem_hfp_battery_state
20012 da204a2f  arg mem_at_cscs ,rega
20013 20200032  branch z_hfp_set_content

z_hfp_send_nerc:
20014 204045a4  call hfp_send_credit_return
20015 704a0004  jam hf_state_waiting_nerc_ok ,mem_hfp_battery_state
20016 da204a40  arg mem_at_nerc ,rega
20017 20200032  branch z_hfp_set_content

z_hfp_send_bia:
20018 204045a4  call hfp_send_credit_return
20019 704a0006  jam hf_state_waiting_bia_ok ,mem_hfp_battery_state
2001a da204a4b  arg mem_at_bia ,rega
2001b 20200032  branch z_hfp_set_content

z_hfp_send_xapl:
2001c 204045a4  call hfp_send_credit_return
2001d 704a0008  jam hf_state_waiting_xapl_ok ,mem_hfp_battery_state
2001e da204a61  arg mem_at_xapl ,rega
2001f 20200032  branch z_hfp_set_content

z_hfp_send_xevent:
20020 204045a4  call hfp_send_credit_return
20021 704a000a  jam hf_state_waiting_xevent_ok ,mem_hfp_battery_state
20022 da204a77  arg mem_at_xevent ,rega
20023 20200032  branch z_hfp_set_content

z_hfp_send_android_bat:
20024 204045a4  call hfp_send_credit_return
20025 704a000d  jam hf_state_waiting_android_ok ,mem_hfp_battery_state
20026 6fe24a25  fetch 1 ,mem_bat_level
20027 1fe0fe30  add pdata ,0x30 ,pdata
20028 67e24a9e  store 1 ,mem_at_android + 15
20029 da204a8f  arg mem_at_android ,rega
2002a 20200032  branch z_hfp_set_content

z_hfp_send_iphone_bat:
2002b 204045a4  call hfp_send_credit_return
2002c 704a000f  jam hf_state_waiting_iphone_ok ,mem_hfp_battery_state
2002d 6fe24a25  fetch 1 ,mem_bat_level
2002e 1fe0fe30  add pdata ,0x30 ,pdata
2002f 67e24ab4  store 1 ,mem_at_iphone + 20
20030 da204aa0  arg mem_at_iphone ,rega
20031 20200032  branch z_hfp_set_content

z_hfp_set_content:
20032 6fe40bc7  fetch 2 ,mem_zcode_temp_param1
20033 20207897  branch callback_func
org 0x30001

z_parse_lmp:
30001 6fe2007d  fetch 1 ,mem_lmi_opcode2
30002 c0108009  beq lmp_max_power ,z_parse_lmp_max_power
30003 c008802f  beq lmp_start_encryption_req ,z_parse_lmp_start_encryption_req
30004 c0058032  beq lmp_au_rand ,z_parse_lmp_au_rand
30005 c00b8020  beq lmp_sniff_req ,z_parse_lmp_sniff_req
30006 c009d6ab  beq lmp_switch_req ,parse_lmp_switch_req + 1
30007 c006000b  beq lmp_sres ,z_parse_lmp_sres
30008 20205462  branch parse_lmp0

z_parse_lmp_max_power:
30009 700b0877  jam bt_evt_max_power ,mem_fifo_temp
3000a 2020485e  branch ipc_tx_bt_event

z_parse_lmp_sres:
3000b da200040  arg mem_plap ,rega
3000c 2040672f  call function_e1
3000d 6fe805c3  fetch 4 ,mem_rxbuf + 1
3000e 68480603  fetcht 4 ,mem_input_store
3000f 98467c00  isub temp ,null
30010 20228014  branch z_authentication_ok ,zero
30011 70007c07  jam lmp_detach ,mem_lmo_opcode2
30012 70052e05  jam authentication_failure_error ,mem_disconn_reason_send
30013 20600000  rtn

z_authentication_ok:
30014 20405639  call authentication_ok_common
30015 6fe20055  fetch 1 ,mem_reconn_lmp_sm
30016 1fe67c11  sub pdata ,conn_sm_auth_wait ,null
30017 2042801b  call z_authentication_ok_conn_sm ,zero
30018 6fe246a0  fetch 1 ,mem_ssp_enable
30019 203a56f9  branch pairing_success ,blank
3001a 20600000  rtn

z_authentication_ok_conn_sm:
3001b 6fe20a26  fetch 1 ,mem_pairing_auth
3001c c1800000  rtnne defalt_pairing_auth
3001d 6fe2004c  fetch 1 ,mem_state_map
3001e c3810000  rtnbit1 smap_encryption
3001f 20205bb7  branch host_create_conn_encrypt

z_parse_lmp_sniff_req:
30020 6fe20031  fetch 1 ,mem_mode
30021 c28356a2  bbit1 acl_in_sniff ,lmp_reject_sniff
30022 c515d6a2  bmark1 mark_sco_flag ,lmp_reject_sniff
30023 6fe405c8  fetch 2 ,mem_rxbuf + 6
30024 203a56a2  branch lmp_reject_sniff ,blank
30025 684405c6  fetcht 2 ,mem_rxbuf + 4
30026 58000040  setarg min_sniff_interval
30027 98467c00  isub temp ,null
30028 20215691  branch parse_lmp_sniff_request ,positive

z_lmp_reject_sniff:
30029 204056a2  call lmp_reject_sniff
3002a 58000040  setarg min_sniff_interval
3002b 67e442b3  store 2 ,mem_sniff_param_interval
3002c 58010001  setarg 0x10001
3002d 67e842b5  store 4 ,mem_sniff_param_attempt
3002e 2020424f  branch app_bt_enter_sniff

z_parse_lmp_start_encryption_req:
3002f 700b0867  jam bt_evt_enc_connected ,mem_fifo_temp
30030 2040485e  call ipc_tx_bt_event
30031 202056a4  branch parse_lmp_start_encryption_req

z_parse_lmp_au_rand:
30032 6fe20a26  fetch 1 ,mem_pairing_auth
30033 205a0035  call z_check_tws_peer_device ,blank
30034 2020561c  branch parse_lmp_au_rand + 2

z_check_tws_peer_device:
30035 70427001  jam 1 ,mem_link_key_exists
30036 6fec0040  fetch 6 ,mem_plap
30037 684c49b3  fetcht 6 ,mem_tws_peer_lap
30038 98467c00  isub temp ,null
30039 20628000  rtn zero
3003a 70427000  jam 0 ,mem_link_key_exists
3003b 20600000  rtn
org 0x40001
40001 c0180003  beq zcode_30 ,z_tws_rcv_context_info_phase_end
40002 20600000  rtn

z_tws_rcv_context_info_phase_end:
40003 20400646  call p_tws_check_header
40004 24740000  nrtn user
40005 1800721e  force 30 ,loopcnt
40006 d8a04363  arg mem_l2cap_active_ch_count ,contw
40007 2040779f  call memcpy
40008 18007204  force 4 ,loopcnt
40009 d8a04292  arg mem_avdtp_xmem_start ,contw
4000a 2040779f  call memcpy
4000b 18007213  force 19 ,loopcnt
4000c d8a04312  arg mem_xmem_hf_state_start ,contw
4000d 2040779f  call memcpy
4000e 20407a38  call tws_reset_connecting
4000f 20404236  call app_bt_stop_discovery
40010 6fe246ea  fetch 1 ,mem_tws_state
40011 1fe1fe09  or pdata ,0x09 ,pdata
40012 793ffe02  set0 tws_state_connecting ,pdata
40013 67e246ea  store 1 ,mem_tws_state
40014 6fe24057  fetch 1 ,mem_context + coffset_arq
40015 793ffe03  set0 wack ,pdata
40016 67e24057  store 1 ,mem_context + coffset_arq
40017 6fe2405b  fetch 1 ,mem_context + coffset_op
40018 793ffe06  set0 op_txl2cap ,pdata
40019 67e2405b  store 1 ,mem_context + coffset_op
4001a 70405800  jam 0 ,mem_context + coffset_lmp_to_send
4001b da204040  arg mem_context ,rega
4001c 20403232  call context_load
4001d 6fe20031  fetch 1 ,mem_mode
4001e c3010023  bbit0 afh_enable ,z_no_afh
4001f 793ffe03  set0 afh_change ,pdata
40020 67e20031  store 1 ,mem_mode
40021 20403934  call afh_process_freq_map
40022 70417800  jam 0 ,mem_afh_new_mod

z_no_afh:
40023 d8c04090  arg mem_context + 80 ,contr
40024 d8a00080  arg mem_state + 80 ,contw
40025 1800720a  force 10 ,loopcnt
40026 20407792  call memcpy_fast
40027 58000000  setarg 0
40028 67f04090  store 8 ,mem_context + 80
40029 67f040e0  store 8 ,mem_context + 160
4002a 70427001  jam 1 ,mem_link_key_exists
4002b 68100080  fetchr mark ,8 ,mem_mark_load
4002c 7854fc00  disable master
4002d 7049f200  jam 0 ,mem_tws_adv_try_num
4002e 58001420  setarg 0x1420
4002f 67e4003e  store 2 ,mem_rx_window
40030 20200657  branch p_tws_slave_scan_adv
org 0x50001
50001 c0200003  beq zcode_40 ,z_hp_evt_bb_disconnect
50002 20600000  rtn

z_hp_evt_bb_disconnect:
50003 2040002a  call z_init_hp_queue
50004 704b0500  jam 0 ,mem_tws_master_sync_timer
50005 793f8007  set0 mark_esco ,mark
50006 20404478  call hfp_hsp_reset
50007 204072d8  call upper_clear_upper_sm
50008 58000000  setarg 0
50009 67e649e5  store 3 ,mem_avrcp_cmd_phase
5000a 20400713  call p_audio_stop_adac
5000b 6fe249ef  fetch 1 ,mem_tws_profile_connected
5000c 203a0011  branch z_hp_evt_bb_disconnect0 ,blank
5000d 6fe249d5  fetch 1 ,mem_tws_role
5000e c0198011  beq tws_set_slave ,z_hp_evt_bb_disconnect0
5000f 700b0871  jam bt_evt_profile_disconnect ,mem_fifo_temp
50010 2040485e  call ipc_tx_bt_event

z_hp_evt_bb_disconnect0:
50011 20400562  call tws_clear_flag_state
50012 6fe44b07  fetch 2 ,mem_m0_lpm_flag
50013 c3828000  rtnbit1 5
50014 c3838000  rtnbit1 7
50015 6fe249d5  fetch 1 ,mem_tws_role
50016 c019841d  beq tws_set_slave ,p_tws_set_slave_role
50017 c5168019  bmark1 mark_supervision_disconn ,z_abnormal_disc_rec
50018 20204234  branch app_bt_start_discovery

z_abnormal_disc_rec:
50019 793f802d  set0 mark_supervision_disconn ,mark
5001a 700b0872  jam bt_evt_abnormal_disconnect ,mem_fifo_temp
5001b 2020485e  branch ipc_tx_bt_event

z_init_all_queue:
5001c 58004b50  setarg mem_alloc_block
5001d 20400021  call z_queue_init
5001e 58004b69  setarg mem_media_block
5001f 20400021  call z_queue_init
50020 58004b81  setarg mem_lcp_block

z_queue_init:
50021 1fe20a00  copy pdata ,contw
50022 1fe0fe09  add pdata ,block_data_offset ,pdata
50023 e7e40005  istore 2 ,contw
50024 e7e40005  istore 2 ,contw
50025 e7e40005  istore 2 ,contw
50026 1fe0fe0f  add pdata ,block_max_len ,pdata
50027 e7e40005  istore 2 ,contw
50028 df200010  arg block_max_len + 1 ,loopcnt
50029 2020776c  branch clear_mem

z_init_hp_queue:
5002a 2040001c  call z_init_all_queue
5002b 18007205  force block_max_num ,loopcnt
5002c dee04b99  arg mem_queue_ptr ,rege

z_queue_loop:
5002d ea460037  ifetchr regb ,3 ,rege
5002e da204b50  arg mem_alloc_block ,rega
5002f 2040075f  call queue_insert
50030 1ee0ee03  increase 3 ,rege
50031 c200002d  loop z_queue_loop
50032 20600000  rtn
org 0x60001

z_l2cap_process_avctp:
60001 204048d4  call l2cap_rx_reset_state
60002 6fe40311  fetch 2 ,mem_l2cap_payload_ptr
60003 1fe20c00  icopy contr
60004 efe20006  ifetch 1 ,contr
60005 1ff1a200  rshift4 pdata ,rega
60006 62220b0d  storer rega ,1 ,mem_temp
60007 1fe17e03  and pdata ,0x03 ,pdata
60008 c001000b  beq 0x02 ,z_process_avctp_cmd_rsp
60009 c000000b  beq 0x00 ,z_process_avctp_cmd_rsp
6000a 20600000  rtn

z_process_avctp_cmd_rsp:
6000b efe40006  ifetch 2 ,contr
6000c d8400e11  arg actp_profile_identifier_avrcp ,temp
6000d 98467c00  isub temp ,null
6000e 2422c8d4  nbranch l2cap_rx_reset_state ,zero
6000f efe20006  ifetch 1 ,contr
60010 18c08c01  increase 1 ,contr
60011 1fe20400  icopy temp
60012 c006002c  beq avrcp_res_stable ,z_process_avctp_rsp_stable
60013 c000802c  beq avrcp_cmd_type_status ,z_process_avctp_rsp_stable
60014 c0048024  beq avrcp_res_accepted ,z_process_avctp_rsp_accepted
60015 c007801d  beq avrcp_res_notify ,z_process_avctp_notify
60016 c001801d  beq avrcp_cmd_type_notify ,z_process_avctp_notify
60017 c006801a  beq avrcp_change ,z_process_avctp_change_notify
60018 c0000247  beq avrcp_cmd_type_control ,proce_avctp_control
60019 202048d4  branch l2cap_rx_reset_state

z_process_avctp_change_notify:
6001a 20400020  call z_process_avctp_change
6001b 7049e501  jam avrcp_phase_set_notifi ,mem_avrcp_cmd_phase
6001c 20600000  rtn

z_process_avctp_notify:
6001d 18427e00  deposit temp
6001e c0018038  beq avrcp_cmd_type_notify ,z_avrcp_send_set_notify_rsp
6001f 704b3b00  jam 0 ,mem_avrcp_flag

z_process_avctp_change:
60020 18c08c09  increase 9 ,contr
60021 efe20006  ifetch 1 ,contr
60022 67e249e6  store 1 ,mem_avctp_play_state
60023 20600000  rtn

z_process_avctp_rsp_accepted:
60024 efe20006  ifetch 1 ,contr
60025 c0be48d4  bne avrcp_opera_code_pass_through ,l2cap_rx_reset_state
60026 efe20006  ifetch 1 ,contr
60027 c063002a  beq 0xC6 ,z_avrcp_rsp_accept_pause_press
60028 c062002a  beq 0xC4 ,z_avrcp_rsp_accept_pause_press
60029 202048d4  branch l2cap_rx_reset_state

z_avrcp_rsp_accept_pause_press:
6002a 704b3b00  jam 0 ,mem_avrcp_flag
6002b 202048d4  branch l2cap_rx_reset_state

z_process_avctp_rsp_stable:
6002c efe20006  ifetch 1 ,contr
6002d c08048d4  bne avrcp_opera_code_vendor_dependent ,l2cap_rx_reset_state
6002e 18c08c03  increase 3 ,contr
6002f efe20006  ifetch 1 ,contr
60030 c0080032  beq avrcp_op_pdu_get_cap ,z_avrcp_handle_get_cap_rsp
60031 202048d4  branch l2cap_rx_reset_state

z_avrcp_handle_get_cap_rsp:
60032 204048d4  call l2cap_rx_reset_state
60033 18427e00  deposit temp
60034 c0860036  bne avrcp_res_stable ,z_avrcp_send_get_cap_rsp
60035 20200442  branch avr_register_notification_play_status

z_avrcp_send_get_cap_rsp:
60036 da604ac9  arg mem_get_cap_evt_rsp ,regc
60037 20200250  branch avc_malloc_rsp_buff

z_avrcp_send_set_notify_rsp:
60038 704b0301  jam 1 ,mem_vlm_notify_enable
60039 6fe20b0d  fetch 1 ,mem_temp
6003a 67e24b04  store 1 ,mem_vlm_notify_label
6003b da604ad7  arg mem_set_not_rsp ,regc
6003c 20200250  branch avc_malloc_rsp_buff
org 0x70001

z_entrance60:
70001 c0300012  beq zcode_60 ,z_ipc_rx_spp
70002 c0308004  beq zcode_61 ,z_send_lmp
70003 20600000  rtn

z_send_lmp:
70004 6fe20048  fetch 1 ,mem_lmp_to_send
70005 c283d829  bbit1 7 ,send_lmp_escape
70006 c019800e  beq lmp_host_connection_req ,z_send_host_connection_req
70007 c00f8009  beq lmp_incr_power_req ,z_send_incr_power_req
70008 202057f9  branch send_lmp + 6

z_send_incr_power_req:
70009 18007e02  force 2 ,pdata
7000a 20405afb  call msg_send_lmp
7000b dfe00000  arg 0 ,pdata
7000c e7e20005  istore 1 ,contw
7000d 20205b14  branch send_lmp_request

z_send_host_connection_req:
7000e 6fe20535  fetch 1 ,mem_lmp_conn_state
7000f 79207e01  set1 sent_conn_req ,pdata
70010 67e20535  store 1 ,mem_lmp_conn_state
70011 202059a7  branch send_lmp_no_payload

z_ipc_rx_spp:
70012 6fe60bc7  fetch 3 ,mem_zcode_temp_param1
70013 1fe20c00  copy pdata ,contr
70014 18c22200  copy contr ,rega
70015 204052ae  call le_fifo_check_full
70016 247a0000  nrtn blank
70017 6fe446c1  fetch 2 ,mem_ui_state_map
70018 2fec0000  isolate0 ui_state_bt_connected ,pdata
70019 2020c850  branch ipc_rx_ble_discard_packet ,true
7001a 1a220c00  copy rega ,contr
7001b 204047df  call ipc_rx_byte_read
7001c 1fe27200  copy pdata ,loopcnt
7001d 67e445b4  store 2 ,mem_current_packet_length
7001e d8a002ea  arg mem_at_command_data ,contw
7001f 204047d6  call ipc_rx_block_read
70020 20204748  branch hfp_tx_rfcomm_without_credit
org 0x80001
80001 c0380005  beq zcode_70 ,z_le_connected
80002 c038800e  beq zcode_71 ,z_tws_pairing_slave_success
80003 c0390016  beq zcode_72 ,z_le_send_adv_ind
80004 20600000  rtn

z_le_connected:
80005 2040326a  call context_new
80006 24628000  nrtn zero
80007 20404f9a  call le_connect_request
80008 7049d555  jam tws_set_master ,mem_tws_role
80009 7046ea00  jam 0 ,mem_tws_state
8000a 6fec450c  fetch 6 ,mem_le_lap
8000b 67ec46e4  store 6 ,mem_tws_bdaddr
8000c 20400011  call z_tws_pairing_success
8000d 20203183  branch disable_master

z_tws_pairing_slave_success:
8000e 6fec04bd  fetch 6 ,mem_le_plap
8000f 67ec46e4  store 6 ,mem_tws_bdaddr
80010 2040041d  call p_tws_set_slave_role

z_tws_pairing_success:
80011 20400650  call p_clear_context
80012 20404e48  call le_clear_connection_info
80013 700b0801  jam tws_evt_pair_success ,mem_fifo_temp
80014 20400722  call ipc_tx_tws_event
80015 20200663  branch p_nv_update_tws_addr

z_le_send_adv_ind:
80016 18007206  force 6 ,loopcnt
80017 d8a043bc  arg mem_le_adv_data + 9 ,contw
80018 d8404145  arg mem_lap + 5 ,temp

z_set_iphone_adv_bdaddr:
80019 efe20002  ifetch 1 ,temp
8001a e7e20005  istore 1 ,contw
8001b 184085ff  increase -1 ,temp
8001c c2000019  loop z_set_iphone_adv_bdaddr
8001d 6fe24a25  fetch 1 ,mem_bat_level
8001e 1fe0fe01  increase 1 ,pdata
8001f 1feffe06  mul32 pdata ,6 ,pdata
80020 67e243c3  store 1 ,mem_le_adv_data + 16
80021 67e243c4  store 1 ,mem_le_adv_data + 17
80022 7043c601  jam 1 ,mem_le_adv_data + 19
80023 6fe24b17  fetch 1 ,mem_adv_count
80024 c0640028  beq 200 ,z_le_send_adv_ind0
80025 1fe0fe01  increase 1 ,pdata
80026 67e24b17  store 1 ,mem_adv_count
80027 7043c609  jam 0x09 ,mem_le_adv_data + 19

z_le_send_adv_ind0:
80028 70440900  jam 0 ,mem_le_txheader
80029 20204f5c  branch le_send_adv_ind + 7
org 0x90001

z_entrance80:
90001 c0400004  beq zcode_80 ,z_tws_send_context_info
90002 c040802e  beq zcode_81 ,z_tws_send_context_info_phase_end
90003 20600000  rtn

z_tws_send_context_info:
90004 6fe20bb9  fetch 1 ,mem_tws_context_offset
90005 c02d0016  beq 90 ,z_tws_send_afh
90006 c034800f  beq 105 ,z_tws_send_sco_info
90007 c03c0022  beq 120 ,z_tws_send_a2dp_info
90008 2040000a  call z_tws_send_context_info_phase
90009 20207a9a  branch tws_send_context_info + 5

z_tws_send_context_info_phase:
9000a 20407a0f  call tws_set_send_context_header
9000b 68420bb9  fetcht 1 ,mem_tws_context_offset
9000c e0420005  istoret 1 ,contw
9000d 58000030  setarg mem_state
9000e 20600000  rtn

z_tws_send_sco_info:
9000f 2040000a  call z_tws_send_context_info_phase
90010 18007218  force 24 ,loopcnt
90011 d8c042f9  arg mem_xmem_sco_start ,contr

z_tws_send_context_info0:
90012 2040779f  call memcpy
90013 6fe20bb9  fetch 1 ,mem_tws_context_offset
90014 1fe0fe0f  increase 15 ,pdata
90015 20207a9f  branch tws_send_context_info0

z_tws_send_afh:
90016 2040000a  call z_tws_send_context_info_phase
90017 6fe242ac  fetch 1 ,mem_audio_vol
90018 e7e20005  istore 1 ,contw
90019 6fe249e6  fetch 1 ,mem_avctp_play_state
9001a e7e20005  istore 1 ,contw
9001b 1800721c  force 28 ,loopcnt
9001c d8c04175  arg mem_afh_error_total ,contr
9001d 2040779f  call memcpy
9001e 6fe20bb9  fetch 1 ,mem_tws_context_offset
9001f 1fe0fe0f  increase 15 ,pdata
90020 67e20bb9  store 1 ,mem_tws_context_offset
90021 20207aa3  branch tws_send_context_info1

z_tws_send_a2dp_info:
90022 2040000a  call z_tws_send_context_info_phase
90023 18007215  force 21 ,loopcnt
90024 d8c045a6  arg mem_rfc_xmem_start ,contr
90025 2040779f  call memcpy
90026 6fe842e6  fetch 4 ,mem_avctp_xmem_start
90027 e7e80005  istore 4 ,contw
90028 6fea4296  fetch 5 ,mem_audio_allow
90029 e7ea0005  istore 5 ,contw
9002a 6fe249e3  fetch 1 ,mem_a2dp_state
9002b 18a08bfc  increase -4 ,contw
9002c e7e20005  istore 1 ,contw
9002d 20207a9d  branch tws_send_context_info + 8

z_tws_send_context_info_phase_end:
9002e 2040000a  call z_tws_send_context_info_phase
9002f 1800721e  force 30 ,loopcnt
90030 d8c04363  arg mem_l2cap_active_ch_count ,contr
90031 2040779f  call memcpy
90032 18007204  force 4 ,loopcnt
90033 d8c04292  arg mem_avdtp_xmem_start ,contr
90034 2040779f  call memcpy
90035 18007213  force 19 ,loopcnt
90036 d8c04312  arg mem_xmem_hf_state_start ,contr
90037 2040779f  call memcpy
90038 70440a3c  jam 60 ,mem_le_txlen
90039 20207a06  branch tws_send_context_info_phase_end + 8
org 0xA0001

z_entrance9:
a0001 c0480005  beq zcode_90 ,z_avrcp_cmd_handle
a0002 c0488010  beq zcode_91 ,z_a2dp_press_play_pause
a0003 c049001c  beq zcode_92 ,z_l2cap_proc_signal_connect_rsp
a0004 20600000  rtn

z_avrcp_cmd_handle:
a0005 20404a61  call l2cap_malloc_is_fifo_empty
a0006 247a0000  nrtn blank
a0007 6fe24b3b  fetch 1 ,mem_avrcp_flag
a0008 247a0000  nrtn blank
a0009 6fe249e5  fetch 1 ,mem_avrcp_cmd_phase
a000a 207a0000  rtn blank
a000b 7049e500  jam 0 ,mem_avrcp_cmd_phase
a000c c0008442  beq avrcp_phase_set_notifi ,avr_register_notification_play_status
a000d c0018234  beq avrcp_phase_play_pressed ,avrcp_cmd_play_press
a000e c0038238  beq avrcp_phase_pause_pressed ,avrcp_cmd_pause_press
a000f 20600000  rtn

z_a2dp_press_play_pause:
a0010 c6158000  rtnmark1 mark_sco_flag
a0011 6fe249e5  fetch 1 ,mem_avrcp_cmd_phase
a0012 247a0000  nrtn blank
a0013 6fe249e6  fetch 1 ,mem_avctp_play_state
a0014 c0010018  beq avrcp_pause_status ,z_avrcp_set_play_cmd
a0015 c000801a  beq avrcp_start_status ,z_avrcp_set_pause_cmd
a0016 c0000018  beq avrcp_suspend_status ,z_avrcp_set_play_cmd
a0017 20600000  rtn

z_avrcp_set_play_cmd:
a0018 7049e503  jam avrcp_phase_play_pressed ,mem_avrcp_cmd_phase
a0019 20200231  branch check_exit_sniff

z_avrcp_set_pause_cmd:
a001a 7049e507  jam avrcp_phase_pause_pressed ,mem_avrcp_cmd_phase
a001b 20600000  rtn

z_l2cap_proc_signal_connect_rsp:
a001c 6fe40313  fetch 2 ,mem_l2cap_rx_pkt_length
a001d 1fe22600  copy pdata ,regc
a001e 6fe40311  fetch 2 ,mem_l2cap_payload_ptr
a001f 98000c00  iforce contr
a0020 efe20006  ifetch 1 ,contr
a0021 18c08c07  increase 7 ,contr
a0022 efe40006  ifetch 2 ,contr
a0023 18c08df7  increase -9 ,contr
a0024 c000497b  beq l2cap_connect_successful ,l2cap_proc_signal_connect_rsp + 1
a0025 c1008000  rtneq l2cap_connect_pending
a0026 18c08c05  increase 5 ,contr
a0027 ea240006  ifetchr rega ,2 ,contr
a0028 20404b24  call l2cap_get_channel_info_by_local_cid
a0029 efec0013  ifetch 6 ,regc
a002a 67ec035f  store 6 ,mem_l2cap_temp_ch_psm
a002b 6fe20002  fetch rega ,2 ,mem_l2cap_temp_local_cid
a002c 20404afd  call l2cap_destory_channel
a002d 20204b61  branch l2cap_clear_server_ptr
org 0xB0001

z_check_51cmd_once_continue:
b0001 6fe20b08  fetch 1 ,mem_fifo_temp
b0002 c584f245  bmark0 mark_context ,check_51cmd_check_idle
b0003 c041800a  beq bt_cmd_inc_power ,z_cmd_inc_power
b0004 c002800c  beq bt_cmd_enter_sniff ,z_cmd_in_sniff
b0005 c00343d4  beq bt_cmd_exit_sniff ,cmd_exit_sniff
b0006 c010001b  beq bt_cmd_store_reconn_info_bt ,z_nv_update_bd_info
b0007 c0480020  beq bt_cmd_forward ,avrcp_send_forward
b0008 c0478025  beq bt_cmd_backward ,avrcp_send_backward
b0009 20207234  branch check_51cmd_once_continue + 3

z_cmd_inc_power:
b000a 70007c1f  jam lmp_incr_power_req ,mem_lmo_opcode2
b000b 20204364  branch cmd_exit

z_cmd_in_sniff:
b000c 6fe446c1  fetch 2 ,mem_ui_state_map
b000d c4000000  rtnbit0 ui_state_bt_connected
b000e c3828000  rtnbit1 ui_state_bt_sniff
b000f 6fe28106  fetch 1 ,core_dac_ctrl
b0010 c3800000  rtnbit1 dac_enable
b0011 6fe24312  fetch 1 ,mem_hf_state
b0012 c1848000  rtnne hf_state_connected
b0013 6fe24296  fetch 1 ,mem_audio_allow
b0014 c1800000  rtnne avd_audio_forbid
b0015 6fe24313  fetch 1 ,mem_hf_call_state
b0016 c1800000  rtnne hfp_nono
b0017 202043bc  branch cmd_in_sniff

z_cmd_exit_sniff:
b0018 6fe446c1  fetch 2 ,mem_ui_state_map
b0019 c4028000  rtnbit0 ui_state_bt_sniff
b001a 202043d4  branch cmd_exit_sniff

z_nv_update_bd_info:
b001b 7049d500  jam 0 ,mem_tws_role
b001c 6fe249b2  fetch 1 ,mem_tws_record_state
b001d 1fe17ef0  and_into 0xf0 ,pdata
b001e 1fe1fe05  or_into 0x05 ,pdata
b001f 20200668  branch p_nv_update_tws_reconn_info

avrcp_send_forward:
b0020 dee0004b  arg passthrough_id_forward ,rege
b0021 204042ab  call arc_send_ct
b0022 dee0004b  arg passthrough_id_forward ,rege
b0023 79206e07  set1 7 ,rege
b0024 202042ab  branch arc_send_ct

avrcp_send_backward:
b0025 dee0004c  arg passthrough_id_backward ,rege
b0026 204042ab  call arc_send_ct
b0027 dee0004c  arg passthrough_id_backward ,rege
b0028 79206e07  set1 7 ,rege
b0029 202042ab  branch arc_send_ct
org 0xC0001

z_entranceb:

z_check_51cmd_once_ext:
c0001 6fe20bc7  fetch 1 ,mem_zcode_temp_param1
c0002 1fe67c4f  sub pdata ,tws_sync_cmd_start ,null
c0003 20210007  branch z_handle_normal_cmd ,positive
c0004 1fe67c7f  sub pdata ,tws_sync_cmd_end ,null
c0005 24210007  nbranch z_handle_normal_cmd ,positive
c0006 20200327  branch p_send_tws_cmd

z_handle_normal_cmd:
c0007 c024068a  beq bt_cmd_tws_none ,p_exit_tws_state
c0008 c0444481  beq bt_cmd_hfp_indicators_update ,hfp_evt_update_state
c0009 c0400673  beq bt_cmd_load_info ,p_nv_load_tws_info
c000a c001867e  beq bt_cmd_reconnect ,p_reconnect_phone
c000b c0008022  beq bt_cmd_start_discovery ,z_check_51cmd_start_discovery
c000c c0010333  beq bt_cmd_stop_discovery ,p_check_51cmd_stop_discovery
c000d c018844b  beq bt_cmd_play_pause ,a2dp_press_play_pause
c000e c01944b0  beq bt_cmd_accept_call ,hfp_send_answer_call
c000f c019c4ba  beq bt_cmd_hang_up ,hfp_send_hang_up
c0010 c01a840b  beq bt_cmd_redial ,hfp_send_redial
c0011 c01b040e  beq bt_cmd_recognition ,hfp_send_recognition
c0012 c0408319  beq bt_cmd_recover_audio ,p_recover_audio
c0013 c0448401  beq bt_cmd_reconnect_avdtp ,p_reconnect_avdtp
c0014 c0450471  beq tws_sync_cmd_switch_to_master ,p_change_to_wait_tws_slave
c0015 c0458314  beq tws_sync_cmd_accpet_switch ,p_tws_master_switch_success
c0016 c0470471  beq tws_sync_cmd_wait_tws_slave ,p_change_to_wait_tws_slave
c0017 c020002c  beq bt_cmd_enter_tws_pair ,z_enter_tws_pairing
c0018 c0208034  beq bt_cmd_exit_tws_pair ,z_exit_tws_pairing
c0019 c022041b  beq bt_cmd_start_wait_master ,p_start_wait_tws_master
c001a c0228422  beq bt_cmd_stop_wait_master ,p_stop_wait_tws_master
c001b c0230411  beq bt_cmd_start_wait_slave ,p_start_wait_tws_slave
c001c c0238422  beq bt_cmd_stop_wait_slave ,p_stop_wait_tws_slave
c001d c0210038  beq bt_cmd_start_recon_tws ,z_start_recon_tws
c001e c0218422  beq bt_cmd_stop_recon_tws ,p_stop_recon_tws
c001f c0460337  beq bt_cmd_charge_full_poweroff ,p_charge_full_power_off
c0020 c0468337  beq bt_cmd_charge_disconnect ,p_charge_disconnect
c0021 20207219  branch check_51cmd_once + 8

z_check_51cmd_start_discovery:
c0022 704b1700  jam 0 ,mem_adv_count
c0023 7043b101  jam 1 ,mem_le_adv_enable
c0024 20400028  call z_start_arbiter_recon_check
c0025 700b0868  jam bt_evt_enter_discoverable ,mem_fifo_temp
c0026 2040485e  call ipc_tx_bt_event
c0027 20207255  branch check_51cmd_start_discovery

z_start_arbiter_recon_check:
c0028 6fec46e4  fetch 6 ,mem_tws_bdaddr
c0029 207a0000  rtn blank
c002a 7046eac1  jam 0xc1 ,mem_tws_state
c002b 20600000  rtn

z_enter_tws_pairing:
c002c 20404236  call app_bt_stop_discovery
c002d 2040422f  call app_bt_reconnect_cancel

z_tws_set_pair:
c002e 7046ea03  jam 0x03 ,mem_tws_state
c002f 7049d500  jam 0 ,mem_tws_role
c0030 6fec49d8  fetch 6 ,mem_local_lap
c0031 67ec450c  store 6 ,mem_le_lap
c0032 700b0803  jam tws_evt_enter_pair ,mem_fifo_temp
c0033 20200722  branch ipc_tx_tws_event

z_exit_tws_pairing:
c0034 7046ea00  jam 0x00 ,mem_tws_state
c0035 7049d500  jam 0 ,mem_tws_role
c0036 700b0802  jam tws_evt_exit_pair ,mem_fifo_temp
c0037 20200722  branch ipc_tx_tws_event

z_start_recon_tws:
c0038 6fec46e4  fetch 6 ,mem_tws_bdaddr
c0039 203a0423  branch p_tws_recon_fail ,blank
c003a 7046ea81  jam 0x81 ,mem_tws_state
c003b 7049d500  jam 0 ,mem_tws_role
c003c 700b0804  jam tws_evt_start_recon ,mem_fifo_temp
c003d 20200722  branch ipc_tx_tws_event
org 0xD0001

z_upper_major_connect_audio:
d0001 6fe246dd  fetch 1 ,mem_sub_uppersm
d0002 c000800f  beq up_sub_sm_creat_avdtp_sig ,z_upper_sub_connect_avdtp_sig
d0003 c0047411  beq up_sub_sm_avdtp_getcap_wait ,upper_sub_avdtp_sig_getcap_wait
d0004 c00481ca  beq up_sub_sm_avdtp_setconf ,p_upper_sub_avdtp_sig_setconf
d0005 c005800c  beq up_sub_sm_avdtp_open ,z_upper_sub_avdtp_sig_open
d0006 c0080012  beq up_sub_sm_config_avdtp_media_wait ,z_upper_sub_config_avdtp_media_wait
d0007 c0088019  beq up_sub_sm_creat_avctp ,z_upper_sub_connect_avctp
d0008 c0090022  beq up_sub_sm_creat_avctp_wait ,z_upper_sub_connect_avctp_wait
d0009 c0098028  beq up_sub_sm_config_avctp ,z_upper_sub_config_avctp
d000a c00a002a  beq up_sub_sm_config_avctp_wait ,z_upper_sub_config_avctp_wait
d000b 202073e4  branch upper_major_connect_audio + 2

z_upper_sub_avdtp_sig_open:
d000c 700b0806  jam avdtp_identifier_open ,mem_fifo_temp
d000d 20400726  call ipc_tx_a2dp_event
d000e 2020741b  branch upper_sub_avdtp_sig_open

z_upper_sub_connect_avdtp_sig:
d000f 6fe44292  fetch 2 ,mem_avdtpsignal_l2capch_ptr
d0010 203a73f5  branch upper_sub_connect_avdtp_sig ,blank
d0011 202072bf  branch upper_reset_sm

z_upper_sub_config_avdtp_media_wait:
d0012 6a644292  fetchr regc ,2 ,mem_avdtpsignal_l2capch_ptr
d0013 1a60a601  add regc ,offset_lc_state ,regc
d0014 efe20013  ifetch 1 ,regc
d0015 c4028000  rtnbit0 l2cap_channel_state_rcv_cfg_res
d0016 c4020000  rtnbit0 l2cap_channel_state_rcv_cfg_req
d0017 7046dd11  jam up_sub_sm_creat_avctp ,mem_sub_uppersm
d0018 20600000  rtn

z_upper_sub_connect_avctp:
d0019 6a6442e8  fetchr regc ,2 ,mem_avr_l2capch_ptr
d001a 1a60a601  add regc ,offset_lc_state ,regc
d001b efe20013  ifetch 1 ,regc
d001c 243a72bf  nbranch upper_reset_sm ,blank
d001d 7046dd12  jam up_sub_sm_creat_avctp_wait ,mem_sub_uppersm
d001e db000017  arg psm_avctp ,regd
d001f 20404ac7  call l2cap_send_server_conn
d0020 626442e8  storer regc ,2 ,mem_avr_l2capch_ptr
d0021 20600000  rtn

z_upper_sub_connect_avctp_wait:
d0022 6a6442e8  fetchr regc ,2 ,mem_avr_l2capch_ptr
d0023 1a60a601  add regc ,offset_lc_state ,regc
d0024 efe20013  ifetch 1 ,regc
d0025 c4008000  rtnbit0 l2cap_channel_state_conn_res
d0026 7046dd13  jam up_sub_sm_config_avctp ,mem_sub_uppersm
d0027 20600000  rtn

z_upper_sub_config_avctp:
d0028 7046dd14  jam up_sub_sm_config_avctp_wait ,mem_sub_uppersm
d0029 20600000  rtn

z_upper_sub_config_avctp_wait:
d002a 6a6442e8  fetchr regc ,2 ,mem_avr_l2capch_ptr
d002b 1a60a601  add regc ,offset_lc_state ,regc
d002c efe20013  ifetch 1 ,regc
d002d c4028000  rtnbit0 l2cap_channel_state_rcv_cfg_res
d002e c4020000  rtnbit0 l2cap_channel_state_rcv_cfg_req
d002f 202072bf  branch upper_reset_sm
org 0xe0001

z_upper_sub_avdtp_sig_setconf:
e0001 7046dd0a  jam up_sub_sm_avdtp_setconf_wait ,mem_sub_uppersm
e0002 7042a302  jam 2 ,mem_conf_sample_freq
e0003 6fe20bc0  fetch 1 ,mem_getcap_codec_type + 2
e0004 c282800e  bbit1 5 ,z_avd_signal_send_setconf
e0005 c2820007  bbit1 4 ,z_avd_signal_send_setconf_48k
e0006 2020000e  branch z_avd_signal_send_setconf

z_avd_signal_send_setconf_48k:
e0007 7042a301  jam 1 ,mem_conf_sample_freq
e0008 20404121  call avd_signal_send_setconf
e0009 18a08bfc  increase -4 ,contw
e000a 58000011  setarg 0x11
e000b e7e20005  istore 1 ,contw
e000c 18a08a02  increase 2 ,contw
e000d 20200010  branch z_avd_signal_send_setconf_end

z_avd_signal_send_setconf:
e000e 20404121  call avd_signal_send_setconf
e000f 18a08bff  increase -1 ,contw

z_avd_signal_send_setconf_end:
e0010 58000021  setarg 0x21
e0011 e7e20005  istore 1 ,contw
e0012 18a08bf5  increase -11 ,contw
e0013 dfe00004  arg 4 ,pdata
e0014 2020428f  branch istore_byte
org 0xf0001
f0001 c0700004  beq zcode_e0 ,z_cb_enter_hibernate
f0002 c0708021  beq zcode_e1 ,z_enter_snooze
f0003 20600000  rtn

z_cb_enter_hibernate:
f0004 70433401  jam mcu_state_hibernate ,mem_ipc_mcu_state
f0005 204002c5  call ipc_check_ack
f0006 20400016  call z_qspi_powerdown_flash

z_clear_gpio_before_hibernate:
f0007 df200020  arg 32 ,loopcnt
f0008 d8c08080  arg core_gpio_conf ,contr

setgpio_loop:
f0009 18c20a00  copy contr ,contw
f000a efe20006  ifetch 1 ,contr
f000b c0018012  beq gpcfg_qspi_sck ,setgpio_pulldown
f000c c0020012  beq gpcfg_qspi_io0 ,setgpio_pulldown
f000d c0028012  beq gpcfg_qspi_io1 ,setgpio_pulldown
f000e c0038012  beq gpcfg_qspi_io3 ,setgpio_pulldown
f000f c0160012  beq gpcfg_iic_scl ,setgpio_pulldown
f0010 c0168012  beq gpcfg_iic_sda ,setgpio_pulldown
f0011 c0800014  bne gpcfg_input ,setgpio_loop_end

setgpio_pulldown:
f0012 58000080  setarg gpcfg_pulldown
f0013 e7e20005  istore 1 ,contw

setgpio_loop_end:
f0014 c2000009  loop setgpio_loop
f0015 20600000  rtn

z_qspi_powerdown_flash:
f0016 7080a004  jam 0x04 ,core_qspi_ctrl
f0017 7080a100  jam 0 ,core_qspi_delay
f0018 58000000  setarg 0
f0019 67e480a8  store 2 ,core_qspi_rxlen
f001a 58000001  setarg 1
f001b 67e480a2  store 2 ,core_qspi_txlen
f001c 580001ee  setarg mem_qspi_tbuf
f001d 67e480a4  store 2 ,core_qspi_txaddr
f001e 7001eeb9  jam 0xb9 ,mem_qspi_tbuf
f001f 70800a08  jam qspi_start ,core_dma_start
f0020 20205cfe  branch wait_qspi_done

z_enter_snooze:
f0021 20400004  call z_cb_enter_hibernate
f0022 708051ff  jam 0xff ,core_clkoff + 1
f0023 708050e1  jam 0xe1 ,core_clkoff
f0024 70890600  jam 0 ,rfen_adc
f0025 20403ca3  call lpm_write_gpio_wakeup
f0026 70804300  jam 0 ,core_config
f0027 70804204  jam 4 ,core_clksel
f0028 6fe88336  fetch 4 ,core_lpm_ctrl
f0029 793ffe02  set0 2 ,pdata
f002a 67e8804c  store 4 ,core_lpm_reg
f002b 20403c9b  call lpm_write_ctrl
f002c 58000fff  setarg 0xfff
f002d 1ff07e00  lshift16 pdata ,pdata
f002e 1ff07e00  lshift16 pdata ,pdata
f002f 9e20e000  iadd lpo_time ,alarm
f0030 07e00000  snooze
f0031 6fe88336  fetch 4 ,core_lpm_ctrl
f0032 79207e02  set1 2 ,pdata
f0033 67e8804c  store 4 ,core_lpm_reg
f0034 20403c9b  call lpm_write_ctrl
f0035 70801003  jam 0x03 ,core_reset
 jam 0x03 ,core_reset

#include<string.h>
#include<stdio.h>
#include "Drv_debug.h"
#include "yc_timer.h"
#include "yc_keypad.h"
#include "yc_RemoteCtr.h"
#include "yc11xx.h"
#include "ipc.h"
#include "Drv_adc.h"
#include "Drv_mic.h"
#include "Drv_msbc.h"
#include "Drv_bt.h"

#define RECORE_BUFFER_SIZE 480

unsigned char micRecordbuf[RECORE_BUFFER_SIZE]=
{
 0x66,0x06,0x36,0x0B,0xFC,0x0F,0xB4,0x14,0x55,0x19,0xD8,0x1D,0x36,0x22,0x69,0x26
,0x68,0x2A,0x30,0x2E,0xB8,0x31,0xFC,0x34,0xF6,0x37,0xA2,0x3A,0xFC,0x3C,0x00,0x3F
,0xAA,0x40,0xF8,0x41,0xE9,0x42,0x79,0x43,0xA9,0x43,0x7A,0x43,0xE8,0x42,0xF8,0x41
,0xAA,0x40,0xFF,0x3E,0xFD,0x3C,0xA2,0x3A,0xF6,0x37,0xFC,0x34,0xB8,0x31,0x2F,0x2E
,0x68,0x2A,0x69,0x26,0x37,0x22,0xD7,0x1D,0x54,0x19,0xB4,0x14,0xFC,0x0F,0x36,0x0B
,0x67,0x06,0x98,0x01,0xD1,0xFC,0x19,0xF8,0x77,0xF3,0xF5,0xEE,0x97,0xEA,0x63,0xE6
,0x64,0xE2,0x9C,0xDE,0x15,0xDB,0xD1,0xD7,0xD7,0xD4,0x2B,0xD2,0xD1,0xCF,0xCC,0xCD
,0x22,0xCC,0xD5,0xCA,0xE4,0xC9,0x54,0xC9,0x23,0xC9,0x53,0xC9,0xE4,0xC9,0xD4,0xCA
,0x23,0xCC,0xCD,0xCD,0xD1,0xCF,0x2B,0xD2,0xD7,0xD4,0xD1,0xD7,0x14,0xDB,0x9D,0xDE
,0x64,0xE2,0x64,0xE6,0x97,0xEA,0xF4,0xEE,0x78,0xF3,0x19,0xF8,0xD1,0xFC,0x98,0x01
,0x66,0x06,0x35,0x0B,0xFB,0x0F,0xB3,0x14,0x55,0x19,0xD8,0x1D,0x36,0x22,0x69,0x26
,0x68,0x2A,0x30,0x2E,0xB9,0x31,0xFD,0x34,0xF7,0x37,0xA2,0x3A,0xFD,0x3C,0x00,0x3F
,0xAA,0x40,0xF8,0x41,0xE9,0x42,0x79,0x43,0xA9,0x43,0x7A,0x43,0xE8,0x42,0xF9,0x41
,0xAA,0x40,0x00,0x3F,0xFC,0x3C,0xA3,0x3A,0xF6,0x37,0xFC,0x34,0xB8,0x31,0x30,0x2E
,0x69,0x2A,0x68,0x26,0x36,0x22,0xD8,0x1D,0x55,0x19,0xB3,0x14,0xFC,0x0F,0x35,0x0B
};

#define MSBC_ENCODE_BUFFER_SIZE 114
unsigned char msbcEncodebuf[MSBC_ENCODE_BUFFER_SIZE];

tIPCHandleCb gTIPCHandleCb[IPC_TYPE_NUM]=
{
	0,
	IpcDefaultCallBack,//cmd
	IpcDefaultCallBack,//evt
	IpcDefaultCallBack,//hid
	IpcDefaultCallBack,//spp
	IpcDefaultCallBack,//ble
	IpcDefaultCallBack,//24g
	IpcDefaultCallBack,//mesh
	IpcDefaultCallBack,//mesh
	IpcDefaultCallBack,//mesh
	IpcDefaultCallBack,//a2dp
	IpcDefaultCallBack//hfp
};

unsigned char destdata[57]=
{
 0xAD
,0x00
,0x00
,0x1B
,0xD9
,0x76
,0x56
,0x65
,0x7F
,0x76
,0xD6
,0xE0
,0x1D
,0xB5
,0xB8
,0x48
,0x6D
,0x6E
,0x2D
,0x1C
,0xA3
,0xB5
,0xC1
,0x53
,0x79
,0x59
,0x11
,0x3D
,0x88
,0x6D
,0x6E
,0xA9
,0xDB
,0x5B
,0x6C
,0x76
,0xD6
,0xCE
,0x5D
,0xB5
,0xB2
,0x27
,0x6D
,0x6C
,0xC9
,0xDB
,0x5B
,0x62
,0x76
,0xD6
,0xE7
,0xDD
,0xB5
,0xBD
,0x37
,0x6D
,0x6C
};

unsigned char *destPtr;
void test_msbc_Only()
{
	int a,me,temp;
	DEBUG_INIT();

	gMsbc_params.mSrcBuf = micRecordbuf;
	gMsbc_params.mSrcBufLen = RECORE_BUFFER_SIZE;
	gMsbc_params.mDstBuf = msbcEncodebuf;
	gMsbc_params.mDstBufLen =  MSBC_ENCODE_BUFFER_SIZE;
	Drv_mSBC_init();
	destPtr = msbcEncodebuf;
	
	Drv_mSBC_enable_test();
	while (1)
	{			
		Drv_mSBC_RefreshWptr(ENCODE_PACKETS_LEN);
		me = 400;
		while (me--);
		while(!Drv_mSBC_CheckEncodeCmp());	
		{			
			//DEBUG_PRINT2(destPtr,ENCODE_OUTPUT_LEN);
			
			for(me = 0; me<57;me++)
			{
				if (destPtr[0] == 0)
					break;
				if(destPtr[me] != destdata[me] )
				{
					while(1);
				}
			}
			
		}
		me = 20000;
		while (me--);
		me = 20000;
		Drv_mSBC_disable_test();
		while (me--);
		me = 20000;
		Drv_mSBC_enable_test();
		while (me--);
	}
	while(1);
	
}



void main()
{
	test_msbc_Only();
	while(1);
}


